<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.8" />
<title>Intel&#174; Integrated Performance Primitives Unified Media Classes</title>
<style type="text/css">
/* Custom theme based on CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body, thead, p.table.header, div.title, caption.title
{
    font-family: Verdana, Arial, sans-serif;
    font-size: 10pt;
}
/*
thead, p.table.header
{
    font-size: 1em;
}*/

/* Title font. */
/*h1, h2, h3, h4, h5, h6,
#toctitle, #author, #revnumber, #revdate, #revremark, #footer
{
    font-family: "Neo Sans Intel",Tahoma,Arial,Helvetica,sans-serif;
}*/

body
{
    color: #333333;
    background-color: #ffffff;
    margin: 1em 5% 1em 5%;
}

img
{
    max-width: 100%;
    table-layout: fixed;
}

div.imageblock img
{
    border-bottom: 1px solid #bababa;
    border-top: 1px solid #bababa;
}

div.listingblock > div.content
{
    font-size: 0.9em;
    overflow: auto;
}

a
{
    color: #0860a8;
    text-decoration: underline;
}
a:visited
{
    color: #0860a8;
}

em
{
    font-style: italic;
/*    color: navy;*/
}

strong
{
    font-weight: bold;
/*    color: #0860a8;*/
}

h1, h2, h3, h4, h5, h6
{
    font-weight: normal;
    color: #0860a8;
    margin-top: 1.0em;
    margin-bottom: 0.5em;
/*    line-height: 1.3;*/
}

h1 {
  border-bottom: 2px solid #0860A8;
  font-size: 2.0em;
/*  color: black;*/
}
h2
{
/*    border-bottom: 1px solid #0860A8;*/
    font-size: 1.5em;
}
h3
{
/*  margin-top: 0.5em;*/
    font-size: 1.5em;
/*  float: left;*/
}/*
h3 + * {
  clear: left;
}*/
h4
{
    font-size: 1.5em;
}
h5
{
/*  margin-top: 1.5em;*/
    font-size: 1.5em;
}

div.sectionbody
{
    margin-left: 0;
}

hr
{
    border: 1px solid #0860A8;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: #333333; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
/*  color: navy;*/
  padding: 0;
  margin: 0;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
    font-weight: bold;
    text-align: left;
    margin-top: 1em;
    margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  font-weight: bold;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  font-weight: normal;
  white-space: nowrap;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

/*
 * TOC control
*/

#toc
{
    background-color: #f1f1f1;
}

#toctitle
{
    border-bottom: 2px solid silver;
    color: #333333;
    font-size: 15pt;
    font-weight: normal;
    margin-top: 1.0em;
    margin-bottom: 0.5em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4
{
    margin-top: 0;
    margin-bottom: 0;
}
div.toclevel0 > a, div.toclevel1 > a, div.toclevel2 > a, div.toclevel3 > a, div.toclevel4 > a
{
    text-decoration: none;
    color: #333333;
}
div.toclevel0 > a:hover, div.toclevel1 > a:hover, div.toclevel2 > a:hover, div.toclevel3 > a:hover, div.toclevel4 > a:hover
{
    text-decoration: underline;
}
div.toclevel0
{
    margin-top: 0.5em;
    color: black;
    font-weight: bold;
}
div.toclevel1
{
    margin-top: 0.5em;
    margin-left: 0.8em;
}
div.toclevel2
{
    list-style-type: circle;
    display: list-item;
    margin-top: 0.5em;
    margin-left: 2em;
}
div.toclevel3
{
    list-style-type: square;
    display: list-item;
    margin-top: 0.2em;
    margin-left: 3.8em;
    font-size: 0.8em;
}
div.toclevel4
{
    display: list-item;
    margin-top: 0.2em;
    margin-left: 5.1em;
    font-size: 0.8em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * Tables control
*/

div.tableblock
{
    margin-top: 1.0em;
    margin-bottom: 1.5em;
    border-color: #bababa;
}
div.tableblock > table
{
    border-collapse: collapse;
    border: 1px solid #bababa;
}
td, th, tr, thead, tfoot, tbody, table,p.table
{
    border-color: #bababa;
}
thead, p.table.header
{
    font-weight: bold;
    background-color: #555555;
    border-color: #bababa;
    color: #FFFFFF;
}
p.table
{
    margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"]
{
    border-style: none;
}
div.tableblock > table[frame="hsides"]
{
    border-left-style: none;
    border-right-style: none;
}
div.tableblock > table[frame="vsides"]
{
    border-top-style: none;
    border-bottom-style: none;
}

/* TOC2 and images width control */
@media print
{
    body.manpage div#toc { display: none; }
}

@media screen
{
    body
    {
        max-width: 60em; /* approximately 80 characters wide */
        margin-left: 25em;
    }
    #toc
    {
        min-width: 17em;
        max-width: 22em;
    }
}


@media screen {
  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    padding: 0.5em;
    margin: 0;
    overflow: auto;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(4);
/*]]>*/
</script>
</head>
<body class="book">
<div id="header">
<h1>Intel&#174; Integrated Performance Primitives Unified Media Classes</h1>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<h1 id="disclaimer" style="font-size:6pt; color:#FFFFFF; border-style:hidden; margin:0px;">Disclaimer</h1>

<font size="-3">
<p><font size="-3">INFORMATION IN THIS DOCUMENT IS PROVIDED IN CONNECTION WITH INTEL PRODUCTS.
NO LICENSE, EXPRESS OR IMPLIED, BY ESTOPPEL OR OTHERWISE, TO ANY INTELLECTUAL
PROPERTY RIGHTS IS GRANTED BY THIS DOCUMENT. EXCEPT AS PROVIDED IN INTEL'S
TERMS AND CONDITIONS OF SALE FOR SUCH PRODUCTS, INTEL ASSUMES NO LIABILITY
WHATSOEVER, AND INTEL DISCLAIMS ANY EXPRESS OR IMPLIED WARRANTY, RELATING
TO SALE AND/OR USE OF INTEL PRODUCTS INCLUDING LIABILITY OR WARRANTIES
RELATING TO FITNESS FOR A PARTICULAR PURPOSE, MERCHANTABILITY, OR INFRINGEMENT
OF ANY PATENT, COPYRIGHT OR OTHER INTELLECTUAL PROPERTY RIGHT.<br>
A   "Mission Critical Application" is any application in which failure of the   Intel Product could result, directly or indirectly, in personal injury or death.   SHOULD YOU PURCHASE OR USE INTEL'S PRODUCTS FOR ANY SUCH MISSION CRITICAL   APPLICATION, YOU SHALL INDEMNIFY AND HOLD INTEL AND ITS SUBSIDIARIES,   SUBCONTRACTORS AND AFFILIATES, AND THE DIRECTORS, OFFICERS, AND EMPLOYEES OF   EACH, HARMLESS AGAINST ALL CLAIMS COSTS, DAMAGES, AND EXPENSES AND REASONABLE   ATTORNEYS' FEES ARISING OUT OF, DIRECTLY OR INDIRECTLY, ANY CLAIM OF PRODUCT   LIABILITY, PERSONAL INJURY, OR DEATH ARISING IN ANY WAY OUT OF SUCH MISSION   CRITICAL APPLICATION, WHETHER OR NOT INTEL OR ITS SUBCONTRACTOR WAS NEGLIGENT IN   THE DESIGN, MANUFACTURE, OR WARNING OF THE INTEL PRODUCT OR ANY OF ITS PARTS.</font></p>
</font>
<p><font size="-3"> Intel may make changes to specifications and product descriptions at any time,
  without notice. Designers must not rely on the absence or characteristics of any
  features or instructions marked "reserved" or "undefined." Intel reserves these
  for future definition and shall have no responsibility whatsoever for conflicts
  or incompatibilities arising from future changes to them. The information here
  is subject to change without notice. Do not finalize a design with this
  information. <br>
  The products described in this document may contain design defects or errors
  known as errata which may cause the product to deviate from published
  specifications. Current characterized errata are available on request. <br>
  Contact your local Intel sales office or your distributor to obtain the latest
  specifications and before placing your product order. <br>
  Copies of documents which have an order number and are referenced in this
  document, or other Intel literature, may be obtained by calling 1-800-548-4725,
  or go to:
  <a href="http://www.intel.com/design/literature.htm">http://www.intel.com/design/literature.htm</a> <br>
  Intel processor numbers are not a measure of performance. Processor numbers
  differentiate features within each processor family, not across different
  processor families. See <a href="http://www.intel.com/products/processor_number"> <a href="http://www.intel.com/products/processor_number/">http://www.intel.com/products/processor_number/</a></a> for details. </font></p>

<p><font size="-3"> BlueMoon, BunnyPeople, Celeron, Celeron Inside, Centrino, Centrino Inside, Core Inside,
  i960, Intel, the Intel logo, Intel Atom, Intel Atom Inside, Intel Core,
  Intel Inside, Intel Inside logo, Intel NetBurst, Intel NetMerge,
  Intel NetStructure, Intel SingleDriver, Intel SpeedStep,
  Intel Sponsors of Tomorrow., the Intel Sponsors of Tomorrow. logo,
  Intel StrataFlash, Intel Viiv, Intel vPro, Intel XScale, InTru, the InTru logo,
  InTru soundmark, Itanium, Itanium Inside, MCS, MMX, Moblin, Pentium,
  Pentium Inside, skoool, the skoool logo, Sound Mark, The Journey Inside,
  vPro Inside, VTune, Xeon, and Xeon Inside
  are trademarks of Intel Corporation in the U.S. and other countries. <br>
  * Other names and brands may be claimed as the property of others. </font></p>

<p><font size="-3"> Microsoft, Windows, Visual Studio, Visual C++, and the Windows logo are
  trademarks, or registered trademarks of Microsoft Corporation
  in the United States and/or other countries. </font></p>

<p><font size="-3">Java is a registered trademark of Oracle and/or its affiliates. </font></p>

<p><font size="-3"> Copyright (C) 2002-2012 Intel Corporation. All rights reserved. </font></p>



<p id="IPP_SAMPLES_OptNotice">
<div class="tablenoborder">
<table cellpadding="4" summary="" id="d3135e12" frame="border" border="1" cellspacing="0" rules="all">
  <thead align="left">
    <tr><th class="cellrowborder" align="left" valign="top" width="100%" id="d157258e36"><p>Optimization Notice</p></th></tr>
  </thead>

  <tbody>
    <tr><td class="bgcolor(#ccecff)" bgcolor="#ccecff" valign="top" width="100%" headers="d157258e36 ">
    <p>Intel's compilers may or may not optimize to the same degree for non-Intel microprocessors for optimizations that are not
    unique to Intel microprocessors. These optimizations include SSE2, SSE3, and SSSE3 instruction sets and
    other optimizations. Intel does not guarantee the availability, functionality, or effectiveness of
    any optimization on microprocessors not manufactured by Intel.
    <br>
    <br>
    Microprocessor-dependent optimizations in this product are intended for use with Intel microprocessors. Certain optimizations not specific to Intel microarchitecture are reserved for Intel microprocessors. Please refer to the applicable product User and Reference Guides for more information regarding the specific instruction sets covered by this notice.</p>
    <p>Notice revision #20110804 </p>
    </td></tr>
  </tbody>
</table>
</div>
</p>
</div>
</div>
<h1 id="_1_overview">1. Overview</h1>
<div class="paragraph"><p>This document contains descriptions of APIs that are deprecated and will be removed in a future release. Use the following link for details:
<a href="http://software.intel.com/en-us/articles/intel-ipp-71-deprecated-features/">http://software.intel.com/en-us/articles/intel-ipp-71-deprecated-features/</a> .</p></div>
<div class="paragraph"><p>The Unified Media Classes (UMC) are a set of unified C++ interfaces for building the standard blocks of a media application, including codecs, renderers, splitters, etc. UMC also help in understanding and using of samples of the Intel&#174; Integrated Performance Primitives (Intel&#174; IPP) for Intel&#174; architecture.</p></div>
<div class="paragraph"><p>UMC include abstract base classes, on the basis of which cross-platform and cross-OS
derivative classes Aare built as well as OS-dependent renderers and readers. The UMC-based media objects are written using Intel&#174; IPP for cross-platform compatibility. Virtual Machine (VM) library is also used to provide application OS-independence.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">VM Library is supplied along with IPP samples and is NOT part of the UMC set.</td>
</tr></table>
</div>
<div class="sect1">
<h2 id="_about_this_software">About This Software</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>The Unified Media Classes are intended for use with various decoding, encoding, and transcoding applications, as well as media plug-ins and filters, for example, Microsoft DirectShow* filters.</p></div>
<div class="paragraph"><p>Major functionality and features for UMC include the following:</p></div>
<div class="ulist"><ul>
<li>
<p>
Interfaces:
</p>
<div class="ulist"><ul>
<li>
<p>
Base Classes (base codec, splitters, audio and video renderers, readers) that serve as a basis for
    development of derivative classes and provide the level of abstraction needed to meet cross-platform and cross-OS requirements.
</p>
</li>
<li>
<p>
Motion Estimation and Mode Decision (ME and MD) Classes provide the standard independent functionality, including different motion estimation and mode decision algorithms.
</p>
</li>
<li>
<p>
Derived Classes (audio codecs, video decoders and encoders) that are codecs developed from base classes for specific applications that may be grouped as:
</p>
<div class="ulist"><ul>
<li>
<p>
OS-independent (for example, implemented in MP3 encoder, AAC decoder, AC3 decoder, H.264 decoder,  MPEG4 splitter, etc.), and
</p>
</li>
<li>
<p>
OS-dependent (for example, implemented in SDL Renderer, File Reader, etc.)
</p>
</li>
</ul></div>
</li>
</ul></div>
</li>
<li>
<p>
Principal operations implemented through specific derived classes and their methods:
</p>
<div class="ulist"><ul>
<li>
<p>
working with blocks of media data and time stamp, and other related parameters (base <a href="#MediaData">MediaData</a> class and derived <a href="#VideoData">VideoData</a> class)
</p>
</li>
<li>
<p>
providing data flow (base <a href="#MediaReceiver">MediaReceiver</a> class and derived <a href="#MediaBuffer">MediaBuffer</a> class)
</p>
</li>
<li>
<p>
reading data from abstract data source or writing data to abstract destination (base <a href="#DataReader">DataReader</a> class and <a href="#DataWriter">DataWriter</a> class)
</p>
</li>
<li>
<p>
splitting audio/video tracks from streams <a href="#Splitter">Splitter</a> class)
</p>
</li>
<li>
<p>
data muxing (<a href="#Muxer">Muxer</a> class)
</p>
</li>
<li>
<p>
processing (decoding, encoding, transforming) media data (base <a href="#BaseCodec">BaseCodec</a> class and derived <a href="#AudioDecoder">AudioDecoder</a>, <a href="#AudioEncoder">AudioEncoder</a> classes
    and <a href="#VideoDecoder">VideoDecoder</a>, <a href="#VideoEncoder">VideoEncoder</a> classes)
</p>
</li>
<li>
<p>
rendering decoded media data (derived <a href="#AudioRender">AudioRender</a> class and <a href="#VideoRender">VideoRender</a> class).
</p>
</li>
</ul></div>
</li>
<li>
<p>
Operations implemented through specific ME &amp; MD classes and their methods:
</p>
<div class="ulist"><ul>
<li>
<p>
providing the standard independent functionality, including different motion estimation and mode decision algorithms (base <a href="#MeBase">MeBase</a> class)
</p>
</li>
<li>
<p>
providing the VC1 specific functionality, including the RD mode decision and the vector prediction calculation (base <a href="#MeBase">MeBase</a> class and derived <a href="#MeVC1">MeVC1</a> class)
</p>
</li>
</ul></div>
</li>
<li>
<p>
Specific implementation methods to ensure OS-independence and plug-in use:
</p>
<div class="ulist"><ul>
<li>
<p>
<a href="#Virtual_Machine_Library">Virtual Machine Library</a>
</p>
</li>
<li>
<p>
<a href="#Shared_Objects_Classes">Shared Objects Classes</a> for plugin-based cross-platform applications.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="paragraph"><p>See examples of building a simple decoder and a coder, using a splitter and a muxer in <a href="#Appendix_A_Getting_Started_with_Intel_IPP_Unified_Media_Classes_Sample">Appendix A: Getting Started with Intel&#174; IPP Unified Media Classes Sample</a>.</p></div>
<div class="sect2">
<h3 id="_hardware_and_software_requirements">Hardware and Software Requirements</h3>
<div class="paragraph"><p>UMC is available for the following Processor/OS combinations:</p></div>
<div class="ulist"><ul>
<li>
<p>
IA-32 processor running Microsoft Windows* OS / Linux* OS/ OS X* OS.
</p>
</li>
<li>
<p>
Intel&#174; Xeon&#174; processor with Intel&#174; 64 architecture running Microsoft Windows*/ Linux* / OS X* OSs.
</p>
</li>
</ul></div>
<div class="paragraph"><p>UMC components can be used in user&#8217;s application/library written in C or C++.</p></div>
</div>
<div class="sect2">
<h3 id="_platforms_supported">Platforms Supported</h3>
<div class="paragraph"><p>UMC runs on Windows*, Linux*, and OS X* platforms. The code and syntax used in this manual for class, method, and arguments declarations are written in the ANSI C style. However, versions of UMC objects for different processors or operating systems may, of necessity, vary slightly.</p></div>
</div>
<div class="sect2">
<h3 id="_technical_support">Technical Support</h3>
<div class="paragraph"><p>UMC is subject to terms and conditions of support services provided for Intel IPP. For the latest information, including product features, white papers, and technical articles, check: <a href="http://www.intel.com/software/products/">http://www.intel.com/software/products/</a></p></div>
<div class="paragraph"><p>Intel also provides a support web site that contains a rich repository of self help information, including getting started tips, known product issues, product errata, license information, user forums, and more (visit <a href="http://www.intel.com/software/products/support">http://www.intel.com/software/products/support</a> ).</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_about_this_manual">About This Manual</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>This manual describes classes and methods implemented in UMC and provides basic concepts of UMC use.
Each reference section in the Base Classes chapter describes an abstract base class with a set of implementation virtual methods.
Each method description is introduced by its name, a short description of its purpose, and the calling sequence, or syntax,
for each type of data with which each method of a class is used. The following sections are also included:</p></div>
<div class="hdlist"><table><col width="18%" /><col width="82%" />
<tr>
<td class="hdlist1">
<em>Syntax</em>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Lists method prototypes.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<em>Description</em>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Describes the operation performed by methods of the class. The data types of the arguments are defined in general terms for the class.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<em>Parameters</em>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Specifies each parameter and its purpose
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<em>Return Values</em>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Describes values indicating status codes set as the result of the method execution.
</p>
</td>
</tr>
</table></div>
<div class="paragraph"><p>The following terms are used in the manual in reference to various operating systems:</p></div>
<div class="hdlist"><table><col width="18%" /><col width="82%" />
<tr>
<td class="hdlist1">
<em>Windows* OS</em>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
This term refers to information that is valid on all supported Windows* operating systems.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<em>Linux* OS</em>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
This term refers to information that is valid on all supported Linux* operating systems.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<em>OS X* OS</em>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
This term refers to information that is valid on Intel&#174;-based systems running the OS X* operating system.
</p>
</td>
</tr>
</table></div>
<div class="sect2">
<h3 id="_audience_for_this_manual">Audience for This Manual</h3>
<div class="paragraph"><p>The Unified Media Classes audience consists of C/C++ developers of media applications for various operating systems. The audience should have a thorough understanding of media data processing and be familiar with Intel IPP.</p></div>
</div>
<div class="sect2">
<h3 id="_manual_organization">Manual Organization</h3>
<div class="paragraph"><p>The manual contains the following chapters:</p></div>
<div class="hdlist"><table><col width="14%" /><col width="86%" />
<tr>
<td class="hdlist1">
Chapter 1
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
<a href="#_1_overview">Overview</a>. Introduces the Unified Media Classes software, provides information on manual organization, and explains notational conventions.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Chapter 2
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
<a href="#_2_intel_174_ipp_unified_media_classes_concepts">Intel&#174; IPP Unified Media Classes Concepts</a>. Explains the basic concepts underlying media data processing in UMC, describes the supported data formats and operation principles, provides error codes and principal structures.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Chapter 3
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
<a href="#_3_base_classes">Base Classes</a>. Provides descriptions of the abstract base classes that serve to create derivative classes.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Chapter 4
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
<a href="#_4_motion_estimation_and_mode_decision_classes">Motion Estimation and Mode Decision Classes</a>. Provides description of the Motion Estimation and Mode Decision component.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Chapter 5
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
<a href="#_5_derived_classes">Derived Classes</a>. Provides descriptions of the principal derived classes.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Chapter 6
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
<a href="#_6_virtual_machine_library">Virtual Machine Library</a>. Provides brief descriptions of VM Library functions used for providing OS-independence of codecs.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Chapter 7
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
<a href="#_7_shared_objects_classes">Shared Objects Classes</a>. Describes classes used for creation of plug-in based cross-platform applications. Provides a list of VM functions that enable the shared objects classes and gives examples of Shared Objects use.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Appendix A
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
<a href="#Appendix_A_Getting_Started_with_Intel_IPP_Unified_Media_Classes_Sample">Getting Started with Intel&#174; IPP Unified Media Classes Sample</a>. Shows how to use some basic UMC classes to build a simple decoder or encoder and to use a splitter or a muxer.
</p>
</td>
</tr>
</table></div>
<div class="paragraph"><p>The manual includes an Index that you can use to find an appropriate class by its purpose.</p></div>
</div>
<div class="sect2">
<h3 id="_notational_conventions">Notational Conventions</h3>
<div class="paragraph"><p>In this manual, notational conventions include:</p></div>
<div class="ulist"><ul>
<li>
<p>
Fonts used for distinction between the text and the code
</p>
</li>
<li>
<p>
Naming conventions for different items.
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">Font Conventions</div><p>The following font conventions are used in this manual:</p></div>
<div class="hdlist"><table><col width="30%" /><col width="70%" />
<tr>
<td class="hdlist1">
<code>UPPERCASE COURIER</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Used in the text for constant identifiers; for example, <code>UMC_ERR_TIMEOUT</code>, <code>VM_ALIGN32_DECL</code>.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>lowercase courier mixed with UpperCase courier</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Method, structure, class, and enumerator names, as in <code>CloseFrame</code>, <code>SystemStreamType</code>, <code>UMC::DefaultMemoryAllocator</code>; also used in code examples and call statements.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>lowercase courier</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
VM functions names and data types; for example: <code>vm_thread_create</code>.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><em>lowercase courier mixed with UpperCase courier italic</em></code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Parameters in function/method prototype and parameters description; for example: <code><em>ret_byte</em></code>, <code><em>InitParams</em></code>.
</p>
</td>
</tr>
</table></div>
<div class="paragraph"><div class="title">Naming Conventions</div><p>The manual employs the following naming conventions for different items used by UMC:</p></div>
<div class="ulist"><ul>
<li>
<p>
Constant identifiers, mostly return values and macros names in VM Library chapter, are in uppercase; for example: <code>UMC_ERR_INIT</code>, <code>VM_ALIGN_DECL</code>.
</p>
</li>
<li>
<p>
All VM function names and structures have the <code>vm_</code> prefix; for example: <code>vm_thread_create</code>, <code>vm_event</code>.
</p>
</li>
<li>
<p>
Each new part of a class or method name starts with an uppercase character, without underscore; for example: <code>MediaReceiverParams</code>, <code>SetDataSize</code>.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_online_version">Online Version</h3>
<div class="paragraph"><p>This manual is available in an electronic format (HTML). To obtain a hard copy of the manual, print the file using the printing capability of your browser.</p></div>
</div>
</div>
</div>
<h1 id="_2_intel_174_ipp_unified_media_classes_concepts">2. Intel&#174; IPP Unified Media Classes Concepts</h1>
<div class="paragraph"><p>This chapter explains the purpose and structure of the Intel&#174; IPP Unified Media Classes (UMC) and
looks over some of the basic concepts used in UMC implementation. It also describes the supported data formats and operation principles.</p></div>
<table rules="none" border="1" cellpadding="5" cellspacing="0">
<tbody>
<tr>
<th style="background-color: #555555; height: 30px; color: white;" valign="middle" align="left">Optimization Notice</th>
</tr>
<tr bgcolor="#ccecff">
<td>
<p>Intel's compilers may or may not optimize to the same degree for non-Intel microprocessors for optimizations that are not unique to Intel microprocessors. These optimizations include SSE2, SSE3, and SSSE3 instruction sets and other optimizations. Intel does not guarantee the availability, functionality, or effectiveness of any optimization on microprocessors not manufactured by Intel. Microprocessor-dependent optimizations in this product are intended for use with Intel microprocessors. Certain optimizations not specific to Intel microarchitecture are reserved for Intel microprocessors. Please refer to the applicable product User and Reference Guides for more information regarding the specific instruction sets covered by this notice.</p>
<p align="right">Notice revision #20110804</p>
</td>
</tr>
</tbody>
</table>
<div class="sect1">
<h2 id="_purpose_and_basic_features">Purpose and Basic Features</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>The Unified Media Classes are intended to standardize the interface of available media codecs and
media applications under development. The purpose is to facilitate reuse of codecs
in a transcoding environment, or other similar environments that require code reuse.
For example, reusing an MPEG-2 encoder in a transcoding environment requires non-trivial code changes.
UMC addresses such adaptability and portability issues.</p></div>
<div class="paragraph"><p>UMC define media classes according to their functions, and require that every codec supports a specific minimum interface.
Thus, the user can write a UMC interface for a media application and expect plug-and-play of various codecs.</p></div>
<div class="paragraph"><p>Another aspect of the UMC is cross-platform/OS capability. UMC provides compatibility of a codec code with a specific OS by using a separate
VM (Virtual Machine) library. To adapt to a new OS, the user can rewrite a small set of primitives in the VM library. To provide
cross-platform portability and Intel platform specific optimization, the codec code contains multiple calls to the Intel&#174; IPP functions.</p></div>
<div class="paragraph"><p>UMC are designed to meet three goals of simplifying and facilitating:</p></div>
<div class="ulist"><ul>
<li>
<p>
media application development/testing,
</p>
</li>
<li>
<p>
adding new codec support to an application
</p>
</li>
<li>
<p>
porting an application to another platform/OS.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_umc_structure">UMC Structure</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>Note that:</p></div>
<div class="ulist"><ul>
<li>
<p>
The notion of media environments in Application Layer includes plug-ins and media filters, for example, Microsoft DirectShow* filters.
</p>
</li>
<li>
<p>
The BaseCodec class is a UMC base class for development of audio codecs, video decoders and encoders.
</p>
<div class="ulist"><ul>
<li>
<p>
Motion Estimation and Mode Decision component, MemoryAllocator and VideoProcessing classes:
</p>
</li>
<li>
<p>
Motion Estimation and Mode Decision Classes provide the standard independent functionality, including different motion estimation and mode decision algorithms, as well as specific VC1 functionality.
</p>
</li>
<li>
<p>
MemoryAllocator Class provides interface for memory management in operation of UMC components.
</p>
</li>
</ul></div>
</li>
<li>
<p>
VideoProcessing Class, derived from BaseCodec class, converts decoded frames from YUV format to another required format (RGB, YV12, etc.).
Methods of this class are called to process decoded output before rendering. See fig. <a href="#Decoding_Pipeline">Decoding Pipeline</a>,
<a href="#Base_Classes_Roles">Base Classes Roles</a>, and <a href="#umc_3">MPEG2 Decoder Data Flow</a>.
</p>
</li>
<li>
<p>
MediaBuffer Class is derived from MediaReceiver class apart from AudioRender and VideoRender. The class provides functionality to organize data flow in UMC-based applications.
</p>
</li>
<li>
<p>
Intel IPP and VM Library provide abstraction from specific platforms and OSs, that is, cross-platform and cross-OS capacity for all derived classes.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Application Layer is associated with environment in which the user may build specific interfaces for the application.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">UMC interfaces, structures, enumerators and other directives designed for external access are part of UMC namespace. Explicit <code>UMC::</code> prefix in declaration of this data may be omitted in this manual.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_flow_support">Data Flow Support</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>From user&#8217;s perspective, each UMC component is a black box processing unit that takes data from input, and performs certain functions to produce output. The application is responsible for:</p></div>
<div class="ulist"><ul>
<li>
<p>
initializing the component before use
</p>
</li>
<li>
<p>
supplying the input data
</p>
</li>
<li>
<p>
retrieving the output data
</p>
</li>
<li>
<p>
closing the component after use.
</p>
</li>
</ul></div>
<div class="paragraph"><p>In a more complicated setting, where two or more components are involved, the application needs to move data from one component to another. In other words, the data flow is controlled by the application code.</p></div>
<div class="paragraph"><p>A simple example can illustrate the role of base classes. Consider a typical decoding process with a variable data source:</p></div>
<div class="imageblock" id="Decoding_Pipeline">
<div class="content">
<img src="./images/umc/umc_2_1.png" alt="./images/umc/umc_2_1.png" />
</div>
<div class="title">Figure 1. Decoding Pipeline</div>
</div>
<div class="paragraph"><p>Figure <a href="#Base_Classes_Roles">Base Classes Roles</a> shows UMC classes used at various stages of the decoding process.</p></div>
<div class="imageblock" id="Base_Classes_Roles">
<div class="content">
<img src="./images/umc/umc_2_2.png" alt="./images/umc/umc_2_2.png" />
</div>
<div class="title">Figure 2. Base Classes Roles</div>
</div>
<div class="paragraph"><p>All standard specific features are implemented as objects of derived classes.
Figure <a href="#MPEG2_Decoder_Data_Flow">MPEG2 Decoder Data Flow</a> provides an example of decoding data flow for MPEG2 and shows UMC-based objects created and used in the process.</p></div>
<div class="imageblock" id="MPEG2_Decoder_Data_Flow">
<div class="content">
<img src="./images/umc/umc_2_3.png" alt="./images/umc/umc_2_3.png" />
</div>
<div class="title">Figure 3. MPEG2 Decoder Data Flow</div>
</div>
<div class="paragraph"><p>The general procedure for application developer is as follows:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Identify the data source and create a respective <code>DataReader</code> object required to receive input data.
</p>
</li>
<li>
<p>
Identify and create a <code>Splitter</code> object in accordance with the data container type and format supported by the application. If the application supports multiple formats,
use other criteria, for example, file extension name, or call <code>GetStreamType</code> method of the base class.
This method returns the required splitter type.
</p>
</li>
<li>
<p>
Initialize the <code>Splitter</code> object that identifies data streams present in the file and the number of required audio- and video decoders.
</p>
</li>
<li>
<p>
Create renderer objects to present data in a specific operating system.
</p>
</li>
<li>
<p>
Launch the application.
</p>
</li>
</ol></div>
<div class="paragraph"><p>Data between the objects is transferred through <code>MediaData</code> objects.
In some cases of video data transfer, when specific amount of data needs to be transferred to pass a frame,
you may use the base <code>MediaReceiver</code> class, and a derived <code>MediaBuffer</code> class in particular.
See <a href="#MediaReceiver">MediaReceiver</a> class for an example with buffering procedure and <a href="#MediaBuffer">MediaBuffer</a> class for free space allocation scheme.</p></div>
<div class="paragraph"><p>Another example of data flow in Figure <a href="#Data_Flow_Between_UMC_Components">Data Flow Between UMC Components</a> illustrates interaction between UMC
components in the case of AVI file processing.</p></div>
<div class="imageblock" id="Data_Flow_Between_UMC_Components">
<div class="content">
<img src="./images/umc/umc_2_4.png" alt="./images/umc/umc_2_4.png" />
</div>
<div class="title">Figure 4. Data Flow Between UMC Components</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_umc_object_initialization_and_closure">UMC Object Initialization and Closure</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>Most of UMC classes are initialized using <code>Init(&#8230;)</code> methods.
MediaData classes are simple and do not require initialization.
Parameters for <code>Init</code> methods are classes derived from parameters for initialization of base classes,
for example, <code>SplitterParams</code>, <code>MediaBufferParams</code>, etc.</p></div>
<div class="paragraph"><p>UMC classes which use special Init or Alloc methods or allocate internal memory in some other ways usually have special
<code>Close()</code> method to free and reset internal data. If some mothod was used without proper initialization it will return <code>UMC_ERR_NOT_INITIALIZED</code> status.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> method releases all resources. Object must be reinitialized before further use.</td>
</tr></table>
</div>
<div class="paragraph"><p>For example, suppose <code>FileReader</code> class is derived from <code>DataReader</code> base class.
Accordingly, its parameters <code>FileReaderParams</code> are derived from <code>DataReaderParams</code> class.
In this case, <code>Init()</code> function declarations are as follows:</p></div>
<div class="paragraph"><p>for <code>DataReader</code>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #008000">// Intialization abstract source data</span>
<span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">DataReaderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">InitParams</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="paragraph"><p>for <code>FileReader</code>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">DataReaderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">InitParams</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="paragraph"><p><code>FileReaderParams</code> class contains file-related information:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">FileReaderParams</span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> DataReaderParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DString</span><span style="color: #000000">   m_sFileName</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">size_t</span><span style="color: #000000">    m_iBufferSize</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="paragraph"><p>Parameters of the derived class are inherited from the parameters of the base class with the generic name <code>BaseClassParams</code>.
However, <code>BaseClassParams</code> may be empty, that is, it may have no base parameters to be inherited by the derived class. For example:</p></div>
<div class="exampleblock">
<div class="title">Example 1. Empty Class</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">DataReaderParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">DataReaderParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">DataReaderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">DataReaderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{}</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>In this case a base class is needed for unification purposes to initialize a required object with <code>Init()</code> method.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_structures_and_enumerators">Structures and Enumerators</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>This section describes the the structures and lists enumerators used by UMC.
For the enumerators used by ME &amp; MD classes, please refer to Chapter 4 <a href="#_4_motion_estimation_and_mode_decision_classes">Motion Estimation and Mode Decision Classes</a>.</p></div>
<h3 id="_streaminfo" class="float">StreamInfo</h3>
<div class="paragraph"><p>The class <code>StreamInfo</code> is for storing common stream information.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">In version 7.1 StreamInfo structures were converted to polymorphic classes. Also data structure descriptors were replaces with MediaData derivatives to unify data flow.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">StreamInfo definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">StreamInfo</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">StreamInfo</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">StreamInfo</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">StreamInfo</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iProfile</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iLevel</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iStreamPID</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iBitrate</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> fDuration</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 1. StreamInfo Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>iProfile</code></p></td>
<td align="left" valign="top"><p class="table">Profile of the stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>iLevel</code></p></td>
<td align="left" valign="top"><p class="table">Level of the stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>iStreamPID</code></p></td>
<td align="left" valign="top"><p class="table">Unique identifier.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>iBitrate</code></p></td>
<td align="left" valign="top"><p class="table">Stream data rate in bits per second.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code>fDuration</code></p></td>
<td align="left" valign="top"><p class="table">Stream duration in seconds.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_audiostreaminfo" class="float">AudioStreamInfo</h4>
<div class="paragraph"><p>The class <code>AudioStreamInfo</code> is for storing the information about an audio track.</p></div>
<div class="listingblock">
<div class="title">AudioStreamInfo definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">AudioStreamInfo</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> StreamInfo</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">AudioStreamInfo</span><span style="color: #000000">,</span><span style="color: #000000"> StreamInfo</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioStreamInfo</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioData</span><span style="color: #000000">          audioInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">AudioStreamType</span><span style="color: #000000">    streamType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">AudioStreamSubType</span><span style="color: #000000"> streamSubtype</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">             iHeader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">             iLanguage</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">               bProtected</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 2. AudioStreamInfo Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                           </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_audiodata">AudioData</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>audioInfo</code></p></td>
<td align="left" valign="top"><p class="table">Stream data structure template.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_audiostreamtype">AudioStreamType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>streamType</code></p></td>
<td align="left" valign="top"><p class="table">Type of audio compression format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_audiostreamsubtype">AudioStreamSubType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>streamSubtype</code></p></td>
<td align="left" valign="top"><p class="table">Subtype of audio compression format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>iHeader</code></p></td>
<td align="left" valign="top"><p class="table">Can carry audio header.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>iLanguage</code></p></td>
<td align="left" valign="top"><p class="table">Stream language code.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>bProtected</code></p></td>
<td align="left" valign="top"><p class="table">Means audio data is encrypted.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_videostreaminfo" class="float">VideoStreamInfo</h4>
<div class="paragraph"><p>The class <code>VideoStreamInfo</code> is for storing the information about a video track.</p></div>
<div class="listingblock">
<div class="title">VideoStreamInfo definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> StreamInfo</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000">,</span><span style="color: #000000"> StreamInfo</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoData</span><span style="color: #000000">           videoInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">VideoStreamType</span><span style="color: #000000">     streamType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">VideoStreamSubType</span><span style="color: #000000">  streamSubtype</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">              iViews</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000">              fFramerate</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 3. AudioStreamInfo Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                           </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata">VideoData</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>videoInfo</code></p></td>
<td align="left" valign="top"><p class="table">Stream data structure template.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_videostreamtype">VideoStreamType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>streamType</code></p></td>
<td align="left" valign="top"><p class="table">Type of video compression format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_videostreamsubtype">VideoStreamSubType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>streamSubtype</code></p></td>
<td align="left" valign="top"><p class="table">Subtype of video compression format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>iViews</code></p></td>
<td align="left" valign="top"><p class="table">Number of mixed views for multiview streams.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>fFramerate</code></p></td>
<td align="left" valign="top"><p class="table">Video frame rate.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_status" class="float">Status</h3>
<div class="paragraph"><p>UMC methods return status codes of the performed operation to report errors and warnings to the calling program.
Thus, it is up to the application to perform error-related actions and/or recover from the error.
The last value of the error status is not stored, and the user is to decide whether to check it or not as the method returns.
The status codes are of <code>Status</code> type and are global constant integers.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 4. Status Codes and Messages</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">The operation is performed successfully.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Method is unable to allocate memory needed for internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">No more new data is expected within the current stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">The format is unacceptable.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The current stream contains an error or errors.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Not enough input and/or output data to process data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Buffer is not sufficient to accommodate data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_IMPLEMENTED</code></p></td>
<td align="left" valign="top"><p class="table">Object cannot be created or class is not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Object is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_OPEN_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">File/device failed to open.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_SYNC</code></p></td>
<td align="left" valign="top"><p class="table">Required synchronization code was not found.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_TIMEOUT</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed to complete successfully within reasonable time.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_UNSUPPORTED</code></p></td>
<td align="left" valign="top"><p class="table">Unsupported profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_WRN_REPOSITION_INPROGRESS</code></p></td>
<td align="left" valign="top"><p class="table">Object is in reposition mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_WRN_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Non-critical error in the incoming stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_WRN_INFO_NOT_READY</code></p></td>
<td align="left" valign="top"><p class="table">Information is yet unknown.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Certain implementation methods may return some specific error codes.
Such codes are specified in the description of the implemented class.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content"><code>Status::UMC_OK</code> code description may be omitted in methods description.</td>
</tr></table>
</div>
<h3 id="_systemstreamtype" class="float">SystemStreamType</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 5. SystemStreamType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UNDEF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Unsupported stream type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AVI_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">AVI RIFF.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MP4_ATOM_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">ISO/IEC 14496-14 stream ([ISO/IEC_14]).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ASF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">AFS stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H26x_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">H26x pure video stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H261_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">H261 pure video stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H263_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">H263 pure video stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H264_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">H264 pure video stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEGx_SYSTEM_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG 1,2 - like system.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG1_SYSTEM_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG 1 system.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_SYSTEM_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG 2 system.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG4_SYSTEM_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG 4 system.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEGx_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG 1,2 - like pure video data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEGx_PURE_AUDIO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG 1,2 - like pure audio data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEGx_PES_PACKETS_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG 1,2 - like pes packets system.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEGx_PROGRAM_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG 1,2 - like program system.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEGx_TRANSPORT_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG 1,2 - like transport system.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG1_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG1 pure video stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG1_PURE_AUDIO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG1 pure audio stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG1_PES_PACKETS_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG1 pes packets stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG1_PROGRAM_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG1 program stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG2 pure video stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_PURE_AUDIO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG2 pure audio stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_PES_PACKETS_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG2 pes packets stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_PROGRAM_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG2 program stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_TRANSPORT_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG2 transport stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_TRANSPORT_STREAM_TTS</code></p></td>
<td align="left" valign="top"><p class="table">MPEG2 transport stream with valid packet time stamps.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_TRANSPORT_STREAM_TTS0</code></p></td>
<td align="left" valign="top"><p class="table">MPEG2 transport stream with zero packet time stamps.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG4_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MPEG4 pure video stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>WEB_CAM_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Web cam stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ADIF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">ADIF (audio) stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ADTS_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">ADTS (audio) stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>STILL_IMAGE</code></p></td>
<td align="left" valign="top"><p class="table">Still image.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VC1_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">VC1 pure video stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>WAVE_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Wave stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AVS_PURE_VIDEO_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">AVS pure video stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FLV_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">FLV stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>IVF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">IVF stream (VP8).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>OGG_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">OGG stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MJPEG_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">MJPEG stream.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_audiostreamtype" class="float">AudioStreamType</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 6. AudioStreamType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UNDEF_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>PCM_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>LPCM_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AC3_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ALAW_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MULAW_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TWINVQ_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DTS_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG1_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG_AUDIO_LAYER1</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG_AUDIO_LAYER2</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG_AUDIO_LAYER3</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MP1L1_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MP1L2_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MP1L3_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MP2L1_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MP2L2_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MP2L3_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VORBIS_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AAC_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AAC_MPEG4_STREAM</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AMR_NB_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table">Narrow band AMR</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AMR_WB_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table">Wide band AMR</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_audiostreamsubtype" class="float">AudioStreamSubType</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 7. AudioStreamSubType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UNDEF_AUDIO_SUBTYPE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AAC_LC_PROFILE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AAC_LTP_PROFILE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AAC_MAIN_PROFILE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AAC_SSR_PROFILE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AAC_HE_PROFILE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AAC_ALS_PROFILE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AAC_BSAC_PROFILE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_videostreamtype" class="float">VideoStreamType</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 8. VideoStreamType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UNDEF_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UNCOMPRESSED_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG1_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG4_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H261_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H263_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H264_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DIGITAL_VIDEO_SD</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DIGITAL_VIDEO_50</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DIGITAL_VIDEO_HD</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DIGITAL_VIDEO_SL</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>WMV_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MJPEG_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VC1_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AVS_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VP8_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_videostreamsubtype" class="float">VideoStreamSubType</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 9. VideoStreamSubType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UNDEF_VIDEO_SUBTYPE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG4_VIDEO_DIVX5</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG4_VIDEO_QTIME</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DIGITAL_VIDEO_TYPE_1</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DIGITAL_VIDEO_TYPE_2</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG4_VIDEO_DIVX3</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG4_VIDEO_DIVX4</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG4_VIDEO_XVID</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AVC1_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H263_VIDEO_SORENSON</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VC1_VIDEO_RCV</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VC1_VIDEO_VC1</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>WVC1_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>WMV3_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MULTIVIEW_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SCALABLE_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_videorendertype" class="float">VideoRenderType</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 10. VideoRenderType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>GDI_VIDEO_RENDER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>OPENGL_VIDEO_RENDER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>NULL_VIDEO_RENDER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FW_VIDEO_RENDER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_audiorendertype" class="float">AudioRenderType</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 11. AudioRenderType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>DSOUND_AUDIO_RENDER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>WINMM_AUDIO_RENDER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>OSS_AUDIO_RENDER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>NULL_AUDIO_RENDER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FW_AUDIO_RENDER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_videofilter" class="float">VideoFilter</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 12. VideoFilter description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>FILTER_DEPTH_CONVERTER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FILTER_COLOR_CONVERTER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FILTER_DEINTERLACER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FILTER_RESIZER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FILTER_ANAGLYPHER</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_colorformat" class="float">ColorFormat</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 13. ColorFormat Types Description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>NONE</code></p></td>
<td align="left" valign="top"><p class="table">Not set</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YV12</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 3 planes: Y, U, V, 4:2:0, luma pitch is equal to 2 * chroma pitch</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>NV12</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 2 planes: Y, UV, 4:2:0, luma pitch is equal to merged chroma pitch</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YUV420</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 3 planes: Y, U, V, 4:2:0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YUV422</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 3 planes: Y, U, V, 4:2:2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YUV444</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 3 planes: Y, U, V, 4:4:4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YUV411</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 3 planes: Y, U, V, 4:1:1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Y41P</code></p></td>
<td align="left" valign="top"><p class="table">Composite, UYVYUYVYYYYY, 4:1:1 packed</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YUV420A</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 4 planes: Y, U, V, Alpha, 4:2:0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YUV422A</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 4 planes: Y, U, V, Alpha, 4:2:2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YUV444A</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 4 planes: Y, U, V, Alpha, 4:4:4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YUV9</code></p></td>
<td align="left" valign="top"><p class="table">Planar, 3 planes: Y, U, V, 16:2:0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Y411</code></p></td>
<td align="left" valign="top"><p class="table">Composite, YYYYUV, 4:1:1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>YUV2</code></p></td>
<td align="left" valign="top"><p class="table">Composite, YUYV, 4:2:2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UYVY</code></p></td>
<td align="left" valign="top"><p class="table">Composite, UYVY, 4:2:2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GRAY</code></p></td>
<td align="left" valign="top"><p class="table">Monochrome, 1 plane</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GRAYA</code></p></td>
<td align="left" valign="top"><p class="table">Monochrome with Alpha, 2 planes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RGBA</code></p></td>
<td align="left" valign="top"><p class="table">Composite R&#8594;G&#8594;B&#8594;A</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RGB</code></p></td>
<td align="left" valign="top"><p class="table">Composite R&#8594;G&#8594;B</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RGB565</code></p></td>
<td align="left" valign="top"><p class="table">Composite R&#8594;G&#8594;B, 5 bit per B &amp; R, 6 bit per G</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RGB555</code></p></td>
<td align="left" valign="top"><p class="table">Composite R&#8594;G&#8594;B&#8594;A, 5 bit per component, 1 bit per A</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RGB444</code></p></td>
<td align="left" valign="top"><p class="table">Composite R&#8594;G&#8594;B&#8594;A, 4 bit per component</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BGRA</code></p></td>
<td align="left" valign="top"><p class="table">Composite B&#8594;G&#8594;R&#8594;A</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BGR</code></p></td>
<td align="left" valign="top"><p class="table">Composite B&#8594;G&#8594;R</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BGR565</code></p></td>
<td align="left" valign="top"><p class="table">Composite B&#8594;G&#8594;R, 5 bit per B &amp; R, 6 bit per G</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BGR555</code></p></td>
<td align="left" valign="top"><p class="table">Composite B&#8594;G&#8594;R&#8594;A, 5 bit per component, 1 bit per A</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BGR444</code></p></td>
<td align="left" valign="top"><p class="table">Composite B&#8594;G&#8594;R&#8594;A, 4 bit per component</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>CMYK</code></p></td>
<td align="left" valign="top"><p class="table">Composite C, M, Y, K</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>CMYKA</code></p></td>
<td align="left" valign="top"><p class="table">Composite C, M, Y, K, Alpha</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_sampleformat" class="float">SampleFormat</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 14. SampleFormat Types Description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>SF_UNSIGNED</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SF_SIGNED</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SF_FLOAT</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_frametype" class="float">FrameType</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 15. FrameType Types Description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>NONE_PICTURE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>I_PICTURE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>P_PICTURE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>B_PICTURE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>D_PICTURE</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VIDEO_FRAME</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AUDIO_FRAME</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_picturestructure" class="float">PictureStructure</h3>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 16. PictureStructure Types Description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>PS_PROGRESSIVE</code></p></td>
<td align="left" valign="top"><p class="table">Progressive frame</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>PS_TOP_FIELD</code></p></td>
<td align="left" valign="top"><p class="table">Top interlacing field</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>PS_BOTTOM_FIELD</code></p></td>
<td align="left" valign="top"><p class="table">Bottom interlacing field</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>PS_TOP_FIELD_FIRST</code></p></td>
<td align="left" valign="top"><p class="table">Both interlacing fields, top is the first to display</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>PS_BOTTOM_FIELD_FIRST</code></p></td>
<td align="left" valign="top"><p class="table">Both interlacing fields, bottom is the first to display</p></td>
</tr>
</tbody>
</table>
</div>
<div style="page-break-after:always"></div>
</div>
</div>
<h1 id="_3_base_classes">3. Base Classes</h1>
<div class="paragraph"><p>This chapter contains description of the following UMC base classes.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 17. UMC Base Classes</caption>
<col width="33%" />
<col width="66%" />
<thead>
<tr>
<th align="left" valign="top">Interface Purpose      </th>
<th align="left" valign="top"> Class Name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Data Input/Output</p></td>
<td align="left" valign="top"><p class="table"><a href="#_datareader">DataReader</a> class, <a href="#_datawriter">DataWriter</a> class</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data Container</p></td>
<td align="left" valign="top"><p class="table"><a href="#_mediadata">MediaData</a> class and derived <a href="#_videodata">VideoData</a> and <a href="#_audiodata">AudioData</a> classes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data Splitting</p></td>
<td align="left" valign="top"><p class="table"><a href="#_splitter">Splitter</a> class</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data Muxing</p></td>
<td align="left" valign="top"><p class="table"><a href="#_muxer">Muxer</a> class</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Codec</p></td>
<td align="left" valign="top"><p class="table"><a href="#_basecodec">BaseCodec</a> class and derived <a href="#_audiodecoder">AudioDecoder</a> class, <a href="#_audioencoder">AudioEncoder</a> class,
                        <a href="#_videodecoder">VideoDecoder</a> class and <a href="#_videoencoder">VideoEncoder</a> class</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Data Passing</p></td>
<td align="left" valign="top"><p class="table"><a href="#_mediareceiver">MediaReceiver</a> class and derived <a href="#_mediabuffer_class">MediaBuffer</a> class, <a href="#_videorender">VideoRender</a> class and <a href="#_audiorender">AudioRender</a> class</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Memory Management</p></td>
<td align="left" valign="top"><p class="table"><a href="#_memoryallocator">MemoryAllocator</a> class</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Example <a href="#_umc_base_classes_usage">UMC Base Classes Usage</a> at the end of this chapter demonstrates the operation of the described UMC base classes.</p></div>
<div style="page-break-after:always"></div>
<div class="sect1">
<h2 id="_datareader">DataReader</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>The <code>DataReader</code> class provides virtual methods for data access independent of the source type (file, network, etc.)
This base class is implemented in derived classes (<code>FileReader</code>, <code>MemoryReader</code>, etc.)
The class provides a set of methods for type-specific stubs for <code>GetData</code> method and supports the opportunity for look forward
along the stream without changing reading position (<code>Check8u</code>, <code>Check16u</code>, and <code>Check32u</code> methods).
<code>DataReader</code> also provides interface for positioning in the data stream, if applicable. The splitter uses this class to obtain data.</p></div>
<div class="listingblock">
<div class="title">DataReader definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">DataReader</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">DataReader</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">DataReader</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">DataReader</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">DataReaderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pParams</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetData</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">iSize</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">CacheData</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">iSize</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">GetPosition</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MovePosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> iPosition</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">GetSize</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000">   </span><span style="color: #000000">IsEOS</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Check8u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Check16u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Check32u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get8u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get16uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get16uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get32uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get32uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get64uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get64uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 18. DataReader Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                       </th>
<th align="left" valign="top">Method                                         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes source data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the object and releases resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets all internal parameters to start reading from beginning.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_getdata">GetData</a></code></p></td>
<td align="left" valign="top"><p class="table">Places n bytes of data to pData buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_cachedata">CacheData</a></code></p></td>
<td align="left" valign="top"><p class="table">Caches data and checks n bytes in data source with how_far offset from the current position.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_getposition">GetPosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns a position in the source, if applicable.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_moveposition">MovePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Moves position on n bytes in data source.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_setposition">SetPosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets position in the source, if applicable.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_getsize">GetSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns size of the source data, if applicable.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_iseos">IsEOS</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns true if EOS</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_check8u">Check8u</a></code></p></td>
<td align="left" valign="top"><p class="table">Checks a byte in data source with how_far offset from the current position.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_check16u">Check16u</a></code></p></td>
<td align="left" valign="top"><p class="table">Checks a 2-bytes unsigned value in data source with how_far offset from the current position.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_check32u">Check32u</a></code></p></td>
<td align="left" valign="top"><p class="table">Checks a 4-bytes unsigned value in data source with how_far offset from the current position.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_get8u">Get8u</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains a byte of data from the current position. The position changes after reading.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_get16uswap">Get16uSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains 2 bytes of data as a 2-bytes unsigned value in big-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_get16unoswap">Get16uNoSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains 2 bytes of data as a 2-bytes unsigned value in little-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_get32uswap">Get32uSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains 4 bytes of data as a 4-bytes unsigned value in big-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_get32unoswap">Get32uNoSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains 4 bytes of data as a 4-bytes unsigned value in little-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_get64uswap">Get64uSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains 8 bytes of data as an 8-bytes unsigned value in big-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader_get64unoswap">Get64uNoSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains 8 bytes of data as an 8-bytes unsigned value in little-endian mode.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_datareaderparams" class="float">DataReaderParams</h3>
<div class="paragraph"><p>The <code>DataReaderParams</code> class provides parameters interface for <code>DataReader</code> initialization</p></div>
<div class="listingblock">
<div class="title">DataReaderParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">DataReaderParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">DataReaderParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">DataReaderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">DataReaderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_datareader_init" class="float">DataReader::Init</h3>
<div class="paragraph"><p>The method performs initialization of the reader according to input parameter from an object derived from <a href="#_datareaderparams">DataReaderParams</a> class.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">DataReaderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pParams</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>DataReaderParams *pParams</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to an object derived from <a href="#_datareaderparams">DataReaderParams</a> class, which contains specific information to initialize the reader.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_close" class="float">DataReader::Close</h3>
<div class="paragraph"><p>The method releases all allocated resources, de-initializes the object, and sets it into the initial state.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_datareader_reset" class="float">DataReader::Reset</h3>
<div class="paragraph"><p>The method resets all internal parameters to start reading from the beginning. This method does not deallocate internal resources unlike the <code>Close</code> method.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_datareader_getdata" class="float">DataReader::GetData</h3>
<div class="paragraph"><p>The method obtains n bytes of data from the current position and moves the reading position by the number of the bytes read.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetData</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">iSize</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>void *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Pointer to the data buffer; must be at least nsize bytes long.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>size_t &amp;iSize</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Number of bytes required to read. This parameter is updated by the number of bytes that were copied.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_cachedata" class="float">DataReader::CacheData</h3>
<div class="paragraph"><p>The method caches data and checks n bytes in data source with iOffset offset from the current position.
In most derived classes, but not necessary in all, no real caching inside UMC::DataReader happens.
The purpose of this function is reading data ahead of the current reading position.
The method may be used to give the OS a hint to cache a chunk of data ahead of the current position, but this behavior
is OS-specific and it should be taken into account that the function returns data only after data reading from a specified
location is actually finished. Unlike GetData, the position read remains the same after this function is called.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">CacheData</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">iSize</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>void *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Pointer to the data buffer; must be at least nsize bytes long.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>size_t &amp;iSize</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Number of bytes required to read. This parameter is updated by the number of bytes that were copied.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp64s iOffset</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Offset from the current position.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_getposition" class="float">DataReader::GetPosition</h3>
<div class="paragraph"><p>The method returns a position in the source.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">GetPosition</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Position from the beginning of the stream or from reading start point if absolute position is undefined.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_moveposition" class="float">DataReader::MovePosition</h3>
<div class="paragraph"><p>The method moves reading pointer relativly to the current position.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">Some implementatations may not support moving or support it partially.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MovePosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64s iOffset</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Number of bytes to move on.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_UNSUPPORTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- This function or part of the function is unsupported by implementation.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_setposition" class="float">DataReader::SetPosition</h3>
<div class="paragraph"><p>The method sets a new absolute position.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content"><code>SetPosition()</code> works through <code>MovePosition()</code> function and <code>GetPosition()</code> function so both of them must be supported by implementation.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> iPosition</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64u iPosition</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Absolute byte position in the stream.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_UNSUPPORTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- This function or part of the function is unsupported by implementation.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_getsize" class="float">DataReader::GetSize</h3>
<div class="paragraph"><p>The method returns size of the source data.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">GetSize</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The size of the stream. If stream size cannot be aquired returns 0.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_iseos" class="float">DataReader::IsEOS</h3>
<div class="paragraph"><p>The method checks if reading pointer at End of Stream, if possible.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content"><code>IsEOS()</code> works through <code>GetPosition()</code> function and <code>GetSize()</code> function so both of them must be supported by implementation.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">IsEOS</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>bool</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- <code>True</code> if EOS.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_check8u" class="float">DataReader::Check8u</h3>
<div class="paragraph"><p>The method checks a byte in the data source with iOffset offset from the current position.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Check8u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp8u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Pointer to the data buffer; must be at least 1 byte long.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp64s iOffset</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Offset from the current position.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_check16u" class="float">DataReader::Check16u</h3>
<div class="paragraph"><p>The method checks 2 bytes in data source with iOffset offset from the current position.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Check16u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp16u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Pointer to the data buffer; must be at least 2 bytes long.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp64s iOffset</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Offset from the current position.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_check32u" class="float">DataReader::Check32u</h3>
<div class="paragraph"><p>The method checks 4 bytes in data source with iOffset offset from the current position.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Check32u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Pointer to the data buffer; must be at least 4 bytes long.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp64s iOffset</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Offset from the current position.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_get8u" class="float">DataReader::Get8u</h3>
<div class="paragraph"><p>The method obtains a byte of data from the current position. The position changes after reading.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get8u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp8u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Pointer to the data buffer; must be at least 1 byte long.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_get16uswap" class="float">DataReader::Get16uSwap</h3>
<div class="paragraph"><p>The method obtains 2-bytes of data from the current position as a 2-bytes unsigned value in big-endian mode. The position changes after reading.
On a little-endian system, the method does not perform byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get16uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp16u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Pointer to the data buffer; must be at least 2 bytes long.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_get16unoswap" class="float">DataReader::Get16uNoSwap</h3>
<div class="paragraph"><p>The method obtains 2-bytes of data from the current position as a 2-bytes unsigned value in little-endian mode. The position changes after reading.
On a little-endian system, the method performs byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get16uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp16u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Pointer to the data buffer; must be at least 2 bytes long.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_get32uswap" class="float">DataReader::Get32uSwap</h3>
<div class="paragraph"><p>The method obtains 4-bytes of data from the current position as a 4-bytes unsigned value in big-endian mode. The position changes after reading.
On a little-endian system, the method does not perform byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get32uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Pointer to the data buffer; must be at least 4 bytes long.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_get32unoswap" class="float">DataReader::Get32uNoSwap</h3>
<div class="paragraph"><p>The method obtains 4-bytes of data from the current position as a 4-bytes unsigned value in little-endian mode. The position changes after reading.
On a little-endian system, the method performs byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get32uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Pointer to the data buffer; must be at least 4 bytes long.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_get64uswap" class="float">DataReader::Get64uSwap</h3>
<div class="paragraph"><p>The method obtains 8-bytes of data from the current position as a 8-bytes unsigned value in big-endian mode. The position changes after reading.
On a little-endian system, the method does not perform byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get64uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Pointer to the data buffer; must be at least 8 bytes long.
</p>
</td>
</tr>
</table></div>
<h3 id="_datareader_get64unoswap" class="float">DataReader::Get64uNoSwap</h3>
<div class="paragraph"><p>The method obtains 8-bytes of data from the current position as a 8-bytes unsigned value in little-endian mode. The position changes after reading.
On a little-endian system, the method performs byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Get64uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64u *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Pointer to the data buffer; must be at least 8 bytes long.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
</div>
<div class="sect1">
<h2 id="_datawriter">DataWriter</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>The <code>DataWriter</code> is an abstract base class that provides virtual methods for writing portions of data to an abstract data consumer, that is, a file, a network, etc.</p></div>
<div class="listingblock">
<div class="title">DataWriter definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">DataWriter</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">DataWriter</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">DataWriter</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">DataWriter</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">DataWriterParams</span><span style="color: #000000">*</span><span style="color: #000000"> pParams</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutData</span><span style="color: #000000">(</span><span style="color: #0000ff">const</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">iSize</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">GetPosition</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MovePosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> iPosition</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put8u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> iByte</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put16uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> iWord</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put16uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> iWord</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put32uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iDWord</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put32uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iDWord</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put64uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> iQWord</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put64uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> iQWord</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 19. DataReader Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                       </th>
<th align="left" valign="top">Method                                         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the target.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the object and releases resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets all internal parameters to start reading from beginning.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_putdata">PutData</a></code></p></td>
<td align="left" valign="top"><p class="table">Puts specified amount of data from the data buffer to <code>DataWriter</code> object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_getposition">GetPosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns a position in the destination media, if applicable.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_moveposition">MovePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Moves position on n bytes in the destination media.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_setposition">SetPosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets position in the destination media, if applicable.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_put8u">Put8u</a></code></p></td>
<td align="left" valign="top"><p class="table">Puts a byte of data to the current position. The position changes after reading.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_put16uswap">Put16uSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Puts 2 bytes of data as a 2-bytes unsigned value in big-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_put16unoswap">Put16uNoSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Puts 2 bytes of data as a 2-bytes unsigned value in little-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_put32uswap">Put32uSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Puts 4 bytes of data as a 4-bytes unsigned value in big-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_put32unoswap">Put32uNoSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Puts 4 bytes of data as a 4-bytes unsigned value in little-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_put64uswap">Put64uSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Puts 8 bytes of data as an 8-bytes unsigned value in big-endian mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter_put64unoswap">Put64uNoSwap</a></code></p></td>
<td align="left" valign="top"><p class="table">Puts 8 bytes of data as an 8-bytes unsigned value in little-endian mode.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_datawriterparams" class="float">DataWriterParams</h3>
<div class="paragraph"><p>The <code>DataWriterParams</code> class provides parameters interface for <code>DataWriter</code> initialization</p></div>
<div class="listingblock">
<div class="title">DataWriterParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">DataWriterParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">DataWriterParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">DataWriterParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">DataWriterParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_datawriter_init" class="float">DataWriter::Init</h3>
<div class="paragraph"><p>The method performs initialization of the writer according to input parameter from an object derived from <a href="#_datawriterparams">DataWriterParams</a> class.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">DataWriterParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pParams</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>DataWriterParams *pParams</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to an object derived from <a href="#_datawriterparams">DataWriterParams</a> class, which contains specific information to initialize the writer.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_close" class="float">DataWriter::Close</h3>
<div class="paragraph"><p>The method releases all allocated resources, de-initializes the object, and sets it into the initial state.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_datawriter_reset" class="float">DataWriter::Reset</h3>
<div class="paragraph"><p>The method resets all internal parameters to start writing from the beginning. This method does not deallocate internal resources unlike the <code>Close</code> method.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_datawriter_putdata" class="float">DataWriter::PutData</h3>
<div class="paragraph"><p>The method gets a pointer to the data buffer and writes to destination. The method puts iSize bytes of data from pData buffer to <code>DataWriter</code> object.
After call of the method, iSize contains the number of the written bytes.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutData</span><span style="color: #000000">(</span><span style="color: #0000ff">const</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">iSize</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>const void *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to the data buffer, where iSize bytes from the stream are copied to.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>size_t &amp;iSize</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Number of bytes required to be written. After call of the method this parameter specifies the number of the copied bytes.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_getposition" class="float">DataWriter::GetPosition</h3>
<div class="paragraph"><p>The method returns a position in the destination media.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> </span><span style="color: #000000">GetPosition</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Position from the beginning of the stream or from writing start point if absolute position is undefined.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_moveposition" class="float">DataWriter::MovePosition</h3>
<div class="paragraph"><p>The method moves writing pointer relativly to the current position.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">Some implementatations may not support moving or support it partially.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MovePosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iOffset</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64s iOffset</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Number of bytes to move on.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_UNSUPPORTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- This function or part of the function is unsupported by implementation.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_setposition" class="float">DataWriter::SetPosition</h3>
<div class="paragraph"><p>The method sets a new absolute position.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content"><code>SetPosition()</code> works through <code>MovePosition()</code> function and <code>GetPosition()</code> function so both of them must be supported by implementation.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> iPosition</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64u iPosition</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Absolute byte position in the stream.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_UNSUPPORTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- This function or part of the function is unsupported by implementation.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_put8u" class="float">DataWriter::Put8u</h3>
<div class="paragraph"><p>The method puts a byte of data to the current position. The position changes after reading.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put8u</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> iByte</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp8u iByte</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Source value to be put to destination object.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_put16uswap" class="float">DataWriter::Put16uSwap</h3>
<div class="paragraph"><p>The method puts 2-bytes of data to the current position as a 2-bytes unsigned value in big-endian mode. The position changes after reading.
On a little-endian system, the method does not perform byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put16uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> iWord</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp16u iWord</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Source value to be put to destination object.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_put16unoswap" class="float">DataWriter::Put16uNoSwap</h3>
<div class="paragraph"><p>The method puts 2-bytes of data to the current position as a 2-bytes unsigned value in little-endian mode. The position changes after reading.
On a little-endian system, the method performs byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put16uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> iWord</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp16u iWord</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Source value to be put to destination object.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_put32uswap" class="float">DataWriter::Put32uSwap</h3>
<div class="paragraph"><p>The method puts 4-bytes of data to the current position as a 4-bytes unsigned value in big-endian mode. The position changes after reading.
On a little-endian system, the method does not perform byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put32uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iDWord</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iDWord</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Source value to be put to destination object.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_put32unoswap" class="float">DataWriter::Put32uNoSwap</h3>
<div class="paragraph"><p>The method puts 4-bytes of data to the current position as a 4-bytes unsigned value in little-endian mode. The position changes after reading.
On a little-endian system, the method performs byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put32uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iDWord</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iDWord</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Source value to be put to destination object.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_put64uswap" class="float">DataWriter::Put64uSwap</h3>
<div class="paragraph"><p>The method puts 8-bytes of data to the current position as a 8-bytes unsigned value in big-endian mode. The position changes after reading.
On a little-endian system, the method does not perform byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put64uSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> iQWord</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64u iQWord</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Source value to be put to destination object.
</p>
</td>
</tr>
</table></div>
<h3 id="_datawriter_put64unoswap" class="float">DataWriter::Put64uNoSwap</h3>
<div class="paragraph"><p>The method puts 8-bytes of data to the current position as a 8-bytes unsigned value in little-endian mode. The position changes after reading.
On a little-endian system, the method performs byte swapping.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Put64uNoSwap</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64u</span><span style="color: #000000"> iQWord</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64u iQWord</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Source value to be put to destination object.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
</div>
<div class="sect1">
<h2 id="_mediadata">MediaData</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>The <code>MediaData</code> class is a base class that is used to pass media data between UMC components.
The <code>MediaData</code> class contains a one-dimensional vector of data and time stamp associated with the data and known as Presentation Time Stamp (PTS).
Methods of the class allow setting or getting properties of media data blocks. <code>MediaData</code> contains a buffer, which may be an allocated block of memory, and data placed in the buffer.</p></div>
<div class="paragraph"><p>An application can get an object of the <code>MediaData</code> class from a UMC component and pass it to the next UMC component in the application pipeline.
UMC components use this class to transmit data samples along with their properties that can be modified.
The downstream UMC component uses the <code>MediaData</code> object to retrieve the properties and read the data.</p></div>
<div class="paragraph"><p>The <code>MediaData</code> object functions include:</p></div>
<div class="ulist"><ul>
<li>
<p>
controlling pointers to the buffer and to the data for some abstract media data, buffer size, and data size
</p>
</li>
<li>
<p>
keeping time stamps of the start and end points of data stream
</p>
</li>
<li>
<p>
allocating and de-allocating memory in the destructor, if required.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The derived classes may contain additional specific information (pitches, start code positions, and so on) and specific methods.
To check if additional data is available and use this additional data, the UMC object casts the <code>MediaData</code> object to the derived class.</p></div>
<div class="listingblock">
<div class="title">MediaData definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MediaData</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">MediaData</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">MediaData</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Alloc</span><span style="color: #000000">(</span><span style="color: #000000">size_t</span><span style="color: #000000"> iLength</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">GetBufferPointer</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">GetBufferSize</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">GetDataSize</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> pBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> iSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">size_t</span><span style="color: #000000"> iSize</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MoveDataPointer</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iBytes</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ResetDataPointer</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MoveDataTo</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> dst</span><span style="color: #000000">);</span>

<span style="color: #000000">    MediaData</span><span style="color: #000000">&amp;</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000">=(</span><span style="color: #0000ff">const</span><span style="color: #000000"> MediaData</span><span style="color: #000000">&amp;);</span>

<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">FrameType</span><span style="color: #000000">  m_frameType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000">     m_fPTSStart</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000">     m_fPTSEnd</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">     m_iFlags</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">     m_iInvalid</span><span style="color: #000000">;</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> m_pBufferPointer</span><span style="color: #000000">;</span>
<span style="color: #000000">    Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> m_pDataPointer</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">size_t</span><span style="color: #000000"> m_iBufferSize</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">size_t</span><span style="color: #000000"> m_iDataSize</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">   m_bMemoryAllocated</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 20. MediaData Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                       </th>
<th align="left" valign="top">Method                                             </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_alloc">Alloc</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets an instance of the class, allocating an internal buffer of a given size.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">De-initializes an instance of the class, releases all internal resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Reset data position and information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void*</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_getbufferpointer">GetBufferPointer</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the pointer to the beginning of the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void*</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_getdatapointer">GetDataPointer</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the pointer to the beginning of data in the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_getbuffersize">GetBufferSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the size of the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_getdatasize">GetDataSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the size of valid data in the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_setbufferpointer">SetBufferPointer</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets an instance of the class associating the internal pointers with a given pointer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_setdatasize">SetDataSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets the size of valid data in the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_movedatapointer">MoveDataPointer</a></code></p></td>
<td align="left" valign="top"><p class="table">Moves the data pointer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_resetdatapointer">ResetDataPointer</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns data pointer to buffer pointer position and increases data size accordingly.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata_movedatato">MoveDataTo</a></code></p></td>
<td align="left" valign="top"><p class="table">Moves the data to another class instance.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 21. MediaData Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                       </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_frametype">FrameType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_frameType</code></p></td>
<td align="left" valign="top"><p class="table">The type of the frame of media data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_fPTSStart</code></p></td>
<td align="left" valign="top"><p class="table">The time stamp (PTS) of the beginning of valid data in the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_fPTSEnd</code></p></td>
<td align="left" valign="top"><p class="table">The time stamp (PTS) of the end of valid data in the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iFlags</code></p></td>
<td align="left" valign="top"><p class="table">Stores various flags</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iInvalid</code></p></td>
<td align="left" valign="top"><p class="table">Stores the state of the data when the processed data may be corrupted.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mediadata_alloc" class="float">MediaData::Alloc</h3>
<div class="paragraph"><p>The method allocates an internal buffer of a given size and associates pointers with it.
The size of valid data is set to zero. The method is supposed to be used in applications that have a data generator instead of a data source (for example, Splitter).
Using this allocation technique suggests applying the Reset method to set the data pointer to the beginning of the buffer.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Alloc</span><span style="color: #000000">(</span><span style="color: #000000">size_t</span><span style="color: #000000"> iLength</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>size_t iLength</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Size of the buffer to allocate.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_ALLOC</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Memory allocation failed.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediadata_close" class="float">MediaData::Close</h3>
<div class="paragraph"><p>The method de-initializes an instance of the class, releases all internal resources setting all pointers and sizes to zero.
This method is a destructor of the class instance. The method is called automatically every time Alloc or SetBufferPointer is called.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<h3 id="_mediadata_reset" class="float">MediaData::Reset</h3>
<div class="paragraph"><p>The method resets the <code>MediaData</code> object to the initial state. All the internal pointers are set to the beginning of the buffer and the data size is set to zero.
This method is recommended when internal memory allocation is used.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<h3 id="_mediadata_getbufferpointer" class="float">MediaData::GetBufferPointer</h3>
<div class="paragraph"><p>The method obtains a pointer to the internal buffer that contains a media buffer.
This pointer may not be equal to the data pointer obtained by GetDataPointer as the buffer pointer is always set to the beginning of the internal buffer.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">GetBufferPointer</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>void*</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Address of the beginning of the buffer.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediadata_getdatapointer" class="float">MediaData::GetDataPointer</h3>
<div class="paragraph"><p>The method obtains a pointer to the media data. Note that the data pointer does not have to be equal to the buffer pointer.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>void*</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Address of the beginning of valid data in the buffer.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediadata_getbuffersize" class="float">MediaData::GetBufferSize</h3>
<div class="paragraph"><p>The method returns the size of the internal buffer either allocated or provided.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">GetBufferSize</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>size_t</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Size of the buffer.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediadata_getdatasize" class="float">MediaData::GetDataSize</h3>
<div class="paragraph"><p>The method returns the size of the valid data in the buffer.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">GetDataSize</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>size_t</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Size of valid data in the buffer.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediadata_setbufferpointer" class="float">MediaData::SetBufferPointer</h3>
<div class="paragraph"><p>The method sets the buffer pointer to memory provided by the user. The bytes parameter specifies the buffer size.
After calling this method, the data pointer is set to the beginning of the buffer and the user should set the size of the data to the appropriate value using <code>SetDataSize</code> method.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> pBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> iSize</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp8u* pBuffer</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Pointer to memory to be used as a buffer.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>size_t iSize</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Size of the memory buffer.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediadata_setdatasize" class="float">MediaData::SetDataSize</h3>
<div class="paragraph"><p>The method sets the size of valid data in the buffer. Note that the data does not have to start from the beginning of the buffer.
This method sets the size of valid data after calling the methods that reset the object (for example, <code>Reset</code>, <code>SetBufferPointer</code>, <code>Alloc</code>).
To decrease amount of valid data, the <code>MoveDataPointer</code> method is supposed to be used.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">size_t</span><span style="color: #000000"> iSize</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>size_t iSize</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Size of valid data in the buffer, starting from the data pointer.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Operation failed.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Buffer pointer is not initialized.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediadata_movedatapointer" class="float">MediaData::MoveDataPointer</h3>
<div class="paragraph"><p>The method moves the data pointer inside the internal buffer and changes the size of the valid data by the number of bytes specified by bytes, that is, by the amount of the data used.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MoveDataPointer</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64s</span><span style="color: #000000"> iBytes</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64s iBytes</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Distance to move the pointer to valid data. A positive value means the pointer is moved forward and the amount of valid data is decreased.
    Otherwise, the pointer to valid data is moved backward and the amount of valid data is increased by a given value.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Operation failed.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediadata_resetdatapointer" class="float">MediaData::ResetDataPointer</h3>
<div class="paragraph"><p>The method returns data pointer to buffer pointer position and increases data size accordingly.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ResetDataPointer</span><span style="color: #000000">();</span></tt></pre></div></div>
<h3 id="_mediadata_movedatato" class="float">MediaData::MoveDataTo</h3>
<div class="paragraph"><p>The method copies the existing data bytes to the free space after the data bytes pointed to by the dst object.
If the available free space is not sufficient to hold all data bytes from the current object, extra data bytes are ignored.
Then the MoveDataPointer method of the current <code>MediaData</code> object is called to mark all processed data bytes as processed.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MoveDataTo</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> dst</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData* dst</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to the destination <code>MediaData</code> object.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-          Destination data is not initialized.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Buffer pointer is not initialized.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
<div class="sect2">
<h3 id="_videodata">VideoData</h3>
<hr />
<div class="paragraph"><p><code>VideoData</code> is a class derived from <a href="#_mediadata"><code>MediaData</code></a> class for transmitting video frames and related information between an application and
UMC components. This class provides functionality to control a video frame, its allocation, initialization, and parameters exchange.
It supports all color formats listed in <code><a href="#_colorformat">ColorFormat</a></code> enumerator. When color format is provided
all internal parameters that it defines are set. You can retrieve and modify most of them.</p></div>
<div class="listingblock">
<div class="title">VideoData definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoData</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> MediaData</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoData</span><span style="color: #000000">,</span><span style="color: #000000"> MediaData</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #0000ff">struct</span><span style="color: #000000"> </span><span style="color: #000000">PlaneData</span>
<span style="color: #000000">    </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">PlaneData</span><span style="color: #000000">();</span>

<span style="color: #000000">        </span><span style="color: #000000">IppiSize</span><span style="color: #000000"> m_size</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">   m_iSampleSize</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">   m_iSamples</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">   m_iBitDepth</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">   m_iWidthDiv</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">   m_iHeightDiv</span><span style="color: #000000">;</span>

<span style="color: #000000">        </span><span style="color: #000000">Ipp8u</span><span style="color: #000000">   </span><span style="color: #000000">*</span><span style="color: #000000">m_pPlane</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">size_t</span><span style="color: #000000">   m_iPitch</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">size_t</span><span style="color: #000000">   m_iMemSize</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoData</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">VideoData</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iWidth</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iHeight</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">ColorFormat</span><span style="color: #000000"> format</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iBitDepth </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">VideoData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Alloc</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ReleaseImage</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MapImage</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MapPlane</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlane</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> iSize</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetBitDepth</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iBitDepth</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPlaneBitDepth</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iBitDepth</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetPlaneBitDepth</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetSampleSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iSampleSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPlaneSampleSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iSampleSize</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetPlaneSampleSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPlaneDataPtr</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDest</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">GetPlaneDataPtr</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPlanePitch</span><span style="color: #000000">(</span><span style="color: #000000">size_t</span><span style="color: #000000"> nPitch</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">GetPlanePitch</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetAlignment</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iAlignment</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">GetMappingSize</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetMaxSampleSize</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Crop</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> CropArea</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Copy</span><span style="color: #000000">(</span><span style="color: #000000">VideoData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDstData</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetChannelsNumber</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetPlanesNumber</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000"> </span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> PlaneData</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">GetPtrToPlane</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlane</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span>

<span style="color: #000000">    VideoData</span><span style="color: #000000">&amp;</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000">=(</span><span style="color: #0000ff">const</span><span style="color: #000000"> VideoData</span><span style="color: #000000">&amp;);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">AllocPlanes</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlanes</span><span style="color: #000000">);</span>

<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">PictureStructure</span><span style="color: #000000"> m_picStructure</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">ColorFormat</span><span style="color: #000000">      m_colorFormat</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">SampleFormat</span><span style="color: #000000">     m_sampleFormat</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iWidth</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iHeight</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iSAWidth</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iSAHeight</span><span style="color: #000000">;</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">     m_iAlignment</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">     m_iPlanes</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">PlaneData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">m_pPlaneData</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 22. VideoData Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                                 </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes frame information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_alloc">Alloc</a></code></p></td>
<td align="left" valign="top"><p class="table">Allocates memory for video data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Releases all allocated memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_releaseimage">ReleaseImage</a></code></p></td>
<td align="left" valign="top"><p class="table">Releases memory allocated for video planes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_mapimage">MapImage</a></code></p></td>
<td align="left" valign="top"><p class="table">Update planes info.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_mapplane">MapPlane</a></code></p></td>
<td align="left" valign="top"><p class="table">Update plane info.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_setbufferpointer">SetBufferPointer</a></code></p></td>
<td align="left" valign="top"><p class="table">Links data buffer to provided buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_setbitdepth">SetBitDepth</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets uniform bit-depth for all planes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_setplanebitdepth">SetPlaneBitDepth</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets bit depth for the specified plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_getplanebitdepth">GetPlaneBitDepth</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns bit depth of the specified plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_setsamplesize">SetSampleSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets uniform sample size for all planes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_setplanesamplesize">SetPlaneSampleSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets sample size in bytes for the specified plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_getplanesamplesize">GetPlaneSampleSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns sample size in bytes for the specified plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_getmaxsamplesize">GetMaxSampleSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns maximum sample size of planes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_setplanedataptr">SetPlaneDataPtr</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets pointer to specified plane data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void*</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_getplanedataptr">GetPlaneDataPtr</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns pointer to specified plane data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_setplanepitch">SetPlanePitch</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets pitch for specified plane data in bytes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_getplanepitch">GetPlanePitch</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns pitch for specified plane data in bytes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_setalignment">SetAlignment</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets alignment required for plane data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_getmappingsize">GetMappingSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the buffer size required for the frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_crop">Crop</a></code></p></td>
<td align="left" valign="top"><p class="table">Modify image info to crop image borders, doesn&#8217;t modify image data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_copy">Copy</a></code></p></td>
<td align="left" valign="top"><p class="table">Copies data to another buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_getchannelsnumber">GetChannelsNumber</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns total number of channels in all planes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_getplanesnumber">GetPlanesNumber</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the number of planes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>PlaneData*</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata_getptrtoplane">GetPtrToPlane</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the pointer to specific planes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 23. VideoData Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                       </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_PictureStructure">PictureStructure</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_picStructure</code></p></td>
<td align="left" valign="top"><p class="table">Structure of picture.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_ColorFormat">ColorFormat</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_colorFormat</code></p></td>
<td align="left" valign="top"><p class="table">Color format of image.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_SampleFormat">SampleFormat</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_sampleFormat</code></p></td>
<td align="left" valign="top"><p class="table">Image sample format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iWidth</code></p></td>
<td align="left" valign="top"><p class="table">Image width.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iHeight</code></p></td>
<td align="left" valign="top"><p class="table">Image height.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iSAWidth</code></p></td>
<td align="left" valign="top"><p class="table">Sample aspect width.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iSAHeight</code></p></td>
<td align="left" valign="top"><p class="table">Sample aspect height.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 24. PlaneData Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>IppiSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_size</code></p></td>
<td align="left" valign="top"><p class="table">Width and height of the plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iSampleSize</code></p></td>
<td align="left" valign="top"><p class="table">Sample size (in bytes).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iSamples</code></p></td>
<td align="left" valign="top"><p class="table">Number of samples per plane element.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iBitDepth</code></p></td>
<td align="left" valign="top"><p class="table">Number of significant bits per sample.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iWidthDiv</code></p></td>
<td align="left" valign="top"><p class="table">Horizontal downsampling factor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iHeightDiv</code></p></td>
<td align="left" valign="top"><p class="table">Vertical downsampling factor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pPlane</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to plane data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iPitch</code></p></td>
<td align="left" valign="top"><p class="table">Plane pitch.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iMemSize</code></p></td>
<td align="left" valign="top"><p class="table">Size of occupied memory.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_videodata_init" class="float">VideoData::Init</h4>
<div class="paragraph"><p>The method initializes a <code>VideoData</code> class object with information on the image. If <code>VideoData</code> is already initialized, it is deinitialized first.
Init allocates memory for internal <code>VideoData::PlaneData</code> structures and fills them according to provided dimensions, color format and, optionally, bit depth.</p></div>
<div class="paragraph"><p>The first function without parameters initializes frame with current data.
The second function sets provided parameters before initialization.
The third function uses another <code>VideoData</code> object as a template.</p></div>
<div class="paragraph"><p><code>Init()</code> does not allocate memory for video planes. For every plane, use the <a href="#_videodata_setbufferpointer"><code>SetBufferPointer()</code></a> or
<a href="#_videodata_setplanedataptr"><code>SetPlaneDataPtr()</code></a> methods to link the initialized <code>VideoData</code> object with the memory you allocated.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">();</span>
<span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iWidth</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iHeight</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">ColorFormat</span><span style="color: #000000"> format</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iBitDepth </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">);</span>
<span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">VideoData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iWidth</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Width of the frame in pixels.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iHeight</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Height of the frame in pixels.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>ColorFormat format</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Color format of the frame.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iBitDepth</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Bit depth for all plane samples.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>VideoData *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to VideoData to use as template.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-               Operation failed.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Incorrect arguments.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_ALLOC</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-                Method is unable to allocate memory for internal structures.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_ENOUGH_BUFFER</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    The size of the buffer is less than required.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_alloc" class="float">VideoData::Alloc</h4>
<div class="paragraph"><p>The method allocates memory for the video frame. The size of allocated memory is computed using the <a href="#_videodata_getmappingsize"><code>GetMappingSize()</code></a> method.
Before <code>Alloc()</code> is invoked, a <code>VideoData</code> object has to be initialized with appropriate values.
If the <code>VideoData</code> object was already linked to the data memory it is unlinked, and if the memory was allocated by the object it is released.</p></div>
<div class="paragraph"><p>The method <a href="#_videodata_releaseimage"><code>ReleaseImage()</code></a> frees the memory block allocated by <code>Alloc()</code> and clears all plane pointers.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Alloc</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_STREAM</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   <code>VideoData</code> object was not properly initialized.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_ALLOC</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-            Method is unable to allocate memory for internal structures.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_close" class="float">VideoData::Close</h4>
<div class="paragraph"><p>The method frees the data memory, if any, allocated by the object and destroys all plane information. After calling this method, delete or re-initialize the object.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<h4 id="_videodata_releaseimage" class="float">VideoData::ReleaseImage</h4>
<div class="paragraph"><p>The method frees the data memory allocated by <a href="#_videodata_alloc"><code>Alloc()</code></a> and clears all plane pointers.
The <code>ReleaseImage()</code> method performs operation inverse to operation by <a href="#_videodata_alloc"><code>Alloc()</code></a>,
<a href="#_videodata_setbufferpointer"><code>SetBufferPointer()</code></a>, and <a href="#_videodata_setplanepointer"><code>SetPlanePointer()</code></a>.
Both the class destructor and the <a href="#_videodata_close"><code>Close()</code></a> method invoke <code>ReleaseImage()</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ReleaseImage</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<h4 id="_videodata_mapimage" class="float">VideoData::MapImage</h4>
<div class="paragraph"><p>The method updates image structures to match current image parameters. It is called by <a href="#_videodata_init"><code>Init()</code></a>
and several other functions to ensure what all structures contain actual image information.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MapImage</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Incorrect image information.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Object was not initialized properly.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_mapplane" class="float">VideoData::MapPlane</h4>
<div class="paragraph"><p>The method updates plane structure to match current image parameters. It is called by <a href="#_videodata_mapimage"><code>MapImage()</code></a>
and several other functions to ensure what current plane contains actual image information.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MapPlane</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlane</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlane</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Plane number to be updated.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Incorrect image information.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Object was not initialized properly.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_setbufferpointer" class="float">VideoData::SetBufferPointer</h4>
<div class="paragraph"><p>The method links an initialized <code>VideoData</code> object to the provided video data memory and sets all plane pointers.
The buffer size must be not less than the value returned by <a href="#_videodata_getmappingsize"><code>GetMappingSize()</code></a>.</p></div>
<div class="paragraph"><p>The method extends <a href="#_mediadata_setbufferpointer"><code>MediaData::SetBufferPointer()</code></a> by setting the data size to
<a href="#_videodata_getmappingsize"><code>GetMappingSize()</code></a> and the data pointer to the aligned <code>pBuffer</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> iSize</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp8u *pBuffer</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Pointer to data memory block.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>size_t iSize</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Size of the data memory block.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-               Operation failed.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_ENOUGH_BUFFER</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Buffer size is not sufficient to accommodate data.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_setbitdepth" class="float">VideoData::SetBitDepth</h4>
<div class="paragraph"><p>The methods sets uniform bit-depth to all planes of an image.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetBitDepth</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iBitDepth</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iBitDepth</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- New bit-depth value.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-               Operation failed.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Incorrect image information.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Object was not initialized properly.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_setplanebitdepth" class="float">VideoData::SetPlaneBitDepth</h4>
<div class="paragraph"><p>The method sets the bit-depth for a specified plane.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPlaneBitDepth</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iBitDepth</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iBitDepth</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      New bit-depth value.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlaneNumber</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Plane number to be used.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-               Operation failed.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Incorrect image information.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Object was not initialized properly.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_getplanebitdepth" class="float">VideoData::GetPlaneBitDepth</h4>
<div class="paragraph"><p>The method returns the bit-depth for a specified plane.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetPlaneBitDepth</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlaneNumber</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Plane number to be used.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Bit-depth value of the specified plane.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_setsamplesize" class="float">VideoData::SetSampleSize</h4>
<div class="paragraph"><p>The methods sets uniform sample size to all planes of an image.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetSampleSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iSampleSize</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iSampleSize</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- New sample size value.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-               Operation failed.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Incorrect image information.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Object was not initialized properly.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_setplanesamplesize" class="float">VideoData::SetPlaneSampleSize</h4>
<div class="paragraph"><p>The method sets the sample size in bytes for a specified plane.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPlaneSampleSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iSampleSize</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iSampleSize</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- New sample size value.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlaneNumber</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Plane number to be used.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-               Operation failed.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Incorrect image information.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Object was not initialized properly.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_getplanesamplesize" class="float">VideoData::GetPlaneSampleSize</h4>
<div class="paragraph"><p>The method returns the sample size in bytes for a specified plane.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetPlaneSampleSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlaneNumber</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Plane number to be used.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Sample size value of a specified plane.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_getmaxsamplesize" class="float">VideoData::GetMaxSampleSize</h4>
<div class="paragraph"><p>The method returns the maximum sample size of an image planes.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetMaxSampleSize</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Maximum sample size of an image.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_setplanedataptr" class="float">VideoData::SetPlaneDataPtr</h4>
<div class="paragraph"><p>The method sets the plane pointer for a given plane to the provided memory location.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPlaneDataPtr</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDst</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>void *pDst</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-            Pointer to the plane data.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlaneNumber</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Plane number to be used.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-               Operation failed.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_getplanedataptr" class="float">VideoData::GetPlaneDataPtr</h4>
<div class="paragraph"><p>The method returns the pointer to data of the specified plane.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">GetPlaneDataPtr</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlaneNumber</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Plane number to be used.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>void*</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Returns address on success and <code>NULL</code> pointer in the case of an error.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_setplanepitch" class="float">VideoData::SetPlanePitch</h4>
<div class="paragraph"><p>The method sets a pitch for a specified plane.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetPlanePitch</span><span style="color: #000000">(</span><span style="color: #000000">size_t</span><span style="color: #000000"> nPitch</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>size_t nPitch</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-         New pitch value.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlaneNumber</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Plane number to be used.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-               Operation failed.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_getplanepitch" class="float">VideoData::GetPlanePitch</h4>
<div class="paragraph"><p>The method returns pitch for a specified plane.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">GetPlanePitch</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlaneNumber</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlaneNumber</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Plane number to be used.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>size_t</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pitch value of the specified plane.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_setalignment" class="float">VideoData::SetAlignment</h4>
<div class="paragraph"><p>The method sets common memory alignment for data. Alignment affects pointers both to planes and pitches.
If alignment is not power of 2, the least significant nonzero bit is taken as the alignment value.</p></div>
<div class="paragraph"><p><a href="#_videodata_init"><code>Init()</code></a> or <a href="#_videodata_mapimage"><code>MapImage()</code></a> mthod should be called for new align value to work. The default value is 1.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetAlignment</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iAlignment</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iAlignment</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Alignment value. Least significant nonzero bit is used for this parameter.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Improper argument value.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_getmappingsize" class="float">VideoData::GetMappingSize</h4>
<div class="paragraph"><p>The method returns the minimum size of the memory block required to locate image data of the initialized <code>VideoData</code> object using current parameters.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">size_t</span><span style="color: #000000"> </span><span style="color: #000000">GetMappingSize</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>size_t</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Size of the memory block.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_crop" class="float">VideoData::Crop</h4>
<div class="paragraph"><p>The method modifies image info to prevent reading of image parts outside of specified rectangle. It doesn&#8217;t modify actual image data.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Crop</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> CropArea</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>UMC::RECT CropArea</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Rectangle with specified crop area.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Improper argument value.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_copy" class="float">VideoData::Copy</h4>
<div class="paragraph"><p>The method copies image data to another <code>VideoData</code> instance. Destination <code>VideoData</code> object must be initialized with the same image information.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Copy</span><span style="color: #000000">(</span><span style="color: #000000">VideoData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDstData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>VideoData *pDstData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Destination <code>VideoData</code> instance.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-           Operation failed.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Image informations of source and destination objects don&#8217;t match.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_getchannelsnumber" class="float">VideoData::GetChannelsNumber</h4>
<div class="paragraph"><p>The method counts all channels in all planes of an image.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetChannelsNumber</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Total number of channels in an image.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_getplanesnumber" class="float">VideoData::GetPlanesNumber</h4>
<div class="paragraph"><p>The method returns the current number of planes that was set on initialization by color format.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetPlanesNumber</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Number of planes in the image.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodata_getptrtoplane" class="float">VideoData::GetPtrToPlane</h4>
<div class="paragraph"><p>The method returns pointer to internal <code>PlaneData</code> structure with parameters of a specified image plane.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> PlaneData</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">GetPtrToPlane</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iPlane</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iPlane</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Plane number to be used.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>PlaneData*</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to specified plain or <code>NULL</code> if plane doesn&#8217;t exist.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
<div class="sect2">
<h3 id="_audiodata">AudioData</h3>
<hr />
<div class="paragraph"><p><code>AudioData</code> is a class derived from <a href="#_mediadata"><code>MediaData</code></a> class for passing, along with audio data, information about audio streams between UMC components.</p></div>
<div class="listingblock">
<div class="title">AudioData definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">AudioData</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> MediaData</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">AudioData</span><span style="color: #000000">,</span><span style="color: #000000"> MediaData</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioData</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">AudioData</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iChannels</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iSampleFrequency</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iBitPerSample</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">AudioData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Alloc</span><span style="color: #000000">(</span><span style="color: #000000">size_t</span><span style="color: #000000"> iLenght</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> nSize</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetAlignment</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iAlignment</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Copy</span><span style="color: #000000">(</span><span style="color: #000000">AudioData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDstData</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000">=(</span><span style="color: #0000ff">const</span><span style="color: #000000"> AudioData</span><span style="color: #000000">&amp;</span><span style="color: #000000"> par</span><span style="color: #000000">);</span>

<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> m_iChannels</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> m_iSampleFrequency</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> m_iBitPerSample</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> m_iChannelMask</span><span style="color: #000000">;</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> m_iAlignment</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 25. AudioData Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                             </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiodata_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes frame information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiodata_alloc">Alloc</a></code></p></td>
<td align="left" valign="top"><p class="table">Allocates memory for audio data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiodata_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Releases all allocated memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiodata_setbufferpointer">SetBufferPointer</a></code></p></td>
<td align="left" valign="top"><p class="table">Links data buffer to provided buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiodata_setalignment">SetAlignment</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets alignment required for plane data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiodata_getmappingsize">GetMappingSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the buffer size required for the frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiodata_copy">Copy</a></code></p></td>
<td align="left" valign="top"><p class="table">Copies data to another buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 26. AudioData Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type           </th>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iChannels</code></p></td>
<td align="left" valign="top"><p class="table">Number of audio channels.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iSampleFrequency</code></p></td>
<td align="left" valign="top"><p class="table">Audio sampling frequency.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iBitPerSample</code></p></td>
<td align="left" valign="top"><p class="table">Number of bits per audio sample.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iChannelMask</code></p></td>
<td align="left" valign="top"><p class="table">Mask for channels positions.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_audiodata_init" class="float">AudioData::Init</h4>
<div class="paragraph"><p>The method initializes a <code>AudioData</code> class object with information on the signal. If <code>AudioData</code> is already initialized, it is deinitialized first.</p></div>
<div class="paragraph"><p>The first function sets provided parameters before initialization.
The second function uses another <code>AudioData</code> object as a template.</p></div>
<div class="paragraph"><p><code>Init()</code> does not allocate memory for audio signal. Use the <a href="#_audiodata_setbufferpointer"><code>SetBufferPointer()</code></a> method
to link the initialized <code>AudioData</code> object with the memory you allocated.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iChannels</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iSampleFrequency</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iBitPerSample</span><span style="color: #000000">);</span>
<span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">AudioData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iChannels</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-          Number of audio channels.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iSampleFrequency</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Sampling frequency.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iBitPerSample</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Number of bits per sample.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>AudioData *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-          Pointer to <code>AudioData</code> to use as template.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_OK</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-                   Oparation was successfull.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Incorrect arguments.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiodata_alloc" class="float">AudioData::Alloc</h4>
<div class="paragraph"><p>The method allocates memory for the audio signal. The size of allocated memory is provided manually but will be aligned according to <code>m_iAlignment</code> value
which can be set through <a href="#_audiodata_setalignment"><code>SetAlignment()</code></a> method.
If the <code>AudioData</code> object was already linked to the data memory it is unlinked, and if the memory was allocated by the object it is released.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Alloc</span><span style="color: #000000">(</span><span style="color: #000000">size_t</span><span style="color: #000000"> iLenght</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_ALLOC</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Method is unable to allocate memory.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiodata_close" class="float">AudioData::Close</h4>
<div class="paragraph"><p>The method frees the data memory, if any, allocated by the object and destroys all plane information. After calling this method, delete or re-initialize the object.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<h4 id="_audiodata_setbufferpointer" class="float">AudioData::SetBufferPointer</h4>
<div class="paragraph"><p>The method links an initialized <code>AudioData</code> object to the provided audio data memory.
The buffer size must be not less than the byte size of one sample.</p></div>
<div class="paragraph"><p>The method extends <a href="#_mediadata_setbufferpointer"><code>MediaData::SetBufferPointer()</code></a> by setting the data pointer to the aligned <code>pBuffer</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> iSize</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp8u *pBuffer</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Pointer to data memory block.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>size_t iSize</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Size of the data memory block.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_ENOUGH_BUFFER</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Buffer size is not sufficient to accommodate data.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiodata_setalignment" class="float">AudioData::SetAlignment</h4>
<div class="paragraph"><p>The method sets common memory alignment for data.
If alignment is not power of 2, the least significant nonzero bit is taken as the alignment value.</p></div>
<div class="paragraph"><p><a href="#_audiodata_alloc"><code>Alloc()</code></a> or <a href="#_audiodata_setbufferpointer"><code>SetBufferPointer()</code></a> mthod should be called for new align value to work. The default value is 1.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetAlignment</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iAlignment</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iAlignment</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Alignment value. Least significant nonzero bit is used for this parameter.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Improper argument value.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiodata_copy" class="float">AudioData::Copy</h4>
<div class="paragraph"><p>The method copies audio data to another <code>AudioData</code> instance. Destination <code>AudioData</code> object must be initialized with the same audio information.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Copy</span><span style="color: #000000">(</span><span style="color: #000000">AudioData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDstData</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>AudioData *pDstData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Destination <code>AudioData</code> instance.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Image informations of source and destination objects don&#8217;t match.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_splitter">Splitter</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>Splitter</code> is an abstract base class that provides virtual methods for high level interface of an abstract media stream splitter.
<code>Splitter</code> receives the stream from an abstract data source, which may be a file, a socket, etc., by using the <a href="#_datareader"><code>DataReader</code></a> interface
and separates audio, video, and auxiliary elementary streams (ES), or tracks.</p></div>
<div class="paragraph"><p>The <a href="#_splitter_getinfo"><code>GetInfo()</code></a> method collects information on the processed stream.
The <a href="#_splitter_getnextdata"><code>GetNextData()</code></a> and <a href="#_splitter_checknextdata"><code>CheckNextData()</code></a> methods obtain the next data chunk from the stream.</p></div>
<div class="paragraph"><p>The <code>Splitter</code> class provides interface for positioning inside streams through the <a href="#_splitter_settimeposition"><code>SetTimePosition</code></a> and <a href="#_splitter_gettimeposition"><code>GetTimePosition</code></a> methods.
The <code>Splitter</code> class also provides interface for changing playback rate through the <a href="#_splitter_setrate"><code>SetRate</code></a> method.
The <a href="#_splitter_settrackstate"><code>SetTrackState</code></a> method can be used to switch ES methods on and off.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_3_1.png" alt="images/umc/umc_3_1.png" />
</div>
<div class="title">Figure 5. Splitter Operation Pipeline</div>
</div>
<div class="listingblock">
<div class="title">Splitter definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">Splitter</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">Splitter</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">Splitter</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">Splitter</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">static</span><span style="color: #000000"> </span><span style="color: #000000">SystemStreamType</span><span style="color: #000000"> </span><span style="color: #000000">GetStreamType</span><span style="color: #000000">(</span><span style="color: #000000">DataReader</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pReader</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">SplitterParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pInit</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetNextData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iTrack</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">CheckNextData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iTrack</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetTimePosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> fPos</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetTimePosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">fPos</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetInfo</span><span style="color: #000000">(</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> </span><span style="color: #000000">**</span><span style="color: #000000">ppInfo</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetRate</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> fRate</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetTrackState</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iTrack</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">TrackState</span><span style="color: #000000"> state</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Run</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Stop</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    DataReader</span><span style="color: #000000">*</span><span style="color: #000000">  m_pDataReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> m_info</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 27. Splitter Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                       </th>
<th align="left" valign="top">Method                                         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_systemstreamtype">SystemStreamType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_getstreamtype">GetStreamType</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns type of the media stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the splitter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the splitter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_getnextdata">GetNextData</a></code></p></td>
<td align="left" valign="top"><p class="table">Provides frame from a specific track. Unlocks the previous returned frame from the track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_checknextdata">CheckNextData</a></code></p></td>
<td align="left" valign="top"><p class="table">Provides frame from a specific track. Does not unlock the previous returned track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_settimeposition">SetTimePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets new current position, if applicable. Parameter is a number of seconds from beginning of the source stream and takes value from 0.0 to duration of the source stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_gettimeposition">GetTimePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns current position in seconds from beginning of the source stream. Returned value is from 0.0 to duration of the source stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_getinfo">GetInfo</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns pointer to <code>SplitterInfo</code> structure where all splitter information is kept.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_setrate">SetRate</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets a new value of playback rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_settrackstate">SetTrackState</a></code></p></td>
<td align="left" valign="top"><p class="table">Disables or enables a specific track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_run">Run</a></code></p></td>
<td align="left" valign="top"><p class="table">Runs the internal processing threads.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_splitter_stop">Stop</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops the internal processing threads.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_splitterparams" class="float">SplitterParams</h3>
<div class="paragraph"><p>This class contains the initialization parameters for <a href="#_splitter"><code>Splitter</code></a> class.</p></div>
<div class="listingblock">
<div class="title">SplitterParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">SplitterParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">SplitterParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">SplitterParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">SplitterParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iFlags</span><span style="color: #000000">;</span>
<span style="color: #000000">    DataReader</span><span style="color: #000000">*</span><span style="color: #000000">      m_pDataReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iSelectedVideoPID</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iSelectedAudioPID</span><span style="color: #000000">;</span>
<span style="color: #000000">    MemoryAllocator</span><span style="color: #000000">*</span><span style="color: #000000"> m_pMemoryAllocator</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 28. SplitterParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                   </th>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iFlags</code></p></td>
<td align="left" valign="top"><p class="table">Flag that sets up splitter configuration; <a href="#_splitter_flags">flags list</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_datareader">DataReader</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pDataReader</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to initialized data reader.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iSelectedVideoPID</code></p></td>
<td align="left" valign="top"><p class="table">ID for video stream chosen by user.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iSelectedAudioPID</code></p></td>
<td align="left" valign="top"><p class="table">ID for audio stream chosen by user.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator">MemoryAllocator</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to memory allocator object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">If a splitter requires additional parameters to be initialized, the user should create a derived class that will contain specific parameters.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">UserSplitterParams example</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">UserSplitterParams</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> SplitterParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">UserSplitterParams</span><span style="color: #000000">,</span><span style="color: #000000"> SplitterParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> user_specific_param</span><span style="color: #000000">;</span>
<span style="color: #000000">...</span>
<span style="color: #000000">}</span></tt></pre></div></div>
<h3 id="_splitterinfo" class="float">SplitterInfo</h3>
<div class="paragraph"><p>The class contains information parameters of the splitter.</p></div>
<div class="listingblock">
<div class="title">SplitterInfo definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">SplitterInfo</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">SplitterInfo</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">            m_iFlags</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">SystemStreamType</span><span style="color: #000000">  m_systemType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">            m_iTracks</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000">            m_fRate</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000">            m_fDuration</span><span style="color: #000000">;</span>
<span style="color: #000000">    TrackInfo</span><span style="color: #000000">**</span><span style="color: #000000">       m_ppTrackInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 29. SplitterInfo Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                       </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iFlags</code></p></td>
<td align="left" valign="top"><p class="table">Splitter flags. See <a href="#_splitterparams"><code>SplitterParams</code></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_systemstreamtype">SystemStreamType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_systemType</code></p></td>
<td align="left" valign="top"><p class="table">Type of the media stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iTracks</code></p></td>
<td align="left" valign="top"><p class="table">Number of tracks in container.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_fRate</code></p></td>
<td align="left" valign="top"><p class="table">Current playback rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_fDuration</code></p></td>
<td align="left" valign="top"><p class="table">Duration of the stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_trackinfo">TrackInfo</a>**</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_ppTrackInfo</code></p></td>
<td align="left" valign="top"><p class="table">Array of pointers to <code>TrackInfo</code> objects. The number of objects is equal to the number of
                                                            tracks in the stream detected by the time GetInfo called.
                                                            For some splitters, info can be updated while parsing the input media stream.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_trackinfo" class="float">TrackInfo</h3>
<div class="paragraph"><p>The class contains information about a track.</p></div>
<div class="listingblock">
<div class="title">TrackInfo definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">TrackInfo</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">TrackInfo</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">TrackInfo</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">TrackInfo</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #000000">TrackType</span><span style="color: #000000">    m_type</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">       m_iPID</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">         m_bEnabled</span><span style="color: #000000">;</span>
<span style="color: #000000">    MediaData</span><span style="color: #000000">*</span><span style="color: #000000">   m_pHeader</span><span style="color: #000000">;</span>
<span style="color: #000000">    MediaData</span><span style="color: #000000">*</span><span style="color: #000000">   m_pHeaderExt</span><span style="color: #000000">;</span>
<span style="color: #000000">    StreamInfo</span><span style="color: #000000">*</span><span style="color: #000000">  m_pStreamInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 30. TrackInfo Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                           </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_tracktype">TrackType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_type</code></p></td>
<td align="left" valign="top"><p class="table">Enum to identify the type of ES.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iPID</code></p></td>
<td align="left" valign="top"><p class="table">PID of elementary stream</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_bEnabled</code></p></td>
<td align="left" valign="top"><p class="table">Shows whether the track is on or off (whether it is splitted or not).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata">MediaData</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pHeader</code></p></td>
<td align="left" valign="top"><p class="table">Decoder specific info (if available)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata">MediaData</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pHeaderExt</code></p></td>
<td align="left" valign="top"><p class="table">Decoder specific extension info (if available)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_streaminfo">StreamInfo</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pStreamInfo</code></p></td>
<td align="left" valign="top"><p class="table">Stream information; can be <a href="#_audiostreaminfo"><code>AudioStreamInfo</code></a>, <a href="#_videostreaminfo"><code>VideoStreamInfo</code></a>, etc. depending on the type of the track.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_related_data" class="float">Related data</h3>
<div class="tableblock" id="_splitter_flags">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 31. Splitter Flags</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UNDEF_SPLITTER</code></p></td>
<td align="left" valign="top"><p class="table">The initial flag that means all the flags are empty.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AUDIO_SPLITTER</code></p></td>
<td align="left" valign="top"><p class="table">Audio stream extraction flag. If set before splitter initialization, the splitter extracts audio streams. If not set, the splitter ignores audio streams.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VIDEO_SPLITTER</code></p></td>
<td align="left" valign="top"><p class="table">Video stream extraction flag. If set before splitter initialization, the splitter extracts video streams. If not set, the splitter ignores video streams.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AV_SPLITTER</code></p></td>
<td align="left" valign="top"><p class="table">If set before splitter initialization, the splitter extracts both audio and video streams.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FLAG_VSPL_4BYTE_ACCESS</code></p></td>
<td align="left" valign="top"><p class="table">Input data interpretation flag for little-endian/big-endian architectures.
                        When set, this value means the coded data should be accessed by 4-bytes reading operations.
                        For a little-endian platform, it means that every four bytes are swapped: [0] with [3], [1] with [2] at 4-byte aligned position.
                        For big-endian systems, swapping is not required and the output data is passed in the original byte order.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="_tracktype">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 32. TrackType Values</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MPEG1V</code></p></td>
<td align="left" valign="top"><p class="table">MPEG1 Video. Defined in ISO/IEC 11172-2 [ISO/IEC93_2]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MPEG2V</code></p></td>
<td align="left" valign="top"><p class="table">MPEG2 Video. Defined in ISO/IEC 13818-2 [ISO/IEC96]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MPEG4V</code></p></td>
<td align="left" valign="top"><p class="table">MPEG4 Video. Defined in ISO/IEC 14496-2 [ISO/IEC_Visual]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_H261</code></p></td>
<td align="left" valign="top"><p class="table">H.261 Video. Defined in ITU-T Recommendation H.261 [ITUH261].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_H263</code></p></td>
<td align="left" valign="top"><p class="table">H.263 Video. Defined in ITU-T Recommendation H.263 [ITUH263].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_H264</code></p></td>
<td align="left" valign="top"><p class="table">H.264 Video. Defined in ITU-T Recommendation H.264 [ITUH264] or ISO/IEC 14496-10 [ISO/IEC_10].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DVSD</code></p></td>
<td align="left" valign="top"><p class="table">DVSD Video. Defined in SMPTE 314M-2005 [SMPTE314M].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DV50</code></p></td>
<td align="left" valign="top"><p class="table">DV50 Video. Defined in SMPTE 314M-2005 [SMPTE314M].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DVHD</code></p></td>
<td align="left" valign="top"><p class="table">DV100 Video. Defined in SMPTE 370M-2002 [SMPTE370M].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DVSL</code></p></td>
<td align="left" valign="top"><p class="table">DVSL Video. Defined in SMPTE 314M-2005 [SMPTE314M].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_VC1</code></p></td>
<td align="left" valign="top"><p class="table">VC-1 Video. Defined in VC-1 standard [SMPTE 421M]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_WMV</code></p></td>
<td align="left" valign="top"><p class="table">AC-3 Audio. Defined in ATSC Document A/52B [ATSC05].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MJPEG</code></p></td>
<td align="left" valign="top"><p class="table">MotionJPEG Video. Defined in ISO/IEC 10918-1 [ISOIEC10918-1].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_YUV</code></p></td>
<td align="left" valign="top"><p class="table">YUV Video. Uncompressed</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_AVS</code></p></td>
<td align="left" valign="top"><p class="table">AVS Video. Defined in GB/T 20090.2 - 2006 [GB/T20090.2]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_VP8</code></p></td>
<td align="left" valign="top"><p class="table">VP8 Video. Defined in RFC6386</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table">Mask that covers all types of video.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_PCM</code></p></td>
<td align="left" valign="top"><p class="table">PCM Audio. Uncompressed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_LPCM</code></p></td>
<td align="left" valign="top"><p class="table">LPCM Audio. Uncompressed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_AC3</code></p></td>
<td align="left" valign="top"><p class="table">AC-3 Audio. Defined in ATSC Document A/52B [ATSC05].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_AAC</code></p></td>
<td align="left" valign="top"><p class="table">MPEG4 Audio; means either ADTS AAC or raw AAC. The stream_type field of structure AudioStreamInfo defines it more exactly.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MPEGA</code></p></td>
<td align="left" valign="top"><p class="table">MPEG Audio layer 1, 2 or 3. Defined in ISO/IEC 11172-3 [ISO/IEC93_3].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_TWINVQ</code></p></td>
<td align="left" valign="top"><p class="table">TwinVQ audio coding technique. Defined in ISO/IEC 14496-2 (MPEG4 Audio) [ISO/IEC_Visual].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DTS</code></p></td>
<td align="left" valign="top"><p class="table">DTS Audio. Defined in ETSI EN 102 114 [ETSI02].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_VORBIS</code></p></td>
<td align="left" valign="top"><p class="table">Ogg Vorbis audio. Defined in Vorbis I specification.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_AMR</code></p></td>
<td align="left" valign="top"><p class="table">Adaptive Multi-Rate speech codec. Defined in 3G TS 26.071 [3GTS].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table">Mask that covers all types of audio.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_SUB_PIC</code></p></td>
<td align="left" valign="top"><p class="table">DVD sub-picture. Defined in DVD Specification [DVD].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DVD_NAV</code></p></td>
<td align="left" valign="top"><p class="table">DVD navigation. Defined in DVD Specification. [DVD]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_DVD</code></p></td>
<td align="left" valign="top"><p class="table">Common for all types of DVD data streams [DVD].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_VBI_TXT</code></p></td>
<td align="left" valign="top"><p class="table">VBI Teletext. Defined in ESTI EN 301 775 [ETSI03].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_VBI_SPEC</code></p></td>
<td align="left" valign="top"><p class="table">Video Programme System (VPS), Side Screen Signaling (WSS), Closed Captioning (CC) or Monochrome 4:2:2. Defined in ESTI EN 301 775 [ETSI03].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_VBI</code></p></td>
<td align="left" valign="top"><p class="table">Common for all types of VBI data streams.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_SPECIAL</code></p></td>
<td align="left" valign="top"><p class="table">Mask that covers all types of special ESs.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_UNKNOWN</code></p></td>
<td align="left" valign="top"><p class="table">Unknown type of ES</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="_trackstate">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 33. TrackState Values</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DISABLED</code></p></td>
<td align="left" valign="top"><p class="table">Disable track</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ENABLED</code></p></td>
<td align="left" valign="top"><p class="table">Enable track</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_splitter_getstreamtype" class="float">Splitter::GetStreamType</h3>
<div class="paragraph"><p>The method determines a system type of the stream by analyzing it through interface of the <a href="#_datareader"><code>DataReader</code></a> class.
The method returns a member of the <a href="#_systemstreamtype"><code>SystemStreamType</code></a> enum.
If the pointer to the object of the <a href="#_datareader"><code>DataReader</code></a> class is <code>NULL</code>, the method returns <code>UNDEF_STREAM</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">static</span><span style="color: #000000"> </span><span style="color: #000000">SystemStreamType</span><span style="color: #000000"> </span><span style="color: #000000">GetStreamType</span><span style="color: #000000">(</span><span style="color: #000000">DataReader</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pReader</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>DataReader *pReader</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to the initialized object of the DataReader class.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<a href="#_systemstreamtype"><code>SystemStreamType</code></a>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Type of the stream.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_init" class="float">Splitter::Init</h3>
<div class="paragraph"><p>The method performs initialization of the splitter according to the input parameter from an object of the UMC::SplitterParams class or a derived class.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">SplitterParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pInit</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>SplitterParams *pInit</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- An object of the <code>SplitterParams</code> class that contains specific information required to initialize the splitter.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_close" class="float">Splitter::Close</h3>
<div class="paragraph"><p>The method frees all resources allocated in Init after all internal threads have been closed.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_splitter_getnextdata" class="float">Splitter::GetNextData</h3>
<div class="paragraph"><p>The method provides access to the next portion of data for a specific track. The memory, to which data refers after calling this method,
is allocated by the <code>Splitter</code> and is valid until this method is called again.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetNextData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iTrack</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Output parameter. Pointer to an output data object.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iTrack</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Input parameter. The number of certain ES. All information about tracks and their numbers can be obtained via the <code>GetInfo()</code> method.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_checknextdata" class="float">Splitter::CheckNextData</h3>
<div class="paragraph"><p>The method provides access to the next portion of data for a specific track but unlike <code>GetNextData()</code> does not forward the <code>DataReader</code> pointer.
So the next call of <code>CheckNextData()</code> returns the same data. This method is expected to be implemented in derived classes.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">CheckNextData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iTrack</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData *pData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Output parameter. Pointer to an output data object.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u iTrack</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Input parameter. The number of certain ES. All information about tracks and their numbers can be obtained via the <code>GetInfo()</code> method.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_settimeposition" class="float">Splitter::SetTimePosition</h3>
<div class="paragraph"><p>The method sets new current position, if applicable. The parameter <code>fPos</code> takes value from 0.0 to the entire duration of the source stream.
If position setting operation is not applicable, the method returns the <code>UMC_ERR_FAILED</code> value.
This method seeks position in the input stream that is the closest to specified time position.
It is assumed to work after call of the <code>Stop()</code> method to perform safe reposition. Then call the <code>Run()</code> method to start splitting the stream from the new place.
This method is expected to be implemented in derived classes.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">In case of several tracks in a stream, SetTimePosition works with the first enabled video track and other enabled tracks are aligned to it.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetTimePosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> fPos</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64f fPos</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. Time in seconds from the beginning of the input stream.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_gettimeposition" class="float">Splitter::GetTimePosition</h3>
<div class="paragraph"><p>This method returns current time position of the input stream that is being split. This method is expected to be implemented in derived classes.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">In case of several tracks in a stream, <code>GetTimePosition()</code> returns time position of the first enabled video track.
If no video tracks are available the method returns time position of the first enabled audio track.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetTimePosition</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">fPos</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64f &amp;fPos</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Address of a variable where current time position will be returned.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_getinfo" class="float">Splitter::GetInfo</h3>
<div class="paragraph"><p>The method provides access to an internal structure of <code>Splitter</code> where all information about the stream is kept. This method is expected to be implemented in derived classes.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">After the <code>Splitter</code> object is released, the <code>SplitterInfo</code> object is not available.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetInfo</span><span style="color: #000000">(</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> </span><span style="color: #000000">**</span><span style="color: #000000">ppInfo</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>SplitterInfo **ppInfo</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Address of a variable of type <code>SplitterInfo</code>* where the pointer to the internal structure will be returned.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_setrate" class="float">Splitter::SetRate</h3>
<div class="paragraph"><p>The method sets a new value of playback rate. This method flushes all output buffers.</p></div>
<div class="paragraph"><p><code>SetRate()</code> can affect the order of samples that the splitter returns. The behavior depends on specific implementation but common rules are as follows:</p></div>
<div class="ulist"><ul>
<li>
<p>
0 &lt; rate ? 1 means normal playback.
</p>
</li>
<li>
<p>
rate &gt; 1 means fast-forward playback,the  splitter may skip some data (audio samples, video samples that are not critical).
</p>
</li>
<li>
<p>
rate &lt; 0 means backward playback, the splitter returns samples in reverse order and may skip some data (audio samples, video samples that are not critical).
</p>
</li>
</ul></div>
<div class="paragraph"><p>The method does not stop the internal thread. To ensure correct operation, the application should call <code>Stop()</code> before and <code>Run()</code> after changing the playback rate.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetRate</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> fRate</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64f fRate</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Value of playback rate.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_settrackstate" class="float">Splitter::SetTrackState</h3>
<div class="paragraph"><p>The method changes the state of a track.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetTrackState</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iTrack</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">TrackState</span><span style="color: #000000"> state</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iTrack</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-                     Input parameter. The number of certain ES. All information about tracks and their numbers can be obtained via GetInfo method.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_trackstate">TrackState</a> state</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. See enumerator description.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_run" class="float">Splitter::Run</h3>
<div class="paragraph"><p>The method runs the internal processing threads. This method is expected to be implemented in derived classes.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Run</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<h3 id="_splitter_stop" class="float">Splitter::Stop</h3>
<div class="paragraph"><p>The method stops processing data incoming from the source reader. The process of splitting stops but all data stored in output buffers is available.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Stop</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
</div>
<div class="sect1">
<h2 id="_muxer">Muxer</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>Muxer</code> is an abstract base class that provides virtual methods for high level interface of an abstract media stream multiplexer.
<code>Muxer</code> receives data from audio, video and other elementary streams (ES) and multiplex them into a container according
to information received during initialization. Finally a container is dumped using the <a href="#_datawriter"><code>DataWriter</code></a> interface.</p></div>
<div class="paragraph"><p>Data sent to <code>Muxer</code> must have time stamps. Video data is usually sent by video frames so that reposition could be performed during splitting.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_3_2.png" alt="images/umc/umc_3_2.png" />
</div>
<div class="title">Figure 6. Muxer Operation Pipeline</div>
</div>
<div class="listingblock">
<div class="title">Muxer definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">Muxer</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">Muxer</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">Muxer</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">Muxer</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MuxerParams</span><span style="color: #000000">*</span><span style="color: #000000"> lpInit</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">LockBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">UnlockBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutEndOfStream</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutVideoData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iVideoIndex </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutAudioData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iAudioIndex </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Flush</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetTrackIndex</span><span style="color: #000000">(</span><span style="color: #000000">MuxerTrackType</span><span style="color: #000000"> type</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> index </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">CopyMuxerParams</span><span style="color: #000000">(</span><span style="color: #000000">MuxerParams</span><span style="color: #000000">*</span><span style="color: #000000"> lpInit</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetOutputTime</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">,</span><span style="color: #000000"> Ipp64f</span><span style="color: #000000">&amp;</span><span style="color: #000000"> dTime</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetStreamToWrite</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000">&amp;</span><span style="color: #000000"> rStreamNumber</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> bFlushMode</span><span style="color: #000000">);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    MuxerParams</span><span style="color: #000000">*</span><span style="color: #000000">  m_pParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">        m_uiTotalNumStreams</span><span style="color: #000000">;</span>
<span style="color: #000000">    TrackParams</span><span style="color: #000000">*</span><span style="color: #000000">  m_pTrackParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    MediaBuffer</span><span style="color: #000000">**</span><span style="color: #000000"> m_ppBuffers</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 34. Muxer Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                     </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the muxer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Destructs the muxer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_lockbuffer">LockBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns pointer to buffer for data to be muxed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_unlockbuffer">UnlockBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Sends user data for multiplexing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_putdata">PutData</a></code></p></td>
<td align="left" valign="top"><p class="table">Sends user data for a special track to be muxed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_putendofstream">PutEndOfStream</a></code></p></td>
<td align="left" valign="top"><p class="table">Indicates that no more data is expected for the current track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_putvideodata">PutVideoData</a></code></p></td>
<td align="left" valign="top"><p class="table">Sends a portion of user data to video track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_putaudiodata">PutAudioData</a></code></p></td>
<td align="left" valign="top"><p class="table">Sends a portion of user data to audio track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_flush">Flush</a></code></p></td>
<td align="left" valign="top"><p class="table">Initiates muxing of all data kept in internal buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_muxer_gettrackindex">GetTrackIndex</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns index of a track of a specific type.</p></td>
</tr>
</tbody>
</table>
</div>
<h2 id="_muxerparams" class="float">MuxerParams</h2>
<div class="paragraph"><p>This class contains the initialization parameters for <a href="#_muxer"><code>Muxer</code></a> class.</p></div>
<div class="listingblock">
<div class="title">MuxerParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MuxerParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">MuxerParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">MuxerParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">MuxerParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000">=(</span><span style="color: #000000">MuxerParams</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">p</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">SystemStreamType</span><span style="color: #000000"> m_SystemType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">           m_lFlags</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">           m_nNumberOfTracks</span><span style="color: #000000">;</span>
<span style="color: #000000">    TrackParams</span><span style="color: #000000">*</span><span style="color: #000000">     m_pTrackParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    DataWriter</span><span style="color: #000000">*</span><span style="color: #000000">      m_lpDataWriter</span><span style="color: #000000">;</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> m_bAllocated</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 35. MuxerParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                       </th>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_systemstreamtype">SystemStreamType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_SystemType</code></p></td>
<td align="left" valign="top"><p class="table">Type of media stream</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_lFlags</code></p></td>
<td align="left" valign="top"><p class="table">Flags to set up muxer configuration</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_nNumberOfTracks</code></p></td>
<td align="left" valign="top"><p class="table">Number of tracks</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_trackparams">TrackParams</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>pTrackParams</code></p></td>
<td align="left" valign="top"><p class="table">Structure with parameters for every stream being muxed</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_datawriter">DataWriter</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_lpDataWriter</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to initialized data writer</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_trackparams" class="float">TrackParams</h3>
<div class="paragraph"><p>The class contains parameters for a track.</p></div>
<div class="listingblock">
<div class="title">TrackParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">TrackParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">TrackParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">union</span>
<span style="color: #000000">    </span><span style="color: #000000">{</span>
<span style="color: #000000">        AudioStreamInfo</span><span style="color: #000000">*</span><span style="color: #000000"> audio</span><span style="color: #000000">;</span>
<span style="color: #000000">        VideoStreamInfo</span><span style="color: #000000">*</span><span style="color: #000000"> video</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000">            undef</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> info</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">MuxerTrackType</span><span style="color: #000000">      type</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MediaBufferParams</span><span style="color: #000000">   bufferParams</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 36. TrackParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                       </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_muxertracktype">MuxerTrackType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>type</code></p></td>
<td align="left" valign="top"><p class="table">Enumeration to identify the type of track (audio, video, etc.)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>union</code></p></td>
<td align="left" valign="top"><p class="table"><code>info</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to either <a href="#_audiostreaminfo"><code>AudioStreamInfo</code></a>, <a href="#_videostreaminfo"><code>VideoStreamInfo</code></a> or <code>void</code> type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mediabufferparams">MediaBufferParams</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>bufferParams</code></p></td>
<td align="left" valign="top"><p class="table">Parameters of the media buffer for every stream being muxed.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_related_data_2" class="float">Related data</h3>
<div class="tableblock" id="_muxertracktype">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 37. MuxerTrackType Values</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Value              </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UNDEF_TRACK</code></p></td>
<td align="left" valign="top"><p class="table">Unknown track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AUDIO_TRACK</code></p></td>
<td align="left" valign="top"><p class="table">Audio track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VIDEO_TRACK</code></p></td>
<td align="left" valign="top"><p class="table">Video track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VBI_TRACK</code></p></td>
<td align="left" valign="top"><p class="table">Teletext track.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_muxer_init" class="float">Muxer::Init</h3>
<div class="paragraph"><p>The method performs initialization of the muxer according to the input parameter from an object of <code>MuxerParams</code> class or a derived class.
<code>Init()</code> is a pure virtual method and should be implemented in the derived classes.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MuxerParams</span><span style="color: #000000">*</span><span style="color: #000000"> lpInit</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MuxerParams* lpInit</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- An object of <code>MuxerParams</code> class that contains specific information required to initialize the muxer.
</p>
</td>
</tr>
</table></div>
<h3 id="_muxer_close" class="float">Muxer::Close</h3>
<div class="paragraph"><p>The method deletes all internal buffers and structures.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<h3 id="_muxer_lockbuffer" class="float">Muxer::LockBuffer</h3>
<div class="paragraph"><p>The method returns the pointer to the internal buffer where the user should copy the data to be muxed.
The pointer to the buffer and available free data sizes are passed by the <code>MediaData</code> object.
This memory block is locked and not used until the user calls the <code>UnlockBuffer()</code> method</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">LockBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData* lpData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. Pointer to an empty <code>MediaData</code> object where the pointer and the data size will be put.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s iTrack</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Input parameter. Number of the track the data will be attached to.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-             <code>MediaData</code> object is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Track number is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Internal buffers are not initialized.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_ENOUGH_BUFFER</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Internal buffer is not sufficient for the given track.
</p>
</td>
</tr>
</table></div>
<h3 id="_muxer_unlockbuffer" class="float">Muxer::UnlockBuffer</h3>
<div class="paragraph"><p>The method sends a portion of user data for the track <code>iTrack</code> to multiplexer.
Before calling this method, the user should copy data into the internal multiplexer buffer.
The pointer to the buffer and its available free space can be received by calling the <code>LockBuffer()</code> method.</p></div>
<div class="paragraph"><p>The user must also set the size in <code>lpData</code> to the size of really copied data and set start and end time stamps.
The muxer merges portions of data (for example, video and audio frames) depending on their time stamps to make frames with close time stamps be close in the result file.
If time stamps are not provided in <code>lpData</code> the muxer attempts to calculate them itself (for example, from the frame rate).
If the muxer fails in the calculation, an error status is returned.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">UnlockBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData *lpData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. Pointer to the <code>MediaData</code> object with user data for the <code>iTrack</code> track.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s iTrack</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Input parameter. Number of the track the data will be attached to.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-             <code>MediaData</code> object is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Track number is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Internal buffers are not initialized.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_FAILED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-               Size of user data is more than available free space in the buffer.
</p>
</td>
</tr>
</table></div>
<h3 id="_muxer_putdata" class="float">Muxer::PutData</h3>
<div class="paragraph"><p>The method sends user data for a special track to be muxed. The method locks a buffer, copies the user data from lpData to the corresponding internal buffer, and unlocks the buffer.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData *lpData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. Pointer to the <code>MediaData</code> object with user data for the <code>iTrack</code> track.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s iTrack</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Input parameter. Number of the track the data will be attached to.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-             <code>MediaData</code> object is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Track number is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Internal buffers are not initialized.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_ENOUGH_BUFFER</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Internal buffer is not sufficient for the given track.
</p>
</td>
</tr>
</table></div>
<h3 id="_muxer_putendofstream" class="float">Muxer::PutEndOfStream</h3>
<div class="paragraph"><p>The method informs the muxer that all data for the iTrack track is sent.
To avoid uneven distribution of data by buffers, the user should constantly analyze return status from the <code>LockBuffer()</code>/<code>UnlockBuffer()</code>
methods and call <code>PutEndOfStream()</code> as soon as no more data is expected.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutEndOfStream</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32s iTrack</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. Number of the track with fully muxed data.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Track number is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Internal buffers are not initialized.
</p>
</td>
</tr>
</table></div>
<h3 id="_muxer_putvideodata" class="float">Muxer::PutVideoData</h3>
<div class="paragraph"><p>The method sends user data for the index video track.
This interface calls <code>GetTrackIndex()</code> first to get the track number for the video track of number index and then calls the <code>PutData()</code> method.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutVideoData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> index</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData *lpData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. Pointer to the <code>MediaData</code> object with user video data.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s index</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Input parameter. Number of the video track.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-             <code>MediaData</code> object is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Track number is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Internal buffers are not initialized.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_ENOUGH_BUFFER</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Internal buffer is not sufficient for the given track.
</p>
</td>
</tr>
</table></div>
<h3 id="_muxer_putaudiodata" class="float">Muxer::PutAudioData</h3>
<div class="paragraph"><p>The method sends user data for the index audio track.
This interface calls <code>GetTrackIndex()</code> first to get the track number for the audio track of number index and then calls the <code>PutData()</code> method.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PutAudioData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">lpData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> index</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData *lpData</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. Pointer to the <code>MediaData</code> object with user audio data.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s index</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Input parameter. Number of the audio track.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-             <code>MediaData</code> object is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Track number is invalid.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Internal buffers are not initialized.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_ENOUGH_BUFFER</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Internal buffer is not sufficient for the given track.
</p>
</td>
</tr>
</table></div>
<h3 id="_muxer_flush" class="float">Muxer::Flush</h3>
<div class="paragraph"><p>The method initiates multiplexing by the muxer of all data from the internal buffers even in case of a big gap in time stamps.
Calling <code>PutEndOfStream()</code> for every track has the same effect.
This method is pure virtual and should be implemented in derived classes.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Flush</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_muxer_gettrackindex" class="float">Muxer::GetTrackIndex</h3>
<div class="paragraph"><p>The method searches for the track number num of type type and returns its index.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetTrackIndex</span><span style="color: #000000">(</span><span style="color: #000000">MuxerTrackType</span><span style="color: #000000"> type</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> num</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MuxerTrackType type</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Input parameter. Track type.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s num</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-            Input parameter. Count number.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32s</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Track index Successful operation. -1 No track of the type type with the num count number was found.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
</div>
<div class="sect1">
<h2 id="_basecodec">BaseCodec</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>The <code>BaseCodec</code> class is a base UMC class for all video, audio, and speech codecs and filters irrespective of their types. The class defines universal codec interface.</p></div>
<div class="paragraph"><p>Before starting data processing, initialize the codec. Define codec settings through <code>Init()</code> and <code>SetParams()</code> methods.
After initialization, call <code>GetFrame()</code> to start processing.
You are supposed to initialize buffers for input and output data passing between objects in the data flow chain.</p></div>
<div class="listingblock">
<div class="title">BaseCodec definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">BaseCodec</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodec</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">BaseCodec</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">BaseCodec</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pParams</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDataIn</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDataOut</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetInfo</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000">*</span><span style="color: #000000"> info</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetParams</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pParams</span><span style="color: #000000">);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    MemoryAllocator</span><span style="color: #000000">*</span><span style="color: #000000"> m_pMemoryAllocator</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">             m_bOwnAllocator</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 38. BaseCodec Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                 </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_basecodec_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes codec.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_basecodec_getframe">GetFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Processes next portion of data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_basecodec_getinfo">GetInfo</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets current stream info and codec setting.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_basecodec_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Deinitializes codec.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_basecodec_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets codec into initial state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_basecodec_setparams">SetParams</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets new codec parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_basecodecparams" class="float">BaseCodecParams</h3>
<div class="paragraph"><p>Class <code>BaseCodecParams</code> is a base class for a set of derived classes that describe settings and information about streams for certain implementation of the codec.</p></div>
<div class="listingblock">
<div class="title">BaseCodecParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">BaseCodecParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ReadParams</span><span style="color: #000000">(</span><span style="color: #000000">ParserCfg</span><span style="color: #000000">*);</span>

<span style="color: #000000">    </span><span style="color: #000000">MediaData</span><span style="color: #000000">       </span><span style="color: #000000">*</span><span style="color: #000000">m_pData</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MemoryAllocator</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">m_lpMemoryAllocator</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iSuggestedInputSize</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iSuggestedOutputSize</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iFlags</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iThreads</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">           m_iFramesCounter</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 39. BaseCodecParams Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_basecodecparams_readparams">ReadParams</a></code></p></td>
<td align="left" valign="top"><p class="table">Reads params from special <a href="#_parsercfg">ParserCfg</a> class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 40. BaseCodecParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                   </th>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mediadata">MediaData</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pData</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the <code><a href="#_mediadata">MediaData</a></code> object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator">MemoryAllocator</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_lpMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table">External memory allocation interface. UMC codecs use this interface for allocation
                                                                of big blocks of dynamic memory for internal usage. If not provided, must be set to NULL.
                                                                See <code><a href="#_memoryallocator">MemoryAllocator</a></code> Class description for more details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iSuggestedInputSize</code></p></td>
<td align="left" valign="top"><p class="table">Suggested maximum frame size of input stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iSuggestedOutputSize</code></p></td>
<td align="left" valign="top"><p class="table">Suggested maximum frame size of output stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iFlags</code></p></td>
<td align="left" valign="top"><p class="table">Stores various flags for codec.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iThreads</code></p></td>
<td align="left" valign="top"><p class="table">Recommended number of threads to be run. 0 means that the number
                                                                of threads to run should be equal to the number of logical processor units.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iFramesCounter</code></p></td>
<td align="left" valign="top"><p class="table">Number of processed frames.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The m_SuggestedInputSize and m_SuggestedOutputSize parameters define the desired size of the input or output data for the GetFrame method.
After initialization of the codec, call GetInfo to obtain these parameters.
The desired size of the input data is a size of input data convenient to perform processing, for example,
the size of uncompressed frame for encoders or maximum size of encoded frame for decoders.
Output size for encoders is the size of the memory buffer sufficient to contain any encoded frame. For decoders, it is the size of decoded data.</p></div>
<h3 id="_basecodecparams_readparams" class="float">BaseCodecParams::ReadParams</h3>
<div class="paragraph"><p>The method reads params from special <a href="#_parsercfg">ParserCfg</a> class.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ReadParams</span><span style="color: #000000">(</span><span style="color: #000000">ParserCfg</span><span style="color: #000000">*);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>ParserCfg*</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to ParserCfg object, which has already processed input data.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Implementation does not support parameters reading.
</p>
</td>
</tr>
</table></div>
<h3 id="_basecodec_init" class="float">BaseCodec::Init</h3>
<div class="paragraph"><p>The method performs initialization of the codec according to the input parameter from <code>BaseCodecParams</code> or a class derived from <code>BaseCodecParams</code>.
Most of the codecs cannot be initialized with a pure <code>BaseCodecParams</code> object and require information contained in the corresponding derived classes.
Derived codecs should call <code>Init()</code> if they use the <code>MemoryAllocator</code> interface.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pParams</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>BaseCodecParams *pParams</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Pointer to an object of the <code>BaseCodecParams</code> class with common parameters or derived class,
                                    which contains more specific information to initialize the codec.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- <code>NULL</code> pointer is passed to the function.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INIT</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Initialization failed.
</p>
</td>
</tr>
</table></div>
<h3 id="_basecodec_getframe" class="float">BaseCodec::GetFrame</h3>
<div class="paragraph"><p>The method processes data. The user allocates input and output buffers. If <code>GetFrame()</code> does not use all data from the input buffer,
the method updates data pointer, value of the actual data in the buffer and start time.</p></div>
<div class="paragraph"><p>If the codec uses internal frame buffering it can return <code>UMC_ERR_NOT_ENOUGH_DATA</code> at the beginning of the processing.
This error code means that the input data is buffered but the output data is not ready to be delivered.
The application has to continue to call <code>GetFrame()</code> with the next input data.</p></div>
<div class="paragraph"><p>To retrieve buffered data at the end of the processing, the application should call <code>GetFrame()</code> with <code>NULL</code> input pointer while output is not empty.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDataIn</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDataOut</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData *pDataIn</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Input parameter. Pointer to input data.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MediaData *pDataOut</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Output parameter. Pointer to output data.
</p>
</td>
</tr>
</table></div>
<h3 id="_basecodec_getinfo" class="float">BaseCodec::GetInfo</h3>
<div class="paragraph"><p>The method returns information on data and codec settings received during processing.
This information is available after successful <code>Init()</code> call. The method checks for the class of the object pointed by info and fills it according to its type.
For example, to obtain suggested input size or number of processed frames, providing <code>BaseCodecParams</code> class is sufficient.
To obtain the size of a video frame in any video decoder, at least <code>VideoDecoderParams</code> class should be provided for output.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetInfo</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000">*</span><span style="color: #000000"> info</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>BaseCodecParams* info</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Output parameter. Pointer to an object of <code>BaseCodecParams</code> class or derived class to be filled with codec parameters and stream information.
</p>
</td>
</tr>
</table></div>
<h3 id="_basecodec_close" class="float">BaseCodec::Close</h3>
<div class="paragraph"><p>The method frees all internal codec resources allocated in Init or later. The method is always called from the destructor.
<code>Close()</code> releases resources allocated internally for external memory allocator, if any.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<h3 id="_basecodec_reset" class="float">BaseCodec::Reset</h3>
<div class="paragraph"><p>The method sets codec to initial state. You can apply <code>Reset()</code> in the case of random access or to process the same kind of data again without complete reinitialization of the codec.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_basecodec_setparams" class="float">BaseCodec::SetParams</h3>
<div class="paragraph"><p>The method is applied to change codec settings after initialization, even if processing already started.
This method can be efficiently used when you need to change settings during data processing (for example, in adaptive encoding
you should change bitrate during processing to meet network capacity).</p></div>
<div class="paragraph"><p>Note that not every parameter can be changed with <code>SetParams()</code>. Relevant information is available in the documentation on a particular codec.</p></div>
<div class="paragraph"><p>Call <code>GetInfo()</code> first to obtain current codec parameters. Use+ SetParams()+ to modify parameters and pass them back to codecs.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetParams</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pParams</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>BaseCodecParams *pParams</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. Codec parameters class.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-         <code>NULL</code> pointer is passed to the function.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   The method is not implemented.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
<div class="sect2">
<h3 id="_audiodecoder">AudioDecoder</h3>
<hr />
<div class="paragraph"><p><code>AudioDecoder</code> is a class derived from <code>BaseCodec</code> Class and inherits the basic features of that class.
The only added functionality is obtaining time duration of data decoding process.</p></div>
<div class="listingblock">
<div class="title">AudioDecoder definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">AudioDecoder</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodec</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">AudioDecoder</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodec</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioDecoder</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetDuration</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDuration</span><span style="color: #000000">);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> m_frame_num</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 41. AudioDecoder Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                     </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiodecoder_getduration">GetDuration</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains time duration of data decoding process.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_audiodecoderparams" class="float">AudioDecoderParams</h4>
<div class="paragraph"><p>Class <code>AudioDecoderParams</code> is a class for a set of derived classes that describe settings and information about streams for certain implementations of audio codecs.</p></div>
<div class="listingblock">
<div class="title">AudioDecoderParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">AudioDecoderParams</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodecParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">AudioDecoderParams</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodecParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioDecoderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioStreamInfo</span><span style="color: #000000"> m_info</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 42. AudioDecoderParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                   </th>
<th align="left" valign="top">Name       </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_audiostreaminfo">AudioStreamInfo</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_info</code></p></td>
<td align="left" valign="top"><p class="table">Audio stream information.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_audiodecoder_getduration" class="float">AudioDecoder::GetDuration</h4>
<div class="paragraph"><p>The method gets duration of data decoding since the last initialization.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetDuration</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDuration</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32f *pDuration</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Duration of decoding.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Object cannot be created or class is not implemented.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
<div class="sect2">
<h3 id="_audioencoder">AudioEncoder</h3>
<hr />
<div class="paragraph"><p><code>AudioEncoder</code> is a class derived from <code>BaseCodec</code> Class and inherits the basic features of that class.
The only added functionality is obtaining time duration of data encoding process.</p></div>
<div class="listingblock">
<div class="title">AudioEncoder definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">AudioEncoder</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodec</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">AudioEncoder</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodec</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioEncoder</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetDuration</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDuration</span><span style="color: #000000">);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> m_frame_num</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 43. AudioEncoder Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                     </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audioencoder_getduration">GetDuration</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains time duration of data encoding process.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_audioencoderparams" class="float">AudioEncoderParams</h4>
<div class="paragraph"><p>Class <code>AudioEncoderParams</code> is a class for a set of derived classes that describe settings and information about streams for certain implementations of audio codecs.</p></div>
<div class="listingblock">
<div class="title">AudioEncoderParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">AudioEncoderParams</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodecParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">AudioEncoderParams</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodecParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioEncoderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioStreamInfo</span><span style="color: #000000"> m_info</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 44. AudioEncoderParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                   </th>
<th align="left" valign="top">Name       </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_audiostreaminfo">AudioStreamInfo</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_info</code></p></td>
<td align="left" valign="top"><p class="table">Audio stream information.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_audioencoder_getduration" class="float">AudioEncoder::GetDuration</h4>
<div class="paragraph"><p>The method gets duration of data encoding since the last initialization.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetDuration</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDuration</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32f *pDuration</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Duration of encoding.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Object cannot be created or class is not implemented.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
<div class="sect2">
<h3 id="_videodecoder">VideoDecoder</h3>
<hr />
<div class="paragraph"><p><code>VideoDecoder</code> is a class derived from <code>BaseCodec</code> class for building video data decoders and inherits the basic features of that class.
Added functionality is frame skipping and accessing the last decoded frame for preview.</p></div>
<div class="listingblock">
<div class="title">VideoDecoder definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodec</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodec</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ResetSkipCount</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SkipVideoFrame</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetNumOfSkippedFrames</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PreviewLastFrame</span><span style="color: #000000">(</span><span style="color: #000000">VideoData</span><span style="color: #000000">*</span><span style="color: #000000"> out</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetUserData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">VideoData</span><span style="color: #000000">        m_lastDecodedFrame</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">BaseCodec</span><span style="color: #000000">       </span><span style="color: #000000">*</span><span style="color: #000000">m_pPostProcessor</span><span style="color: #000000">;</span>

<span style="color: #0000ff">private</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #0000ff">const</span><span style="color: #000000"> VideoDecoder</span><span style="color: #000000">&amp;</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000">=(</span><span style="color: #0000ff">const</span><span style="color: #000000"> VideoDecoder</span><span style="color: #000000">&amp;);</span>
<span style="color: #000000">    </span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">(</span><span style="color: #0000ff">const</span><span style="color: #000000"> VideoDecoder</span><span style="color: #000000">&amp;);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 45. VideoDecoder Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                     </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodecoder_resetskipcount">ResetSkipCount</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets skip frame counter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodecoder_skipvideoframe">SkipVideoFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Increments skip video frame counter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodecoder_getnumofskippedframes">GetNumOfSkippedFrames</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets skip frame counter statistic.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodecoder_previewlastframe">PreviewLastFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Previews the last video frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videodecoder_getuserdata">GetUserData</a></code></p></td>
<td align="left" valign="top"><p class="table">Provides the user data from the source stream to the caller.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_videodecoderparams" class="float">VideoDecoderParams</h4>
<div class="paragraph"><p><code>VideoDecoderParams</code> is a class for a set of derived classes that describe settings and information about streams for certain implementations of video codecs.</p></div>
<div class="listingblock">
<div class="title">VideoDecoderParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodecParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodecParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">BaseCodec</span><span style="color: #000000">      </span><span style="color: #000000">*</span><span style="color: #000000">m_pPostProcessor</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000"> m_info</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">          m_iTrickModes</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000">          m_fPlaybackRate</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 46. VideoDecoderParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                   </th>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_basecodec">BaseCodec</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pPostProcessor</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to post processing. If <code>NULL</code>, default post processing is used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_videostreaminfo">VideoStreamInfo</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_info</code></p></td>
<td align="left" valign="top"><p class="table">Audio stream information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iTrickModes</code></p></td>
<td align="left" valign="top"><p class="table">Trick modes flag.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_fPlaybackRate</code></p></td>
<td align="left" valign="top"><p class="table">Playback rate.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_related_data_3" class="float">Related data</h3>
<div class="tableblock" id="_decoder_flags">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 47. Decoder Flags</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>FLAG_VDEC_CHECK_ONLY</code></p></td>
<td align="left" valign="top"><p class="table"><code>Init()</code> must only check whether stream is supported (looking to specified video header) and not allocate any resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FLAG_VDEC_REORDER</code></p></td>
<td align="left" valign="top"><p class="table">Receiving this flag decoder must output decompressed data in proper display order, otherwise it will output decompressed data
                        in decoding order, application is responsible to reorder frames before displaying.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FLAG_VDEC_4BYTE_ACCESS</code></p></td>
<td align="left" valign="top"><p class="table">Input data interpretation flag for little-endian/big-endian architectures.
                        When set, this value means the coded data should be accessed by 4-bytes reading operations.
                        For a little-endian platform, it means that every four bytes are swapped: [0] with [3], [1] with [2] at 4-byte aligned position.
                        For big-endian systems, swapping is not required and the output data is passed in the original byte order.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_videodecoder_resetskipcount" class="float">VideoDecoder::ResetSkipCount</h4>
<div class="paragraph"><p>The method resets the skip frame counter.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ResetSkipCount</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h4 id="_videodecoder_skipvideoframe" class="float">VideoDecoder::SkipVideoFrame</h4>
<div class="paragraph"><p>The method increments the skip frame counter.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SkipVideoFrame</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32s</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Input parameter. Number of frames to be skipped.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodecoder_getnumofskippedframes" class="float">VideoDecoder::GetNumOfSkippedFrames</h4>
<div class="paragraph"><p>The method gets skip frame counter statistic.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">GetNumOfSkippedFrames</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Number of frames skipped.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodecoder_previewlastframe" class="float">VideoDecoder::PreviewLastFrame</h4>
<div class="paragraph"><p>The method previews the last video frame.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PreviewLastFrame</span><span style="color: #000000">(</span><span style="color: #000000">VideoData</span><span style="color: #000000">*</span><span style="color: #000000"> out</span><span style="color: #000000">)</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>VideoData* out</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Output parameter. Pointer to an object of the UMC::VideoData class, which contains output video frame data.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_INITIALIZED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Object is not yet initialized.
</p>
</td>
</tr>
</table></div>
<h4 id="_videodecoder_getuserdata" class="float">VideoDecoder::GetUserData</h4>
<div class="paragraph"><p>The method provides user data "as is". It does not parse or format data but provides a user data byte stream as it is stored in the bit stream.
Classes derived from <code>VideoDecoder</code> are expected to overweight this method.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetUserData</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData*</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Output parameter. An instance of the <code>MediaData</code> class to hold user data associated with a stream.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The method is not implemented.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
<div class="sect2">
<h3 id="_videoencoder">VideoEncoder</h3>
<hr />
<div class="paragraph"><p><code>VideoEncoder</code> is a class derived from <code>BaseCodec</code> Class for building video data encoders and inherits the basic features of that class.
Video encoders use <code>VideoEncoderParams</code> class derived from <code>BaseCodecParams</code> Class.</p></div>
<div class="listingblock">
<div class="title">VideoEncoder definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoEncoder</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodec</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoEncoder</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodec</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoEncoder</span><span style="color: #000000">();</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<h4 id="_videoencoderparams" class="float">VideoEncoderParams</h4>
<div class="paragraph"><p><code>VideoEncoderParams</code> is a class for a set of derived classes that describe settings and information about streams for certain implementations of video codecs.</p></div>
<div class="listingblock">
<div class="title">VideoEncoderParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodecParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodecParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000"> m_info</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">          m_iQuality</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 48. VideoEncoderParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                   </th>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_videostreaminfo">VideoStreamInfo</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_info</code></p></td>
<td align="left" valign="top"><p class="table">Compressed video stream information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iQuality</code></p></td>
<td align="left" valign="top"><p class="table">Quantization precision, in percents.</p></td>
</tr>
</tbody>
</table>
</div>
<div style="page-break-after:always"></div>
</div>
<div class="sect2">
<h3 id="_videoprocessing">VideoProcessing</h3>
<hr />
<div class="paragraph"><p>The <code>VideoProcessing</code> class is a class derived from <code>BaseCodec</code> Class for converting video frames into a different format, resizing,
color conversion, deinterlacing, and performing other operations on video frames.</p></div>
<div class="paragraph"><p>The <code>VideoProcessing</code> class is used in UMC video decoders to transmit decoded frames to destination buffers.
The class can be passed to decoder initialization by pointer in <code>VideoDecoderParams</code> Class.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_3_3.png" alt="images/umc/umc_3_3.png" />
</div>
<div class="title">Figure 7. VideoProcessing Functional Example</div>
</div>
<div class="listingblock">
<div class="title">VideoProcessing definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoProcessing</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodec</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoProcessing</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodec</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoProcessing</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">VideoProcessing</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodecParams </span><span style="color: #000000">*);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">out</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetInfo</span><span style="color: #000000">(</span><span style="color: #000000">BaseCodecParams </span><span style="color: #000000">*);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">AddFilter</span><span style="color: #000000">(</span><span style="color: #000000">VideoFilter</span><span style="color: #000000"> iFilter</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">filterParams</span><span style="color: #000000">);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">VideoProcessingParams</span><span style="color: #000000"> m_params</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">List&lt;BaseCodec*&gt;</span><span style="color: #000000">      m_filtersChain</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">                m_iNumFilters</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 49. VideoProcessing Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                     </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videoprocessing_addfilter">AddFilter</a></code></p></td>
<td align="left" valign="top"><p class="table">Adds filter into the video processing pipeline.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videoprocessing_getframe">GetFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Processes the video frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videoprocessing_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Destroys a <code>VideoProcessing</code> object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Dummy implementation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Dummy implementation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Dummy implementation.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_videoprocessingparams" class="float">VideoProcessingParams</h4>
<div class="paragraph"><p>This class is derived from <code>BaseCodecParams</code> Class and contains video processing parameters.</p></div>
<div class="listingblock">
<div class="title">VideoProcessingParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoProcessingParams</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> BaseCodecParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoProcessingParams</span><span style="color: #000000">,</span><span style="color: #000000"> BaseCodecParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoProcessingParams</span><span style="color: #000000">();</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<h4 id="_videoprocessing_addfilter" class="float">VideoProcessing::AddFilter</h4>
<div class="paragraph"><p>The method adds a new filter into the video processing pipeline. See <a href="#_videofilter">VideoFilter</a> for avaliable filters.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">Most filters have limitations on image formats and structures which they can process. User should consider these limits to add filters in effective order.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">AddFilter</span><span style="color: #000000">(</span><span style="color: #000000">VideoFilter</span><span style="color: #000000"> iFilter</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">BaseCodecParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">filterParams</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>VideoFilter iFilter</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-           Type of video filter to add.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>BaseCodecParams *filterParams</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to video filter parameters class, see filters implementations.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Selected filter is not implemented.
</p>
</td>
</tr>
</table></div>
<h4 id="_videoprocessing_getframe" class="float">VideoProcessing::GetFrame</h4>
<div class="paragraph"><p>The method performs video processing on the source image.
Both input and output images must be properly initialized. The output data must contain all necessary buffers needed to store the image in the destination format,
otherwise a memory corruption can occur. For more details see definition of <code>VideoData</code> Class.</p></div>
<div class="paragraph"><p>Before calling <code>GetFrame()</code> one should add filter with <code>AddFilter()</code> method. If no filters were specified simple data copy operation will occur.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">out</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData *in</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-     Pointer to the input data object. The pointer must refer to an instance of <code>VideoData</code> class object.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MediaData *out</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Pointer to the output data object. The pointer must refer to an instance of <code>VideoData</code> class object.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-         At least one of the pointers is NULL.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_ENOUGH_DATA</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Filter requires more frames.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_INVALID_PARAMS</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Destination data formats do not match. Usually means that some filters cannot convert data to destination format.
</p>
</td>
</tr>
</table></div>
<h4 id="_videoprocessing_close" class="float">VideoProcessing::Close</h4>
<div class="paragraph"><p>The method destroys filter chain.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<div style="page-break-after:always"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mediareceiver">MediaReceiver</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>The <code>MediaReceiver</code> class is a base UMC class that provides interface for data receivers like intermediate buffers and renderers.</p></div>
<div class="paragraph"><p>The next figure illustrates a typical UMC model of access to input buffer. In a simple decoding pipeline a <code>MediaReceiver</code> class object is
implemented as an audio or video renderer. Input data block depicted on the left is an object of <code>MediaData</code> Class and the <code>MediaReceiver</code> object on the right is a renderer.</p></div>
<div class="imageblock" id="_input_buffer_access">
<div class="content">
<img src="images/umc/umc_3_4.png" alt="images/umc/umc_3_4.png" />
</div>
<div class="title">Figure 8. Input Buffer Access</div>
</div>
<div class="paragraph"><p>In a more sophisticated transcoding process buffering is implemented through interface provided by <code>MediaBuffer</code> Class objects.</p></div>
<div class="listingblock">
<div class="title">MediaReceiver definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MediaReceiver</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiver</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">MediaReceiver</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">MediaReceiver</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*</span><span style="color: #000000"> init</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> in</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> in</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> StreamStatus </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Stop</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 50. MediaReceiver Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                                     </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediareceiver_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes <code>MediaReceiver</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediareceiver_lockinputbuffer">LockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Locks input buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediareceiver_unlockinputbuffer">UnLockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Unlocks input buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediareceiver_stop">Stop</a></code></p></td>
<td align="left" valign="top"><p class="table">Breaks waiting.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Dummy implementation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Dummy implementation.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mediareceiverparams" class="float">MediaReceiverParams</h3>
<div class="paragraph"><p>The <code>MediaReceiverParams</code> class is a base UMC class that provides interface for data receiver initialization.</p></div>
<div class="listingblock">
<div class="title">MediaReceiverParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000">  </span><span style="color: #000000">MediaReceiverParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> m_iFlags</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 51. MediaReceiverParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type           </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_iFlags</code></p></td>
<td align="left" valign="top"><p class="table">Various <code>MediaReceiver</code> flags.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mediareceiver_init" class="float">MediaReceiver::Init</h3>
<div class="paragraph"><p>The method performs initialization of media receiver according to the input parameter from an object of the class derived
from <code>MediaReceiverParams</code>. <code>MediaReceiverParams</code> is an empty common base class for various implementations of the <code>MediaReceiver</code> interface.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*</span><span style="color: #000000"> init</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaReceiverParams* init</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to an object of a class derived from <code>MediaReceiverParams</code>.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediareceiver_lockinputbuffer" class="float">MediaReceiver::LockInputBuffer</h3>
<div class="paragraph"><p>The method obtains a pointer to a free-to-write portion of data in the internal buffer.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> in</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData* in</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to an object of <code>MediaData</code> class or derived class, allocated by user. The object is filled with information on buffer, where user can place a new portion of data.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediareceiver_unlockinputbuffer" class="float">MediaReceiver::UnLockInputBuffer</h3>
<div class="paragraph"><p>The method unlocks the input buffer. After putting new data to the buffer obtained through call of <code>LockInputBuffer</code> method, user should provide
feedback to the <code>MediaBuffer</code> object about the amount of data written to the buffer and other specific information that can be stored in the object
derived from the <code>MediaBuffer</code> class. After call of the <code>UnLockInputBuffer</code> method new data is acceptable to read with <code>LockOutputBuffer</code>/<code>UnLockOutputBuffer</code> methods of inherited classes.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> in</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> StreamStatus </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData* in</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-                     Pointer to an object of <code>MediaData</code> class or derived class, allocated by user, which contains updated information.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a> StreamStatus</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Current stream status parameter that returns <code>UMC_OK</code> if the stream continues and <code>UMC_ERR_END_OF_STREAM</code> if no more data within the current stream is expected.
</p>
</td>
</tr>
</table></div>
<h3 id="_mediareceiver_stop" class="float">MediaReceiver::Stop</h3>
<div class="paragraph"><p>The method raises the stop flag to stop waiting for data in Lock functions.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Stop</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div style="page-break-after:always"></div>
<div class="sect2">
<h3 id="_videorender">VideoRender</h3>
<hr />
<div class="paragraph"><p>The <code>VideoRender</code> class is a UMC class covering video displaying functionality. <code>VideoRender</code> is used at the end of decompression pipeline to display the decompressed video stream.
<code>VideoRender is an abstract class that defines interface for UMC video renderers. +VideoRender</code> is a class derived from <code>MediaReceiver</code>.
So all return values for pure virtual methods, except <code>UMC_OK</code>, are successor-dependent.</p></div>
<div class="paragraph"><p>Common <code>VideoRender</code> interface simplifies cross-OS code porting by means of instantiated render class replacement.</p></div>
<div class="paragraph"><p><code>VideoRender</code> contains a list of surfaces. Surface is a memory buffer related to the video memory, which can be displayed on the screen.
Each surface has a time stamp mark and a frame type key (I | P | B) that can be used for frame reordering.</p></div>
<div class="paragraph"><p>User gets a pointer to the next free surface from the list, copies decompressed video data to the surface buffer,
associates a time stamp with the surface and marks the surface as ready to be displayed.
Ready surface takes place at the end of the list. User can examine the time stamp of the first surface in the list.
To show the examined surface, user instructs the renderer to display it.
It is convenient to use separate threads for filling surfaces with data and for synchronous surface displaying.</p></div>
<div class="listingblock">
<div class="title">VideoRender definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoRender</span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> MediaReceiver</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoRender</span><span style="color: #000000">,</span><span style="color: #000000"> MediaReceiver</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoRender</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">VideoRender</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetRenderFrame</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000">*</span><span style="color: #000000"> time</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">RenderFrame</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ShowLastFrame</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PrepareForRePosition</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">ColorFormat</span><span style="color: #000000"> </span><span style="color: #000000">CheckColorFormat</span><span style="color: #000000">(</span><span style="color: #000000">ColorFormat</span><span style="color: #000000"> format</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">      </span><span style="color: #000000">CheckBitDepth</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iDepth</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">VideoRenderType</span><span style="color: #000000"> </span><span style="color: #000000">GetRenderType</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000">  </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">VideoData</span><span style="color: #000000">  m_dataTemplate</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 52. VideoRender Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                                                         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videorender_getrenderframe">GetRenderFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns time stamp of the next surface in the renderer display list.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videorender_renderframe">RenderFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Displays the next ready surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videorender_showlastframe">ShowLastFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Displays last displayed surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videorender_prepareforreposition">PrepareForRePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Prepares render for repositioning of a stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_colorformat">ColorFormat</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videorender_checkcolorformat">CheckColorFormat</a></code></p></td>
<td align="left" valign="top"><p class="table">Checks for compatibility with specified color format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videorender_checkbitdepth">CheckBitDepth</a></code></p></td>
<td align="left" valign="top"><p class="table">Checks for compatibility with specified bit-deph.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_videorendertype">VideoRenderType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_videorender_getrendertype">GetRenderType</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns current render type.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_videorenderparams" class="float">VideoRenderParams</h4>
<div class="paragraph"><p><code>VideoRenderParams</code> is a class for a set of derived classes that describe settings and information about streams for certain implementations of video renderers.</p></div>
<div class="listingblock">
<div class="title">VideoRenderParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">VideoRenderParams</span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> MediaReceiverParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">VideoRenderParams</span><span style="color: #000000">,</span><span style="color: #000000"> MediaReceiverParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoRenderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoData</span><span style="color: #000000"> m_videoData</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 53. VideoRenderParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                       </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_videodata">VideoData</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_videoData</code></p></td>
<td align="left" valign="top"><p class="table">Video information template for internal buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_related_data_4" class="float">Related data</h3>
<div class="tableblock" id="_videorender_flags">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 54. VideoRender Flags</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>FLAG_VREN_KEEPASPECT</code></p></td>
<td align="left" valign="top"><p class="table">Keep frame aspect ratio during resizing in render.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FLAG_VREN_USETEXTURES</code></p></td>
<td align="left" valign="top"><p class="table">Render frame as texture (OpenGL only).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FLAG_VREN_HIDDEN</code></p></td>
<td align="left" valign="top"><p class="table">Keep rendering window hidden.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_videorender_init" class="float">VideoRender::Init</h4>
<div class="paragraph"><p>The method initializes the renderer.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaReceiverParams*</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to the initialization structure.
</p>
</td>
</tr>
</table></div>
<h4 id="_videorender_getrenderframe" class="float">VideoRender::GetRenderFrame</h4>
<div class="paragraph"><p>The method returns time stamp of the next surface ready to be displayed in the renderer display list and increments the internal video buffer counter.
This method should be called before <code>UnLockInputBuffer()</code> inherited from <code>MediaReceiver</code> (or in another thread) and after <code>RenderFrame()</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">GetRenderFrame</span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000">*</span><span style="color: #000000"> time</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64f* time</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Output parameter. Pointer to the frame time stamp.
</p>
</td>
</tr>
</table></div>
<h4 id="_videorender_renderframe" class="float">VideoRender::RenderFrame</h4>
<div class="paragraph"><p>The method displays the surface from the head of video renderer display list. This method renders a frame to the destination surface.
Call this method before <code>UnLockInputBuffer()</code> inherited from <code>MediaReceiver</code> (or in another thread) and after <code>GetRenderFrame()</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">RenderFrame</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h4 id="_videorender_showlastframe" class="float">VideoRender::ShowLastFrame</h4>
<div class="paragraph"><p>The method displays the last rendered surface.
Call this method after <code>UnLockInputBuffer()</code> inherited from <code>MediaReceiver</code> (or in another thread) and <code>GetRenderFrame()</code>.
The method performs the same operation as <code>RenderFrame()</code> but the renderer after rendering is completed.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ShowLastFrame</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h4 id="_videorender_prepareforreposition" class="float">VideoRender::PrepareForRePosition</h4>
<div class="paragraph"><p>The method prepares the render for repositioning of a stream. The return value is always <code>UMC_OK</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">PrepareForRePosition</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<h4 id="_videorender_checkcolorformat" class="float">VideoRender::CheckColorFormat</h4>
<div class="paragraph"><p>The method checks compatibility of provided <code>ColorFormat</code> with render and returns the same format if it is compatible or proposes compatible format instead.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">ColorFormat</span><span style="color: #000000"> </span><span style="color: #000000">CheckColorFormat</span><span style="color: #000000">(</span><span style="color: #000000">ColorFormat</span><span style="color: #000000"> format</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>ColorFormat format</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Desired color format.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_colorformat">ColorFormat</a></code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Format compatible with render.
</p>
</td>
</tr>
</table></div>
<h4 id="_videorender_checkbitdepth" class="float">VideoRender::CheckBitDepth</h4>
<div class="paragraph"><p>The method checks compatibility of provided bit-depth with render and returns the same bit-depth if it is compatible or proposes compatible bit-depth instead.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> </span><span style="color: #000000">CheckBitDepth</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> iDepth</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u iDepth</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Desired bit-depth.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32u</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Bit-depth compatible with render.
</p>
</td>
</tr>
</table></div>
<h4 id="_videorender_getrendertype" class="float">VideoRender::GetRenderType</h4>
<div class="paragraph"><p>The method returns <code>VideoRenderType</code> of allocated render implementation.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">VideoRenderType</span><span style="color: #000000"> </span><span style="color: #000000">GetRenderType</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_videorendertype">VideoRenderType</a></code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Actual render type.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
<div class="sect2">
<h3 id="_audiorender">AudioRender</h3>
<hr />
<div class="paragraph"><p>The <code>AudioRender</code> class is an abstract class of audio renderer. The class describes the high level interface of abstract audio renderer for synchronous rendering of audio data.</p></div>
<div class="listingblock">
<div class="title">AudioRender definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">AudioRender</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> MediaReceiver</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">AudioRender</span><span style="color: #000000">,</span><span style="color: #000000"> MediaReceiver</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioRender</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">AudioRender</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SendFrame</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> pDataIn</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Pause</span><span style="color: #000000">(</span><span style="color: #0000ff">bool</span><span style="color: #000000"> bPause</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> </span><span style="color: #000000">SetVolume</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> fVolume</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> </span><span style="color: #000000">GetVolume</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> </span><span style="color: #000000">GetTime</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> </span><span style="color: #000000">GetDelay</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetParams</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*</span><span style="color: #000000"> pMedia</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">  trickModes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_TRICK_MODES_NO</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">AudioRenderType</span><span style="color: #000000"> </span><span style="color: #000000">GetRenderType</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 55. AudioRender Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                   </th>
<th align="left" valign="top">Method                                         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiorender_sendframe">SendFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Sends a portion of data to the audio device.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiorender_pause">Pause</a></code></p></td>
<td align="left" valign="top"><p class="table">Pauses the audio rendering.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32f</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiorender_setvolume">SetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets volume of sound.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32f</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiorender_getvolume">GetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets volume of sound.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiorender_gettime">GetTime</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets value of audio reference clock.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiorender_getdelay">GetDelay</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets estimated value of device latency.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiorender_setparams">SetParams</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets new audio render parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_audiorendertype">AudioRenderType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_audiorender_getrendertype">GetRenderType</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns current render type.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_audiorenderparams" class="float">AudioRenderParams</h4>
<div class="paragraph"><p><code>AudioRenderParams</code> is a class for a set of derived classes that describe settings and information about streams for certain implementations of audio renderers.
<code>AudioRenderParams</code> class is inherited from <code>MediaReceiverParams</code>.</p></div>
<div class="listingblock">
<div class="title">AudioRenderParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">AudioRenderParams</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> MediaReceiverParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">AudioRenderParams</span><span style="color: #000000">,</span><span style="color: #000000"> MediaReceiverParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioRenderParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">AudioStreamInfo</span><span style="color: #000000">   m_info</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">SysRenderContext</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">m_pSysContext</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 56. AudioRenderParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                       </th>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_audiostreaminfo">AudioStreamInfo</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_info</code></p></td>
<td align="left" valign="top"><p class="table">Common fields necessary to initialize the renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_sysrendercontext">SysRenderContext</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pSysContext</code></p></td>
<td align="left" valign="top"><p class="table">Pointer for passing system context for some renders.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_audiorender_sendframe" class="float">AudioRender::SendFrame</h4>
<div class="paragraph"><p>The method plays audio data referenced by in on a selected audio device.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SendFrame</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> pDataIn</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData* pDataIn</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to the object of the <code>MediaData</code> class, which keeps the information about data being sent to the audio device (data size, data pointer, etc.)
</p>
</td>
</tr>
</table></div>
<h4 id="_audiorender_pause" class="float">AudioRender::Pause</h4>
<div class="paragraph"><p>The method breaks and resumes audio rendering. If pause is <code>TRUE</code>, rendering stops, if pause is <code>FALSE</code>, rendering resumes.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Pause</span><span style="color: #000000">(</span><span style="color: #0000ff">bool</span><span style="color: #000000"> bPause</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>bool bPause</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pausing parameter.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiorender_setvolume" class="float">AudioRender::SetVolume</h4>
<div class="paragraph"><p>The method sets attenuation of the sound. If volume parameter is equal to 0, the volume is at minimum (silence).
If the volume parameter is equal to 1, the volume is at maximum value.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> </span><span style="color: #000000">SetVolume</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> fVolume</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32f fVolume</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Value of volume.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32f</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Actual value of volume.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiorender_getvolume" class="float">AudioRender::GetVolume</h4>
<div class="paragraph"><p>The method retrieves the audio volume.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32f</span><span style="color: #000000"> </span><span style="color: #000000">GetVolume</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32f</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Value of volume.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiorender_gettime" class="float">AudioRender::GetTime</h4>
<div class="paragraph"><p>The method gets value of audio reference clock.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> </span><span style="color: #000000">GetTime</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64f</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Value of audio reference clock.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiorender_getdelay" class="float">AudioRender::GetDelay</h4>
<div class="paragraph"><p>The method gets an estimated value of the device latency.</p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp64f GetDelay(void) = 0;</code></pre>
</div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code>Ipp64f</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Value of the device latency.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiorender_setparams" class="float">AudioRender::SetParams</h4>
<div class="paragraph"><p>The method is applied to change audio renderer settings after initialization, even if rendering already started.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">SetParams</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*</span><span style="color: #000000"> pMedia</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000">  trickModes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_TRICK_MODES_NO</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaReceiverParams* pMedia</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Object of <code>AudioRenderParams</code> class.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u trickModes</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-             Type of the trick mode.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_IMPLEMENTED</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- This status is returned if <code>SetParams</code> is not implemented in derived classes.
</p>
</td>
</tr>
</table></div>
<h4 id="_audiorender_getrendertype" class="float">AudioRender::GetRenderType</h4>
<div class="paragraph"><p>The method returns <code>AudioRenderType</code> of allocated render implementation.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">AudioRenderType</span><span style="color: #000000"> </span><span style="color: #000000">GetRenderType</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_audiorendertype">AudioRenderType</a></code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Actual render type.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
<div class="sect2">
<h3 id="_mediabuffer">MediaBuffer</h3>
<hr />
<div class="paragraph"><p>The <code>MediaBuffer</code> class is derived from the <code>MediaReceiver</code> base class and provides functionality to organize a data flow in UMC-based applications.
Methods of the <code>MediaBuffer</code> class provide asynchronous access to a flow of data and allow using minimized portions of data for both components (producer and consumer)
in process of data passing. Another benefit is that hiding data buffering code in an <code>MediaBuffer</code> object simplifies the application code.</p></div>
<div class="paragraph"><p>An <code>MediaBuffer</code> object is a buffer of cyclic type since application does not have to wait for free memory space allocation within the buffer but
revisits the object until space is allocated. See next figure.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_3_5.png" alt="images/umc/umc_3_5.png" />
</div>
<div class="title">Figure 9. Free Space Allocation Process in MediaBuffer Object</div>
</div>
<div class="paragraph"><p>Implementations of the <code>MediaBuffer</code> interface allow users to build various memory/threading models of codecs. So by writing a codec derived from the <code>BaseCodec</code> class,
the user is able to reuse such a codec in different streaming infrastructures by creating an appropriate object of the <code>MediaBuffer</code> class.</p></div>
<div class="paragraph"><p>The following is an example of output buffer use in an audio transcoding chain. See <a href="#_input_buffer_access">this figure</a> for input buffer access procedure in an analogous chain.</p></div>
<div class="paragraph"><p>Consider an audio transcoding chain with different sizes of output decoded frame and input frame for encoder (see <a href="#_output_buffer_access">figure</a>).
The buffer for output on the right is an <code>MediaData</code> class object that accommodates data in a portion, or frame, required by the next-in-line encoder for a different format.</p></div>
<div class="imageblock" id="_output_buffer_access">
<div class="content">
<img src="images/umc/umc_3_6.png" alt="images/umc/umc_3_6.png" />
</div>
<div class="title">Figure 10. Output Buffer Access</div>
</div>
<div class="listingblock">
<div class="title">MediaBuffer definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MediaBuffer</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> MediaReceiver</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">MediaBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> MediaReceiver</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">MediaBuffer</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">MediaBuffer</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">LockOutputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> out</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">UnLockOutputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> out</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*</span><span style="color: #000000"> pInit</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    MemoryAllocator</span><span style="color: #000000">*</span><span style="color: #000000"> m_pMemoryAllocator</span><span style="color: #000000">;</span>
<span style="color: #000000">    MemoryAllocator</span><span style="color: #000000">*</span><span style="color: #000000"> m_pAllocated</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 57. MediaBuffer Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                                     </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediabuffer_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediabuffer_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes allocated resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediabuffer_lockoutputbuffer">LockOutputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Locks portion of unread data in the internal buffer to allow consumer to take data safely.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mediabuffer_unlockoutputbuffer">UnLockOutputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Updates information about size of portion of data which was taken from the buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_mediabufferparams" class="float">MediaBufferParams</h4>
<div class="paragraph"><p>The class contains initialization parameters for <code>MediaBuffer</code>.</p></div>
<div class="listingblock">
<div class="title">MediaBufferParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MediaBufferParams</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> MediaReceiverParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">MediaBufferParams</span><span style="color: #000000">,</span><span style="color: #000000"> MediaReceiverParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">MediaBufferParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">size_t</span><span style="color: #000000"> m_prefInputBufferSize</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> m_numberOfFrames</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">size_t</span><span style="color: #000000"> m_prefOutputBufferSize</span><span style="color: #000000">;</span>
<span style="color: #000000">    MemoryAllocator</span><span style="color: #000000">*</span><span style="color: #000000"> m_pMemoryAllocator</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 58. MediaBufferParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                   </th>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_prefInputBufferSize</code></p></td>
<td align="left" valign="top"><p class="table">Preferable size of a portion of data for data producer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_numberOfFrames</code></p></td>
<td align="left" valign="top"><p class="table">Desired number of buffers of preferred size in <code>MediaBuffer</code> object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_prefOutputBufferSize</code></p></td>
<td align="left" valign="top"><p class="table">Preferable size of a portion of data for component that will takes data from <code>MediaBuffer</code> output.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator">MemoryAllocator</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to manually created <code>MemoryAllocator</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<h4 id="_mediabuffer_init" class="float">MediaBuffer::Init</h4>
<div class="paragraph"><p>The method accepts pointer of type <code>MediaReceiverParams</code> as its single parameter. The pointer must actually refer to the instance of
<code>MediaBufferParams</code> structure that contains initialization info.
The <code>MediaBuffer</code> class is a base class, so this method just encapsulates common code for derived classes.
The method only saves a given pointer to an allocated memory manager or creates its new instance.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*</span><span style="color: #000000"> pInit</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaReceiverParams* pInit</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to a structure with working parameters. Passed structure shall have the <code>MediaBufferParams</code> type.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NULL_PTR</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to the initialization structure has incorrect value or cannot be converted to the <code>MediaBufferParams*</code> type.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_ALLOC</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    An internal memory buffer or a list of structures cannot be allocated.
</p>
</td>
</tr>
</table></div>
<h4 id="_mediabuffer_close" class="float">MediaBuffer::Close</h4>
<div class="paragraph"><p>The method deletes the allocated memory manager if it was allocated by Init method.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span></tt></pre></div></div>
<h4 id="_mediabuffer_lockoutputbuffer" class="float">MediaBuffer::LockOutputBuffer</h4>
<div class="paragraph"><p>The method obtains pointer on free-to-read portion of data in the internal buffer. The caller should wait for a while before calling the next <code>LockOutputBuffer()</code> method.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">LockOutputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> out</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData* out</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Pointer to the object of the <code>MediaData</code> class or derived class, allocated by user, which is filled with information on buffer,
                            from which consumer reads new portion of data.
</p>
</td>
</tr>
</table></div>
<div class="hdlist"><div class="title">Return Values</div><table>
<tr>
<td class="hdlist1">
<code><a href="#_status">Status</a>::UMC_ERR_NOT_ENOUGH_DATA</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- The portion of data is less than preferred output buffer size.
</p>
</td>
</tr>
</table></div>
<h4 id="_mediabuffer_unlockoutputbuffer" class="float">MediaBuffer::UnLockOutputBuffer</h4>
<div class="paragraph"><p>The method unlocks the output buffer. After reading data from the buffer obtained through call of <code>LockOutputBuffer()</code> method,
the user should provide feedback to the <code>MediaBuffer</code> object about the amount of unread data remaining in the buffer and other specific
information that can be stored in the object derived from the <code>MediaBuffer</code> class.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">UnLockOutputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> out</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MediaData* out</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to the object of the <code>MediaData</code> class or derived class, allocated by the user, which contains updated information.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_memoryallocator">MemoryAllocator</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>The <code>MemoryAllocator</code> base class provides interface for flexible memory management for UMC components and allows users to implement their own memory control strategy.
The class also provides interface to relocate allocated memory blocks.</p></div>
<div class="paragraph"><p>Use the <code>Alloc()</code> method to allocate a memory block. The method provides only a block identification. When a codec is going to use this memory block,
it calls <code>Lock()</code> method to obtain the pointer. After the memory was used the block is unlocked with <code>Unlock()</code> method. In the process, usually between <code>GetFrame()</code>
calls of a codec, you can move the unlocked memory blocks to different position or swap them, etc. All codecs assume that the pointer to unlocked memory can be changed.</p></div>
<div class="listingblock">
<div class="title">MemoryAllocator definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MemoryAllocator</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">MemoryAllocator</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">MemoryAllocator</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">MemoryAllocator</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MemoryAllocatorParams</span><span style="color: #000000">*</span><span style="color: #000000"> pParams</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Alloc</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000">*</span><span style="color: #000000"> pNewMemID</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> Size</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> Flags</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> Align </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">16</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">Lock</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000"> MID</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Unlock</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000"> MID</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Free</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000"> MID</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">DeallocateMem</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000"> MID</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">Mutex</span><span style="color: #000000"> m_guard</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 59. MemoryAllocator Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                   </th>
<th align="left" valign="top">Method                                             </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes memory allocator object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the object and releases all allocated resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator_alloc">Alloc</a></code></p></td>
<td align="left" valign="top"><p class="table">Allocates or reserves physical memory and returns unique ID, sets lock counter to 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void*</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator_lock">Lock</a></code></p></td>
<td align="left" valign="top"><p class="table">Locks memory buffer, increases lock counter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator_unlock">Unlock</a></code></p></td>
<td align="left" valign="top"><p class="table">Decreases lock counter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator_free">Free</a></code></p></td>
<td align="left" valign="top"><p class="table">Notifies that the data will not be used anymore and the memory can be released.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_status">Status</a></code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memoryallocator_deallocatemem">DeallocateMem</a></code></p></td>
<td align="left" valign="top"><p class="table">Immediately deallocates memory regardless of whether it is in use (locked) or not.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_memoryallocatorparams" class="float">MemoryAllocatorParams</h3>
<div class="paragraph"><p>The <code>MemoryAllocatorParams</code> base class provides interface for MemoryAllocator initialization.</p></div>
<div class="listingblock">
<div class="title">MemoryAllocatorParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MemoryAllocatorParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">MemoryAllocatorParams</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #000000">MemoryAllocatorParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">MemoryAllocatorParams</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_related_data_5" class="float">Related data</h3>
<div class="listingblock">
<div class="title">MemID Definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">typedef</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> MemID</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 60. UMC_ALLOC_FLAGS Values</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>MID_INVALID</code></p></td>
<td align="left" valign="top"><p class="table">Invalid Memory Identifier value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ALLOC_PERSISTENT</code></p></td>
<td align="left" valign="top"><p class="table">Persistent memory block.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ALLOC_FUNCLOCAL</code></p></td>
<td align="left" valign="top"><p class="table">Temporary allocated memory block.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_memoryallocator_init" class="float">MemoryAllocator::Init</h3>
<div class="paragraph"><p>The method performs initialization of memory allocator according to the initialization structure.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">If the <code>MemoryAllocator</code> object is already in use, all allocated memory is released.</td>
</tr></table>
</div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MemoryAllocatorParams</span><span style="color: #000000">*</span><span style="color: #000000"> pParams</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MemoryAllocatorParams* pParams</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Pointer to the initialization structure. The pointer should refer to the instance of class derived from <code>MemoryAllocatorParams</code>,
                                            which contains specific initialization parameters.
</p>
</td>
</tr>
</table></div>
<h3 id="_memoryallocator_close" class="float">MemoryAllocator::Close</h3>
<div class="paragraph"><p>The method closes the memory allocator object and releases all memory regardless of whether it is still in use (locked) or not. The method is invoked in the destructor.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<h3 id="_memoryallocator_alloc" class="float">MemoryAllocator::Alloc</h3>
<div class="paragraph"><p>The method allocates or reserves physical memory using specific allocation strategy. If the method succeeds it returns unique ID of the allocated memory
through the pNewMemID output parameter. If the allocation fails the method returns error code and ID is set to <code>MID_INVALID</code>. The method uses size
of the buffer to be allocated, flags, and required alignment. The last parameter defines memory alignment and by default is set to 16.</p></div>
<div class="paragraph"><p>The Flags argument can contain flags from the <code>UMC_ALLOC_FLAGS</code> enumeration.
<code>UMC_ALLOC_PERSISTENT</code> and <code>UMC_ALLOC_FUNCLOCAL</code> flags should help implement more effective memory management strategy. The flags are mutually exclusive.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Alloc</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000">*</span><span style="color: #000000"> pNewMemID</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">size_t</span><span style="color: #000000"> Size</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> Flags</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> Align </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">16</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MemID* pNewMemID</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-  Output parameter. Memory address where the unique identifier of the new buffer will be stored.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>size_t Size</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Input parameter. Size in bytes of the memory buffer to be allocated.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u Flags</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Input parameter. One of the flags from the <code>UMC_ALLOC_FLAGS</code> enumeration, which determines if the memory is persistent or temporal.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32u Align</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Input parameter. Memory alignment value.
</p>
</td>
</tr>
</table></div>
<h3 id="_memoryallocator_lock" class="float">MemoryAllocator::Lock</h3>
<div class="paragraph"><p>The method locks memory buffer identified by MID. If the method succeeds it returns buffer pointer and increases lock counter for this buffer.
If the method fails (for example, the memory cannot be locked, the identifier is not valid, etc.), the method returns <code>NULL</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">Lock</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000"> MID</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MemID MID</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Identifier of the memory buffer to lock.
</p>
</td>
</tr>
</table></div>
<h3 id="_memoryallocator_unlock" class="float">MemoryAllocator::Unlock</h3>
<div class="paragraph"><p>The method decreases lock counter for the buffer specified by the MID identifier. After the buffer has been unlocked the pointer obtained by the corresponding <code>Lock()</code>
method is no longer valid. Using this pointer can lead to memory corruption and application crash.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Unlock</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000"> MID</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MemID MID</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Identifier of the memory buffer to unlock.
</p>
</td>
</tr>
</table></div>
<h3 id="_memoryallocator_free" class="float">MemoryAllocator::Free</h3>
<div class="paragraph"><p>The method frees memory specified by the MID identifier.
If the buffer was previously locked, the memory is not released until the buffer is unlocked, but marked as invalidated.
This memory cannot be locked any more. The <code>Lock()</code> method returns error if invalidated memory is attempted to be locked.
The memory is released when locks counter of the buffer reaches zero.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Free</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000"> MID</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MemID MID</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Identifier of the memory buffer to release.
</p>
</td>
</tr>
</table></div>
<h3 id="_memoryallocator_deallocatemem" class="float">MemoryAllocator::DeallocateMem</h3>
<div class="paragraph"><p>The method immediately deallocates memory regardless of whether it is in use (locked) or not unlike the <code>Free()</code> method that checks whether the memory is in use or not.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">DeallocateMem</span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000"> MID</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MemID MID</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Identifier of the memory buffer to deallocate.
</p>
</td>
</tr>
</table></div>
<div style="page-break-after:always"></div>
</div>
</div>
<div class="sect1">
<h2 id="_example_of_umc_base_classes_usage">Example of UMC Base Classes Usage</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>This section presents a video decoding pipeline as an example of decoding of motion JPEG video data wrapped into an AVI file. The output is a raw YUV file. This example illustrates initialization and interaction of splitter, video decoder, and video renderer.</p></div>
<div class="exampleblock" id="example_3_6">
<div class="title">Example 2. UMC Base Classes Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #008000">/*</span>
<span style="color: #008000">//</span>
<span style="color: #008000">// INTEL CORPORATION PROPRIETARY INFORMATION</span>
<span style="color: #008000">// This software is supplied under the terms of a license agreement or</span>
<span style="color: #008000">// nondisclosure agreement with Intel Corporation and may not be copied</span>
<span style="color: #008000">// or disclosed except in accordance with the terms of that agreement.</span>
<span style="color: #008000">// Copyright(c) 2005-2008 Intel Corporation. All Rights Reserved.</span>
<span style="color: #008000">//</span>
<span style="color: #008000">*/</span>

<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">&lt;stdio.h&gt;</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">&lt;stdlib.h&gt;</span>

<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"ippdefs.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"ippcore.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"ipps.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"ippi.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"ippj.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"ippcc.h"</span>

<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"vm_time.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_defs.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_structures.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_data_reader.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_splitter.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_video_decoder.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_video_data.h"</span>

<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_video_render.h"</span>

<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_file_reader.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_fio_reader.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_avi_splitter.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_mjpeg_video_decoder.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"fw_video_render.h"</span>

<span style="color: #0000ff">using</span><span style="color: #000000"> </span><span style="color: #0000ff">namespace</span><span style="color: #000000"> UMC</span><span style="color: #000000">;</span>
<span style="color: #0000ff">static</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">copyright</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"</span><span style="color: #A31515">\n</span><span style="color: #A31515">Intel(R) Media processing sample based on</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">" UMC and Intel(R) Integrated Performance</span>
<span style="color: #A31515">            Primitives</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"Copyright(c) 2005-2008 Intel Corporation. All</span>
<span style="color: #A31515">            Rights Reserved.</span><span style="color: #A31515">\n\n</span><span style="color: #A31515">"</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// copyright()</span>

<span style="color: #0000ff">static</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">ipp_version</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">const</span><span style="color: #000000"> IppLibraryVersion</span><span style="color: #000000">*</span><span style="color: #000000"> version</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"Intel(R) Integrated Performance Primitives</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">));</span>

<span style="color: #000000">    </span><span style="color: #008000">/* ippCore version info */</span>
<span style="color: #000000">    version </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ippGetLibVersion</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">" %s,</span><span style="color: #A31515">\t</span><span style="color: #A31515">%s {%d.%d.%d.%d},</span><span style="color: #A31515">\t</span><span style="color: #A31515">build date %s</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Name</span><span style="color: #000000">,</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Version</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">major</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">minor</span><span style="color: #000000">,</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">majorBuild</span><span style="color: #000000">,</span><span style="color: #000000">version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">build</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">BuildDate</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">/* ippSP version info */</span>
<span style="color: #000000">    version </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ippsGetLibVersion</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">" %s,</span><span style="color: #A31515">\t</span><span style="color: #A31515">%s {%d.%d.%d.%d},</span><span style="color: #A31515">\t</span><span style="color: #A31515">build date %s</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Name</span><span style="color: #000000">,</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Version</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">major</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">minor</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">majorBuild</span><span style="color: #000000">,</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">build</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">BuildDate</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">/* ippIP version info */</span>
<span style="color: #000000">    version </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ippiGetLibVersion</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">" %s,</span><span style="color: #A31515">\t</span><span style="color: #A31515">%s {%d.%d.%d.%d},</span><span style="color: #A31515">\t</span><span style="color: #A31515">build date %s</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Name</span><span style="color: #000000">,</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Version</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">major</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">minor</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">majorBuild</span><span style="color: #000000">,</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">build</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">BuildDate</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">/* ippJP version info */</span>
<span style="color: #000000">    version </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ippjGetLibVersion</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">" %s,</span><span style="color: #A31515">\t</span><span style="color: #A31515">%s {%d.%d.%d.%d},</span><span style="color: #A31515">\t</span><span style="color: #A31515">build date %s</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Name</span><span style="color: #000000">,</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Version</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">major</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">minor</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">majorBuild</span><span style="color: #000000">,</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">build</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">BuildDate</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">/* ippCC version info */</span>
<span style="color: #000000">    version </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ippccGetLibVersion</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">" %s,</span><span style="color: #A31515">\t</span><span style="color: #A31515">%s {%d.%d.%d.%d},</span><span style="color: #A31515">\t</span><span style="color: #A31515">build date %s</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Name</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Version</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">major</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">minor</span><span style="color: #000000">,</span>
<span style="color: #000000">            version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">majorBuild</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">build</span><span style="color: #000000">,</span><span style="color: #000000"> version</span><span style="color: #000000">-&gt;</span><span style="color: #000000">BuildDate</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// ipp_version()</span>

<span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">InitDataReader</span><span style="color: #000000">(</span><span style="color: #000000">DataReader</span><span style="color: #000000">*</span><span style="color: #000000"> pDataReader</span><span style="color: #000000">,</span><span style="color: #000000"> vm_char</span><span style="color: #000000">*</span><span style="color: #000000">  file_name</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">FileReaderParams</span><span style="color: #000000"> reader_params</span><span style="color: #000000">;</span>

<span style="color: #000000">    reader_params</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">reader_params</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> file_name</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> pDataReader</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">reader_params</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// InitDataReader()</span>

<span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">InitAVISplitter</span><span style="color: #000000">(</span><span style="color: #000000">Splitter</span><span style="color: #000000">*</span><span style="color: #000000"> pAVISplitter</span><span style="color: #000000">,</span><span style="color: #000000"> DataReader</span><span style="color: #000000">*</span><span style="color: #000000"> pDataReader</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">SplitterParams</span><span style="color: #000000"> spl_params</span><span style="color: #000000">;</span>
<span style="color: #000000">    spl_params</span><span style="color: #000000">.</span><span style="color: #000000">m_lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> VIDEO_SPLITTER</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// want to exctract only video spl_params.m_pDataReader = pDataReader;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> pAVISplitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">spl_params</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// InitAVISplitter()</span>

<span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">InitMJPEGVideoDecoder</span><span style="color: #000000">(</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoDecoder</span><span style="color: #000000">,</span><span style="color: #000000"> VideoStreamInfo</span><span style="color: #000000">*</span><span style="color: #000000"> video_info</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">video_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">stream_type </span><span style="color: #000000">!=</span><span style="color: #000000"> MJPEG_VIDEO</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC_ERR_FAILED</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> dec_params</span><span style="color: #000000">;</span>
<span style="color: #000000">    dec_params</span><span style="color: #000000">.</span><span style="color: #000000">info  </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">video_info</span><span style="color: #000000">;</span><span style="color: #000000"> dec_params</span><span style="color: #000000">.</span><span style="color: #000000">lFlags  </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span><span style="color: #000000"> dec_params</span><span style="color: #000000">.</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> pVideoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">dec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// InitMJPEGVideoDecoder()</span>

<span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">InitVideoRender</span><span style="color: #000000">(</span><span style="color: #000000">VideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">,</span><span style="color: #000000"> VideoStreamInfo</span><span style="color: #000000">*</span><span style="color: #000000"> video_info</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">VideoRenderParams</span><span style="color: #000000"> render_params</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> render_params</span><span style="color: #000000">.</span><span style="color: #000000">out_data_template</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span>
<span style="color: #000000">        video_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">,</span><span style="color: #000000"> video_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">,</span>
<span style="color: #000000">        video_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">color_format</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">render_params</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// InitVideoRender()</span>

<span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">DecodeMJPEGVideo</span><span style="color: #000000">(</span><span style="color: #000000">vm_char</span><span style="color: #000000">*</span><span style="color: #000000"> input_file</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> track</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> nframes</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_tick</span><span style="color: #000000"> t0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_tick</span><span style="color: #000000"> t1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_tick</span><span style="color: #000000"> total</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_tick</span><span style="color: #000000"> freq</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> fps</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">FIOReader</span><span style="color: #000000"> src</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">AVISplitter</span><span style="color: #000000"> avi_spl</span><span style="color: #000000">;</span>
<span style="color: #000000">    SplitterInfo</span><span style="color: #000000">*</span><span style="color: #000000"> spl_info</span><span style="color: #000000">;</span>
<span style="color: #000000">    VideoStreamInfo</span><span style="color: #000000">*</span><span style="color: #000000"> video_info</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MJPEGVideoDecoder</span><span style="color: #000000"> mjpeg_dec</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">FWVideoRender</span><span style="color: #000000"> dst</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MediaData</span><span style="color: #000000"> in</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">VideoData</span><span style="color: #000000"> out</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// Initialize data reader component</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">InitDataReader</span><span style="color: #000000">(&amp;</span><span style="color: #000000">src</span><span style="color: #000000">,</span><span style="color: #000000"> input_file</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// Initialize splitter component</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">InitAVISplitter</span><span style="color: #000000">(&amp;</span><span style="color: #000000">avi_spl</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">src</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// get stream info</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> avi_spl</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">spl_info</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// find required track</span>
<span style="color: #000000">    </span><span style="color: #0000ff">for</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">track </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span><span style="color: #000000"> track </span><span style="color: #000000">&lt;</span><span style="color: #000000"> spl_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_nOfTracks</span><span style="color: #000000">;</span><span style="color: #000000"> track</span><span style="color: #000000">++)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">TRACK_MJPEG </span><span style="color: #000000">==</span><span style="color: #000000"> spl_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">track</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_Type</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// track of MJPEG type is not found</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">track </span><span style="color: #000000">&gt;=</span><span style="color: #000000"> spl_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_nOfTracks</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC_ERR_INVALID_STREAM</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// get VideoStreamInfo structure</span>
<span style="color: #000000">    video_info </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000">*)</span><span style="color: #000000">spl_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">track</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_pStreamInfo</span><span style="color: #000000">;</span>

<span style="color: #000000">    video_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">color_format </span><span style="color: #000000">=</span><span style="color: #000000"> YUY2</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"file: %s</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000">input_file</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">" video stream</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"  type : %s</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000">GetVideoTypeString</span><span style="color: #000000">(</span><span style="color: #000000">spl_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">stream_type</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">" dims : %dx%d</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000">spl_info</span><span style="color: #000000">-&gt;</span>
<span style="color: #000000">        m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">,</span><span style="color: #000000">spl_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">" color : %s</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000">GetFormatTypeString</span><span style="color: #000000">(</span><span style="color: #000000">spl_info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">color_format</span><span style="color: #000000">));</span>

<span style="color: #000000">    </span><span style="color: #008000">// Initialize video decoder component</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">InitMJPEGVideoDecoder</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mjpeg_dec</span><span style="color: #000000">,</span><span style="color: #000000"> video_info</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// Initialize video render component</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">InitVideoRender</span><span style="color: #000000">(&amp;</span><span style="color: #000000">dst</span><span style="color: #000000">,</span><span style="color: #000000"> video_info</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">    freq </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">vm_time_get_frequency</span><span style="color: #000000">();</span>

<span style="color: #000000">    total </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    nframes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// decoding &amp; rendering loop (frame by frame)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">==</span><span style="color: #000000"> UMC_OK </span><span style="color: #000000">||</span><span style="color: #000000"> umcRes </span><span style="color: #000000">==</span><span style="color: #000000"> UMC_ERR_NOT_ENOUGH_DATA</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA </span><span style="color: #000000">==</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> avi_spl</span><span style="color: #000000">.</span><span style="color: #000000">GetNextData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000"> track</span><span style="color: #000000">)))</span>
<span style="color: #000000">            </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">5</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> dst</span><span style="color: #000000">.</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>

<span style="color: #000000">        t0 </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">vm_time_get_tick</span><span style="color: #000000">();</span>

<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> mjpeg_dec</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>

<span style="color: #000000">        t1 </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">vm_time_get_tick</span><span style="color: #000000">();</span>

<span style="color: #000000">        total </span><span style="color: #000000">+=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">t1 </span><span style="color: #000000">-</span><span style="color: #000000"> t0</span><span style="color: #000000">);</span>

<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">continue</span><span style="color: #000000">;</span>

<span style="color: #000000">        </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"frame# %d, FPS - %4.1f</span><span style="color: #A31515">\r</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000">nframes</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000">)</span><span style="color: #000000">1.0</span><span style="color: #000000"> </span><span style="color: #000000">/</span><span style="color: #000000"> </span><span style="color: #000000">((</span><span style="color: #000000">t1 </span><span style="color: #000000">-</span><span style="color: #000000"> t0</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">/</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000">)</span><span style="color: #000000">freq</span><span style="color: #000000">));</span>

<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">==</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #000000">{</span>
<span style="color: #000000">            umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> dst</span><span style="color: #000000">.</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">                </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>

<span style="color: #000000">            </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> time </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span>
<span style="color: #000000">            </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC_ERR_TIMEOUT </span><span style="color: #000000">==</span><span style="color: #000000"> dst</span><span style="color: #000000">.</span><span style="color: #000000">GetRenderFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">time</span><span style="color: #000000">));</span>

<span style="color: #000000">            umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> dst</span><span style="color: #000000">.</span><span style="color: #000000">RenderFrame</span><span style="color: #000000">();</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">                </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>

<span style="color: #000000">        nframes</span><span style="color: #000000">++;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// while()</span>


<span style="color: #000000">    fps </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">Ipp64f</span><span style="color: #000000">)(</span><span style="color: #000000">freq </span><span style="color: #000000">/</span><span style="color: #000000"> </span><span style="color: #000000">((</span><span style="color: #000000">Ipp64f</span><span style="color: #000000">)</span><span style="color: #000000">total </span><span style="color: #000000">/</span><span style="color: #000000"> nframes</span><span style="color: #000000">));</span>

<span style="color: #000000">    </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"processed %d frames, with avg performance %4.1f</span>
<span style="color: #A31515">        FPS</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">),</span><span style="color: #000000">nframes</span><span style="color: #000000">,</span><span style="color: #000000"> fps</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// DecodeMJPEGVideo()</span>

<span style="color: #0000ff">int</span><span style="color: #000000"> </span><span style="color: #000000">main</span><span style="color: #000000">(</span><span style="color: #0000ff">int</span><span style="color: #000000"> argc</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">char</span><span style="color: #000000">*</span><span style="color: #000000"> argv</span><span style="color: #000000">[])</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">ippStaticInit</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #000000">copyright</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">ipp_version</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">argc </span><span style="color: #000000">&gt;</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">DecodeMJPEGVideo</span><span style="color: #000000">(</span><span style="color: #000000">argv</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">]);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span>
<span style="color: #000000">        </span><span style="color: #000000">vm_string_printf</span><span style="color: #000000">(</span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"expected AVI file name"</span><span style="color: #000000">));</span>

<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// main()</span></tt></pre></div></div>
</div></div>
<div style="page-break-after:always"></div>
</div>
</div>
<h1 id="_4_motion_estimation_and_mode_decision_classes">4. Motion Estimation and Mode Decision Classes</h1>
<div class="paragraph"><p>This chapter contains description of the following UMC Motion Estimation (ME) and Mode Decision (MD) classes:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="#_meadr">MeAdr</a> - represents addresses and steps of points in all the three planes Y, U, and V. Use this class for downsampling search to refer to different levels.
</p>
</li>
<li>
<p>
<a href="#_mebase">MeBase</a> - The base class for motion estimation. It provides the standard independent functionality, including different motion estimation and mode decision algorithms.
</p>
<div class="ulist"><ul>
<li>
<p>
<a href="#_mevc1">MeVC1</a> - Provides the VC1 specific functionality, including the RD mode decision and the vector prediction calculation.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<a href="#_mecostrd">MeCostRD</a> - Rate Distortion (RD) cost. The class keeps the rate and the distortion values for each marcroblock, and the number of coded transformed coefficients and block partitions.
</p>
</li>
<li>
<p>
<a href="#_meframe">MeFrame</a> - Represents one frame, which may be either a source or reference frame.
</p>
</li>
<li>
<p>
<a href="#_meinitparams">MeInitParams</a> - Class for the motion estimation initialization.
</p>
</li>
<li>
<p>
<a href="#_memb">MeMB</a> - Represents the results of motion estimation and mode decision.
</p>
</li>
<li>
<p>
<a href="#_membstat">MeMbStat</a> - Statistics for a macroblock. This class is used in feedback implementation.
</p>
</li>
<li>
<p>
<a href="#_memv">MeMV</a> - Represents a motion vector, which is always in quarter pixel units.
</p>
</li>
<li>
<p>
<a href="#_meparams">MeParams</a> - Specifies the current frame estimation.
</p>
</li>
</ul></div>
<div class="sect1">
<h2 id="_enumerators">Enumerators</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>The following tables details the enumeration types.</p></div>
<h3 id="_medecisionmetrics" class="float">MeDecisionMetrics</h3>
<div class="paragraph"><p>Cost metrics for motion estimation and transform decision.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 61. MeDecisionMetrics description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Sad</code></p></td>
<td align="left" valign="top"><p class="table">Sum of absolute differences (SAD).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Sadt</code></p></td>
<td align="left" valign="top"><p class="table">Hadamard transform.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_SSD</code></p></td>
<td align="left" valign="top"><p class="table">Sum of square differences.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Maxad</code></p></td>
<td align="left" valign="top"><p class="table">Calculate the maximum of absolute differences between the source and the reference macroblock coefficients.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Hadamard</code></p></td>
<td align="left" valign="top"><p class="table">This option is no longer supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_SadtSrc</code></p></td>
<td align="left" valign="top"><p class="table">Calculate the sum of coefficients of a Hadamard transformed source buffer. The sum is used for Intra/Inter mode decision.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_SadtSrcNoDC</code></p></td>
<td align="left" valign="top"><p class="table">Calculate the sum of coefficients of a Hadamard transformed source buffer. The sum is used for Intra/Inter mode decision. This enumeration does not consider DC.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_VarMean</code></p></td>
<td align="left" valign="top"><p class="table">Calculate two values: the sum of square differences between the source and the reference macroblock coefficients;
                the mean value of differences between the source and the reference macroblock coefficients.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_InterSSD</code></p></td>
<td align="left" valign="top"><p class="table">This option is no longer supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_InterRate</code></p></td>
<td align="left" valign="top"><p class="table">This option is no longer supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_IntraSSD</code></p></td>
<td align="left" valign="top"><p class="table">This option is no longer supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_IntraRate</code></p></td>
<td align="left" valign="top"><p class="table">This option is no longer supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_InterRD</code></p></td>
<td align="left" valign="top"><p class="table">Calculate the rate and the distortion for an inter-coded macroblock.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_IntraRD</code></p></td>
<td align="left" valign="top"><p class="table">Calculate the rate and the distortion for an intra-coded macroblock.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_meinterpolation" class="float">MeInterpolation</h3>
<div class="paragraph"><p>Interpolation type. See also <code>MePixelType</code>.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 62. MeDiamondType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_VC1_Bilinear</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_VC1_Bicubic</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_H264_Luma</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_H264_Chroma</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_AVS_Luma</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mediamondtype" class="float">MeDiamondType</h3>
<div class="paragraph"><p>Motion estimation paths.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 63. MeDiamondType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_SmallDiamond</code></p></td>
<td align="left" valign="top"><p class="table">Small +-1 point diamond</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MediumDiamond</code></p></td>
<td align="left" valign="top"><p class="table">Medium +-2 point diamond</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_BigDiamond</code></p></td>
<td align="left" valign="top"><p class="table">Big +-3 point diamond</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_SmallHexagon</code></p></td>
<td align="left" valign="top"><p class="table">Small +-8 points two-level hexagon</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MediumHexagon</code></p></td>
<td align="left" valign="top"><p class="table">Medium +-16 points four-level hexagon</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_membpart" class="float">MeMbPart</h3>
<div class="paragraph"><p>Marcroblock partitioning. Make sure to use the numbering as shown here. Use unusual types such as 2x2 during downsampling search.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 64. MeMbPart description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Mb2x2</code></p></td>
<td align="left" valign="top"><p class="table">2x2 block size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Mb4x4</code></p></td>
<td align="left" valign="top"><p class="table">4x4 block size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Mb8x8</code></p></td>
<td align="left" valign="top"><p class="table">8x8 block size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Mb16x16</code></p></td>
<td align="left" valign="top"><p class="table">16x16 block size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Mb16x8</code></p></td>
<td align="left" valign="top"><p class="table">16x8 block size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Mb8x16</code></p></td>
<td align="left" valign="top"><p class="table">8x16 block size</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mepixeltype" class="float">MePixelType</h3>
<div class="paragraph"><p>Macroblock type. <code>MeMbType</code> is a standard independent type.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 65. MeMbPart description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbIntra</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbFrw</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbBkw</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbBidir</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbFrwSkipped</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbBkwSkipped</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbBidirSkipped</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbDirectSkipped</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbDirect</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MbMixed</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mepixeltype_2" class="float">MePixelType</h3>
<div class="paragraph"><p>Pixel type. Use <code>MePixelType</code> to specify the subpixel search level, or to choose the downsampled level in motion estimation.
<code>MePixelType</code> does not define the interpolation type. See also <code>MeInterpolation</code> type above.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 66. MePixelType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_IntegerPixel</code></p></td>
<td align="left" valign="top"><p class="table">Integer pixel</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_HalfPixel</code></p></td>
<td align="left" valign="top"><p class="table">Half pixel</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_QuarterPixel</code></p></td>
<td align="left" valign="top"><p class="table">Quarter pixel</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_DoublePixel</code></p></td>
<td align="left" valign="top"><p class="table">Two times downsampling</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_QuadPixel</code></p></td>
<td align="left" valign="top"><p class="table">Four times</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_OctalPixel</code></p></td>
<td align="left" valign="top"><p class="table">Eight times</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mepredictiontype" class="float">MePredictionType</h3>
<div class="paragraph"><p>Motion vector prediction type.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 67. MePredictionType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_VC1</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_VC1Hybrid</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_VC1Field1</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_VC1Field2</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_VC1Field2Hybrid</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_MPEG2</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_H264</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_AVS</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mesearchdirection" class="float">MeSearchDirection</h3>
<div class="paragraph"><p>Search direction. Use MeSearchDirection to choose between P and B frames.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 68. MeSearchDirection description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_ForwardSearch</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_BidirSearch</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_metransformtype" class="float">MeTransformType</h3>
<div class="paragraph"><p>Transform type. Use <code>MeTransformType</code> for standard abstraction.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 69. MeTransformType description</caption>
<col width="14%" />
<col width="85%" />
<thead>
<tr>
<th align="left" valign="top">Name           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Tranform8x8</code></p></td>
<td align="left" valign="top"><p class="table">Transforming on eight by eight blocks of coefficients.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Tranform8x4</code></p></td>
<td align="left" valign="top"><p class="table">Transforming on eight by four blocks of coefficients.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Tranform4x8</code></p></td>
<td align="left" valign="top"><p class="table">Transforming on four by eight blocks of coefficients.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME_Tranform4x4</code></p></td>
<td align="left" valign="top"><p class="table">Transforming on four by four blocks of coefficients.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_meadr">MeAdr</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>MeAdr</code> represents addresses and steps of points in all the three planes Y, U, and V. Use this class for downsampling search to refer to different levels.</p></div>
<div class="listingblock">
<div class="title">MeAdr definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeAdr</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">MeAdr</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">clear</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">set</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> ch</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> st</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">move</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> ch</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dx</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dy</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">move</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dx</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dy</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">at</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> ch</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dx</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dy</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000">=(</span><span style="color: #0000ff">const</span><span style="color: #000000"> </span><span style="color: #000000">MeAdr</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">a</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> chroma</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> channel</span><span style="color: #000000">;</span>
<span style="color: #000000">    Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> ptr</span><span style="color: #000000">[</span><span style="color: #000000">3</span><span style="color: #000000">];</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> step</span><span style="color: #000000">[</span><span style="color: #000000">3</span><span style="color: #000000">];</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 70. MeAdr Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Method                             </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_meadr_clear">clear</a></code></p></td>
<td align="left" valign="top"><p class="table">Clears plane pointers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_meadr_set">set</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets one channel.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_meadr_move">move</a></code></p></td>
<td align="left" valign="top"><p class="table">Moves pointers in both x and y axes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_meadr_at">at</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns a pointer in a given channel with an offset of x and y pixels.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u*</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_meadr_operator">operator=</a></code></p></td>
<td align="left" valign="top"><p class="table">Preserves the chroma flag and the selected channel during object copying.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 71. MeAdr Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Name       </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>chroma</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - chroma planes are valid or a chroma address should be loaded.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>channel</code></p></td>
<td align="left" valign="top"><p class="table">Index of the active channel. Use this class member for cost calculations.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u*[3]</code></p></td>
<td align="left" valign="top"><p class="table"><code>ptr</code></p></td>
<td align="left" valign="top"><p class="table">Plane pointer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s[3]</code></p></td>
<td align="left" valign="top"><p class="table"><code>step</code></p></td>
<td align="left" valign="top"><p class="table">Plane step.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_meadr_clear" class="float">MeAdr::clear</h3>
<div class="paragraph"><p>This method clears plane pointers.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">clear</span><span style="color: #000000">();</span></tt></pre></div></div>
<h3 id="_meadr_set" class="float">MeAdr::set</h3>
<div class="paragraph"><p>This method sets one channel.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">set</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> ch</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> st</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32s ch</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Channel Y, U, or V.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp8u *pt</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Pointer to plane.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s st</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Plane step.
</p>
</td>
</tr>
</table></div>
<h3 id="_meadr_move" class="float">MeAdr::move</h3>
<div class="paragraph"><p>The method moves pointers in both x and y axes for a given channel.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">move</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> ch</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dx</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dy</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32s ch</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Channel index to move.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s dx</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- X offset.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s dy</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Y offset.
</p>
</td>
</tr>
</table></div>
<div class="paragraph"><p>The method moves pointers in both x and y axes under one of the following conditions:</p></div>
<div class="ulist"><ul>
<li>
<p>
For luma, if <code>chorma==false</code>.
</p>
</li>
<li>
<p>
For all channels, the chroma offset is two times smaller than the luma offset.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">move</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dx</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dy</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32s dx</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- X offset.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s dy</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Y offset.
</p>
</td>
</tr>
</table></div>
<h3 id="_meadr_at" class="float">MeAdr::at</h3>
<div class="paragraph"><p>This method returns a pointer in a given channel with an offset of x and y pixels.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">at</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> ch</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dx</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dy</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32s ch</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Channel index.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s dx</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- X offset.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s dy</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Y offset.
</p>
</td>
</tr>
</table></div>
<h3 id="_meadr_operator" class="float">MeAdr::operator=</h3>
<div class="paragraph"><p>This operator preserves the chroma flag and the selected channel during object copying.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000">=(</span><span style="color: #0000ff">const</span><span style="color: #000000"> </span><span style="color: #000000">MeAdr</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">a</span><span style="color: #000000">);</span></tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_mebase">MeBase</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>MeBase</code> is the base class for motion estimation. It provides the standard independent functionality, including different motion estimation and mode decision algorithms.</p></div>
<div class="listingblock">
<div class="title">MeBase definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeBase</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL_BASE</span><span style="color: #000000">(</span><span style="color: #000000">MeBase</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">MeBase</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">MeBase</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MeInitParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">par</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MeInitParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">par</span><span style="color: #000000">,</span><span style="color: #000000"> Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> ptr</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">size</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">EstimateFrame</span><span style="color: #000000">(</span><span style="color: #000000">MeParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">par</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">static</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetError</span><span style="color: #000000">(</span><span style="color: #0000ff">const</span><span style="color: #000000"> </span><span style="color: #000000">vm_char</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">msg</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> condition</span><span style="color: #000000">=</span><span style="color: #0000ff">true</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">ProcessFeedback</span><span style="color: #000000">(</span><span style="color: #000000">MeParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pPar</span><span style="color: #000000">);</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">EstimateFrameInner</span><span style="color: #000000">(</span><span style="color: #000000">MeParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">par</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EstimateMB16x16</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EstimateMB8x8</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">EstimateSkip</span><span style="color: #000000">()=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetInterpPixelType</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">EarlyExitForSkip</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EstimateInter</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">Estimate16x16Bidir</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">Estimate16x16Direct</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EstimateIntra</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">UpdateVlcTableStatistic</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeVlcTableDecision</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> </span><span style="color: #000000">MakeTransformDecisionInter</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeMBModeDecision16x16</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeMBModeDecision16x16Org</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeMBModeDecision16x16ByFB</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">ModeDecision16x16ByFBFastFrw</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">ModeDecision16x16ByFBFastBidir</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">ModeDecision16x16ByFBFullFrw</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">ModeDecision16x16ByFBFullBidir</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeSkipModeDecision16x16BidirByFB</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetModeDecision16x16BidirByFB</span><span style="color: #000000">(</span><span style="color: #000000">MeMV</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">mvF</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">mvB</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeBlockModeDecision</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeMBModeDecision8x8</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeMBModeDecision8x8Org</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeMBModeDecision8x8ByFB</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">IsSkipEnabled</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">Interpolate</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeInterpolation</span><span style="color: #000000"> interp</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> src</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeAdr</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">dst</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EstimatePointInter</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">EstimatePointAverage</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeDecisionMetrics</span><span style="color: #000000"> CostMetric</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> RefDirection0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> RefIndex0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> RefDirection1</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> RefIndex1</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv1</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">EstimatePoint</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeDecisionMetrics</span><span style="color: #000000"> CostMetric</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetCost</span><span style="color: #000000">(</span><span style="color: #000000">MeDecisionMetrics</span><span style="color: #000000"> CostMetric</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeAdr</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">src</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> ref</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">GetCost</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> src</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> ref</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> numX</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp16u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">sadArr</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetCostHDMR</span><span style="color: #000000">(</span><span style="color: #000000">MeDecisionMetrics</span><span style="color: #000000"> CostMetric</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> src</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> ref</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> </span><span style="color: #000000">GetCostRD</span><span style="color: #000000">(</span><span style="color: #000000">MeDecisionMetrics</span><span style="color: #000000"> CostMetric</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeTransformType</span><span style="color: #000000"> transf</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> src</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> ref</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">AddHeaderCost</span><span style="color: #000000">(</span><span style="color: #000000">MeCostRD </span><span style="color: #000000">&amp;,</span><span style="color: #000000"> MeTransformType </span><span style="color: #000000">*,</span><span style="color: #000000"> MeMbType</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">DownsampleOne</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> level</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> x0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> y0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> w</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> h</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeAdr</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">adr</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">DownsampleFrames</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetReferenceFrame</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> RefDirection</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> RefIndex</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetPlaneLevel</span><span style="color: #000000">(</span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeSrcAdr</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> adr</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeRefAdrFromMV</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> adr</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">MakeBlockAdr</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> level</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> BlkIdx</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> adr</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetMB16x16B</span><span style="color: #000000">(</span><span style="color: #000000">MeMbType</span><span style="color: #000000"> mbt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mvF</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mvB</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> cost</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetMB8x8</span><span style="color: #000000">(</span><span style="color: #000000">MeMbType</span><span style="color: #000000"> mbt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">[</span><span style="color: #000000">4</span><span style="color: #000000">],</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> cost</span><span style="color: #000000">[</span><span style="color: #000000">4</span><span style="color: #000000">]);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> </span><span style="color: #000000">GetChromaMV</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetMvSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000">,</span><span style="color: #000000">Ipp32s</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EstimateMbInterFullSearch</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EstimateMbInterFullSearchDwn</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EstimateMbInterOneLevel</span><span style="color: #000000">(</span><span style="color: #0000ff">bool</span><span style="color: #000000"> UpperLevel</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> level</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> x0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> x1</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> y0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> y1</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EstimateMbInterFast</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">FullSearch</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> org</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> RangeX</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> RangeY</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">DiamondSearch</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeDiamondType</span><span style="color: #000000"> dm</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">RefineSearch</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">MeCurrentMB</span><span style="color: #000000"> m_cur</span><span style="color: #000000">;</span>
<span style="color: #000000">    MePredictCalculator</span><span style="color: #000000">*</span><span style="color: #000000"> m_PredCalc</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">CheckParams</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">WeightMV</span><span style="color: #000000">(</span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> predictor</span><span style="color: #000000">);</span>

<span style="color: #000000">    MeParams</span><span style="color: #000000">*</span><span style="color: #000000">         m_par</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeInitParams</span><span style="color: #000000">      m_InitPar</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">            m_SkippedThreshold</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> m_AllocatedSize</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">m_OwnMem</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">  CostOnInterpolation</span><span style="color: #000000">[</span><span style="color: #000000">4</span><span style="color: #000000">];</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">QpToIndex</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> QP</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UniformQuant</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">LoadRegressionPreset</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> m_lambda</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeRegrFunSet</span><span style="color: #000000">  m_CurRegSet</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">LowessRegrFun</span><span style="color: #000000"> m_InterRegFunD</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">LowessRegrFun</span><span style="color: #000000"> m_InterRegFunR</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">LowessRegrFun</span><span style="color: #000000"> m_InterRegFunJ</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">LowessRegrFun</span><span style="color: #000000"> m_IntraRegFunD</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">LowessRegrFun</span><span style="color: #000000"> m_IntraRegFunR</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MvRegrFun</span><span style="color: #000000"> m_MvRegrFunR</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 72. MeBase Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type   </th>
<th align="left" valign="top">Method                                     </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mebase_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Allocates memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mebase_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Performs motion estimation for one frame or slice.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mebase_estimateframe">EstimateFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes motion estimator.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mebase_init" class="float">MeBase::Init</h3>
<div class="paragraph"><p>The method allocates memory with malloc. To free memory, call Close or destroy the object.
The method performs some basic checks for passed parameters. If the requested modes are not supported, the method returns <code>FALSE</code>.</p></div>
<div class="paragraph"><p>The method saves initialization parameters inside <code>MeBase</code> and later <code>EstimateFrame</code> checks <code>MeParams</code>. Do not violate the initialization agreement,
for example, if <code>Init</code> does not allocate memory for the downsampled images and you attempt to perform a search on the downsampled image, you get a false return of <code>EstimateFrame</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MeInitParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">par</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MeInitParams *par</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Initialization parameters.
</p>
</td>
</tr>
</table></div>
<div class="paragraph"><p>The method allocates memory from an external buffer. Use two subsequent calls of this method for a proper allocation.
The first one with a <code>NULL</code> pointer calculates the necessary memory size, and the second one with a valid pointer allocates memory.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">MeInitParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">par</span><span style="color: #000000">,</span><span style="color: #000000"> Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> ptr</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">size</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MeInitParams *par</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Initialization parameters.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp8u* ptr</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-        Pointer to an external buffer or <code>NULL</code> to calculate the necessary memory size.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s &amp;size</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-      Size of an external buffer or the necessary amount of memory.
</p>
</td>
</tr>
</table></div>
<h3 id="_mebase_close" class="float">MeBase::Close</h3>
<div class="paragraph"><p>This method closes the motion estimator and frees all allocated memory.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">();</span></tt></pre></div></div>
<h3 id="_mebase_estimateframe" class="float">MeBase::EstimateFrame</h3>
<div class="paragraph"><p>This method performs motion estimation for one frame or slice. See also <code>Init</code> and <code>MeParams</code> descriptions.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">EstimateFrame</span><span style="color: #000000">(</span><span style="color: #000000">MeParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">par</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MeParams *par</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Motion estimation parameters.
</p>
</td>
</tr>
</table></div>
<div class="sect2">
<h3 id="_mevc1">MeVC1</h3>
<hr />
<div class="paragraph"><p><code>MeVC1</code> provides the VC1 specific functionality, including the RD mode decision and the vector prediction calculation.
There are no differences in public functions in comparison with <code>MeBase</code>.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_4_2.png" alt="images/umc/umc_4_2.png" />
</div>
<div class="title">Figure 11. MeVC1 Derivation Scheme</div>
</div>
<div class="listingblock">
<div class="title">MeVC1 definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeVC1</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> MeBase</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">DYNAMIC_CAST_DECL</span><span style="color: #000000">(</span><span style="color: #000000">MeVC1</span><span style="color: #000000">,</span><span style="color: #000000">MeBase</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">MeVC1</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">EstimateSkip</span><span style="color: #000000">();</span>

<span style="color: #0000ff">protected</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">MePredictCalculatorVC1</span><span style="color: #000000"> m_PredCalcVC1</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">EstimateSkip16x16</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">EstimateSkip8x8</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetInterpPixelType</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> </span><span style="color: #000000">MakeTransformDecisionInter</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">GetCoeffMode</span><span style="color: #000000">(</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">run</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">level</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000"> </span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pTableDR</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">const</span><span style="color: #000000"> </span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pTableDL</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetAcCoeffSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">ptr</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> DC</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeTransformType</span><span style="color: #000000"> transf</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> QP</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> luma</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> intra</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetOneAcCoeffSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> level</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> run</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> QP</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> dc</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> luma</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> intra</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> last</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">QuantTrellis</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">ptr</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> DC</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeTransformType</span><span style="color: #000000"> transf</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> QP</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> luma</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> intra</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">AddHeaderCost</span><span style="color: #000000">(</span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">cost</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeTransformType</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">tansf</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMbType</span><span style="color: #000000"> MbType</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetMvSize</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dx</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> dy</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> </span><span style="color: #000000">GetCostRD</span><span style="color: #000000">(</span><span style="color: #000000">MeDecisionMetrics</span><span style="color: #000000"> CostMetric</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeTransformType</span><span style="color: #000000"> transf</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> src</span><span style="color: #000000">,</span><span style="color: #000000"> MeAdr</span><span style="color: #000000">*</span><span style="color: #000000"> ref</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">GetDcPredictor</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> BlkIdx</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> </span><span style="color: #000000">GetChromaMV</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">GetChromaMV</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">MeMV</span><span style="color: #000000"> LumaMV</span><span style="color: #000000">,</span><span style="color: #000000"> MeMV</span><span style="color: #000000">*</span><span style="color: #000000"> pChroma</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">GetChromaMVFast</span><span style="color: #000000">(</span><span style="color: #000000">MeMV</span><span style="color: #000000"> LumaMV</span><span style="color: #000000">,</span><span style="color: #000000"> MeMV </span><span style="color: #000000">*</span><span style="color: #000000"> pChroma</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 73. MeVC1 Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Method                                                             </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>MeCostRD</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mevc1_maketransformdecisioninter">MakeTransformDecisionInter</a></code></p></td>
<td align="left" valign="top"><p class="table">Selects the best transforming type for inter block.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mevc1_estimateskip">EstimateSkip</a></code></p></td>
<td align="left" valign="top"><p class="table">Makes decision for the current macroblock to code it as skipped or not.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mevc1_maketransformdecisioninter" class="float">MeVC1::MakeTransformDecisionInter</h3>
<div class="paragraph"><p>This method selects the best transforming type for inter block.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> </span><span style="color: #000000">MakeTransformDecisionInter</span><span style="color: #000000">(</span><span style="color: #000000">MeMbPart</span><span style="color: #000000"> mt</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MePixelType</span><span style="color: #000000"> pix</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> mv</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>MeMbPart mt</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-       Macro block partition. For example: 16x16 pixels, 8x8 pixels.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MePixelType pix</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Pixel type for motion estimation. For example: integer pixel, half pixel.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MeMV mv</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-           Current motion vector.
</p>
</td>
</tr>
</table></div>
<h3 id="_mevc1_estimateskip" class="float">MeVC1::EstimateSkip</h3>
<div class="paragraph"><p>This method makes decision for the current macroblock, and returns <code>TRUE</code> to code the macroblock as skipped, otherwise returns <code>FALSE</code>.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">EstimateSkip</span><span style="color: #000000">();</span></tt></pre></div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mecostrd">MeCostRD</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>MeCostRD</code> represents the Rate Distortion (RD) cost. The class keeps the rate and the distortion values for each marcroblock,
and the number of coded transformed coefficients and block partitions.</p></div>
<div class="listingblock">
<div class="title">MeCostRD definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeCostRD</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">MeCostRD</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">MeCostRD</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> x</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> R</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> D</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> J</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> NumOfCoeff</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> BlkPat</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> SbPat</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000"> </span><span style="color: #000000">+=(</span><span style="color: #0000ff">const</span><span style="color: #000000"> MeCostRD</span><span style="color: #000000">&amp;</span><span style="color: #000000"> a</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 74. MeCostRD Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Method                                 </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_mecostrd_operator">operator+=</a></code></p></td>
<td align="left" valign="top"><p class="table">Sum the costs for a macroblocks.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 75. MeCostRD Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Name       </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>R</code></p></td>
<td align="left" valign="top"><p class="table">Macroblock rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>D</code></p></td>
<td align="left" valign="top"><p class="table">Macroblock distortion.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>J</code></p></td>
<td align="left" valign="top"><p class="table">Linear combination of R and D.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>NumOfCoeff</code></p></td>
<td align="left" valign="top"><p class="table">Number of coded coefficients for macroblock on luma and chroma blocks.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>BlkPat</code></p></td>
<td align="left" valign="top"><p class="table">Block pattern, six bits are in use. 0-3 bits are for luma blocks, and 4, 5 bits are for chroma blocks).
                        The value of a bit equals one if one or more coefficients are coded for block, and equals zero if no coefficients are coded.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>SbPat</code></p></td>
<td align="left" valign="top"><p class="table">Sub-block pattern, for variable transform. For 8x8 transform only bit 0 is set, for 8x4 and 4x8 transforms bit 1 is for zero
                        sub-block, and bit 0 is for the first block.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_mecostrd_operator" class="float">MeCostRD::operator+=</h3>
<div class="paragraph"><p>This method performs the sum of the current cost for a macroblock and the cost a.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000"> </span><span style="color: #000000">+=(</span><span style="color: #0000ff">const</span><span style="color: #000000"> MeCostRD</span><span style="color: #000000">&amp;</span><span style="color: #000000"> a</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>const MeCostRD&amp; a</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- RD-cost.
</p>
</td>
</tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_meframe">MeFrame</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>MeFrame</code> represents one frame, which may be either a source or reference frame. This class simplifies the interface by grouping all frame attributes
in one class and avoids unnecessary downsampling.</p></div>
<div class="listingblock">
<div class="title">MeFrame definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeFrame</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">        processed</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeFrameType</span><span style="color: #000000"> type</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">      WidthMB</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">      HeightMB</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">      padding</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">MeAdr</span><span style="color: #000000">       plane</span><span style="color: #000000">[</span><span style="color: #000000">5</span><span style="color: #000000">];</span>

<span style="color: #000000">    </span><span style="color: #000000">MeAdr</span><span style="color: #000000">       SrcPlane</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeAdr</span><span style="color: #000000">       RecPlane</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">      NumOfMVs</span><span style="color: #000000">;</span>
<span style="color: #000000">    MeMB</span><span style="color: #000000">*</span><span style="color: #000000">       MBs</span><span style="color: #000000">;</span>
<span style="color: #000000">    MeMV</span><span style="color: #000000">*</span><span style="color: #000000">       MVDirect</span><span style="color: #000000">;</span>
<span style="color: #000000">    Ipp32s</span><span style="color: #000000">*</span><span style="color: #000000">     RefIndx</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">        StatValid</span><span style="color: #000000">;</span>
<span style="color: #000000">    MeMbStat</span><span style="color: #000000">*</span><span style="color: #000000">   stat</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> m_blockDist</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">][</span><span style="color: #000000">4</span><span style="color: #000000">];</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> m_distIdx</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">][</span><span style="color: #000000">4</span><span style="color: #000000">];</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> picture_distance</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 76. MeFrame Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                           </th>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>processed</code></p></td>
<td align="left" valign="top"><p class="table">Motion estimation already processed for this frame. It is set after motion estimation and reset by the encoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meframetype">MeFrameType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>type</code></p></td>
<td align="left" valign="top"><p class="table">Frame type, set by the encoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>WidthMB</code></p></td>
<td align="left" valign="top"><p class="table">Frame width in a macroblock. Set by the encoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>HeightMB</code></p></td>
<td align="left" valign="top"><p class="table">Frame height in a macroblock. Set by the encoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>padding</code></p></td>
<td align="left" valign="top"><p class="table">Number of pixels that are added on each side of the frame, should be less or equal to MeInitParams.refPadding
                                                    and divisible by 16. Zero is also possible.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meadr">MeAdr</a>[5]</code></p></td>
<td align="left" valign="top"><p class="table"><code>plane</code></p></td>
<td align="left" valign="top"><p class="table">Image plain. Five is the number of the downsampled levels. The encoder allocates the zero level,
                                                    which is the original picture, and motion estimation uses all the other levels. Not all levels are valid.
                                                    Pointers at all levels point to the left top pixel of the picture without padding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meadr">MeAdr</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>SrcPlane</code></p></td>
<td align="left" valign="top"><p class="table">Original uncompressed image plane. Use it for distortion calculation. It may or may not be the same as MeFrame::plane[0].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meadr">MeAdr</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>RecPlane</code></p></td>
<td align="left" valign="top"><p class="table">Reconstructed image plane. Use it for distortion calculation. It may or may not be the same as MeFrame::plane[0].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>NumOfMVs</code></p></td>
<td align="left" valign="top"><p class="table">Number of motion vectors in MBs structure. Motion estimation sets this class member, and the encoder should not change it.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_memb">MeMB</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>MBs</code></p></td>
<td align="left" valign="top"><p class="table">Estimation results for the current frame. The number of elements is equal to the number of macroblocks in the frame. Allocated by <code>MeBase</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_memv">MeMV</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>MVDirect</code></p></td>
<td align="left" valign="top"><p class="table">Direct motion vector, calculated and set by the encoder. Currently VC1 specific. Allocated by <code>MeBase</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s*</code></p></td>
<td align="left" valign="top"><p class="table"><code>RefIndx</code></p></td>
<td align="left" valign="top"><p class="table">Reference index for direct motion vectors. Currently VC1 specific. Allocated by <code>MeBase</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>StatValid</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - encoder is filled in a static array for this frame. Set by the encoder and reset after the motion estimation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_membstat">MeMbStat</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>stat</code></p></td>
<td align="left" valign="top"><p class="table">Statistics for the current frame. Filled in by the encoder. The number of elements is equal to the number of macroblocks
                                                    in the frame. Allocated by <code>MeBase</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s[2][4]</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_blockDist</code></p></td>
<td align="left" valign="top"><p class="table">Calculated as follows:<br />
                                                    If the reference block is located before the current block (in display order), m_blockDist equals the distance index of the current
                                                    block minus the distance index of the reference block, plus 512, in modulo 512 operation.<br />
                                                    If the reference block is located after the current block (in display order), m_blockDist equals the distance index of the reference
                                                    block minus the distance index of the current block, plus 512, in modulo 512 operation.<br />
                                                    m_blockDist[0][4] is for forward direction,<br />
                                                    m_blockDist[1][4] is for backward direction.<br />
                                                    AVS specific.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s[2][4]</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_distIdx</code></p></td>
<td align="left" valign="top"><p class="table">Calculated as follows:<br />
                                                    If all the pixels of a block belong to the second field (in display order) of an interlaced picture or belong to the bottom
                                                    field of a progressive picture, m_distIdx equals picture_distance*2 + 1; otherwise, m_distIdx equals picture_distance*2.<br />
                                                    m_distIdx[0][4] is for forward direction,<br />
                                                    m_distIdx[1][4] is for backward direction.<br />
                                                    AVS specific.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>picture_distance</code></p></td>
<td align="left" valign="top"><p class="table">An integer value cast from an 8-bit unsigned integer during the MeAVS initialization. This variable equals the picture_distance
                                                    of the previous picture (in display order) plus one, plus the number of skipped pictures between the current picture and the
                                                    previous picture (this number is less than 32), in modulo 256 operation. The picture_distance of the first picture of a sequence
                                                    is zero.<br />
                                                    AVS specific.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_meinitparams">MeInitParams</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>MeInitParams</code> is for the motion estimation initialization. See <code>MeBase::Init</code> for the detailed description of the motion estimation initialization.</p></div>
<div class="listingblock">
<div class="title">MeInitParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeInitParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">MeInitParams</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">            MaxNumOfFrame</span><span style="color: #000000">;</span>
<span style="color: #000000">    MeFrame</span><span style="color: #000000">*</span><span style="color: #000000">          pFrames</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">            WidthMB</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">            HeightMB</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">            refPadding</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeSearchDirection</span><span style="color: #000000"> SearchDirection</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">            MbPart</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseStatistics</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseDownSampling</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 77. MeInitParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                                       </th>
<th align="left" valign="top">Name               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>MaxNumOfFrame</code></p></td>
<td align="left" valign="top"><p class="table">Maximum number of frames to allocate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meframe">MeFrame</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>pFrames</code></p></td>
<td align="left" valign="top"><p class="table">Allocated frames. Returned after the motion estimation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>WidthMB</code></p></td>
<td align="left" valign="top"><p class="table">Frame width in a macroblock, only for memory allocation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>HeightMB</code></p></td>
<td align="left" valign="top"><p class="table">Frame height in a macroblock.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>refPadding</code></p></td>
<td align="left" valign="top"><p class="table">Reference frame padding. All values are valid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mesearchdirection">MeSearchDirection</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>SearchDirection</code></p></td>
<td align="left" valign="top"><p class="table">Search direction. Possible values: forward or bidir.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>MbPart</code></p></td>
<td align="left" valign="top"><p class="table">Macroblock partitioning, possible types: 16x16, 16x8, 8x16, 8x8, 4x4, see MeMbPart.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseStatistics</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - allocate memory for statistics, see MeFrame::stat.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseDownSampling</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - allocate memory for downsampling, see MeFrame::plane[x].</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_memb">MeMB</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>MeMB</code> represents the results of motion estimation and mode decision. <code>MeMB</code> also stores some intermediate data from motion estimation. See <code>MeFrame::MBs</code>.</p></div>
<div class="listingblock">
<div class="title">MeMB definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeMB</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">Reset</span><span style="color: #000000">(</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> numOfMVs</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">CnvertCoeffToRoundControl</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">transf</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">trellis</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">rc</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> QP</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">MeMV</span><span style="color: #000000">      </span><span style="color: #000000">*</span><span style="color: #000000">MV</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">];</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">    </span><span style="color: #000000">*</span><span style="color: #000000">Refindex</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">];</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">    </span><span style="color: #000000">*</span><span style="color: #000000">MbCosts</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">MeMV</span><span style="color: #000000">      </span><span style="color: #000000">*</span><span style="color: #000000">MVPred</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">];</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp8u</span><span style="color: #000000">     MbPart</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp8u</span><span style="color: #000000">     BlockPart</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp8u</span><span style="color: #000000">     MbType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp8u</span><span style="color: #000000">     McType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp8u</span><span style="color: #000000">     BlockType</span><span style="color: #000000">[</span><span style="color: #000000">4</span><span style="color: #000000">];</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">     BlockTrans</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> predType</span><span style="color: #000000">[</span><span style="color: #000000">4</span><span style="color: #000000">];</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">  NumOfNZ</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">  PureSAD</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> InterCostRD</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> IntraCostRD</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> DirectCostRD</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> DirectSkippedCostRD</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeCostRD</span><span style="color: #000000"> SkippedCostRD</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">  DcCoeff</span><span style="color: #000000">[</span><span style="color: #000000">6</span><span style="color: #000000">];</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> Coeff</span><span style="color: #000000">[</span><span style="color: #000000">6</span><span style="color: #000000">][</span><span style="color: #000000">64</span><span style="color: #000000">];</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 78. MeMB Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Method                                                             </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memb_cnvertcoefftoroundcontrol">CnvertCoeffToRoundControl</a></code></p></td>
<td align="left" valign="top"><p class="table">Converts trellis quantized coefficients to a round control value for each coefficient.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 79. MeMB Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                       </th>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_memv">MeMV</a>*[2]</code></p></td>
<td align="left" valign="top"><p class="table"><code>MV</code></p></td>
<td align="left" valign="top"><p class="table">Best found motion vector, 0 - forward, 1- backward, order: fwd1, fwd2, fwd3, fwd4, the number of allocated elements is <code>MeFrame::NumOfMVs</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s*[2]</code></p></td>
<td align="left" valign="top"><p class="table"><code>Refindex</code></p></td>
<td align="left" valign="top"><p class="table">Indexes for the reference frames, 0 - forward, 1 - backward.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s*</code></p></td>
<td align="left" valign="top"><p class="table"><code>MbCosts</code></p></td>
<td align="left" valign="top"><p class="table">Costs of the best motion vectors. The number of allocated elements is MeFrame::NumOfMVs + 1.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_memv">MeMV</a>*[2]</code></p></td>
<td align="left" valign="top"><p class="table"><code>MVPred</code></p></td>
<td align="left" valign="top"><p class="table">Predicted motion vector for the current macroblock, 0 - forward, 1- backward. The number of allocated elements is equal to the number
                                                    of motion vectors.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table"><code>MbPart</code></p></td>
<td align="left" valign="top"><p class="table">Macroblock partitioning, possible types: 16x16, 16x8, 8x16, 8x8, 4x4, see MeMbPart.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table"><code>BlockPart</code></p></td>
<td align="left" valign="top"><p class="table">This option is no longer supported.<br />
                                                    Block partitioning, 4x2 bits field, 00 - 8x8, 01 - 8x4, 10 - 4x8, 11 - 4x4.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table"><code>MbType</code></p></td>
<td align="left" valign="top"><p class="table">Macroblock type, see MeMbType.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table"><code>McType</code></p></td>
<td align="left" valign="top"><p class="table">This option is no longer supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table"><code>BlockType</code></p></td>
<td align="left" valign="top"><p class="table">Block type for each of 8x8 blocks. To simplify comparison between 16x16 and 8x8, use  MeMbType.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>BlockTrans</code></p></td>
<td align="left" valign="top"><p class="table">Block transforming. For example: 6x2 bit field, 00 - 8x8, 01 - 8x4, 10 - 4x8, 11 - 4x4, lowest bits 1:0 for block 0,
                                                    2:1 for block 2 and 11:10 for block 5.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u[4]</code></p></td>
<td align="left" valign="top"><p class="table"><code>predType</code></p></td>
<td align="left" valign="top"><p class="table">The following prediction types for macroblock are available in the AVS encoder for the MeAVS initialization:<br />
                                                    PredIntra = 0, PredForward = 1, PredBackward = 2, PredBiDir = 3.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>NumOfNZ</code></p></td>
<td align="left" valign="top"><p class="table">The number of non-zero blocks after transforming and quantization.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>PureSAD</code></p></td>
<td align="left" valign="top"><p class="table">Pure inter SAD without motion vector weighting. InterCostRD MeCostRD Value for inter rate and distortion prediction.
                                                    IntraCostRD MeCostRD Value for intra rate and distortion prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mecostrd">MeCostRD</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>InterCostRD</code></p></td>
<td align="left" valign="top"><p class="table">Value for inter rate and distortion prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mecostrd">MeCostRD</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>IntraCostRD</code></p></td>
<td align="left" valign="top"><p class="table">Value for intra rate and distorton prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mecostrd">MeCostRD</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>DirectCostRD</code></p></td>
<td align="left" valign="top"><p class="table">Value for direct inter rate and distortion prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mecostrd">MeCostRD</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>DirectSkippedCostRD</code></p></td>
<td align="left" valign="top"><p class="table">MeCostRD Value for direct skipped inter rate and distortion prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mecostrd">MeCostRD</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>SkippedCostRD</code></p></td>
<td align="left" valign="top"><p class="table">Value for skipped inter rate and distortion prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>DcCoeff</code></p></td>
<td align="left" valign="top"><p class="table">DC coefficients for all the six blocks, use this class member for DC prediction calculation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp16s</code></p></td>
<td align="left" valign="top"><p class="table"><code>Coeff</code></p></td>
<td align="left" valign="top"><p class="table">Quantized coefficients. Use this class member only if trellis quantization is enabled.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_memb_cnvertcoefftoroundcontrol" class="float">MeMB::CnvertCoeffToRoundControl</h3>
<div class="paragraph"><p>This method converts trellis quantized coefficients to a round control value for each coefficient.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">CnvertCoeffToRoundControl</span><span style="color: #000000">(</span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">transf</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">trellis</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">rc</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> QP</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp16s *transf</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-    Block of transformed coefficients.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp16s *trellis</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-   Block of trellis quantized coefficients.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp16s *rc</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-        Block of round control values.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>Ipp32s QP</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
-         Quantization coefficient.
</p>
</td>
</tr>
</table></div>
</div>
</div>
<div class="sect1">
<h2 id="_membstat">MeMbStat</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p>Statistics for a macroblock. This class is used in feedback implementation. Motion estimation fills in the dist field, and the encoder fills in all the other fields.</p></div>
<div class="listingblock">
<div class="title">MeMbStat definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeMbStat</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp16u</span><span style="color: #000000">  whole</span><span style="color: #000000">;</span>
<span style="color: #000000">    Ipp16u</span><span style="color: #000000">*</span><span style="color: #000000"> MVF</span><span style="color: #000000">;</span>
<span style="color: #000000">    Ipp16u</span><span style="color: #000000">*</span><span style="color: #000000"> MVB</span><span style="color: #000000">;</span>
<span style="color: #000000">    Ipp16u</span><span style="color: #000000">*</span><span style="color: #000000"> coeff</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp16u</span><span style="color: #000000">  qp</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp8u</span><span style="color: #000000">  MbType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> dist</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 80. MeMbStat Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type           </th>
<th align="left" valign="top">Name       </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp16u</code></p></td>
<td align="left" valign="top"><p class="table"><code>whole</code></p></td>
<td align="left" valign="top"><p class="table">Number of bits used for all macroblock data encoding, including motion vectors, coefficients, and any additional information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp16u*</code></p></td>
<td align="left" valign="top"><p class="table"><code>MVF</code></p></td>
<td align="left" valign="top"><p class="table">Size of each forward motion vectors, in bits, the number of allocated elements is MeFrame::NumOfMVs.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp16u*</code></p></td>
<td align="left" valign="top"><p class="table"><code>MVB</code></p></td>
<td align="left" valign="top"><p class="table">Size of each backward motion vectors, in bits, the number of allocated elements is MeFrame::NumOfMVs.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp16u*</code></p></td>
<td align="left" valign="top"><p class="table"><code>coeff</code></p></td>
<td align="left" valign="top"><p class="table">Size of coefficients, in bits, for each block. The number of elements is MeFrame::NumOfMVs. A block is a motion compensated entity,
                            not a transformation block. So if there is only one motion vector for a macroblock, then only one element is set here, even if a 4x4
                            transformation is used. This class member is to simplify the feedback implementation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp16u</code></p></td>
<td align="left" valign="top"><p class="table"><code>qp</code></p></td>
<td align="left" valign="top"><p class="table">qp used for encoding of this macroblock.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table"><code>MbType</code></p></td>
<td align="left" valign="top"><p class="table">Coded macroblock type, see MeMbType. This MbType may be different from MeFrame::MBs::MbType. The encoder receives macroblock type for
                            each macroblock in MeFrame::MBs::MbType, but the encoder may change the type during encoding, and then fill in MeMbStat::MbType.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table"><code>dist</code></p></td>
<td align="left" valign="top"><p class="table">Whole 16x16 macroblock distortion.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_memv">MeMV</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>MeMV</code> represents a motion vector, which is always in quarter pixel units.</p></div>
<div class="listingblock">
<div class="title">MeMV definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">MeMV</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">MeMV</span><span style="color: #000000">(</span><span style="color: #0000ff">int</span><span style="color: #000000"> a0</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">MeMV</span><span style="color: #000000">(</span><span style="color: #0000ff">int</span><span style="color: #000000"> a0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">int</span><span style="color: #000000"> a1</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> x</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp16s</span><span style="color: #000000"> y</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetInvalid</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">IsInvalid</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">const</span><span style="color: #000000"> MeMV</span><span style="color: #000000">&amp;</span><span style="color: #000000"> a</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000"> </span><span style="color: #000000">==</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">const</span><span style="color: #000000"> MeMV</span><span style="color: #000000">&amp;</span><span style="color: #000000"> a</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 81. MeMV Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Method                                 </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memv_setinvalid">SetInvalid</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets an invalid value to the motion vector.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memv_isinvalid">IsInvalid</a></code></p></td>
<td align="left" valign="top"><p class="table">Checks if the motion vector is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MeMV</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memv_operator_pl">operator+</a></code></p></td>
<td align="left" valign="top"><p class="table">Adds two motion vectors.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_memv_operator_eq">operator==</a></code></p></td>
<td align="left" valign="top"><p class="table">Compares two motion vectors.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 82. MeMV Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type           </th>
<th align="left" valign="top">Name       </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp16s</code></p></td>
<td align="left" valign="top"><p class="table"><code>x</code></p></td>
<td align="left" valign="top"><p class="table">Stores x coordinate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp16s</code></p></td>
<td align="left" valign="top"><p class="table"><code>y</code></p></td>
<td align="left" valign="top"><p class="table">Stores y coordinate.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_memv_setinvalid" class="float">MeMV::SetInvalid</h3>
<div class="paragraph"><p>This method sets the motion vector with an invalid value, which means the motion vector is not estimated at the moment.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetInvalid</span><span style="color: #000000">();</span></tt></pre></div></div>
<h3 id="_memv_isinvalid" class="float">MeMV::IsInvalid</h3>
<div class="paragraph"><p>This method checks if the motion vector is invalid, and returns TRUE if it is invalid.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #000000">IsInvalid</span><span style="color: #000000">();</span></tt></pre></div></div>
<h3 id="_memv_operator_pl" class="float">MeMV::operator+</h3>
<div class="paragraph"><p>This method adds two motion vectors.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #000000">MeMV</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000"> </span><span style="color: #000000">+</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">const</span><span style="color: #000000"> MeMV</span><span style="color: #000000">&amp;</span><span style="color: #000000"> a</span><span style="color: #000000">);</span></tt></pre></div></div>
<h3 id="_memv_operator_eq" class="float">MeMV::operator==</h3>
<div class="paragraph"><p>This method compares two motion vectors, and returns TRUE if they are equal.</p></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">inline</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> </span><span style="color: #0000ff">operator</span><span style="color: #000000"> </span><span style="color: #000000">==</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">const</span><span style="color: #000000"> MeMV</span><span style="color: #000000">&amp;</span><span style="color: #000000"> a</span><span style="color: #000000">);</span></tt></pre></div></div>
</div>
</div>
<div class="sect1">
<h2 id="_meparams">MeParams</h2>
<div class="sectionbody">
<hr />
<div class="paragraph"><p><code>MeParams</code> specifies the current frame estimation. All parameters should not exceed the value passed to <code>MeBase::Init</code>.</p></div>
<div class="listingblock">
<div class="title">MeParams definition</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">MeParams</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #000000">MeParams</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">SetSearchSpeed</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> Speed</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">   FirstMB</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">   LastMB</span><span style="color: #000000">;</span>

<span style="color: #000000">    MeFrame</span><span style="color: #000000">*</span><span style="color: #000000"> pSrc</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">              FRefFramesNum</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">              BRefFramesNum</span><span style="color: #000000">;</span>
<span style="color: #000000">    MeFrame</span><span style="color: #000000">*</span><span style="color: #000000"> pRefF</span><span style="color: #000000">[</span><span style="color: #000000">MAX_REF</span><span style="color: #000000">];</span>
<span style="color: #000000">    MeFrame</span><span style="color: #000000">*</span><span style="color: #000000"> pRefB</span><span style="color: #000000">[</span><span style="color: #000000">MAX_REF</span><span style="color: #000000">];</span>

<span style="color: #000000">    </span><span style="color: #000000">IppiPoint</span><span style="color: #000000">           SearchRange</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeSearchDirection</span><span style="color: #000000">   SearchDirection</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MePredictionType</span><span style="color: #000000">    PredictionType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeInterpolation</span><span style="color: #000000">     Interpolation</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeInterpolation</span><span style="color: #000000">     ChromaInterpolation</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">              MbPart</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MePixelType</span><span style="color: #000000">         PixelType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MePicRange</span><span style="color: #000000">          PicRange</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">MeDecisionMetrics</span><span style="color: #000000">   CostMetric</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeDecisionMetrics</span><span style="color: #000000">   SkippedMetrics</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">                bSecondField</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">              Quant</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">                UniformQuant</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">                ProcessSkipped</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">                ProcessDirect</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">                FieldMCEnable</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000">                UseVarSizeTransform</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseFastInterSearch</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseDownSampledImageForSearch</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseFeedback</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UpdateFeedback</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseFastFeedback</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseChromaForME</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseChromaForMD</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> ChangeInterpPixelType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> SelectVlcTables</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseTrellisQuantization</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> UseTrellisQuantizationChroma</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">//VC1 specific</span>
<span style="color: #000000">    </span><span style="color: #0000ff">bool</span><span style="color: #000000"> FastChroma</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MeVC1fieldScaleInfo</span><span style="color: #000000"> ScaleInfo</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">];</span>

<span style="color: #000000">    </span><span style="color: #008000">//VC1 specific, used for RD mode decision</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000">      MVRangeIndex</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">const</span><span style="color: #000000"> Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000">    MVSizeOffset</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">const</span><span style="color: #000000"> Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000">    MVLengthLong</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">const</span><span style="color: #000000"> Ipp32u</span><span style="color: #000000">*</span><span style="color: #000000">  DcTableLuma</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">const</span><span style="color: #000000"> Ipp32u</span><span style="color: #000000">*</span><span style="color: #000000">  DcTableChroma</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">const</span><span style="color: #000000"> Ipp8u</span><span style="color: #000000">*</span><span style="color: #000000"> ScanTable</span><span style="color: #000000">[</span><span style="color: #000000">4</span><span style="color: #000000">];</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> CbpcyTableIndex</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> MvTableIndex</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> AcTableIndex</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">MeInterpolation</span><span style="color: #000000">     OutInterpolation</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">MePixelType</span><span style="color: #000000">         OutPixelType</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> OutCbpcyTableIndex</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> OutMvTableIndex</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> OutAcTableIndex</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> SearchSpeed</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 83. MeParams Class Methods</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type       </th>
<th align="left" valign="top">Method                                         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_meparams_setsearchspeed">SetSearchSpeed</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets MeParams value to the default presets and the next speed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="hsides"
cellspacing="0" cellpadding="4">
<caption class="title">Table 84. MeParams Class Members</caption>
<col width="12%" />
<col width="12%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Name                                               </th>
<th align="left" valign="top">Type                           </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>FirstMB</code></p></td>
<td align="left" valign="top"><p class="table">Address of the first macroblock for estimation. Used for multithreading slice processing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>LastMB</code></p></td>
<td align="left" valign="top"><p class="table">Address of the last macroblock for estimation. Used for multithreading slice processing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meframe">MeFrame</a>*</code></p></td>
<td align="left" valign="top"><p class="table"><code>pSrc</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the source frame. Estimation results are returned in pSrc&#8594;MBs.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>FRefFramesNum</code></p></td>
<td align="left" valign="top"><p class="table">Number of forward reference frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>BRefFramesNum</code></p></td>
<td align="left" valign="top"><p class="table">Number of backward reference frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meframe">MeFrame</a>*[MAX_REF]</code></p></td>
<td align="left" valign="top"><p class="table"><code>pRefF</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the array of the forward reference frames, array allocated after motion estimation, frames by
                                                                                    the encoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meframe">MeFrame</a>*[MAX_REF]</code></p></td>
<td align="left" valign="top"><p class="table"><code>pRefB</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the array of the backward reference frames, array allocated after motion estimation, frames by
                                                                                    the encoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>IppiPoint</code></p></td>
<td align="left" valign="top"><p class="table"><code>SearchRange</code></p></td>
<td align="left" valign="top"><p class="table">Motion vector range in pixels. Resulting motion vector is from -4*SearchRange.z to 4*SearchRange.z-1.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mesearchdirection">MeSearchDirection</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>SearchDirection</code></p></td>
<td align="left" valign="top"><p class="table">Search direction. Possible values are: forward or bidir.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mepredictiontype">MePredictionType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>PredictionType</code></p></td>
<td align="left" valign="top"><p class="table">One possible prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meinterpolation">MeInterpolation</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>Interpolation</code></p></td>
<td align="left" valign="top"><p class="table">Interpolation type for the luma channel.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meinterpolation">MeInterpolation</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>ChromaInterpolation</code></p></td>
<td align="left" valign="top"><p class="table">Interpolation type for the chroma channel.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>MbPart</code></p></td>
<td align="left" valign="top"><p class="table">List of partitions to check. Only partitions from this list are checked.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mepixeltype">MePixelType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>PixelType</code></p></td>
<td align="left" valign="top"><p class="table">Subpixel type to search.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mepicrange">MePicRange</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>PicRange</code></p></td>
<td align="left" valign="top"><p class="table">Area where motion estimation is valid, relative to the left top pixel of the frame. Negative values are
                                                                                    possible. All the pixels of any block or macroblock remain within these borders for any resulting motion
                                                                                    vector. The top and the left ranges are inclusive. So if top_left.x==-8, then MV.x=-4*8 is the smallest
                                                                                    possible x value for a macroblock with address 0. The right and the bottom ranges are not inclusive.
                                                                                    So if bottom_right.x==720, then MV.x=4*720-4*16 is the biggest possible motion vector for a 16x16 macroblock 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_medecisionmetrics">MeDecisionMetrics</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>CostMetric</code></p></td>
<td align="left" valign="top"><p class="table">One possible prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_medecisionmetrics">MeDecisionMetrics</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>SkippedMetrics</code></p></td>
<td align="left" valign="top"><p class="table">Skipped macroblock metric.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>bSecondField</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - the current coded picture is the second field.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>Quant</code></p></td>
<td align="left" valign="top"><p class="table">Quantizer for the current picture.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UniformQuant</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - uniform quantization is used. VC1 specific.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>ProcessSkipped</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - estimate the skipped macroblock.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>ProcessDirect</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - estimate the direct macroblock.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>FieldMCEnable</code></p></td>
<td align="left" valign="top"><p class="table">This option is no longer supported. <code>TRUE</code> - field macroblock mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseVarSizeTransform</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - choose the variable size transforming for Inter blocks. VC1 specific.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseFastInterSearch</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - use the fastest possible motion estimation algorithm. This feature leads to significant speed-up and
                                                                                    to significant quality degradation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseDownSampledImageForSearch</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - enable search on downsampled pictures. This feature should be enabled in MeBase::Init. It leads to
                                                                                    significant speed-up without noticeable quality degradation. Set this variable to FALSE in a memory-tight
                                                                                    environment.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseFeedback</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - use the feedback from encoder. This feature significantly (if UseFastFeedback==false) improves quality
                                                                                    with moderate speed lost. Use it for 16x16 and 8x8 partitions, forward, backward, and bi-directional search.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UpdateFeedback</code></p></td>
<td align="left" valign="top"><p class="table"><code>FALSE</code> - use the feedback with the default presets, no actual feedback from the encoder is needed. <code>TRUE</code> -
                                                                                    update the presets by the feedback from encoder. This feature leads to quality improvement on some bizarre
                                                                                    streams with some speed degradation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseFastFeedback</code></p></td>
<td align="left" valign="top"><p class="table"><code>FALSE</code> - use a transform-based prediction method, also known as the RD mode decision. <code>TRUE</code> - use a less
                                                                                    accurate but faster prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseChromaForME</code></p></td>
<td align="left" valign="top"><p class="table">This option is no longer supported. <code>TRUE</code> - use the chrome component during motion estimation. This feature
                                                                                    leads to small quality improvement, with some speed degradation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseChromaForMD</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - use the chrome component during mode decision. Set it to <code>TRUE</code> to avoid chromatic artifacts on some
                                                                                    streams. This feature leads to significant chroma quality improvement, moderate luma quality degradation,
                                                                                    and some speed degradation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>ChangeInterpPixelType</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - allow motion estimation to select subpixel type and interpolation type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>SelectVlcTables</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - allow motion estimation to select VLC tables. This feature leads to significant speed degradation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseTrellisQuantization</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - use trellis quantization. This feature leads to significant quality improvement, and significant slowdown.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>UseTrellisQuantizationChroma</code></p></td>
<td align="left" valign="top"><p class="table"><code>TRUE</code> - use trellis quantization for chroma. This feature leads to chroma quality improvement, luma quality
                                                                                    degradation, and significant slow down.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table"><code>FastChroma</code></p></td>
<td align="left" valign="top"><p class="table">This parameter is only for VC1 encoder vector prediction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mevc1fieldscaleinfo">MeVC1fieldScaleInfo</a>[2]</code></p></td>
<td align="left" valign="top"><p class="table"><code>ScaleInfo</code></p></td>
<td align="left" valign="top"><p class="table">Structure for the field vector predictor calculation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>CbpcyTableIndex</code></p></td>
<td align="left" valign="top"><p class="table">Table index used for the previous frame coding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>MvTableIndex</code></p></td>
<td align="left" valign="top"><p class="table">Table index used for the previous frame coding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>AcTableIndex</code></p></td>
<td align="left" valign="top"><p class="table">Table index used for the previous frame coding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_meinterpolation">MeInterpolation</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>OutInterpolation</code></p></td>
<td align="left" valign="top"><p class="table">Interpolation suggested by motion estimation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_mepixeltype">MePixelType</a></code></p></td>
<td align="left" valign="top"><p class="table"><code>OutPixelType</code></p></td>
<td align="left" valign="top"><p class="table">Interpolation suggested by motion estimation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>OutCbpcyTableIndex</code></p></td>
<td align="left" valign="top"><p class="table">Best table index chosen by motion estimation for CBPCY coding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>OutMvTableIndex</code></p></td>
<td align="left" valign="top"><p class="table">Best table index chosen by motion estimation for motion vector coding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>OutAcTableIndex</code></p></td>
<td align="left" valign="top"><p class="table">Best table index chosen by motion estimation for AC coefficient coding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table"><code>SearchSpeed</code></p></td>
<td align="left" valign="top"><p class="table">Search speed, see SetSearchSpeed.</p></td>
</tr>
</tbody>
</table>
</div>
<h3 id="_meparams_setsearchspeed" class="float">MeParams::SetSearchSpeed</h3>
<div class="paragraph"><p>This method sets MeParams value to the default presets. See below for the definition of the speed:</p></div>
<div class="ulist"><ul>
<li>
<p>
-1 changes nothing, this is the expert mode.
</p>
</li>
<li>
<p>
75 and more. Fast speed search. Only the fastest features are used. This results in significant quality degradation.
</p>
</li>
<li>
<p>
25-74 Quality search. The best possible quality without full search.
</p>
</li>
<li>
<p>
0-24 Full search. This results in significant speed reduction.
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="title">Declaration</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">MeParams</span><span style="color: #000000">::</span><span style="color: #000000">SetSearchSpeed</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> Speed</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="hdlist"><div class="title">Parameters</div><table>
<tr>
<td class="hdlist1">
<code>Ipp32s Speed</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
- Search speed.
</p>
</td>
</tr>
</table></div>
</div>
</div>
<h1 id="_5_derived_classes">5. Derived Classes</h1>
<div class="paragraph"><p>This chapter contains description of the following UMC derived classes that can be arranged into four groups:</p></div>
<div class="ulist"><div class="title">Codecs</div><ul>
<li>
<p>
<code><a href="#_umc_aacdecoder">UMC::AACDecoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_aacencoder">UMC::AACEncoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_acedecoder">UMC::AC3Decoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_mp3decoder">UMC::MP3Decoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_mp3encoder">UMC::MP3Encoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_h264videodecoder">UMC::H264VideoDecoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_h264videoencoder">UMC::H264VideoEncoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_vc1videodecoder">UMC::VC1VideoDecoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_vc1videoencoder">UMC::VC1VideoEncoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_mpeg2videodecoder">UMC::MPEG2VideoDecoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_mpeg2videoencoder">UMC::MPEG2VideoEncoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_mpeg4videodecoder">UMC::MPEG4VideoDecoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_mpeg4videoencoder">UMC::MPEG4VideoEncoder</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_mjpegvideodecoder">UMC::MJPEGVideoDecoder</a></code>
</p>
</li>
</ul></div>
<div class="ulist"><div class="title">Splitters and Demuxers</div><ul>
<li>
<p>
<code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_avisplitter">UMC::AVISplitter</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_h264splitter">UMC::H264Splitter</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_vc1splitter">UMC::VC1Splitter</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code>
</p>
</li>
</ul></div>
<div class="ulist"><div class="title">Auxiliary Classes</div><ul>
<li>
<p>
<code><a href="#_umc_defaultmemoryallocator">UMC::DefaultMemoryAllocator</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_linearbuffer">UMC::LinearBuffer</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_samplebuffer">UMC::SampleBuffer</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_sceneanalyzer">UMC::SceneAnalyzer</a></code>
</p>
</li>
</ul></div>
<div class="ulist"><div class="title">Input/Output Devices</div><ul>
<li>
<p>
UMC Audio Renders
</p>
<div class="ulist"><ul>
<li>
<p>
<code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_dsoundaudiorender">UMC::DSoundAudioRender</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_fqaudiorender">UMC::FWAudioRender</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_sdlaudiorender">UMC::SDLAudioRender</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_nullaudiorender">UMC::NULLAudioRender</a></code>
</p>
</li>
</ul></div>
</li>
<li>
<p>
UMC Video Renders
</p>
<div class="ulist"><ul>
<li>
<p>
<code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_fwvideorender">UMC::FWVideoRender</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_nullvideorender">UMC::NULLVideoRender</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_dxvideorender">UMC::DXVideoRender</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_sdlvideorender">UMC::SDLVideoRender</a></code>
</p>
</li>
</ul></div>
</li>
<li>
<p>
<code><a href="#_umc_filewriter">UMC::FileWriter</a></code>
</p>
</li>
<li>
<p>
<code><a href="#_umc_filereader">UMC::FileReader</a></code>
</p>
</li>
</ul></div>
<div class="sect1">
<h2 id="_audio_codecs">Audio Codecs</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_umc_aacdecoder">UMC::AACDecoder</h3>
<div class="paragraph"><p>The AAC audio decoder performs decompression of a compressed audio stream encoded according to General Audio part of MPEG-4 audio standard. MPEG-4 AAC coding is not restricted to some fixed bit rates but supports a wide range of bit rates and variable rate coding.</p></div>
<div class="paragraph"><p>The AAC Audio standard is covered by the <a href="#ISOIEC_Main">[ISOIEC_Main]</a>, <a href="#ISOIEC_GA">[ISOIEC_GA]</a>, <a href="#ISOIEC_Am1">[ISOIEC_Am1]</a>, and <a href="#ISOIEC_AmCor">[ISOIEC_AmCor]</a> documents.</p></div>
<div class="paragraph"><p>The next figure shows the functional scheme of the decoder.</p></div>
<div class="paragraph"><p>The current implementation of AAC decoder supports the following profiles:</p></div>
<div class="ulist"><ul>
<li>
<p>
Low Complexity Profile (AAC_LC)
</p>
</li>
<li>
<p>
Long Term Prediction Profile (AAC_LTP)
</p>
</li>
<li>
<p>
Main Profile (AAC_MAIN)
</p>
</li>
<li>
<p>
Scalable Sampling Rate Profile (AAC_SSR)
</p>
</li>
<li>
<p>
Bit Sliced Arithmetic Coding Profile (AAC_BSAC)
</p>
</li>
<li>
<p>
Audio Lossless Coding Profile (AAC_ALS)
</p>
</li>
</ul></div>
<div class="paragraph"><p>The MPEG-4 SBR (Spectral Band Replication) is also supported.</p></div>
<div class="imageblock" id="_aacdecoder_functional_scheme">
<div class="content">
<img src="images/umc/umc_5_1.png" alt="images/umc/umc_5_1.png" />
</div>
<div class="title">Figure 12. AACDecoder Functional Scheme</div>
</div>
<div class="paragraph"><p>The AAC decoder has the following tools:</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 85. AAC Decoder Tools</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Tool Purpose/Name                          </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Noiseless decoding</p></td>
<td align="left" valign="top"><p class="table">Parses input data, reconstructs the quantized spectra using Huffman decoding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Inverse quantization</p></td>
<td align="left" valign="top"><p class="table">Reconstructs non-scaled spectra from quantized spectra.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Scalefactor decoding</p></td>
<td align="left" valign="top"><p class="table">Decodes scalefactors and provides multiplication non-scaled spectra on these scalefactors.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">M/S tool</p></td>
<td align="left" valign="top"><p class="table">Converts spectral pair from Mid-Side to Left-Right using information from bitstream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Perceptual noise substitution (PNS)</p></td>
<td align="left" valign="top"><p class="table">Implements noise substitution decoding on channel spectra by providing an efficient representation for noise-like signal components.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Prediction</p></td>
<td align="left" valign="top"><p class="table">Reverses the short-term prediction process carried out at the encoder. The tool is used in the MAIN profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Intensity/Coupling</p></td>
<td align="left" valign="top"><p class="table">Provides intensity stereo and coupling channel decoding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Long term prediction (LTP)</p></td>
<td align="left" valign="top"><p class="table">Reverses the long-term prediction process carried out at the encoder. The tool is used in the LTP profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Temporal noise shaping (TNS)</p></td>
<td align="left" valign="top"><p class="table">Implements a control of the fine time structure of the coding noise.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Filterbank tool</p></td>
<td align="left" valign="top"><p class="table">Provides inverse MDCT and windowing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">AAC Gain control</p></td>
<td align="left" valign="top"><p class="table">Applies a separate time domain gain control to each of the four frequency bands that have been created by the gain control PQF filterbank in the encoder. The tool is used in the SSR profile.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Derivation</div><p><code>UMC::AACDecoder</code> class is inherited from <code>UMC::AudioCodec</code> Class. The <code>UMC::AudioCodec</code> class provides basic interface for all the audio codecs.
It includes methods that perform initialization of the decoder, decompression of the frame, destroying of the decoder, etc.
<code>UMC::AACDecoder</code> class implements AAC audio decoder.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::MediaData Class, UMC::AudioData Class, UMC::BaseCodec Class, UMC::AudioCodec Class, UMC::BaseCodecParams Class, UMC::AudioCodecParams Class, UMC::MemoryAllocator Class.</p></div>
<div class="sect3">
<h4 id="_user_interface">User Interface</h4>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 86. Data Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                       </th>
<th align="left" valign="top">Type                    </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>DecodeMode</code></p></td>
<td align="left" valign="top"><p class="table"><code>enum</code></p></td>
<td align="left" valign="top"><p class="table">Type of stream container<br />
DM_UNDEF_STREAM - unknown container<br />
DM_RAW_STREAM - ADIF<br />
DM_ADTS_STREAM - ADTS</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 87. AACDecoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Performs initialization of the decoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Performs destruction of the decoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets decoder parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Performs decompression of the next audio frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets decoder into initial state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Gets stream information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetDuration</code></p></td>
<td align="left" valign="top"><p class="table">Gets decoded stream duration.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Pointer to the initialization structure. The pointer must be a <code>NULL</code> pointer or a pointer to one of the following structures:<br />
- UMC::BaseCodecParams, which contains common initialization info for all codec<br />
- UMC::AudioCodecParams, which contains common initialization info for all audio codecs, or<br />
- UMC::AACDecoderParams with more detailed AAC decoder specific parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method performs initialization of the decoder. The parameters specific for the AAC
decoder influence its behavior only if the encoded stream contains SBR extension. See detailed description of this method in Initialization section.</p></div>
<h5 id="_return_values" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to audio-specific configuration is NULL in the case of MPEG4 input stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Wrong audio-specific configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Parameters do not contain audio-specific config in the case of MPEG4 input streams.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the decoder, that is, releases all allocated resources. Close() is called from destructor. The return value is always UMC::UMC_OK.</p></div>
<h5 id="_return_values_2" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close. The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_setparams" class="float">SetParams</h4>
<div class="paragraph"><p><em>Sets decoder parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_2" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the parameters structure. The pointer must refer to the instance of <code>UMC::AACDecoderParams</code> structure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets parameters that are specific for AAC decoder (see Initialization section). This method can be called anytime during decoding.</p></div>
<h5 id="_return_values_3" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The params pointer is NULL or does not refer to the instance of UMC::AudioCodecParams structure.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Decodes next audio frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *pInData, UMC::MediaData *pOutData);</code></pre>
</div></div>
<h5 id="_parameters_3" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInData</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the input data object. The pointer must refer to the instance of the <code>UMC::MediaData</code> or <code>UMC::AudioData</code> object. The <em>pInData</em> refers to the compressed frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pOutData</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the output data object. The pointer must refer to the instance of the <code>UMC::MediaData</code> or <code>UMC::AudioData</code> object. The <em>pOutData</em> refers to the uncompressed frame.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method decodes the next audio frame. Upon successful decoding of the frame, the
pInData is moved by the number of decoded bytes.
If pOutData refers to an instance of UMC::AudioData (UMC::AudioData Class), frame
information (number of channels, sample frequency, bit rate, etc.) is stored to pOutData.</p></div>
<h5 id="_return_values_4" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the pInData or pOutData pointers is NULL. UMC_ERR_NOT_ENOUGH_DATA Input buffer does not contain enough data. UMC_ERR_NOT_ENOUGH_BUFFER Output buffer is not sufficient to accommodate data. UMC_ERR_INVALID_STREAM Input stream contains error(s). UMC_ERR_UNSUPPORTED Unsupported profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Wrong audio-specific config.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets all internal parameters to start reading from the beginning.</p></div>
<div class="paragraph"><p>This method should be used after rewind operations for successful decoding of the next frames of the same stream. For decoding of another stream, a new instance of UMC::AACDecoder should be created.</p></div>
<h5 id="_return_values_5" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Gets stream information.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *info);</code></pre>
</div></div>
<h5 id="_parameters_4" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>info</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the codec parameters object. The pointer must refer to the instance of a <code>UMC::BaseCodecParams</code> or <code>UMC::AudioCodecParams</code> object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the stream information (number of channels, sampling frequency, bit rate, etc.) corresponding to the last successfully decoded frame. Some stream characteristics, like the number of channels, bit rate, etc., may vary in different frames. If info is a pointer to a UMC::BaseCodecParams object only base information (SuggestedInputSize, SuggestedOutputSize, and level) is returned.</p></div>
<h5 id="_return_values_6" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_WRN_INFO_NOT_READY</code></p></td>
<td align="left" valign="top"><p class="table">Information is unknown yet (when the function is called before the first successful GetFrame).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getduration" class="float">GetDuration</h4>
<div class="paragraph"><p><em>Gets decoded stream duration.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetDuration(Ipp32f *p_duration);</code></pre>
</div></div>
<h5 id="_parameters_5" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>p_duration</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the destination variable for the duration value.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the decoded stream duration in seconds after the last call of Init().</p></div>
<h5 id="_return_values_7" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize AAC decoder, create an instance of the <code>UMC::AACDecoder</code> class and invoke <code>Init()</code> method.
The method accepts a pointer of type <code>UMC::BaseCodecParams</code> (see <code><a href="#_umc_basecodecparams">UMC::BaseCodecParams</a></code> Class) as its single parameter.
The pointer must be a <code>NULL</code> pointer (see below) or a pointer to one of the following structures:</p></div>
<div class="ulist"><ul>
<li>
<p>
UMC::BaseCodecParams, which contains common initialization info for all codec
</p>
</li>
<li>
<p>
UMC::AudioCodecParams, which contains common initialization info for all audio codecs, or
</p>
</li>
<li>
<p>
UMC::AACDecoderParams with more detailed AAC decoder specific parameters.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The following members of the UMC::AudioCodecParams structure determine initialization of the AAC decoder:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_info_in.stream_type</code></p></td>
<td align="left" valign="top"><p class="table">Type of encoded audio stream. AAC decoder supports two values of stream_type field: AAC_MPEG4_STREAM and UNDEF_AUDIO. AAC_MPEG4_STREAM should be used if AAC is encapsulated into MP4 data format, UNDEF_AUDIO should be used in the other cases. The default value is UNDEF_AUDIO.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pData</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData that contains initialization info.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lpMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table">Pointer that must be NULL, in this case traditional allocation is used, or pointer to UMC::MemoryAllocator object. The default value is NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Since encoded data can be encapsulated into various stream containers, there are two ways to initialize AAC decoder:</p></div>
<div class="paragraph"><div class="title">MP4 data format</div><p>Encoded data is encapsulated into MP4 data format. In this case, to receive initialization information, use <code>UMC::MP4Splitter component</code>:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACDecoder</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AudioCodecParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> spl_info</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP4Splitter</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> trNumber </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialization of MP4 Splitter</span>
<span style="color: #000000">.......</span>
<span style="color: #008000">// Get info about an mp4 file</span>
<span style="color: #000000">splitter</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">spl_info</span><span style="color: #000000">);</span>
<span style="color: #008000">// These parameters are needed for AAC decoder initialization</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in </span><span style="color: #000000">=</span><span style="color: #000000"> info</span><span style="color: #000000">.</span><span style="color: #000000">m_audio_info</span><span style="color: #000000">;</span>

<span style="color: #008000">// The first AudioData is an audio_specific_info</span>
<span style="color: #000000">splitter</span><span style="color: #000000">.</span><span style="color: #000000">GetNextAudioData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">);</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">in</span><span style="color: #000000">;</span>

<span style="color: #008000">//Initialization of AAC decoder</span>
<span style="color: #000000">decoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="paragraph"><div class="title">ADIFF/ADTS data format</div><p>Encoded data are encapsulated into ADIFF or ADTS data formats. In this case, use <code>NULL</code> pointer
as a pointer to the parameters structure or set parameters as the following:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACDecoder</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AudioCodecParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>

<span style="color: #000000">AACDecoderParams</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in</span><span style="color: #000000">.</span><span style="color: #000000">stream_type </span><span style="color: #000000">=</span><span style="color: #000000"> UNDEF_AUDIO</span><span style="color: #000000">;</span>
<span style="color: #000000">AACDecoderParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> NULL</span><span style="color: #000000">;</span>

<span style="color: #008000">//Initialization of AAC decoder</span>
<span style="color: #000000">decoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span></tt></pre></div></div>
<div class="paragraph"><p>There is another set of parameters that are specific for AAC decoder.
To use these parameters, pointer of type <code>UMC::BaseCodecParam</code> must refer to the instance of <code>UMC::AACDecoderParams</code>.
The other way to set these parameters is to use <code>SetParams</code> method immediately after decoder initialization.</p></div>
<div class="paragraph"><p>The following members of UMC::AACDecoderParams influence AAC decoder behavior:</p></div>
<div class="ulist"><ul>
<li>
<p>
ModeDecodeHEAACprofile (HEAAC_HQ_MODE | HEAAC_LP_MODE) - SBR part of AAC decoders works either in high quality mode or in low process mode.
</p>
</li>
<li>
<p>
ModeDwnsmplHEAACprofile (HEAAC_DWNSMPL_ON | HEAAC_DWNSMPL_OFF) - downsampling mode is enabled or disabled.
</p>
</li>
<li>
<p>
flag_SBR_support_lev (SBR_ENABLE | SBR_DISABLE) - SBR support is enabled or disabled; if SBR support is disabled, AAC decoder ingnores all SBR extensions.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Default parameters are HEAAC_HQ_MODE, HEAAC_DWNSMPL_ON, and SBR_ENABLE respectively.</p></div>
<div class="paragraph"><p>The parameters specific for AAC decoder determine its behavior only if the encoded stream contains an SBR extension.
See below for a usage example of these parameters</p></div>
<div class="exampleblock">
<div class="title">Example 3. AACDecoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACDecoder</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACDecoderParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> spl_info</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP4Splitter</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>

<span style="color: #000000">Ipp32s</span><span style="color: #000000"> trNumber </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialization of MP4 Splitter</span>
<span style="color: #000000">.......</span>
<span style="color: #008000">// Get info about an mp4 file</span>
<span style="color: #000000">splitter</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">spl_info</span><span style="color: #000000">);</span>
<span style="color: #008000">// These parameters are needed for AAC decoder initialization</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in </span><span style="color: #000000">=</span><span style="color: #000000"> info</span><span style="color: #000000">.</span><span style="color: #000000">m_audio_info</span><span style="color: #000000">;</span>

<span style="color: #008000">// The first AudioData is an audio_specific_info</span>
<span style="color: #000000">splitter</span><span style="color: #000000">.</span><span style="color: #000000">GetNextAudioData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">);</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">in</span><span style="color: #000000">;</span>
<span style="color: #008000">//Parameters specific for AAC decoder</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">ModeDecodeHEAACprofile </span><span style="color: #000000">=</span><span style="color: #000000"> HEAAC_HQ_MODE</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">ModeDwnsmplHEAACprofile </span><span style="color: #000000">=</span><span style="color: #000000"> HEAAC_DWNSMPL_ON</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">flag_SBR_support_lev </span><span style="color: #000000">=</span><span style="color: #000000"> SBR_ENABLE</span><span style="color: #000000">;</span>

<span style="color: #008000">//Initialization of AAC decoder</span>
<span style="color: #000000">decoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke <code>Close()</code> method. No restrictions are applied. The destructor automatically invokes <code>Close()</code> method.</p></div>
</div>
<div class="sect3">
<h4 id="_typical_usage_cases">Typical Usage Cases</h4>
<div class="paragraph"><p>Every time <code>GetFrame()</code> method is called it returns a decoded frame.
No buffering performs at the beginning of the stream and no frames are buffered during decoding.
If size of the input data is not enough, the decoder does not perform buffering and returns <code>UMC::UMC_ERR_NOT_ENOUGH_DATA</code> error value
(for more information see the description of <code>GetFrame</code> method).</p></div>
<div class="exampleblock">
<div class="title">Example 4. AACDecoder Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACDecoder</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACDecoderParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> status</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">;</span>
<span style="color: #000000">&lt;&lt;&lt;</span><span style="color: #000000">NOT</span><span style="color: #000000"> COMPLETE</span><span style="color: #000000">&gt;&gt;&gt;</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_aacencoder">UMC::AACEncoder</h3>
<div class="paragraph"><p>The AAC audio encoder performs compression of a PCM audio stream according to General Audio part of MPEG-4 audio standard.
MPEG-4 AAC coding is not restricted to some fixed bit rates but supports a wide range of bit rates and variable rate coding.</p></div>
<div class="paragraph"><p>The AAC Audio standard is covered by the <a href="#ISOIEC_Main">[ISOIEC_Main]</a>, <a href="#ISOIEC_GA">[ISOIEC_GA]</a>, <a href="#ISOIEC_Am1">[ISOIEC_Am1]</a>, and <a href="#ISOIEC_AmCor">[ISOIEC_AmCor]</a> documents.</p></div>
<div class="paragraph"><p>The next figure shows the functional scheme of the encoder.</p></div>
<div class="paragraph"><p>The current implementation of AAC encoder supports the following profiles:</p></div>
<div class="ulist"><ul>
<li>
<p>
Low Complexity Profile (AAC_LC)
</p>
</li>
<li>
<p>
Long Term Prediction Profile (AAC_LTP)
</p>
</li>
</ul></div>
<div class="paragraph"><p>The MPEG-4 SBR (Spectral Band Replication) is also supported.</p></div>
<div class="paragraph"><p>The current implementation of UMC::AACEncoder supports ADTS and ADTF stream containers and only average bit rate (ABR) mode. ABR mode means that the length of encoded frames can vary but the current bit rate does not exceed the requested bit rate. The bit rate of the encoded stream does not include overhead provided by ADTS header.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_3.png" alt="images/umc/umc_5_3.png" />
</div>
<div class="title">Figure 13. AACEncoder Functional Scheme</div>
</div>
<div class="paragraph"><div class="title">Derivation</div><p><code>UMC::AACEncoder</code> class is inherited from <a href="#_umc_audiocodec">UMC::AudioCodec</a>+ class. <a href="#_umc_audiocodec">UMC::AudioCodec</a>+ class provides basic
interface for all audio codecs.
It includes methods that perform initialization of the encoder, compression of the frame, destroying of the encoder, etc.
<code>UMC::AACEncoder</code> class implements AAC audio encoder.</p></div>
<div class="paragraph"><div class="title">See Also</div><p><code><a href="#_umc_mediadata">UMC::MediaData</a></code> class, <code><a href="#_umc_audiodata">UMC::AudioData</a></code> class, <a href="#_umc_audio_codec">UMC::AudioCodec</a>+ class,
<code><a href="#_umc_basecodecparams">UMC::BaseCodecParams</a></code> class, <code><a href="#_umc_audiocodecparams">UMC::AudioCodecParams</a></code> class, <code><a href="#_umc_aacencoderparams">UMC::AACEncoderParams</a></code> class.</p></div>
<div class="sect3">
<h4 id="_user_interface_2">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p><code>UMC::AACEncoderParams</code> class is an AAC encoder parameters class derived from <a href="#_umc_audiocodecparams">UMC::AudioCodecParams</a>+ Class.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 88. AACEncoder Params Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                       </th>
<th align="left" valign="top">Type                    Description</th>
<th align="left" valign="top">audioObjectType            </th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>AudioObjectType         AAC profile (AAC_LC or AAC_LTP)</code></p></td>
<td align="left" valign="top"><p class="table"><code>auxAudioObjectType</code></p></td>
<td align="left" valign="top"><p class="table">AudioObjectType         SBR extension enabling</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>stereo_mode</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC_AACStereoMode       Stereo coding mode</code></p></td>
<td align="left" valign="top"><p class="table">outputFormat</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_AACOuputFormat      Encoder output format (ADIF or ADTS)</code></p></td>
<td align="left" valign="top"><p class="table"><code>ns_mode</code></p></td>
<td align="left" valign="top"><p class="table">Ipp32s                  Noise shaping model</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 89. AACEncoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Performs initialization of the encoder. Close  Performs destruction of the encoder. SetParams Sets encoder parameters. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Performs compression of the next audio frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Gets stream information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets encoder into initial state. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetDuration</code></p></td>
<td align="left" valign="top"><p class="table">Gets decoded stream duration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>CheckBitRate</code></p></td>
<td align="left" valign="top"><p class="table">Checks bit rate against the valid value.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_2" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes encoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters_6" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Pointer to the initialization structure. The pointer must refer to the instance of UMC::AudioCodecParams structure or <code>UMC::AACEncoderParams</code> structure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method performs initialization of the encoder. See detailed description of this method in Initialization section.</p></div>
<h5 id="_return_values_8" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed. Some of the parameters are out of range.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The encoder failed to allocate memory for one of the internal objects or buffers, or some of the parameters are out of range.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The init pointer does not refer to the instance of UMC::AudioCodecParams or UMC::AACEncoderParams structure.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_2" class="float">Close</h4>
<div class="paragraph"><p><em>Closes encoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the encoder, that is, releases all allocated resources, etc.</p></div>
<h5 id="_return_values_9" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close. The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_getframe_2" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Encodes next audio frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *pInData, UMC::MediaData *pOutData);</code></pre>
</div></div>
<h5 id="_parameters_7" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInData</em></p></td>
<td align="left" valign="top"><p class="table">[in] Pointer to the input data object. The pointer must refer to the instance of the +UMC::MediaData. The "[in]" refers to the input PCM frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pOutData</em></p></td>
<td align="left" valign="top"><p class="table">[out] Pointer to the output data object. The pointer must refer to the instance of the UMC::MediaData. The "[out]" refers to the compressed frame.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method encodes the next audio frame. Upon successful encoding of the frame, the "in" buffer position is moved by the input frame length. If "out" already contains data, this data is overwritten.</p></div>
<h5 id="_return_values_10" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the pInData or pOutData pointers is NULL. UMC_ERR_NOT_ENOUGH_DATA Input buffer does not contain enough data. UMC_ERR_NOT_INITIALIZED The encoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_2" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Gets stream information.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *info);</code></pre>
</div></div>
<h5 id="_parameters_8" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>info</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the codec parameters object. The pointer must refer to the instance of UMC::BaseCodecParams object or UMC::AudioCodecParams object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the stream information (number of channels, sampling frequency, bit rate, etc.) corresponding to the last successfully encoded frame.</p></div>
<div class="paragraph"><p>Some stream characteristics (number of channels, bit rate) can vary in different frames. If info is a pointer to UMC::BaseCodecParams object only base information (SuggestedInputSize, SuggestedOutputSize and level) is returned.</p></div>
<h5 id="_return_values_11" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getduration_2" class="float">GetDuration</h4>
<div class="paragraph"><p><em>Returns stream duration.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetDuration(Ipp32f *p_duration);</code></pre>
</div></div>
<h5 id="_parameters_9" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>p_duration</em></p></td>
<td align="left" valign="top"><p class="table">Pointer to the destination variable for duration value.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the encoded stream duration.</p></div>
<h5 id="_return_values_12" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_checkbitrate" class="float">CheckBitRate</h4>
<div class="paragraph"><p><em>Checks bit rate against valid value.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>IppBool CheckBitRate(Ipp32s bitrate, Ipp32s &amp;ind);</code></pre>
</div></div>
<h5 id="_parameters_10" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>bitrate</em></p></td>
<td align="left" valign="top"><p class="table">Bit rate to be checked.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>ind</em></p></td>
<td align="left" valign="top"><p class="table">Not used.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method checks bit rate against a valid value.</p></div>
<div class="paragraph"><p>ippFalse Invalid bit rate
ippTrue Valid bit rate.</p></div>
</div>
<div class="sect3">
<h4 id="_usage_examples_2">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize an AAC encoder, create an instance of the <code><a href="#_umc_aacencoder">UMC::AACEncoder</a></code> class and invoke <code>Init()</code> method.
The method accepts a pointer of type <code>UMC::BaseCodecParams</code> (see <code><a href="#_umc_basecodecparams">UMC::BaseCodecParams</a></code> Class) as its single parameter.
The pointer must refer to an instance of one of the following structures:</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>UMC::AudioCodecParams</code> structure, which contains common initialization information for all audio codecs
</p>
</li>
<li>
<p>
<code>UMC::AACEncoderParams</code> with more detailed AAC encoder specific parameters.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The following members of the <code>UMC::AudioCodecParams</code> structure determine initialization of the AAC encoder:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_info_in.sample_frequency.</code></p></td>
<td align="left" valign="top"><p class="table">Sampling frequency of the input PCM stream. There is no default value for this field, so it must be specified by user. All sample frequencies specified by standard are supported. For proper encoding value of m_info_in.sample_frequency is supposed to correspond to actual stream sample frequency. Otherwise, the result of encoding is unpredictable.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_info_in.channels.</code></p></td>
<td align="left" valign="top"><p class="table">Number of channels of the input PCM stream. There is no default value for this field, so it must be specified by user. Channels number should be a positive integer number. There are no other restrictions for the number of channels for the UMC_AAC_ADIF output format. If the output format is UMC_AAC_ADTS the supported channels numbers are the following: 1, 2, 3, 4, 5, 6, 8. For proper encoding, the value of m_info_in.channels must correspond to the actual number of channels in the stream. Otherwise, the result of encoding is unpredictable.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_info_out.bitrate.</code></p></td>
<td align="left" valign="top"><p class="table">Desired bit rate, in bits. There is no default value for this field, so it must be specified by user. Any positive number is supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lpMemoryAllocator.</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the external memory allocator to be used for allocation of big internal memory blocks. If it is NULL, default internal memory allocator will be used. The default value is NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>If you want to use AAC encoder specific parameters different from the default parameters, the pointer must refer to the instance
of <code>UMC::AACEncoderParams</code> structure. The following members of the <code>UMC::AACEncoderParams</code> structure determine initialization of the AAC encoder:</p></div>
<div class="ulist"><ul>
<li>
<p>
audioObjectType - desired profile (AOT_AAC_LC or AOT_AAC_LTP). The default value is AAC_LC.
</p>
</li>
<li>
<p>
auxAudioObjectType - SBR is enabled or disabled (AOT_SBR - enabled, AOT_UNDEF - disabled, default - AOT_UNDEF).
</p>
</li>
<li>
<p>
stereo_mode - AAC audio encoder stereo mode (UMC_AAC_LR_STEREO - left/right stereo mode in all frames, UMC_AAC_JOINT_STEREO - joint stereo mode, UMC_AAC_MS_STEREO - forced mid/side stereo mode in all frames; default - UMC_AAC_LR_STEREO)
</p>
</li>
<li>
<p>
ns_mode - AAC encoder noise shaping model (0 - simple: fast, lower quality, 1 - advanced: slow, higher quality; default - 0)
</p>
</li>
<li>
<p>
outputFormat - AAC encoder output format (UMC_AAC_ADTS or UMC_AAC_ADIF, default - UMC_AAC_ADTS).
</p>
</li>
</ul></div>
<div class="paragraph"><p>If the pointer refers to the instance of <code>UMC::AACEncoderParams</code> structure, all the above members should be initialized.
Default values are used only if the pointer refers to the instance of UMC::AudioCodecParams structure.</p></div>
<div class="paragraph"><p>See next example for AAC Encoder initialization.</p></div>
<div class="exampleblock">
<div class="title">Example 5. AACEncoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACEncoder</span><span style="color: #000000"> encoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACEncoderParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>

<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in</span><span style="color: #000000">.</span><span style="color: #000000">sample_frequency </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">44100</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in</span><span style="color: #000000">.</span><span style="color: #000000">channels </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">2</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_info_out</span><span style="color: #000000">.</span><span style="color: #000000">bitrate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">128000</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">audioObjectType </span><span style="color: #000000">=</span><span style="color: #000000"> AOT_AAC_LC</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">auxAudioObjectType </span><span style="color: #000000">=</span><span style="color: #000000"> AOT_UNDEF </span><span style="color: #008000">//can only be equal to AOT_SBR or not</span>
<span style="color: #000000">                                      </span><span style="color: #008000">// equal to AOT_SBR);</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">stereo_mode </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_AAC_LR_STEREO</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">ns_mode </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">outputFormat </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_AAC_ADTS</span><span style="color: #000000">;</span>
<span style="color: #008000">//Initialization of AAC encoder</span>
<span style="color: #000000">encoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the encoder, invoke <code>Close()</code> method. No restrictions are applied. The destructor automatically invokes <code>Close()</code> method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>Every time the <code>GetFrame()</code> method is called it returns an encoded frame. If size of the input data is not enough,
the encoder does not perform buffering and returns <code>UMC::UMC_ERR_NOT_ENOUGH_DATA</code> error value (for more information see the description of <code>GetFrame</code> method).</p></div>
<div class="exampleblock">
<div class="title">Example 6. AACEncoder Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACEncoder</span><span style="color: #000000"> encoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AACEncoderParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> status</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">outMediaBuffer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AudioCodecParams</span><span style="color: #000000"> audio_codec_params</span><span style="color: #000000">;</span>
<span style="color: #008000">// initialize input and output buffer</span>
<span style="color: #000000">...</span>
<span style="color: #008000">// set encoder params (See Initialization section)</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in</span><span style="color: #000000">.</span><span style="color: #000000">sample_frequency </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">44100</span><span style="color: #000000">;</span>
<span style="color: #000000">...</span>
<span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000"> encoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">exit</span><span style="color: #000000"> </span><span style="color: #000000">(-</span><span style="color: #000000">1</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #008000">//init failed</span>
<span style="color: #000000">encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audio_codec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">Ipp32s</span><span style="color: #000000"> needSize </span><span style="color: #000000">=</span><span style="color: #000000"> audio_codec_params</span><span style="color: #000000">.</span><span style="color: #000000">m_SuggestedInputSize</span><span style="color: #000000">;</span>
<span style="color: #008000">//main loop</span>
<span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// append data to inMediaBuffer up to needSize bytes</span>
<span style="color: #000000">    size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">Append</span><span style="color: #000000">(</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> needSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        status </span><span style="color: #000000">=</span><span style="color: #000000"> encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> outMediaBuffer</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #008000">// write output data</span>
<span style="color: #000000">            </span><span style="color: #000000">Write</span><span style="color: #000000">(</span><span style="color: #000000">outMediaBuffer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(),</span><span style="color: #000000"> outMediaBuffer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">((</span><span style="color: #000000">size</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_INVALID_STREAM</span><span style="color: #000000">));</span>
<span style="color: #000000">encoder</span><span style="color: #000000">.</span><span style="color: #000000">Close</span><span style="color: #000000">();</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>There are no threading capabilities in this implementation of AAC encoder.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The decoder allocates ~500kB.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>The input data must be large enough to contain one uncompressed PCM frame.
If the size of input data is not enough to contain one uncompressed frame <code>GetFrame()</code> method fails
with <code>UMC::UMC_ERR_NOT_ENOUGH_DATA</code> return value.
The encoder moves input data pointer by the size of the uncompressed PCM frame after encoding is finished successfully.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_aac_encoder.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(IPPROOT)\include
$(CODECWS)\codec\aac_enc\include
$(CODECWS)\codec\common\include
$(CODECWS)\core\umc\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
common
</p>
</li>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippac, ippdc.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_AAC_AUDIO_ENCODER is in umc_defs.h.</p></div>
<div class="paragraph"><div class="title">Platform Specifics</div><p>The encoder uses floating-point operations.</p></div>
<div class="paragraph"><div class="title">Features and Notes</div><p>If the required bit rate is very small, the real bit rate of the output stream can be more</p></div>
<div class="paragraph"><p>The method initializes the encoder. See detailed description of this method in Initialization section.
This method can be called more than once and can be called after <code>Close()</code> method also.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_ac3decoder">UMC::AC3Decoder</h3>
<div class="paragraph"><p>The AC3 audio decoder performs decompression of a compressed audio stream encoded according to ATSC Digital Audio Compression (AC3) standard (<a href="#ATSC05">[ATSC05]</a>).</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_5.png" alt="images/umc/umc_5_5.png" />
</div>
<div class="title">Figure 14. AC3Decoder Functional Scheme</div>
</div>
<div class="paragraph"><div class="title">Derivation</div><p><code>UMC::AC3Decoder</code> class is inherited from <code>UMC::AudioCodec</code> Class. <code>UMC::AudioCodec</code> class provides basic interface for all audio codecs.
It includes methods that perform initialization of the decoder, decompression of the frame, destroying of the decoder, etc. UMC::AC3Decoder class implements AC3 audio decoder.</p></div>
<div class="paragraph"><p>See Also</p></div>
<div class="paragraph"><p>UMC::MediaData, UMC::AudioData, UMC::BaseCodec, UMC::AudioCodec, UMC::BaseCodecParams, UMC::AudioCodecParams, UMC::MemoryAllocator and UMC::AC3DecoderParams classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_3">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p>UMC::AC3DecoderParams class is an AC3 decoder parameters class derived from UMC::AudioCodecParams Class.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 90. AC3DecoderParams Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                       </th>
<th align="left" valign="top">Type                    </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>dualmonomode</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Parameter indicating how to mix output in the case of dual independent mono channel input</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>out_acmod</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">AC3 decoder output channel configuration</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>outlfeon</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Parameter indicating whether LFE channel should exist in the output of AC3 decoder</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>out_compmod</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">AC3 decoder DRC mode</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>karaokeCapable</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">AC3 decoder karaoke capable mode</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>crc_mute</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Parameter indicating whether a bad frame should be mute or restored from the previous frame</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drc_scaleLow</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32f</code></p></td>
<td align="left" valign="top"><p class="table">AC3 decoder DRC low scale factor</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drc_scaleHigh</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32f</code></p></td>
<td align="left" valign="top"><p class="table">AC3 decoder DRC high scale factor</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>gainScale</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32f</code></p></td>
<td align="left" valign="top"><p class="table">AC3 decoder output gain</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 91. AACDecoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Performs initialization of the decoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Performs destruction of the decoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets decoder parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Performs decompression of the next audio frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets decoder into initial state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Provides stream information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetDuration</code></p></td>
<td align="left" valign="top"><p class="table">Provides decoded stream duration.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_3" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters_11" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Pointer to the initialization structure. The pointer must be a NULL pointer or a pointer to one of the following structures:<br />
- UMC::BaseCodecParams, which contains common initialization info for all codec<br />
- UMC::AudioCodecParams, which contains common initialization info for all audio codecs, or<br />
- UMC::AC3DecoderParams with more detailed AC3 decoder specific parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the decoder. This method can be called more than once and can also be called after Close method.
See detailed description of this method in Initialization section.</p></div>
<h5 id="_return_values_13" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_3" class="float">Close</h4>
<div class="paragraph"><p><em>Closes decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the decoder, that is, releases all allocated resources. The return value is always UMC::UMC_OK.
The method is called from the destructor.</p></div>
<h5 id="_return_values_14" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling <code>Close</code>.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_setparams_2" class="float">SetParams</h4>
<div class="paragraph"><p><em>Sets decoder parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_12" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the parameters structure. The pointer must refer to an instance of UMC::AC3DecoderParams structure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets parameters that are specific for AC3 decoder (see Initialization section). This method can be called anytime during decoding.</p></div>
<h5 id="_return_values_15" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The params pointer is NULL or does not refer to the instance of UMC::AudioCodecParams structure.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe_3" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Decodes next audio frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *in, UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_13" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the input data object. The pointer must refer to the instance of the UMC::MediaData or UMC::AudioData object. The in refers to the compressed frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the output data object. The pointer must refer to the instance of the UMC::MediaData or UMC::AudioData object. The out refers to the uncompressed frame.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method decodes the next audio frame. Upon successful decoding of the frame, the in
pointer is moved by the number of decoded bytes.
If out refers to an instance of UMC::AudioData (UMC::AudioData Class),
frame information (number of channels, sample frequency, bit rate, etc.) is stored to out. If out already contains data, this data is overwritten.</p></div>
<h5 id="_return_values_16" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the pointers is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Input buffer does not contain enough data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Output buffer is not sufficient to accommodate data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Input stream contains error(s).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_SYNC</code></p></td>
<td align="left" valign="top"><p class="table">Required synchronization code was not found.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset_2" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets all internal parameters to start reading from the beginning.</p></div>
<div class="paragraph"><p>This method should be used after rewind operations for successful decoding of the next frames of the same stream.
For decoding of another stream, a new instance of UMC::AC3Decoder should be created or Close() and Init() should be called.</p></div>
<h5 id="_return_values_17" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_3" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Gets stream information.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *info);</code></pre>
</div></div>
<h5 id="_parameters_14" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>info</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the codec parameters object. The pointer must refer to an instance of UMC::BaseCodecParams or UMC::AudioCodecParams object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the stream information (number of channels, sampling frequency, bit rate, etc.) corresponding to the
last successfully decoded frame. Some stream characteristics, like the number of channels, bit rate, etc., may vary in
different frames. If info is a pointer to a UMC::BaseCodecParams object only base information (SuggestedInputSize, SuggestedOutputSize, and level) is returned.</p></div>
<h5 id="_return_values_18" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_WRN_INFO_NOT_READY</code></p></td>
<td align="left" valign="top"><p class="table">Information is unknown yet (when the function is called before the first successful GetFrame).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getduration_3" class="float">GetDuration</h4>
<div class="paragraph"><p><em>Gets decoded stream duration.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetDuration(Ipp32f *p_duration);</code></pre>
</div></div>
<h5 id="_parameters_15" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>p_duration</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the destination variable for the duration value.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the decoded stream duration in seconds after the last call of Init().</p></div>
<h5 id="_return_values_19" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">External Lock or Unlock failed.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_3">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize AC3 decoder, create an instance of the UMC::AC3Decoder class and invoke Init() method.
The method accepts a pointer of type UMC::BaseCodecParams (see UMC::BaseCodecParams Class) as its single parameter.
The pointer must refer to the instance of UMC::AC3DecoderParams structure, which contains common initialization info for all audio codecs
and parameters that are specific for the AC3 decoder. This pointer can also be NULL pointer.</p></div>
<div class="paragraph"><p>The following members of the UMC::AC3DecoderParams structure determine initialization of the AC3 decoder:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>dualmonomode</code></p></td>
<td align="left" valign="top"><p class="table">Parameter indicating how to mix output in the case of dual independent mono channel input.<br />
Default value is
0 - STEREO. The other values are 1 - LEFTMONO, 2 - RIGHTMONO, 3 - MIXMONO.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>out_acmod</code></p></td>
<td align="left" valign="top"><p class="table">(0 - (Ch1, Ch2) Dolby Surround compatible,<br />
1 - ( C ),<br />
2 - (L, R),<br />
3 - (L, C, R),<br />
4 - (L, R, S),<br />
5 - (L, C, R, S),<br />
6 - (L, R, SL, SR),<br />
7 - (L, C, R, SL, SR),<br />
8 - as in input (downmixing off))<br />
AC3 decoder output channel configuration. Default value is 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>outlfeon</code></p></td>
<td align="left" valign="top"><p class="table">(0 - off, 1 - on) - parameter indicating whether LFE channel should exist in the output of AC3 decoder. Default value is 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>out_compmod</code></p></td>
<td align="left" valign="top"><p class="table">(0 - CUSTOM_A, 1 - CUSTOM_D, 2 - LINE, 3 - RF) - AC3 decoder DRC mode. Default value is 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>karaokeCapable</code></p></td>
<td align="left" valign="top"><p class="table">(0, 1, 2, 3)- AC3 decoder karaoke capable mode. Default value is 3.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>crc_mute</code></p></td>
<td align="left" valign="top"><p class="table">(0 - restore, 1- mute) - parameter indicating whether a bad frame should be muted or restored from the previous frame. Default value is 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drc_scaleLow</code></p></td>
<td align="left" valign="top"><p class="table">(0 - 1) - AC3 decoder DRC low scale factor. Default value is 1.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drc_scaleHigh</code></p></td>
<td align="left" valign="top"><p class="table">(0 - 1) - AC3 decoder DRC high scale factor. Default value is 1.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>gainScale</code></p></td>
<td align="left" valign="top"><p class="table">AC3 decoder output gain. Default value is 1.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lpMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table">Pointer that must be either NULL and in this case traditional allocation is used, or Pointer to UMC::MemoryAllocator object. Default value is NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>See below for AC3Decoder initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 7. UMC::AC3Decoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AC3Decoder</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AC3DecoderParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #008000">//Parameters specific for AC3 decoder</span>
<span style="color: #008000">//5.1 mode</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">out_acmod </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">7</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">outlfeon </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #008000">//mute bad frame</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">crc_mute </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #008000">//Initialization of AC3 decoder</span>
<span style="color: #000000">decoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>Every time GetFrame() method is called it returns a decoded frame. No buffering performs at the beginning of the stream and no
frames are buffered during decoding. If size of the input data is not enough, the decoder does not perform buffering and
returns UMC::UMC_ERR_NOT_ENOUGH_DATA error value (for more information see the description of GetFrame method).</p></div>
<div class="exampleblock">
<div class="title">Example 8. AC3Decoder Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AC3Decoder</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AC3DecoderParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> status</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">outMediaBuffer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AudioCodecParams</span><span style="color: #000000"> audio_codec_params</span><span style="color: #000000">;</span>
<span style="color: #008000">// initialize input and output buffer</span>
<span style="color: #000000">...</span>
<span style="color: #008000">// set decoder params (See Initialization Examples section)</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">out_acmod </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">7</span><span style="color: #000000">;</span>
<span style="color: #000000">...</span>
<span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000"> decoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">exit</span><span style="color: #000000"> </span><span style="color: #000000">(-</span><span style="color: #000000">1</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #008000">//init failed</span>
<span style="color: #000000">decoder</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audio_codec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">Ipp32s</span><span style="color: #000000"> needSize </span><span style="color: #000000">=</span><span style="color: #000000"> audio_codec_params</span><span style="color: #000000">.</span><span style="color: #000000">m_SuggestedInputSize</span><span style="color: #000000">;</span>
<span style="color: #008000">//main loop</span>
<span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// append data to inMediaBuffer up to needSize bytes</span>
<span style="color: #000000">    size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">Append</span><span style="color: #000000">(</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> needSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        status </span><span style="color: #000000">=</span><span style="color: #000000"> decoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> outMediaBuffer</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #008000">// write output data</span>
<span style="color: #000000">            </span><span style="color: #000000">Write</span><span style="color: #000000">(</span><span style="color: #000000">outMediaBuffer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(),</span><span style="color: #000000"> outMediaBuffer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">((</span><span style="color: #000000">size</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_INVALID_STREAM</span><span style="color: #000000">));</span>
<span style="color: #000000">decoder</span><span style="color: #000000">.</span><span style="color: #000000">Close</span><span style="color: #000000">();</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_2">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>There are no threading capabilities in this implementation of AC3 decoder.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The decoder allocates ~60kB.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>The input data must be large enough to contain one compressed frame. If the size of input data is not enough to contain one compressed frame GetFrame() method fails with UMC::UMC_ERR_NOT_ENOUGH_DATA return value. The decoder moves input data pointer by the size of the compressed frame after decoding is finished successfully. The decoder overwrites data in the output buffer if this buffer is not empty.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_2">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_ac3_decoder.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(IPPROOT)\include
$(CODECWS)\codec\ac3_dec\include
$(CODECWS)\codec\common\include
$(CODECWS)\core\umc\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
common
</p>
</li>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippac.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_AC3_AUDIO_DECODER is in umc_defs.h.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_mp3decoder">UMC::MP3Decoder</h3>
<div class="paragraph"><p>UMC::MP3Decoder is a derived class intended for decompression of an audio stream encoded according to the Audio part of MPEG
standard described in documents <a href="#ISOIEC93_3">[ISOIEC93_3]</a>(MPEG-1 Audio) and <a href="#ISOIEC98">[ISOIEC98]</a>(MPEG-2 Audio).</p></div>
<div class="paragraph"><p>The following audio data are supported:</p></div>
<div class="ulist"><ul>
<li>
<p>
MPEG-1: layers I, II, III
</p>
</li>
<li>
<p>
MPEG-2, low sampling frequencies extension: layers I, II, III
</p>
</li>
<li>
<p>
MPEG-2, multichannel audio extension: layer 2, contained within the single stream
</p>
</li>
<li>
<p>
MPEG-2.5 (unofficial), extra low sampling frequencies extension: layers I, II, III.
</p>
</li>
</ul></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_7.png" alt="images/umc/umc_5_7.png" />
</div>
<div class="title">Figure 15. Algorithm Block-Diagram: Layer I and II Decoder Flow Chart</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_8.png" alt="images/umc/umc_5_8.png" />
</div>
<div class="title">Figure 16. Algorithm  Block-Diagram: Layer  Ill Decoder Flow Chart</div>
</div>
<div class="paragraph"><div class="title">Derivation</div><p>The UMC::MP3Decoder class is inherited from UMC::AudioCodec Class. UMC::AudioCodec class provides basic interface for
all audio codecs. It includes methods that perform initialization of the decoder, decompression of the frame, destroying
of the decoder, etc. UMC::MP3Decoder class implements MPEG Audio decoder.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::MediaData, UMC::AudioCodec, UMC::BaseCodecParams and UMC::MemoryAllocator classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_4">User Interface</h4>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 92. MP3Decoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes internal data for subsequent frame decoding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Gets the next frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Gets information of the audio stream under decoding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets the decoder after rewind.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetDuration</code></p></td>
<td align="left" valign="top"><p class="table">Gets the decoded stream duration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets the decoder parameters. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Closes decoding and frees all allocated resources.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_4" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes internal data for subsequent frame decoding.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters_16" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure or NULL. Currently not used.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>This method initializes the decoder. The Init method can be called after the Close
method.</p></div>
<h5 id="_return_values_20" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Wrong audio-specific configuration.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe_4" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Decodes next frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *pInData, UMC::MediaData *pOutData);</code></pre>
</div></div>
<h5 id="_parameters_17" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInData</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an object of the UMC::MediaData class or UMC::AudioData class. The pInData refers to the compressed frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pOutData</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an object of the UMC::MediaData class or UMC::AudioData class. The pOutData refers to the decompressed frame.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method decodes the next audio frame. Upon successful decoding of the frame,
pInData buffer position is moved by the number of the decoded bytes.</p></div>
<div class="paragraph"><p>If pOutData refers to an instance of UMC::AudioData, the frame information
(number of channels, sample frequency, bit rate, etc.) will be stored to pOutData.
If pOutData already contains data, it will be overwritten.</p></div>
<h5 id="_return_values_21" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One or more pointers is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">The input buffer does not contain enough data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">The output buffer is not sufficient to accommodate data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_SYNC</code></p></td>
<td align="left" valign="top"><p class="table">Failed to find a valid frame synchroword in the input stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Incorrect bitstream is provided.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_4" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Gets information of the audio stream under decoding.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *info);</code></pre>
</div></div>
<h5 id="_parameters_18" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>info</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the codec parameters object. The pointer must refer to an instance of the UMC::BaseCodecParams or UMC::AudioCodecParams object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the stream information (number of channels, sampling frequency, bit rate, etc.) corresponding to the last successfully decoded frame. Some stream characteristics (number of channels, bit rate) may vary in different frames.</p></div>
<h5 id="_return_values_22" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_WRN_INFO_NOT_READY</code></p></td>
<td align="left" valign="top"><p class="table">Information is yet unknown (when the function is called before the first successful GetFrame call).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset_3" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets the decoder after rewind.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the decoder. The method always returns UMC::UMC_OK.</p></div>
<div class="paragraph"><p>This method should be used after rewind operations for successful decoding of the next frames of the same stream.</p></div>
<div class="paragraph"><p>For decoding of another stream, a new instance of UMC::MP3Decoder should be created
(or Close() and Init() should be called).</p></div>
<h5 id="_return_values_23" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getduration_4" class="float">GetDuration</h4>
<div class="paragraph"><p><em>Gets decoded stream duration.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetDuration(Ipp32_f *p_duration);</code></pre>
</div></div>
<h5 id="_parameters_19" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>p_duration</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to duration.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns decoded stream duration in seconds.</p></div>
<h5 id="_return_values_24" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_4" class="float">Close</h4>
<div class="paragraph"><p><em>Closes decoding and frees all allocated resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method frees all resources allocated by the decoder. The return value is always
UMC::UMC_OK. The Close() is called from the destructor.</p></div>
<h5 id="_return_values_25" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be
used after calling Close. The only exception is the Init method.</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_4">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize the MPEG Audio decoder, create an instance of the UMC::MP3Decoder class and invoke Init() method with NULL argument:</p></div>
<div class="exampleblock">
<div class="title">Example 9. MP3Decoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP3Decoder</span><span style="color: #000000"> MP3Decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3Decoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>Every time the GetFrame() method is called it returns a decoded frame. No buffering performs at the beginning of the
stream and no frames are buffered during decoding. If size of the input data is not enough, the
decoder does not perform buffering and returns UMC::UMC_ERR_NOT_ENOUGH_DATA error value. For more information, see the
description of GetFrame method.</p></div>
<div class="exampleblock">
<div class="title">Example 10. MP3Decoder Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP3Decoder</span><span style="color: #000000"> MP3Decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> status</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">outMediaBuffer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AudioCodecParams</span><span style="color: #000000"> audio_codec_params</span><span style="color: #000000">;</span>
<span style="color: #008000">// initialize input and output buffer</span>
<span style="color: #000000">...</span>

<span style="color: #000000">MP3Decoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">);</span>
<span style="color: #000000">MP3Decoder</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audio_codec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">Ipp32s</span><span style="color: #000000"> needSize </span><span style="color: #000000">=</span><span style="color: #000000"> audio_codec_params</span><span style="color: #000000">.</span><span style="color: #000000">m_SuggestedInputSize</span><span style="color: #000000">;</span>
<span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// append data to inMediaBuffer up to needSize bytes</span>
<span style="color: #000000">    size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">Append</span><span style="color: #000000">(</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> needSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        status </span><span style="color: #000000">=</span><span style="color: #000000"> MP3Decoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> outMediaBuffer</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #008000">// write output data</span>
<span style="color: #000000">            </span><span style="color: #000000">Write</span><span style="color: #000000">(</span><span style="color: #000000">outMediaBuffer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(),</span><span style="color: #000000"> outMediaBuffer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">((</span><span style="color: #000000">size</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_INVALID_STREAM</span><span style="color: #000000">));</span>
<span style="color: #000000">MP3Decoder</span><span style="color: #000000">.</span><span style="color: #000000">Close</span><span style="color: #000000">();</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_3">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>No threading is currently implemented in this version of the MPEG Audio decoder.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The decoder always allocates approximately 360 kB.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>The input data must be large enough to contain one compressed frame. If the size of input data is not enough to contain one compressed frame, the GetFrame() method fails with UMC::UMC_ERR_NOT_ENOUGH_DATA return value.</p></div>
<div class="paragraph"><p>The decoder moves input data pointer by the size of the compressed frame after decoding is finished successfully. The decoder overwrites data in the output buffer, if any.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_3">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mp3dec_fp.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(IPPROOT)\include
$(CODECWS)\codec\mp3_dec\include
$(CODECWS)\codec\common\include
$(CODECWS)\core\umc\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
common
</p>
</li>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippac, ippdc, ippcorel.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_MP3_AUDIO_DECODER is in umc_defs.h.</p></div>
<div class="paragraph"><div class="title">Platform Specifics</div><p>The decoder uses floating-point operations.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_mp3encoder">UMC::MP3Encoder</h3>
<div class="paragraph"><p>UMC::MP3Encoder is a derived class intended for compression of a PCM audio stream in accordance with
the Audio part of MPEG standard described
in documents <a href="#ISOIEC93_3">[ISOIEC93_3]</a>(MPEG-1 Audio) and <a href="#ISOIEC98">[ISOIEC98]</a>(MPEG-2 Audio).</p></div>
<div class="paragraph"><p>The following compression modes are supported:</p></div>
<div class="ulist"><ul>
<li>
<p>
MPEG-1: layers I, II, III
</p>
</li>
<li>
<p>
MPEG-2, low sampling frequencies extension: layers I, II, III
</p>
</li>
<li>
<p>
MPEG-2, multichannel audio extension: layer 2, contained within the single stream
</p>
</li>
</ul></div>
<div class="paragraph"><p>See next figure for the audio encoder functional scheme.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_10.png" alt="images/umc/umc_5_10.png" />
</div>
<div class="title">Figure 17. MP3Encoder Algorithm Block-Diagram</div>
</div>
<div class="paragraph"><div class="title">Derivation</div><p>The UMC::MP3Encoder class is inherited from UMC::AudioCodec Class.
UMC::AudioCodec class provides basic interface for all audio codecs.
It includes methods that perform initialization of the encoder, compression of the frame,
destroying of the encoder, etc. UMC::MP3Encoder class implements MPEG Audio encoder.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::MediaData, UMC::BaseCodec, UMC::AudioCodec, UMC::BaseCodecParams, UMC::AudioCodecParams, UMC::MP3EncoderParams and
UMC::MemoryAllocator classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_5">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p>The UMC::MP3EncoderParams class is an MPEG Audio encoder parameters class derived from UMC::AudioCodecParams Class.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 93. MP3EncoderParams Description</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                       </th>
<th align="left" valign="top">Type                </th>
<th align="left" valign="top">Description
stereo_mode         UMC_MP3StereoMode           </th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Stereo coding mode<br />
UMC_MPA_MONO - mono<br />
UMC_MPA_LR_STEREO - left/right stereo mode<br />
UMC_MPA_MS_STEREO - mid/side stereo mode<br />
UMC_MPA_JOINT_STEREO - joint stereo mode</code></p></td>
<td align="left" valign="top"><p class="table"><code>layer</code></p></td>
<td align="left" valign="top"><p class="table">Ipp32s</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG Audio Layer</code></p></td>
<td align="left" valign="top"><p class="table"><code>mode</code></p></td>
<td align="left" valign="top"><p class="table">Ipp32s</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bit rate mode</code></p></td>
<td align="left" valign="top"><p class="table"><code>ns_mode</code></p></td>
<td align="left" valign="top"><p class="table">Ipp32s</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Noise shaping mode</code></p></td>
<td align="left" valign="top"><p class="table"><code>force_mpeg1</code></p></td>
<td align="left" valign="top"><p class="table">Ipp32s</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Force MPEG1</code></p></td>
<td align="left" valign="top"><p class="table"><code>mc_matrix_procedure</code></p></td>
<td align="left" valign="top"><p class="table">Ipp32s</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Matrix procedure</code></p></td>
<td align="left" valign="top"><p class="table"><code>mc_lfe_filter_off</code></p></td>
<td align="left" valign="top"><p class="table">Ipp32s</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 94. MP3Encoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes encoder with given parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Encodes the next frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Provides stream information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets the encoder. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetDuration</code></p></td>
<td align="left" valign="top"><p class="table">Provides encoded stream duration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets the decoder parameters. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>CheckBitRate</code></p></td>
<td align="left" valign="top"><p class="table">Checks bit rate for a valid value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Closes encoding and frees all allocated resources.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_5" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes encoder with given parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters_20" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure or NULL. Currently not used.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>This method initializes the encoder. The pointer must actually refer to an instance of
UMC::AudioCodecParams structure or UMC::MP3EncoderParams structure. The Init method can be called after the Close method.</p></div>
<h5 id="_return_values_26" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Wrong audio-specific config.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The init pointer does not refer to the instance of</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC</code></p></td>
<td align="left" valign="top"><p class="table">::AudioCodecParams structure.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe_5" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Encodes next frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *pInData, UMC::MediaData *pOutData);</code></pre>
</div></div>
<h5 id="_parameters_21" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInData</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an object of the UMC::MediaData class. The pInData refers to the input PCM data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pOutData</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an object of the UMC::MediaData class. The pOutData refers to the compressed frame.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method encodes the next audio frame. Upon successful encoding of the frame, pInData buffer position is moved by the input frame length. If pOutData already contains data, the data will be overwritten.</p></div>
<h5 id="_return_values_27" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One or more pointers is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">The input buffer does not contain enough data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">The output buffer does not contain enough space.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized. The initialization process did not start before the method is called.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">If in == NULL and there is no frames left in an internal buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_5" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Provides stream information.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *info);</code></pre>
</div></div>
<h5 id="_parameters_22" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>info</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the codec parameters object. The pointer must refer to an instance of the UMC::BaseCodecParams or UMC::AudioCodecParams object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the stream information (number of channels, sampling frequency, bit rate, etc.) corresponding to the last
successfully encoded frame.</p></div>
<h5 id="_return_values_28" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getduration_5" class="float">GetDuration</h4>
<div class="paragraph"><p><em>Provides encoded stream duration.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetDuration(Ipp32f *p_duration);</code></pre>
</div></div>
<h5 id="_parameters_23" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>p_duration</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to duration.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns encoded stream duration in seconds after last Init() call.</p></div>
<h5 id="_return_values_29" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_checkbitrate_2" class="float">CheckBitRate</h4>
<div class="paragraph"><p><em>Checks bit rate for validity.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual IppBool CheckBitRate(Ipp32s sample_rate, Ipp32s layer, Ipp32s bitrate, Ipp32s channels);</code></pre>
</div></div>
<h5 id="_parameters_24" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>sample_rate</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Sample rate of the input stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>layer</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Desired MPEG layer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>bitrate</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Bit rate to be checked.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>channels</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of channels to be checked.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method checks the bit rate validity. MPEG supports only discrete values of bit rate. See
<a href="#ISOIEC93_3">[ISOIEC93_3]</a> and <a href="#ISOIEC98">[ISOIEC98]</a> standards for reference.</p></div>
<h5 id="_return_values_30" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ippFalse</code></p></td>
<td align="left" valign="top"><p class="table">Invalid bit rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ippTrue</code></p></td>
<td align="left" valign="top"><p class="table">Valid bit rate.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_5" class="float">Close</h4>
<div class="paragraph"><p><em>Closes encoding and frees all allocated resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the encoder, releases all allocated resources, etc. The return value is always UMC::UMC_OK.
The Close() is called from the destructor.</p></div>
<h5 id="_return_values_31" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used
after calling Close. The only exception is the Init method.</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_5">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize the MPEG Audio encoder, create an instance of the UMC::MP3Encoder class and invoke
Init() method. The method accepts a pointer of UMC::BaseCodecParams type as its single parameter.
The pointer must actually refer to the instance of UMC::AudioCodecParams structure,
which contains common initialization info for all encoders, or a UMC::MP3EncoderParams structure.</p></div>
<div class="paragraph"><p>The following members of the UMC::AudioCodecParams structure affect initialization of the MPEG Audio encoder:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_info_in.sample_frequency</code></p></td>
<td align="left" valign="top"><p class="table">Sampling frequency of the input PCM stream. m_info_in.channels. Number of channels in the input PCM stream. m_info_in.channel_mask. channel configuration of the input PCM stream; if 0, the encoder
relies on the number of channels.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_info_out.bitrate</code></p></td>
<td align="left" valign="top"><p class="table">Desired bit rate, in bits. All allowable bit rates are supported except
32,000 for layer 1.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>If it is necessary to use specific MPEG audio encoder parameters different from the default parameters,
the pointer should actually refer to the instance of UMC::MP3EncoderParams structure.
The following members of the UMC::MP3EncoderParams structure affect initialization of the MPEG Audio encoder:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>layer</code></p></td>
<td align="left" valign="top"><p class="table">Desired MPEG layer (1, 2 or 3; default is 3)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>mode</code></p></td>
<td align="left" valign="top"><p class="table">Bit rate mode (0 - CBR, 1 - VBR(ABR): variable bit rate (average bit rate), default - 0)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>CBR</code></p></td>
<td align="left" valign="top"><p class="table">Constant bit rate</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VBR, ABR</code></p></td>
<td align="left" valign="top"><p class="table">Variable bit rate, average bit rate</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_force_mpeg1</code></p></td>
<td align="left" valign="top"><p class="table">Force encoder to produce MPEG1 stream (0 - disable, 1 - enable, default - 0)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>stereo_mode</code></p></td>
<td align="left" valign="top"><p class="table">MPEG Audio encoder stereo mode:<br />
- UMC_MPA_LR_STEREO - left/right stereo mode in all frames<br />
- UMC_MPA_JOINT_STEREO -  joint stereo mode<br />
- UMC_MPA_MS_STEREO - forced mid/side stereo mode in all frames. The default mode is UMC_MPA_LR_STEREO.<br />
UMC_MPA_MS_STEREO can be used only for layer 3 encoding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ns_mode</code></p></td>
<td align="left" valign="top"><p class="table">MPEG Audio layer 3 encoder noise shaping model (0 - simple: fast, lower quality,
1 - advanced: slow, higher quality, default - 0)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>mc_matrix_procedure</code></p></td>
<td align="left" valign="top"><p class="table">Multichannel encoder matrix procedure: 0, 1, 2, 3, default - 0.<br />
0, 1, 2 - MPEG1 compatible L,R channels are mixed input channels<br />
3 - MPEG1 compatible L,R channels are L,R input channels</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>mc_lfe_filter_off</code></p></td>
<td align="left" valign="top"><p class="table">LFE channel low-pass filter: 0 - filter enabled, 1 - filter disabled, default -
0.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>If the pointer actually refers to the instance of the UMC::MP3EncoderParams structure, all the above members should be initialized. Default values are used only if the pointer actually refers to the instance of the UMC::AudioCodecParams structure.</p></div>
<div class="paragraph"><p>The encoder produces MPEG1 streams for input PCM streams with sample rates
44100/48000/32000.</p></div>
<div class="paragraph"><p>By default, the encoder produces MPEG2 streams for input PCM streams with sample rates
22050/24000/16000. But if the force_mpeg1 parameter is enabled, the encoder performs
2x upsampling and produces MPEG1 streams.</p></div>
<div class="paragraph"><p>See the UMC::MP3Encoder initialization example below:</p></div>
<div class="exampleblock">
<div class="title">Example 11. MP3Encoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP3Encoder</span><span style="color: #000000"> MP3Encoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP3EncoderParams</span><span style="color: #000000"> MP3EncoderParams</span><span style="color: #000000">;</span>

<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in</span><span style="color: #000000">.</span><span style="color: #000000">sample_frequency </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">44100</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in</span><span style="color: #000000">.</span><span style="color: #000000">channels </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">2</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in</span><span style="color: #000000">.</span><span style="color: #000000">channel_mask </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">m_info_out</span><span style="color: #000000">.</span><span style="color: #000000">bitrate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">128000</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">layer </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">3</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">force_mpeg1 </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">stereo_mode </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_MPA_LR_STEREO</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">mode </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">m_ns_mode </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">mc_matrix_procedure </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">mc_lfe_filter_off </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #008000">//Initialization of MPEG Audio encoder</span>
<span style="color: #000000">MP3Encoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the encoder, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>Every time the GetFrame() method is called it returns an encoded frame. If size of the input data is not enough, the encoder does not perform buffering and returns UMC::UMC_ERR_NOT_ENOUGH_DATA error value. For more information, see the description of GetFrame() method.</p></div>
<div class="exampleblock">
<div class="title">Example 12. MP3Encoder Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP3Encoder</span><span style="color: #000000"> MP3Encoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP3EncoderParams</span><span style="color: #000000"> MP3EncoderParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> status</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">outMediaBuffer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AudioCodecParams</span><span style="color: #000000"> audio_codec_params</span><span style="color: #000000">;</span>
<span style="color: #008000">// initialize input and output buffer</span>
<span style="color: #000000">...</span>
<span style="color: #008000">// set encoder params (See Initialization examples section)</span>
<span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">.</span><span style="color: #000000">m_info_in</span><span style="color: #000000">.</span><span style="color: #000000">sample_frequency </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">44100</span><span style="color: #000000">;</span>
<span style="color: #000000">...</span>

<span style="color: #000000">MP3Encoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">MP3EncoderParams</span><span style="color: #000000">);</span>
<span style="color: #000000">MP3Encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audio_codec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">Ipp32s</span><span style="color: #000000"> needSize </span><span style="color: #000000">=</span><span style="color: #000000"> audio_codec_params</span><span style="color: #000000">.</span><span style="color: #000000">m_SuggestedInputSize</span><span style="color: #000000">;</span>
<span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// append data to inMediaBuffer up to needSize bytes</span>
<span style="color: #000000">    size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">Append</span><span style="color: #000000">(</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> needSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        status </span><span style="color: #000000">=</span><span style="color: #000000"> MP3Encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">inMediaBuffer</span><span style="color: #000000">,</span><span style="color: #000000"> outMediaBuffer</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #008000">// write output data</span>
<span style="color: #000000">            </span><span style="color: #000000">Write</span><span style="color: #000000">(</span><span style="color: #000000">outMediaBuffer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(),</span><span style="color: #000000"> outMediaBuffer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">((</span><span style="color: #000000">size</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_INVALID_STREAM</span><span style="color: #000000">));</span>
<span style="color: #000000">MP3Encoder</span><span style="color: #000000">.</span><span style="color: #000000">Close</span><span style="color: #000000">();</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_4">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>No threading is currently implemented in this version of the MPEG Audio encoder.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The encoder allocates approximately 420 kB.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>The input data must be large enough to contain one uncompressed PCM frame. If the size of input data is not enough to contain one uncompressed frame, the GetFrame() method fails with the UMC::UMC_ERR_NOT_ENOUGH_DATA return value.</p></div>
<div class="paragraph"><p>The encoder moves input data pointer by the size of the uncompressed PCM frame after encoding is finished successfully.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_4">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mp3_encoder.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(IPPROOT)\include
$(CODECWS)\codec\mp3_enc\include
$(CODECWS)\codec\common\include
$(CODECWS)\core\umc\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_video_codecs">Video Codecs</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_umc_h264videodecoder">UMC::H264VideoDecoder</h3>
<div class="paragraph"><p>UMC::H264VideoDecoder is a derived class for decoding of H.264 video streams compressed in
accordance with H.264 video compression standard ISO/IEC 14496-10 <a href="#ITUH264">[ITUH264]</a>.</p></div>
<div class="paragraph"><p>This standard is based on the entropy coding of picture data (intra coding) or difference between a
picture and a reference picture (inter or predictive coding). The decoder completely supports the
following coding profiles from the standard:</p></div>
<div class="ulist"><ul>
<li>
<p>
Baseline
</p>
</li>
<li>
<p>
Main
</p>
</li>
<li>
<p>
High
</p>
</li>
<li>
<p>
High 10
</p>
</li>
<li>
<p>
High 422.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The Extended profile is supported partially, that is, data partition and switching pictures are not supported.
The decoder provides wide opportunity to play broken, incomplete or damaged media streams.</p></div>
<div class="paragraph"><p>The decoder supports the following kinds of defects:</p></div>
<div class="ulist"><ul>
<li>
<p>
gaps in a stream
</p>
</li>
<li>
<p>
missed frame/field in a stream
</p>
</li>
<li>
<p>
missed reference frame/field in a stream
</p>
</li>
<li>
<p>
missed slice(s) in a frame/field
</p>
</li>
<li>
<p>
missed macroblock(s) in a slice(s)
</p>
</li>
<li>
<p>
corrupted source in a slice(s).
</p>
</li>
</ul></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_12.png" alt="images/umc/umc_5_12.png" />
</div>
<div class="title">Figure 18. Decoding Algorithm Diagram</div>
</div>
<div class="paragraph"><div class="title">Derivation</div><p>UMC::H264VideoDecoder class is inherited from UMC::VideoDecoder Class.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::VideoDecoder Class, UMC::VideoDecoderParams Class, UMC::BaseCodec Class, VideoData Class, UMC::MemoryAllocator Class, UMC::VideoProcessing Class, and UMC::DefaultMemoryAllocator.</p></div>
<div class="sect3">
<h4 id="_user_interface_6">User Interface</h4>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 95. H.264VideoDecoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes an instance of the UMC::H264VideoDecoder class and sets it into the "ready-to-decode" state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Provides a portion of compressed video to an instance of the class and gets a decompressed frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Gets from an initialized instance of the class information of the video stream under decoding: width, height, framerate, etc.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Sets an initialized instance of the class into the "ready-to-decode" state, resets all internal counters and all buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets specific parameters related to video decoding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ChangeVideoDecodingSpeed</code></p></td>
<td align="left" valign="top"><p class="table">Adjusts relative decoding speed, gives the decoder a hint how the decoding process is flowing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">De-initializes an instance of the class and releases all internal resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetUserData</code></p></td>
<td align="left" valign="top"><p class="table">Copy user-specific data from the stream that is being decoded.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_6" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes internal data for subsequent frame decoding.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_25" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to an object of the UMC::VideoDecoderParams class or a derived class, which contains specific information to initialize an instance of the decoder.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes internal data for subsequent frame decoding. This method returns the status code of the performed operation. The status code is of UMC::Status type.
The method must be called between construction of the H264Decoder object and the first
time decompression is done.</p></div>
<div class="paragraph"><p>Before starting initialization, the decoder calls Close method. So the Init method can be called many times in series.</p></div>
<h5 id="_return_values_32" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Incorrect betstream is provided.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization of the base class failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The operation failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe_6" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Decodes next frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *in, UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_26" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an object of the UMC::MediaData class or a derived class, which contains an encoded video portion. The minimal allowed encoded portion is a NAL unit of any type. The decoder can use only part of the provided data and updates the data amount and the data pointer of UMC::MediaData instance.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an object of the UMC::MediaData class or a derived class, which contains a buffer for a decoded picture. After successful picture decoding, the decoder updates Presentation Time Stamp (PTS) and sets amount of data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method processes the next frame. The decoder takes the source data, copies it into internal buffer, tries to decode it, and returns the status code of the performed operation. The H264 video standard uses inter-frame dependencies. That is why the decoder cannot return a decoded frame per an encoded frame. It needs to fulfill internal Decoded Picture Buffer (DPB) to be able to provide even a single decoded frame. So at the end of the decoding process the NULL input pointer is supposed to be passed into the decoder as a source to get buffered decoded frames.</p></div>
<div class="paragraph"><p>The user is supposed to allocate input and output buffers.
Both the input and output pointers should hold valid addresses of corresponding classes. An obtained decoded frame is supposed to be used only until the next GetFrame is called.
Otherwise, it requires to be copied into a separate buffer. Format of the output buffer is taken from the output UMC::VideoData object.</p></div>
<div class="paragraph"><p>The final stage of frame delivery is the color conversion and frame resizing from the internal format of the decoder into the format of the output buffer. For this purposes, the decoder calls the GetFrame method of UMC::VideoProcessing class indirectly. This way has a disadvantage of too much of memory copying.</p></div>
<div class="paragraph"><p>To avoid extra copying, the decoder can return its internal buffers from the method. For this purposes, the address of an instance of the DataPointersCopy shall be passed as a pointer to PostProcessing object. The frame taken may be used until the next GetFrame is called. The reason is that the decoder can use this buffer for new frame decoding.</p></div>
<h5 id="_return_values_33" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal buffers. During the decoding process the decoder may increase capacity of DPB and may allocate more frames. This value can be returned when allocation of an additional frame fails.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Incorrect bitstream is provided.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One or more pointers hold NULL value or the output pointer is not a UMC::VideoData class object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">The provided compressed stream portion is not enough to get even a single decoded frame. All data from a source pointer was used, the destination object is unchanged.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Object is not yet initialized. The initialization process did not start before the method is called.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_6" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Gets decoder information.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status GetInfo(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_27" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an object of the UMC::BaseCodecParams class or a derived class. The decoder fills dimensions, a frame rate, and several other parameters related to video decoding.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides information of a stream, which is being decoded. The decoder uses video stream parameters of the latest successfully decoded frame and fills a provided UMC::BaseCodecParams class instance.</p></div>
<div class="paragraph"><p>The user is supposed to allocate memory for info buffers.</p></div>
<div class="paragraph"><p>This method may be called only after the decoder initialization or even after the first frame decoding. Format of H264 streams allows many headers to follow each other, and the format could be changed from header to header completely. That is why this method could provide the most exact format information only before a successful  GetFrame call.</p></div>
<h5 id="_return_values_34" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Object is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset_4" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets an instance of the class into the initial state, like after the initialization process. The method does not release internal resource but sets all counters and flags into the initial state and marks all decoded frames as displayed.</p></div>
<div class="paragraph"><p>This method is similar to a pair of Close-Init methods, except for repeated passing of parameters.</p></div>
<h5 id="_return_values_35" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Object is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_setparams_3" class="float">SetParams</h4>
<div class="paragraph"><p><em>Sets specific parameters in decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_28" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. A pointer to an instance of UMC::BaseCodecParams or a derived class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>This method slightly changes behavior of the decoder by setting a maximum supported level/profile or through enabling/disabling the trick mode. An instance of the UMC::BaseCodecParams, UMC::VideoDecoderParams, UMC::H264VideoDecoderParams classes may be used to provide the decoder different detail levels of information.</p></div>
<h5 id="_return_values_36" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One or more pointers hold a NULL value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Object is not yet initialized. The initialization process did not start before the method is called.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_changevideodecodingspeed" class="float">ChangeVideoDecodingSpeed</h4>
<div class="paragraph"><p><em>Changes video decoding speed.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status ChangeVideoDecodingSpeed(Ipp32s &amp;num);</code></pre>
</div></div>
<h5 id="_parameters_29" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>num</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Reference to integer value indicating changes to video decoding speed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method relatively adjusts the decoding speed and the skipping algorithm.</p></div>
<div class="paragraph"><p>The decoder supports different speeds of decoding. The slowest speed is 0, when the decoder decodes everything, skipping nothing. The fastest speed is 7, when the decoder processes key frames mostly, without any post processing. The owning application may change decoding speed from 0 to 7 smoothly, choosing the most suitable speed.</p></div>
<h5 id="_return_values_37" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Object is not yet initialized. The initialization process did not start before the method is called.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getuserdata" class="float">GetUserData</h4>
<div class="paragraph"><p><em>Copies user&#8217;s data associated within a stream to the given media buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status GetUserData(UMC::MediaData *pUD);</code></pre>
</div></div>
<h5 id="_parameters_30" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pUD</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. A pointer that holds an address of the UMC::MediaData class instance.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>This method provides user information that is stored in a stream. It utilizes user_data_registered_itu_t_t35 SEI message. The decoder provides a pointer to the internal buffer with user information. The obtained data is valid until the next GetUserData call.</p></div>
<h5 id="_return_values_38" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer was passed to the method.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">No available data to provide to the user.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Object is not yet initialized. The initialization process did not start before the method&#8217;s call.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_6" class="float">Close</h4>
<div class="paragraph"><p><em>Closes decoding and frees all allocated resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method de-initializes the object, frees all allocated memory and releases all internal resources. This method is optional to use, because it is called from the Init method and destructor automatically.</p></div>
<h5 id="_return_values_39" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_6">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize H.264 video decoder, create an instance of the UMC::H264Decoder class and invoke Init() method.</p></div>
<div class="paragraph"><p>Only a few members of the class are used to pass parameters into the decoder instance:</p></div>
<div class="paragraph"><p>numThreads. This field is used to pass a number of desired computing internal threads. The
0 value can be used to delegate decision on the number of threads to the decoder.</p></div>
<div class="paragraph"><p>lpMemoryAllocator. This pointer is used to pass an address of the external memory manager. When it is NULL, the decoder uses a memory manager of its own. For this purpose, the decoder creates a UMC::DefaultMemoryAllocator instance and uses it during decompression.</p></div>
<div class="paragraph"><p>m_pData. This pointer holds an address of the first encoded frame (or of a header only) to let the decoder know dimensions of the video stream under decoding. If this pointer is NULL, the decoder is initialized, but no output format can be retrieved.</p></div>
<div class="paragraph"><p>There are two types of video sources: an MPEG2 system streams and MP4 containers, so appropriate stream identification should be used. Set info.stream_subtype variable to UMC::AVC1_VIDEO value to show that a stream under decoding is from an MP4 container. Otherwise, leave this field empty.</p></div>
<div class="paragraph"><p>When default parameters are used the decoder is initialized in the following way:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Non-fixed number of internal threads is obtained.
</p>
</li>
<li>
<p>
An instance of the UMC::DefaultMemoryManager class is created as a memory manager.
</p>
</li>
<li>
<p>
Default initializations are preformed (decoding format cannot be provided).
</p>
</li>
</ol></div>
<div class="paragraph"><p>In this realization, the number of internal decoding threads created by the decoder equals the number of available CPUs (both physical and logical).</p></div>
<div class="paragraph"><p>Initialization parameters should be set before Init call. See Example 5-11 for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 13. H.264 Decoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264VideoDecoder</span><span style="color: #000000"> videoDec</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> videoParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseSplitter</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pSpl</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> mediaSrc</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">ColorSpaceConversion</span><span style="color: #000000"> colorConverter</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #008000">// initialization of the splitter</span>
<span style="color: #000000">...</span>
<span style="color: #000000">pSpl </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">CreateSplitter</span><span style="color: #000000">(...);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">NULL </span><span style="color: #000000">==</span><span style="color: #000000"> pSpl</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_ALLOC</span><span style="color: #000000">;</span>
<span style="color: #008000">// get the first encoded media portion</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pSpl</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetNextVideoData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>

<span style="color: #008000">// initialization of the decoder</span>
<span style="color: #000000">videoParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">;</span>
<span style="color: #000000">videoParams</span><span style="color: #000000">.</span><span style="color: #000000">pPostProcessing </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">colorConverter</span><span style="color: #000000">;</span>
<span style="color: #000000">videoParams</span><span style="color: #000000">.</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// the decoders will choose the number of threads</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> videoDec</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. The destructor automatically invokes
Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>Typically, objects of the UMC::H264VideoDecoder class are used for consecutive frame decoding. See Example 5-12 for the main working cycle code.</p></div>
<div class="exampleblock">
<div class="title">Example 14. H.264 Decoder Main Working Cycle</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoRenderParams</span><span style="color: #000000"> rndParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoRender</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pRnd</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> videoDst</span><span style="color: #000000">;</span>

<span style="color: #008000">// create &amp; initialize the render using parameters of a stream being decoded</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> videoDec</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoParams</span><span style="color: #000000">);</span>
<span style="color: #000000">rndParams</span><span style="color: #000000">.</span><span style="color: #000000">info </span><span style="color: #000000">=</span><span style="color: #000000"> videoParams</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">;</span>
<span style="color: #000000">...</span>
<span style="color: #008000">// create a video render</span>
<span style="color: #000000">pRnd </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">CreateVideoRender</span><span style="color: #000000">(...);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">NULL </span><span style="color: #000000">==</span><span style="color: #000000"> pRnd</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_ALLOC</span><span style="color: #000000">;</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pRnd</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">rndParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>

<span style="color: #008000">//</span>
<span style="color: #008000">// MAIN WORKING CYCLE</span>
<span style="color: #008000">//</span>
<span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// get the next portion of encoded data. Sometimes there are a few bytes</span>
<span style="color: #000000">    </span><span style="color: #008000">// remaining from the previous call.</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">4</span><span style="color: #000000"> </span><span style="color: #000000">&gt;</span><span style="color: #000000"> mediaData</span><span style="color: #000000">.</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">())</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pSpl</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetNextVideoData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_END_OF_STREAM </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #008000">// get an output buffer</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pRnd</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_BUFFER </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">1</span><span style="color: #000000">);</span><span style="color: #000000"> </span><span style="color: #008000">// sleep for a while, waiting for a free buffer</span>
<span style="color: #000000">        </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_BUFFER </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// try to decode a frame</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> videoDec</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaSrc</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// a frame was decoded successfully</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pRnd</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// just correct return value for UMC::UMC_ERR_NOT_ENOUGH_DATA</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>Multiple calls of the LockInputBuffer method is not an issue because this method can be re-entered as it is inherited from the MediaReceiver interface.</p></div>
<div class="paragraph"><p>After successful stream decoding, all buffered frames should be obtained from the decoder. See Example 5-13 for the finishing cycle code.</p></div>
<div class="exampleblock">
<div class="title">Example 15. H.264 Decoder Finishing Cycle</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #008000">//</span>
<span style="color: #008000">// FINISHING CYCLE</span>
<span style="color: #008000">//</span>
<span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// get an output buffer</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pRnd</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_BUFFER </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">1</span><span style="color: #000000">);</span><span style="color: #000000"> </span><span style="color: #008000">// sleep for a while, waiting for a free buffer</span>
<span style="color: #000000">        </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_BUFFER </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// try to get a buffered frame</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> videoDec</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// a frame was taken successfully</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pRnd</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span>
<span style="color: #000000">        </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_5">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>The decoder uses three types of threading: functional, spatial, and temporal. Combining these 3 types, the decoder can
reach high performance on multi-processors systems for streams of different types.</p></div>
<div class="paragraph"><p>The functional type is based on decomposition of slice decoding process into several operations like decoding and reconstruction. See  Figure 5-14.</p></div>
<div class="paragraph"><p>The spatial type involves independent decoding of different slices within a frame. This type is not used with frames that have a single slice. See Figure 5-15.</p></div>
<div class="paragraph"><p>Temporal threading involves independent decoding of different slices from several frames. This type is useful when a wide bandwidth stream is being decoded.</p></div>
<div class="paragraph"><p>It is important to know that using threading abilities of the decoder leads to an increase in the delay of the first successfully decoded frame, because the decoder collects several frames to get more efficient threading. Usually the delay increase is proportional to the number of active processors.</p></div>
<div class="paragraph"><p>All threading algorithms of distributing working tasks between threads are "hard-coded" and based on threading API (posix/WinAPI).</p></div>
<div class="paragraph"><p>All internal threads have the priority equal to UMC::VM_THREAD_PRIORITY_NORMAL value.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_14.png" alt="images/umc/umc_5_14.png" />
</div>
<div class="title">Figure 19. Functional Parallelization</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_15.png" alt="images/umc/umc_5_15.png" />
</div>
<div class="title">Figure 20. Spatial Parallelization</div>
</div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The decoder generally allocates memory only for frame data. There are pixels values, motion vectors values, and etc. For this purpose, the decoder uses the given memory manager. Using the manager provides a more flexible way to memory consumption and allows the decoder to use the memory as much as the decoder needs, returning all extra unused memory back to the application.</p></div>
<div class="paragraph"><p>The decoder allocates a large amount of dynamic memory roughly estimated as follows. Dimension of the frame is multiplied by weight (1.0 for YUV400 format, 1.5 for YUV420 format, 2.0 for YUV422 format, 3.0 for YUV444 format), which is increased by 10, and by the number of frames in the decoded frames buffer (DPB). Note that the DPB size can vary in wide range, from 1 to 16. Besides, there is some overhead, because the decoder has to collect all encoded data.</p></div>
<div class="paragraph"><p>Typical memory usage in case of QVGA stream is 320x240x(10+1.5)x8=~7Mb.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>Most H264 streams have inter-frame dependency. That is why the decoder does not produce an output immediately after receiving of the first encoding data. The H264 standard has the special term - decoded pictures buffer size (DPB size). It means the depth of the buffer of the decoded pictures that are used for temporal prediction (motion compensation). So the decoder does not provide any decoded frame until the DP buffer is full.</p></div>
<div class="paragraph"><p>Note that H264 streams may contain a changing media stream. For this reason, the decoder may require additional encoded data, returning UMC::UMC_ERR_NOT_ENOUGH_DATA in the middle of a stream, or provide several frames without consuming any encoded data.</p></div>
<div class="paragraph"><p>At the end of decoding, getting buffered frames from the decoder is recommended. Pass a NULL value as a pointer to the source media data to the GetFrame method as many times as the decoder returns the UMC::UMC_OK value.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_5">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_h264_dec.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include
$(CODECWS)\core\umc\include
$(CODECWS)\codec\color_space_converter\include
$(IPPROOT)\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
color_space_converter
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippi, ippvc, ippcore.</p></div>
<div class="paragraph"><div class="title">Compiler Specifics</div><p>The decoder is written with templates. So its compilation may take a long time and a lot of memory. Note that Intel&#174; compiler
9.X takes about 500Mb of RAM to compile the decoder.</p></div>
</div>
<div class="sect3">
<h4 id="_features_and_notes">Features and Notes</h4>
<div class="ulist"><div class="title">Known limitations:</div><ul>
<li>
<p>
Decoder supports decoding of files created by JM9.2 (or higher) compliant encoders.
</p>
</li>
<li>
<p>
Decoder supports baseline, main, extended, high, high 10, and high 422 profiles features.
</p>
</li>
<li>
<p>
Advanced 444 and 444 profiles are not supported.
</p>
</li>
<li>
<p>
Slice Data Partitioning is not supported.
</p>
</li>
<li>
<p>
SI and SP slice types are not supported.
</p>
</li>
<li>
<p>
Annex D - SEI (Supplemental Enhancement Information) is not supported.
</p>
</li>
<li>
<p>
Annex E - VUI (Video Usability Information) is not supported.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_h264videoencoder">UMC::H264VideoEncoder</h3>
<div class="paragraph"><p>The H.264 Video Encoder is a derived class for encoding of H.264 video data. The encoding process is described in the documents ITU
Recommendation H.264 (<a href="#ITUH264">[ITUH264]</a>) or ISO/IEC 14496-10:2005 (E) (<a href="#ISO/IEC_10">[ISO/IEC_10]</a>).</p></div>
<div class="paragraph"><div class="title">Derivation</div><p>UMC::H264VideoEncoder class is inherited from UMC::VideoEncoder Class.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::MediaData, UMC::VideoData, UMC::H264VideoDecoder, UMC::VideoEncoder, UMC::VideoEncoderParams, UMC::H264EncoderParams and UMC::BaseCodec classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_7">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p>The EncoderType enumerator (typedef enum {&#8230;} EncoderType;) is used to specify a type of encoder depending on type of data to be processed.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 96. EncoderType Values</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Value      </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>H264_VIDEO_ENCODER_8U_16S =0</code></p></td>
<td align="left" valign="top"><p class="table">video encoder with pixel type of 8 unsigned bits and coefficients type of 16 signed bits</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H264_VIDEO_ENCODER_16U_32S =1</code></p></td>
<td align="left" valign="top"><p class="table">video encoder with pixel type of 16 unsigned bits and coefficients type of 32 signed bits</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>H264_VIDEO_ENCODER_NONE =2</code></p></td>
<td align="left" valign="top"><p class="table">another video encoder</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Member Functions</div><p>See UMC::BaseCodec Class, UMC::VideoEncoder Class.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 97. H.264Encoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes the encoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Releases all codec resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets encoder parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Returns encoder parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Passes a frame to encode and gets an encoded frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets encoder state. Currently not supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetReconstructedFrame</code></p></td>
<td align="left" valign="top"><p class="table">Provides reconstructed frame.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_7" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_31" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to an object of either UMC::VideoEncoderParams class or UMC::H264EncoderParams class, which contains encoding parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method chooses a type of the internal structure according to the given encoding parameters and initializes it. The method allocates necessary memory.</p></div>
<div class="paragraph"><p>The params parameter should be a pointer to an instance of UMC::VideoEncoderParams or UMC::H264EncoderParams class. Otherwise, no initialization occurs. If params is a pointer to an instance of UMC::VideoEncoderParams, other encoding parameters not given by params keep their default values.</p></div>
<h5 id="_return_values_40" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Method is unable to allocate enough memory needed for internal structures.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed. An instance of a class other than UMC::VideoEncoderParams class or UMC::H264EncoderParams class is passed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The params parameter is NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_7" class="float">Close</h4>
<div class="paragraph"><p><em>Closes encoding and releases all allocated resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes encoding and releases all the resources allocated by the encoder.</p></div>
<h5 id="_return_values_41" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_setparams_4" class="float">SetParams</h4>
<div class="paragraph"><p><em>Changes encoding parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_32" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to an object of UMC::VideoEncoderParams class or UMC::H264EncoderParams class, which contains encoding parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method changes only the bit rate and only if H264_RCM_MPEG2 rate control method is used. If params is a pointer to an instance of a class other than UMC::VideoEncoderParams class or UMC::H264EncoderParams class, no change is made.</p></div>
<h5 id="_return_values_42" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_UNSUPPORTED</code></p></td>
<td align="left" valign="top"><p class="table">An encoding parameter other than the bit rate differs from a value set during initialization (Init()).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The params parameter is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_7" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Returns encoder parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_33" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an object of UMC::VideoEncoderParams class or UMC::H264EncoderParams class, which contains encoding parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method gets encoding parameters and some parameters of the encoder state.</p></div>
<div class="paragraph"><p>If params is a pointer to an instance of a class other than UMC::VideoEncoderParams
class or UMC::H264EncoderParams class, no change is made.</p></div>
<h5 id="_return_values_43" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">An instance of a class other than UMC::VideoEncoderParams or UMC::H264EncoderParams is passed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The params is a NULL pointer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe_7" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Passes a frame to encode and gets an encoded frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *in, UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_34" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input pointer to an object of UMC::VideoData class, which contains input frame in one of the formats: UMC::YUV420 (I420 according to [FOURCC] classification), UMC::YUV422, UMC::GRAY depending on the chroma_format_idc value given during initialization. Other formats are not supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Output pointer to an object of the UMC::MediaData class for encoded frames output.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method gets an input frame and returns an encoded frame. If in is a pointer to an instance of UMC::VideoData class,
UMC::UMC_ERR_INVALID_STREAM is returned.</p></div>
<div class="paragraph"><p>If in == NULL, no more input frames are expected and the encoder encodes all buffered frames if any of them are available.</p></div>
<h5 id="_return_values_44" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The in pointer is not a pointer to an instance of UMC::VideoData class.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">in == NULL and no frames are left in the internal buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset_5" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets encoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method is currently not supported.</p></div>
<h5 id="_return_values_45" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Not enough memory for allocation of internal structures.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getreconstructedframe" class="float">GetReconstructedFrame</h4>
<div class="paragraph"><p><em>Provides reconstructed frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::VideoData* GetReconstructedFrame()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method provides reconstructed frame.</p></div>
<h5 id="_return_values_46" class="float">Return Values</h5>
<div class="paragraph"><p>Pointer to UMC::VideoData that contains reconstructed frame or NULL in case of an error.</p></div>
</div>
<div class="sect3">
<h4 id="_usage_examples_7">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize H.264 encoder, invoke Init() method. The method accepts a pointer of type UMC::BaseCodecParams*
(see UMC::BaseCodecParams Class) as its single parameter. The pointer must refer to an instance of
UMC::VideoEncoderParams class or UMC::H264EncoderParams class.</p></div>
<div class="paragraph"><p>UMC::H264EncoderParams class is derived from UMC::VideoEncoderParams and extends the latter with encoding parameters
specific for H.264 video encoder. See below a list of UMC::H264EncoderParams class members with their description.
Please refer to the description of UMC::VideoEncoderParams Class for explanation of parameters common for all UMC video encoders.</p></div>
<h5 id="_umc_h264encoderparams_class_members" class="float">UMC::H264EncoderParams class members</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>chroma_format_idc(1)</code></p></td>
<td align="left" valign="top"><p class="table">should contain chroma_format_idc sequence parameter value according to the standard specifications. Supported values are as follows:<br />
0 - monochrome (starting from High profile)<br />
1 - YUV420<br />
2 - YUV422 (starting from High422 profile).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>arco</code></p></td>
<td align="left" valign="top"><p class="table">Stands for Advanced Rate Control Options. Not supported by the current version.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>coding_type(0)</code></p></td>
<td align="left" valign="top"><p class="table">Supported values:<br />
0 - Frame (all frames are coded as frames)<br />
1 - Fields (each frame is divided into 2 fields: the top field contains even lines counting from zero, the bottom field contains odd lines).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>B_frame_rate(1)</code></p></td>
<td align="left" valign="top"><p class="table">Number of <strong>B</strong> frames between consequent frames of type <strong>I</strong> or <strong>P</strong>. Must be greater than or equal to zero.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>treat_B_as_reference(0)</code></p></td>
<td align="left" valign="top"><p class="table">Allows use of <strong>B</strong>-coded frames as reference.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>num_ref_frames(2)</code></p></td>
<td align="left" valign="top"><p class="table">Maximum number of reference frames. Must be consistent with profile/level parameters for a given frame size,
since they determine reference pictures buffer constrains for a decoder. If <strong>P</strong> frames are allowed, the number should exceed 0.
If <strong>B</strong> frames are allowed, the number should be equal to or greater than 2.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>num_ref_to_start_code_B_slice(1)</code></p></td>
<td align="left" valign="top"><p class="table">Minimum number of frames in reference list1 to start <strong>B</strong> frames coding. The only supported value is 1.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>level_idc(41)</code></p></td>
<td align="left" valign="top"><p class="table">level_idc value according to the standard. Make sure it corresponds to num_ref_frames value and frame size.
Set 0 for automatic level_idc computation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>profile_idc(77)</code></p></td>
<td align="left" valign="top"><p class="table">profile_idc value according to the standard. Make sure that the other encoding parameters are set in accordance with
the profile setting. Supported profiles are as follows:<br />
66 - Baseline,<br />
77 - Main,<br />
100 - High,<br />
110 - High10,<br />
122 - High422,<br />
144 - High444 (for lossless mode only).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>rate_controls</code></p></td>
<td align="left" valign="top"><p class="table">Structure of H264_Rate_Controls type. Contains the following fields:<br />
rate_controls.method(2) - Rate control method. Can take four values:<br />
2 - ABR<br />
3 - Constant quantization parameters<br />
4 - CBR<br />
5 - VBR. CBR and VBR modes are currently not supported.<br />
<br />
rate_controls.quantI(12) - When rate control method 3 is set, <strong>I</strong> slices are encoded with QPy == quantI.<br />
rate_controls.quantP(25) - Same as rate_controls.quantI, but for <strong>P</strong> slices.<br />
rate_controls.quantB(38) - Same as rate_controls.quantI, but for Bslices.<br /></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>num_slices(1)</code></p></td>
<td align="left" valign="top"><p class="table">Number of slices per frame (or field in field coding). A frame/field is divided into equal parts except for the last one that can be shorter. The number cannot exceed the number of macroblocks per frame/field.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_do_weak_forced_key_frames(false)</code></p></td>
<td align="left" valign="top"><p class="table">Extra <strong>I</strong> frames insertion. Only false value is supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>deblocking_filter_idc(1)</code></p></td>
<td align="left" valign="top"><p class="table">Deblocking filter mode: 0 - "on", 1 - "off", 2 - "on", but the algorithm does not cross the slice borders.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>deblocking_filter_alpha(0)</code></p></td>
<td align="left" valign="top"><p class="table">Deblocking filter alpha index offset. Values range is integer[-12;12].
Odd values are forced to an even number less than a given, since a value divided by 2 is encoded into an output stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>deblocking_filter_beta(0)</code></p></td>
<td align="left" valign="top"><p class="table">Deblocking filter beta index offset. Values range is integer[-12;12].
Odd values are forced to an even number less than a given, since a value divided by 2 is encoded into an output stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>mv_search_method(3)</code></p></td>
<td align="left" valign="top"><p class="table">Motion estimation method.<br />
0 - Full,<br />
1 - Classic log,<br />
2 -Log,<br />
3 - EPZS,<br />
4 - Full orthogonal,<br />
5 - Log orthogonal,<br />
6 - TTS (tree type structure).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>me_split_mode(1)</code></p></td>
<td align="left" valign="top"><p class="table">The parameter defines for which types of blocks ME is made:<br />
0 - 16x16 only<br />
1 - down to 8x8<br />
2 - down to 4x4.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>me_search_x(4)</code></p></td>
<td align="left" valign="top"><p class="table">Indicates how far in horizontal direction from the predicted motion vector value ME is made.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>me_search_y(4)</code></p></td>
<td align="left" valign="top"><p class="table">Same as me_search_x, but in vertical direction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>use_weighted_pred(0)</code></p></td>
<td align="left" valign="top"><p class="table">Use of weighted prediction. Weighted prediction is not implemented yet and 0 is the only allowed value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>use_weighted_bipred(0)</code></p></td>
<td align="left" valign="top"><p class="table">Use of weighted prediction for bi-prediction. This feature is not implemented yet and 0 is the only allowed value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>use_implicit_weighted_bipred(0)</code></p></td>
<td align="left" valign="top"><p class="table">Use of implicit weighted biprediction. Not implemented and must be set to 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>direct_pred_mode(1)</code></p></td>
<td align="left" valign="top"><p class="table">Mode of direct prediction:<br />
0 - temporal,<br />
1 - spatial.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>use_direct_inference(0)</code></p></td>
<td align="left" valign="top"><p class="table">Equal to desired value of direct_8x8_inference_flag. Possible values: {0, 1}.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>entropy_coding_mode(0)</code></p></td>
<td align="left" valign="top"><p class="table">0 means CAVLC, 1 means CABAC.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>cabac_init_idc(0)</code></p></td>
<td align="left" valign="top"><p class="table">A desired value for cabac_init_idc. Used when CABAC method of entropy coding is selected.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>write_access_unit_delimiters(0)</code></p></td>
<td align="left" valign="top"><p class="table">Indicates whether to write access unit delimiters or not:<br />
0 - do not write,<br />
1 - write.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>key_frame_controls</code></p></td>
<td align="left" valign="top"><p class="table">A structure that defines how often <strong>I</strong> and IDR frames should be inserted.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>key_frame_controls.method(1)</code></p></td>
<td align="left" valign="top"><p class="table">Only value 1 (interval method) is supported. Interval method is defined by an interval between
neighboring <strong>I</strong> frames and how often <strong>I</strong> frames must be coded as IDR.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>key_frame_controls.interval(0)</code></p></td>
<td align="left" valign="top"><p class="table">Distance between two sequential <strong>I</strong> frames. Must be greater than or equal to 0. 0 and 1 mean that every frame is coded as <strong>I</strong>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>key_frame_controls.idr_interval(0)</code></p></td>
<td align="left" valign="top"><p class="table">Must be greater or equal to 0. If it takes the n value then each n-th <strong>I</strong> frame is encoded as IDR.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>use_transform_for_intra_decision(true)</code></p></td>
<td align="left" valign="top"><p class="table">Indicates whether the transformation is used for intra decision.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>transform_8x8_mode_flag(0)</code></p></td>
<td align="left" valign="top"><p class="table">Indicates whether transformation 8x8 can be used. Requires High profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bit_depth_luma(8)</code></p></td>
<td align="left" valign="top"><p class="table">Size of a luminance component sample in bits. Possible values are from 8 up to 14. Values more than 8 are possible starting from High10 profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bit_depth_chroma(8)</code></p></td>
<td align="left" valign="top"><p class="table">Size of a chrominance component sample in bits. Possible values are from 8 up to 14. Values more than 8 are possible starting from High10 profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>aux_format_idc(0)</code></p></td>
<td align="left" valign="top"><p class="table">Value of aux_format_idc parameter. It designates presence of auxiliary coded pictures in the stream. Possible values are: 0, 1, 2, 3. Auxiliary coded pictures can be used for example for alpha blending if aux_format_idc is equal to 1 or 2. Value 0 means there is no auxiliary coded picture in the stream and 3 means that usage of the auxiliary coded picture is not specified. See the standard specifications for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>alpha_incr_flag(0)</code></p></td>
<td align="left" valign="top"><p class="table">Parameter is used for alpha blending. Please refer to the standard for more information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>alpha_opaque_value(0)</code></p></td>
<td align="left" valign="top"><p class="table">Parameter is used for alpha blending. Please refer to the standard for more information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>alpha_transparent_value(0)</code></p></td>
<td align="left" valign="top"><p class="table">Parameter is used for alpha blending. Please refer to the standard for more information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bit_depth_aux(8)</code></p></td>
<td align="left" valign="top"><p class="table">Size of an auxiliary coded picture sample in bits. Possible values are from 8 up to 14. Values more than 8 are possible starting from High10 profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>use_default_scaling_matrix(false)</code></p></td>
<td align="left" valign="top"><p class="table">Standard and default scaling matrices are available. Default matrices are available starting from High profile. Possible values: true - use default matrices, false - use standard matrices.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>qpprime_y_zero_transform_bypass_flag(false)</code></p></td>
<td align="left" valign="top"><p class="table">Used to switch on lossless coding mode (available starting from High444 profile). The encoding is lossless when qpprime_y_zero_transform_bypass_flag is true, rate control method is 3 (constant quantization parameters) and quantization parameters for all types of slices are set to -6*(bit_depth_luma - 8).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_QualitySpeed(0)</code></p></td>
<td align="left" valign="top"><p class="table">Quality/speed trade off [0,4] (0-max speed, 4 - max quality). quant_opt_level(0). Optimal quantization switch (0-off, 1 - on). numFramesToEncode. Number of frames to encode.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>UMC::MediaData::SetFrameType is used to provide the desired frame type (<strong>I</strong>, <strong>P</strong> or <strong>B</strong>). Otherwise, the encoder assigns the frame type.</p></div>
<div class="paragraph"><div class="title">Initialization Examples</div><p>There are two methods of H.264 Video Encoder initialization.</p></div>
<div class="ulist"><ul>
<li>
<p>
Call UMC::H264VideoEncoder::Init(UMC::BasicCodecParams*) member function with a parameter that is a pointer to UMC::VideoEncoderParams class object. This method is used when the user does not want to change default values of specific H.264 encoding parameters and only sets general encoding parameters like width, height, bit rate, etc. Consult the documentation on UMC::VideoEncoderParams Class for more information.
</p>
</li>
<li>
<p>
Call UMC::H264VideoEncoder::Init(UMC::BasicCodecParams* member function with a parameter that is a pointer to UMC::H264EncoderParams class object. This method is used when the user wants to set both general encoding parameters and H.264 codec specific parameters. UMC::H264EncoderParams object can be initialized via UMC::H264EncoderParams::ReadParamFile() member function. Look at the script in Example 5-14 as an example of initialization.
</p>
</li>
</ul></div>
<div class="exampleblock">
<div class="title">Example 16. H.264VideoEncoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">vm_char</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">ParFileName </span><span style="color: #000000">=</span><span style="color: #000000"> NULL</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoder</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">p_vidEncoder </span><span style="color: #000000">=</span><span style="color: #000000"> NULL</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">p_vidEncoderParams </span><span style="color: #000000">=</span><span style="color: #000000"> NULL</span><span style="color: #000000">;</span>
<span style="color: #008000">// get par-file name if it is available</span>
<span style="color: #000000">...</span>
<span style="color: #008000">// get mWidth, mHeights and other parameters' values from command line, for example</span>
<span style="color: #000000">mWidth </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">...</span>
<span style="color: #000000">mHeight </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">...</span>
<span style="color: #000000">FrameRate</span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">...</span>
<span style="color: #000000">...</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">ParFileName</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    p_vidEncoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">createH264VideoEncoder</span><span style="color: #000000">();</span>
<span style="color: #000000">    p_vidEncoderParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264EncoderParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    p_vidEncoderParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">ReadParamFile</span><span style="color: #000000">(</span><span style="color: #000000">ParFileName</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span>

<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(!</span><span style="color: #000000">ParFileName</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    p_vidEncoderParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(!</span><span style="color: #000000">FrameRate</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        FrameRate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">30</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">...</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// override parameters if non-zero</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">mWidth </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> mHeight</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    p_vidEncoderParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">width </span><span style="color: #000000">=</span><span style="color: #000000"> mWidth</span><span style="color: #000000">;</span>
<span style="color: #000000">    p_vidEncoderParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> mHeight</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    mWidth </span><span style="color: #000000">=</span><span style="color: #000000"> p_vidEncoderParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">;</span>
<span style="color: #000000">    mHeight </span><span style="color: #000000">=</span><span style="color: #000000"> p_vidEncoderParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">p_vidEncoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">p_vidEncoderParams</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>UMC::H264EncoderParams class uses ReadParamFile method to open and read a standard parameter file. See Table 5-21 for the structure of the parameter file.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 98. Par-File Description</caption>
<col width="12%" />
<col width="12%" />
<col width="25%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top">Line Number             </th>
<th align="left" valign="top">Type                    </th>
<th align="left" valign="top">Range                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">1</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">Reserved</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">2</p></td>
<td align="left" valign="top"><p class="table">string</p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">The name of source YUV file</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">3</p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">&gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Number of frames to encode</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">4</p></td>
<td align="left" valign="top"><p class="table">3 int</p></td>
<td align="left" valign="top"><p class="table">1; &gt;= 1; &gt;= 0</p></td>
<td align="left" valign="top"><p class="table">1; Number of frames in between <strong>I</strong> frames; IDR interval</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">5</p></td>
<td align="left" valign="top"><p class="table">2 int</p></td>
<td align="left" valign="top"><p class="table">&gt;= 0; 0</p></td>
<td align="left" valign="top"><p class="table">Number of <strong>B</strong> frames between <strong>I</strong> (or <strong>P</strong>) and next <strong>P</strong>; 0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">6</p></td>
<td align="left" valign="top"><p class="table">3 int</p></td>
<td align="left" valign="top"><p class="table">1-16; 1; &gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Number of reference frames; 1; Number of slices (if set to 0, the encoder will set this number automatically corresponding to number of threads)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">7</p></td>
<td align="left" valign="top"><p class="table">2 int</p></td>
<td align="left" valign="top"><p class="table">77, 100; &gt;= 0</p></td>
<td align="left" valign="top"><p class="table">profile_idc; level_idc (set 0 for automatic selection)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">8</p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">&gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Width of source</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">9</p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">&gt;=1</p></td>
<td align="left" valign="top"><p class="table">Height of source</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">10</p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">0 - 8</p></td>
<td align="left" valign="top"><p class="table">Frame Rate Code<br />
0 - 30fps,<br />
1 - 15fps,<br />
2 - 24fps,<br />
3 - 25fps,<br />
4 - 30fps,<br />
5 - 30fps,<br />
6 - 50fps,<br />
7 - 60fps,<br />
8 - 60fps</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">11</p></td>
<td align="left" valign="top"><p class="table">3 int</p></td>
<td align="left" valign="top"><p class="table">0-1;8-12;8-12</p></td>
<td align="left" valign="top"><p class="table">chroma_format_idc (0 - monochrom, 1 - 420); bit_depth_luma;  bit_depth_chroma</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">12</p></td>
<td align="left" valign="top"><p class="table">5 int</p></td>
<td align="left" valign="top"><p class="table">0-3; 8-12; 0-1; 0-2<sup>(bit_depth_aux+9)-1; 0-2</sup>(bit_depth_aux+9)-1</p></td>
<td align="left" valign="top"><p class="table">aux_format_idc; bit_depth_aux; alpha_incr_flag; alpha_opaque_value; alpha_transparent_value</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">13</p></td>
<td align="left" valign="top"><p class="table">5 int</p></td>
<td align="left" valign="top"><p class="table">0-2; 0-51; 0-51; 0-51; &gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Rate Control method (0 - quant_codes, 1 - CBR, 2 - VBR); start qp values for <strong>I</strong>, <strong>P</strong>, <strong>B</strong> slices for Rate Control method 0; bit rate (bits per second) for Rate Control method 1 and 2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">14</p></td>
<td align="left" valign="top"><p class="table">4 int</p></td>
<td align="left" valign="top"><p class="table">1-6;<br />
0-2;<br />
&gt;= 1;<br />
&gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Motion Estimation method;<br />
subblock split (0 - none, 1 - 8x8, 2 - 4x4);<br />
ME search region width;<br />
ME search region height</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">15</p></td>
<td align="left" valign="top"><p class="table">3 int</p></td>
<td align="left" valign="top"><p class="table">0; 0; 0</p></td>
<td align="left" valign="top"><p class="table">Reserved</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">16</p></td>
<td align="left" valign="top"><p class="table">2 int</p></td>
<td align="left" valign="top"><p class="table">0-1; 0-1</p></td>
<td align="left" valign="top"><p class="table">Direct type (0 - temporal 1 - spatial); direct_inference_flag</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">17</p></td>
<td align="left" valign="top"><p class="table">3 int</p></td>
<td align="left" valign="top"><p class="table">0-2; -12 - 12; -12 - 12</p></td>
<td align="left" valign="top"><p class="table">disable_deblocking_idc (1 - off, 0 - on, 2 - on without crossing slice boundaries); deblocking_filter_alpha; deblocking_filter_beta</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">18</p></td>
<td align="left" valign="top"><p class="table">3 int</p></td>
<td align="left" valign="top"><p class="table">0-1; 0-1; 0-1</p></td>
<td align="left" valign="top"><p class="table">transform_8x8_mode (0 - off, 1 - on); scaling matrices (0 - use standard, 1 - use default scaling matrices for 8x8 quantization); qpprime_y_zero_transform_bypass_flag</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">19</p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">&gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Reserved (must be the same as Width of source).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">20</p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">&gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Reserved (must be the same as Height of source).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">21</p></td>
<td align="left" valign="top"><p class="table">2 int</p></td>
<td align="left" valign="top"><p class="table">0 - 1; 0 - 2</p></td>
<td align="left" valign="top"><p class="table">Entropy coding mode (0 - cavlc, 1 - cabac); cabac_init_idc</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">22</p></td>
<td align="left" valign="top"><p class="table">int</p></td>
<td align="left" valign="top"><p class="table">0 - 1</p></td>
<td align="left" valign="top"><p class="table">Picture coding type (0 - only FRM, 1 - only FLD)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">23</p></td>
<td align="left" valign="top"><p class="table">2 int</p></td>
<td align="left" valign="top"><p class="table">0 - 4; 0 - 1</p></td>
<td align="left" valign="top"><p class="table">Quality/speed trade off [0,4] (0-max speed, 4 - max quality). Optimal quantization (0-off, 1 - on).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the encoder, invoke Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>For encoder initialization with parameters from par-file and from command line, for main working cycle example
see $(CODECWS)\application\umc_video_enc_con\. Example of par-file lies in $(CODECWS)\test\streams\video\video_enc\.</p></div>
<div class="exampleblock">
<div class="title">Example 17. GetFrame Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> in</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> out</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> res </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264VideoEncoder</span><span style="color: #000000">*</span><span style="color: #000000"> pCodec</span><span style="color: #000000">;</span>
<span style="color: #008000">// Objects initialization.</span>
<span style="color: #000000">...</span>
<span style="color: #008000">// Loop over input frames start.</span>
<span style="color: #0000ff">for</span><span style="color: #000000">(</span><span style="color: #0000ff">int</span><span style="color: #000000"> i </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span><span style="color: #000000"> i </span><span style="color: #000000">&lt;</span><span style="color: #000000"> NumberOfFramesToEncode</span><span style="color: #000000">;</span><span style="color: #000000"> i</span><span style="color: #000000">++)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">GetNextInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">);</span><span style="color: #000000">            </span><span style="color: #008000">// A function that should load next frame data in</span>
<span style="color: #000000">                                        </span><span style="color: #008000">//display order into "in" object.</span>
<span style="color: #000000">    </span><span style="color: #000000">GetOutputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span><span style="color: #000000">              </span><span style="color: #008000">// A function that sets the output buffer parameters.</span>
<span style="color: #000000">                                        </span><span style="color: #008000">//See UMC::MediaData description.</span>
<span style="color: #000000">    res </span><span style="color: #000000">=</span><span style="color: #000000"> pCodec</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span><span style="color: #000000">  </span><span style="color: #008000">// Actual frame encoding.</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">res </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> res </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">//ERROR PROCESSING;}</span>
<span style="color: #000000">        </span><span style="color: #000000">DeliverOutputData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span><span style="color: #000000">        </span><span style="color: #008000">// A function that processes data output by the</span>
<span style="color: #000000">                                        </span><span style="color: #008000">//encoder.</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000">                                   </span><span style="color: #008000">// Loop over input frames end.</span>

<span style="color: #000000">    </span><span style="color: #008000">// Next section is to get encoded frames that were buffered inside encoder. do {</span>
<span style="color: #000000">    </span><span style="color: #000000">GetOutputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">    res </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">,</span><span style="color: #000000"> out</span><span style="color: #000000">);</span><span style="color: #000000">          </span><span style="color: #008000">// NULL instead of "in" designates that the</span>
<span style="color: #000000">                                        </span><span style="color: #008000">//sequence is over and we need the encoder to output buffered frames.</span>
<span style="color: #000000">    </span><span style="color: #000000">DeliverOutputData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">res </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>The encoder internal multithreading capabilities can be used when encoding parameters allow several slices per
frame/field and the number of threads for the encoder is set as desired.</p></div>
<div class="exampleblock">
<div class="title">Example 18. Threading Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264EncoderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">p_vidEncoderParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264EncoderParams</span><span style="color: #000000">;</span>
<span style="color: #008000">// Parameters initialization if needed.</span>
<span style="color: #000000">...</span>
<span style="color: #000000">p_vidEncoderParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">4</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Number of threads for the encoder to use.</span>
<span style="color: #000000">p_vidEncoderParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">num_slices </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">16</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Number of slices per frame/field.</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264VideoEncoder</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">p_Encoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264VideoEncoder</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> res </span><span style="color: #000000">=</span><span style="color: #000000"> p_Encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">p_vidEncoderParams</span><span style="color: #000000">);</span>
<span style="color: #008000">// Encoder use.</span>
<span style="color: #000000">...</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>See an application with multithreading capabilities in
$(CODECWS)\application\umc_video_enc_con\.
There are three threads for loading input data, encoding, and saving data. Synchronization is performed by means of mutexes.</p></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_6">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>UMC::H264VideoEncoder has threaded implementation using OpenMP* standard. Threading is done in slice-wise manner, that is, each thread processes a whole slice. Number of slices per frame/field should be set accordingly to benefit from the encoder threading capabilities. Priorities for threads could be changed only on application level for application as a whole.</p></div>
<div class="paragraph"><p>Number of threads is set via UMC::VideoEncoderParams::numThreads field. Value 0 means that the encoder chooses the number of slices automatically.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The encoder memory usage depends on the following major factors:</p></div>
<div class="ulist"><ul>
<li>
<p>
Frame resolution (width and height): the greater the size of a frame, the more memory is required for internal frame buffers.
</p>
</li>
<li>
<p>
Color depth: if maximum of bit_depth_luma, bit_depth_chroma, bit_depth_aux is greater than 8 bits, then all the buffers are doubled comparing with 8-bits version.
</p>
</li>
<li>
<p>
<strong>B</strong>-frames number: <strong>B</strong>-frames are buffered until a future reference frame is received. So at least frameSize*B_frame_rate memory is allocated.
</p>
</li>
<li>
<p>
Number of reference frames: the greater is the number of reference frames, the more frame buffers are required for them. The minimum required buffer space is frameSize*num_ref_frames.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The encoder supports UMC::MemoryAllocator Class interface.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>H.264 video encoder like other popular video encoders can encode
frames as <strong>I</strong> (intra coding), <strong>P</strong> (predicted) or <strong>B</strong> (bi-predicted) frames.
While <strong>I</strong> and <strong>P</strong> frames do not require encoding of a future frame in advance, <strong>B</strong> frames do.
When a frame is received by GetFrame(in, out) member function the encoder determines whether it is <strong>I</strong>,
<strong>P</strong> or <strong>B</strong> frame. If the frame is to be encoded as an <strong>I</strong> or <strong>P</strong> frame it is encoded immediately.
If not, then the frame goes to the encoder internal frame buffer until a future reference frame has been encoded.
If at this moment the buffer contains a frame that can be encoded, that frame is encoded and returned as output data.
If no such frame is present in the buffer, UMC::UMC_ERR_NOT_ENOUGH_DATA is returned.</p></div>
<div class="paragraph"><p>According to this algorithm, by the moment when all frames are passed to the encoder there can one or more frames
remaining in the encoders internal buffer and waiting for their future reference frame.
To get them encoded, GetFrame() member function is called with NULL pointer instead of a pointer to input UMC::VideoData object.
The encoder then makes the last frame of type <strong>P</strong> and encodes the remaining frames one per each GetFrame(NULL, out) call.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_6">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_h264_video_encoder.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(CODECWS)\codec\h264_enc\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include
$(CODECWS)\core\umc\include
$(CODECWS)\codec\color_space_converter\include
$(IPPROOT)\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
color_space_converter
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippi, ippvc, ippcc.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>ALPHA_BLENDING_H264 - Builds the encoder with a possibility to encode auxiliary coded pictures.</p></div>
<div class="paragraph"><p>BITDEPTH_9_12 - Builds the encoder with support of video sequences with
bit_depth_luma/chroma more than 8 bits.</p></div>
<div class="paragraph"><p>Features and Notes</p></div>
<div class="paragraph"><p>Auxiliary pictures coding</p></div>
<div class="paragraph"><p>H.264 standard describes an additional feature: video stream can contain an auxiliary coded picture along with each primary picture. This picture can be used, for example, for alpha blending process described in the standard as well as for another, not specified purpose. This feature is available starting from High profile only.</p></div>
<div class="paragraph"><p>To encode auxiliary pictures:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Build the encoder with ALPHA_BLENDING_H264 macros defined.
</p>
</li>
<li>
<p>
Set UMC::H264EncoderParams::aux_format_idc to a non-zero value according to your preferences. Consult the standard specifications for details.
</p>
</li>
<li>
<p>
An UMC::VideoDataAlpha class was created to pass data of auxiliary picture along with primary. The class is declared in additional header file umc_h264_video_data_alpha.h. UMC::VideoDataAlpha is an extension of UMC::VideoData Class by adding a protected field UMC::VideoData *m_pAlpha to store auxiliary picture data. Use an object of this class instead of one of UMC::VideoData to pass both primary and auxiliary frames to the encoder via UMC::H264VideoEncoder::GetFrame().
</p>
</li>
</ol></div>
<div class="paragraph"><p>In both cases, if aux_format_idc is greater than zero and UMC::VideoData object is received, or if aux_format_idc is zero and UMC::VideoDataAlpha is received, an UMC::UMC_ERR_INVALID_STREAM status value is returned.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_vc1videodecoder">UMC::VC1VideoDecoder</h3>
<div class="paragraph"><p>UMC::VC1VideoDecoder is a derived class for decompressing video data from a bitstream encoded in compliance with the SMPTE-421M-FDS1 standard
(see <a href="#SMPTE421M">[SMPTE421M]</a>). The respective component forms .YUV video frames as output.</p></div>
<div class="paragraph"><p>The next picture shows the decoding pipe-line. Compressed video stream is an input for component. UMC::MediaData is a class that contains a pointer
to the input buffer and buffer size. UMC::MediaDataEx is a derived class from UMC::MediaData and contains</p></div>
<div class="paragraph"><p>additional information for decoding (start codes, offsets for start codes in the input buffer). Either of the two structures can be input.
In the case of UMC::MediaData, the decoder should parse data to find start codes and remove forbidden combinations (like 0x00 0x00
0x03 00) at the beginning.</p></div>
<div class="paragraph"><p>Motion vectors and quantized coefficients are decoded from VLC data. Coefficients after dequantization, inverse transform, and smoothing are
used as differences to motion compensation. The predicted blocks are obtained from reference frames (located in the internal frame buffer)
with the help of Motion Vectors and Interpolation procedure.</p></div>
<div class="paragraph"><p>Deblocking is a filtering operation performed on reconstructed pixels prior to displaying the picture and using frame as reference.
Range reduction and Intensity Compensation are used to remap pixels in the reference frame prior to using them as predictors for the current frame.</p></div>
<div class="paragraph"><p>The UMC::VideoProcessing component performs range map filtering operation on the output picture before display. For decoding pipe-line details, see <a href="#SMPTE421M">[SMPTE421M]</a>.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_17.png" alt="images/umc/umc_5_17.png" />
</div>
<div class="title">Figure 21. VC1 Decoder Functional Scheme</div>
</div>
<div class="paragraph"><div class="title">Derivation</div><p>UMC::VC1VideoDecoder class is inherited from the base UMC::VideoDecoder Class.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::VC1Splitter, UMC::MediaData, UMC::BaseCodec, UMC::BaseCodecParams, UMC::VideoData, UMC::VideoDecoderParams, UMC::MemoryAllocator, UMC::MediaData and
UMC::MediaDataEx classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_8">User Interface</h4>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 99. Member Functions</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>VC1VideoDecoder</code></p></td>
<td align="left" valign="top"><p class="table">Class Methods</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes frame decoding and allocates all required memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Gets new data from input buffer, decodes it and puts result into output buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Closes decoding and frees all allocated memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets decoder to initial state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Gets video information, valid after initialization.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ChangeVideoDecodingSpeed</code></p></td>
<td align="left" valign="top"><p class="table">Adjusts relative decoding speed, gives the decoder a hint on how the decoding process is flowing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ResetSkipCount</code></p></td>
<td align="left" valign="top"><p class="table">Resets counter of skipped frames. Currently not supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SkipVideoFrame</code></p></td>
<td align="left" valign="top"><p class="table">Increments counter of skipped frames. Currently not supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetNumOfSkippedFrames</code></p></td>
<td align="left" valign="top"><p class="table">Returns number of skipped frames. Currently not supported.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_8" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes data for subsequent frame decoding and allocates memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status Init(UMC::BaseCodecParams *pInit);</code></pre>
</div></div>
<h5 id="_parameters_35" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Structure with initialization parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes decoding by</p></div>
<div class="ulist"><ul>
<li>
<p>
allocating memory for frame buffers
</p>
</li>
<li>
<p>
parsing the first sequence header if the input data contains it, otherwise input parameters are taken from the init structure
</p>
</li>
<li>
<p>
initializing all parameters required for decoding
</p>
</li>
<li>
<p>
allocating memory for internal buffers and tables
</p>
</li>
<li>
<p>
initializing processor of decoding tasks' queues (UMC::VC1TaskStore object).
The input parameter is a UMC::VideoDecoderParams object derived from UMC::BaseCodecParams. See Initialization section for input parameters details. After
initialization, the decoder is ready to process frames using GetFrame().
</p>
</li>
</ul></div>
<div class="paragraph"><p>If <em>PROJECT_STATISTICS</em> macro is included, use UMC::VC1VideoDecoderParams as input. UMC::VC1VideoDecoderParams is a structure derived from UMC::VideoDecoderParams and contains stream name. For details see
<em>PROJECT_STATISTICS</em>.</p></div>
<h5 id="_return_values_47" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed as the input parameters are incorrect.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Memory allocation error.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe_8" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Gets data from input buffer, decodes it and puts result into output buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status GetFrame(UMC::MediaData* input, UMC::MediaData* output);</code></pre>
</div></div>
<h5 id="_parameters_36" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>input</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the input data object. The pointer should refer to the instance of the UMC::MediaData or UMC::MediaDataEx object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>output</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the output data object. The pointer should refer to the instance of the UMC::VideoData object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method gets a compressed frame from the input buffer, decodes it, and puts the resulting YUV frame into the output buffer. No data is returned in the case of a zero output buffer. If input is NULL, the method returns the earlier decoded frame from internal buffers. The UMC::UMC_ERR_NOT_ENOUGH_DATA return value signals about a need in one more frame to correct subsequent operation (for instance, B frame decoding).</p></div>
<div class="paragraph"><p>If UMC::MediaData points to UMC::MediaDataEx object, additional information is passed that contains the start codes and offsets.</p></div>
<h5 id="_return_values_48" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Decoder is not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">No data for output.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed. The input data is of UMC::MediaData type and is swapped or the inpit frame is incorrect.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_8" class="float">Close</h4>
<div class="paragraph"><p><em>Closes decoding and frees all allocated resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><p>Description</p></div>
<div class="paragraph"><p>The method frees all allocated memory. All parameters are set to the initial values.</p></div>
<h5 id="_return_values_49" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_reset_6" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status Reset(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the decoder to initial state.</p></div>
<div class="paragraph"><p>This method can be used for repositioning. Call the Init() method with sequence header data to start the next initialization.</p></div>
<h5 id="_return_values_50" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Decoder is not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_8" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Gets video information, valid after initialization.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status GetInfo(UMC::BaseCodecParams* inInfo);</code></pre>
</div></div>
<h5 id="_parameters_37" class="float">Parameters</h5>
<div class="paragraph"><p>inInfo Output parameter. Pointer to a UMC::BaseCodecParams object.</p></div>
<div class="paragraph"><div class="title">Description</div><p>The method provides video information. The input parameter is a UMC::VideoDecoderParams object derived from UMC::BaseCodecParams. See Initialization section for input parameters details.</p></div>
<h5 id="_return_values_51" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_changevideodecodingspeed_2" class="float">ChangeVideoDecodingSpeed</h4>
<div class="paragraph"><p><em>Changes the decoding speed.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status ChangeVideoDecodingSpeed(Ipp32s &amp;num)</code></pre>
</div></div>
<h5 id="_parameters_38" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>num</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter. A relative value to be added to the current decoding speed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method relatively adjusts the decoding speed and the skipping algorithm.</p></div>
<div class="paragraph"><p>The decoder supports different speeds of decoding. The slowest speed is 0, when the decoder decodes everything, skipping nothing. The fastest speed is 9, when the decoder processes key frames mostly, without any post processing. The owning application may change decoding speed from 0 to 9 smoothly, choosing the most suitable speed.</p></div>
<h5 id="_return_values_52" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The initialization process did not start before the method is called.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_resetskipcount" class="float">ResetSkipCount</h4>
<div class="paragraph"><p><em>Resets counter of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status ResetSkipCount()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method is currently not implemented. You may use the UMC::ChangeVideoDecodingSpeed method instead.</p></div>
<h5 id="_return_values_53" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_IMPLEMENTED</code></p></td>
<td align="left" valign="top"><p class="table">The method is not implemented.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_skipvideoframe" class="float">SkipVideoFrame</h4>
<div class="paragraph"><p><em>Increments counter of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status SkipVideoFrame(Ipp32s num)</code></pre>
</div></div>
<h5 id="_parameters_39" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>num</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of frames to be skipped.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method is currently not implemented. You may use the
UMC::ChangeVideoDecodingSpeed method instead.</p></div>
<h5 id="_return_values_54" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_IMPLEMENTED</code></p></td>
<td align="left" valign="top"><p class="table">The method is not implemented.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getnumofskippedframes" class="float">GetNumOfSkippedFrames</h4>
<div class="paragraph"><p><em>Returns number of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>Ipp32u GetNumOfSkippedFrames()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method is currently not implemented. You may use the
UMC::ChangeVideoDecodingSpeed method instead.</p></div>
<h5 id="_return_values_55" class="float">Return Values</h5>
<div class="paragraph"><p>0</p></div>
</div>
<div class="sect3">
<h4 id="_usage_examples_8">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize the decoder, fill the UMC::VideoDecoderParams structure derived from
BaseCodecParams (see UMC::BaseCodecParams Class). The required fields are as follows:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pData</code></p></td>
<td align="left" valign="top"><p class="table">sequence header for the decoder</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>cformat</code></p></td>
<td align="left" valign="top"><p class="table">format that must be YUV420</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>clip_info.height</code></p></td>
<td align="left" valign="top"><p class="table">input image height</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.clip_info.width</code></p></td>
<td align="left" valign="top"><p class="table">input image width</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lFlags</code></p></td>
<td align="left" valign="top"><p class="table">flag that can be NULL or FLAG_VDEC_4BYTE_ACCESS if input data is swapped</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.stream_type</code></p></td>
<td align="left" valign="top"><p class="table">stream type that can be VC1_VIDEO or WMV_VIDEO. info.stream_subtype stream subtype that can be VIDEO_RCV or VIDEO_VC1.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.numThreads</code></p></td>
<td align="left" valign="top"><p class="table">If numThreads is not NULL, the decoder creates a required number of internal decoding threads but not greater than eight.
If numThreads is NULL, the decoder creates the optimal number of threads based on the number of logical CPUs.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>pPostProcessing</code></p></td>
<td align="left" valign="top"><p class="table">pointer that must either be 0 or refer to the proper UMC::VideoProcessing object. If the pointer is 0, default processing is used, which can perform copy or color conversion and resizing, according to correspondence between the internal and destination formats, specified by output UMC::VideoData.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lpMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table">field that defines the type of the memory allocator. If lpMemoryAllocator = NULL, run your allocator. The external allocator is used otherwise.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The decoder uses the following flag:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_decoderFlags</code></p></td>
<td align="left" valign="top"><p class="table">If m_decoderFlags == FLAG_VDEC_4BYTE_ACCESS, the input data is swapped.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Initialization parameters should be set before Init call. See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 19. VC1VideoDecoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #008000">//DECODER</span>
<span style="color: #0000ff">using</span><span style="color: #000000"> </span><span style="color: #0000ff">namespace</span><span style="color: #000000"> UMC</span><span style="color: #000000">;</span>
<span style="color: #000000">decoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> VC1VideoDecoder</span><span style="color: #000000">;</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">decoder </span><span style="color: #000000">==</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Failed to allocate memory</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_splitter_flags</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">stream_type </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">stream_type</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">interlace_type </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">interlace_type</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">color_format </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">color_format</span><span style="color: #000000">;</span>
<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcSts</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method that frees all allocated memory and sets the remaining parameters to init values.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>decoder-&gt;Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>See next example for working cycle code for VC1 Video Decoder.</p></div>
<div class="exampleblock">
<div class="title">Example 20. VC1VideoDecoder Working Cycle</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #008000">//DECODER</span>
<span style="color: #0000ff">using</span><span style="color: #000000"> </span><span style="color: #0000ff">namespace</span><span style="color: #000000"> UMC</span><span style="color: #000000">;</span>
<span style="color: #000000">decoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> VC1VideoDecoder</span><span style="color: #000000">;</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">decoder </span><span style="color: #000000">==</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Decoder: failed new operation</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> splInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>
<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetNextVideoData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">);</span>
<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(</span><span style="color: #000000">splInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">;</span>
<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(</span><span style="color: #000000">splInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_splitter_flags</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">stream_type </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">stream_type</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">stream_subtype </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">stream_subtype</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">interlace_type </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">interlace_type</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">color_format </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">color_format</span><span style="color: #000000">;</span>
<span style="color: #008000">//decoder initialization</span>
<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcSts</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> yuv_data</span><span style="color: #000000">.</span><span style="color: #000000">AllocInit</span><span style="color: #000000">(</span><span style="color: #000000">splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">,</span>
<span style="color: #000000">                    splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">,</span><span style="color: #000000"> YV12</span><span style="color: #000000">);</span>

<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcSts</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">umcSts </span><span style="color: #000000">==</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    umcSpl </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetNextVideoData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">umcSpl</span><span style="color: #000000">!=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>

<span style="color: #000000">    umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">yuv_data</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">switch</span><span style="color: #000000">(</span><span style="color: #000000">umcSts</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #0000ff">case</span><span style="color: #000000"> UMC_ERR_NOT_INITIALIZED</span><span style="color: #000000">:</span>
<span style="color: #000000">            </span><span style="color: #008000">//need to initialize decoder</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #0000ff">case</span><span style="color: #000000"> UMC_ERR_NOT_ENOUGH_DATA</span><span style="color: #000000">:</span>
<span style="color: #000000">            </span><span style="color: #008000">//not enough data</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #0000ff">case</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">:</span>
<span style="color: #000000">        </span><span style="color: #000000">{</span>
<span style="color: #000000">            frameCount</span><span style="color: #000000">++;</span>
<span style="color: #000000">            </span><span style="color: #008000">//new frame is ready</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #0000ff">default</span><span style="color: #000000">:</span>
<span style="color: #000000">            </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Frame decoding error</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">}</span>

<span style="color: #008000">//get last frame from decoder internal buffer</span>
<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000"> </span><span style="color: #000000">GetFrame</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">yuv_data</span><span style="color: #000000">);</span>

<span style="color: #000000">decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Close</span><span style="color: #000000">();</span>

<span style="color: #0000ff">delete</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_7">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>VC1 Decoder can create a specified number of decoding threads or determine the optimal number of threads automatically. The number of threads is controlled through numThreads member of UMC::BaseCodecParams structure (see UMC::BaseCodecParams Class). For more details see Initialization section.</p></div>
<div class="paragraph"><p>Synchronization is performed automatically by means of events and does not require any additional actions.</p></div>
<div class="paragraph"><p>Combination of functional and temporal threading schemes is used (Figure 5-19).
Two or more threads decode one frame by functional division of tasks (VLD Decoding, Dequantization, Inverse Transformation, and etc.).
Each macroblock row has two corresponding tasks - one from the main queue and one from the additional queue.
Each task changes state during frame decoding (see Figure 5-20 and Figure 5-21). Tasks related</p></div>
<div class="paragraph"><p>to one MBQuant in green state can work simultaneously. Temporal scheme allows threads to take tasks from several frames, which is very beneficial when high-definition streams are decoded.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_19.png" alt="images/umc/umc_5_19.png" />
</div>
<div class="title">Figure 22. Data Threading Model</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_20.png" alt="images/umc/umc_5_20.png" />
</div>
<div class="title">Figure 23. Main Queue Task State Machine</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_21.png" alt="images/umc/umc_5_21.png" />
</div>
<div class="title">Figure 24. Additional Queue Task State Machine</div>
</div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The decoder allocates memory for 4 frames = (height + 128)<strong>(width + 128) + ((height
/ 2 + 64)</strong>(width / 2 + 64))*4, width is aligned on 64. VLC tables - 376992 bytes,
smoothing structures = (1536 + 1024 * (widthMB + 1) + 3 * 8 * (widthMB + 1)) *
thread_num, motion vector structures = 16*heghtMB*widthMB*4*5, decoding
parameters are 127516. For example, one thread model with 720 x 480 frame resolutions
makes 5612 kbytes, dual thread model - 5620 kbytes.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>Input data can be of UMC::MediaData or UMC::MediaDataEx type. UMC::MediaDataEx data can be either swapped or unswapped. To use swapped data in the decoder, set the corresponding init flag m_decoderFlags to FLAG_VDEC_4BYTE_ACCESS. UMC::MediaData input data should be not swapped.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_7">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_vc1_video_decoder.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(CODECWS)\codec\vc1_common\include
$(CODECWS)\codec\vc1_dec\include
$(CODECWS)\core\umc\include
$(CODECWS)\core\vm\include
$(CODECWS)\codec\color_space_converter\include
$(IPPROOT)\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
color_space_converter
</p>
</li>
<li>
<p>
vc1_common
</p>
</li>
<li>
<p>
vm
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippi, ippvc.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The following macros are supported:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 100. VC1VideoDecoder Macros</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name       </th>
<th align="left" valign="top">Purpose        </th>
<th align="left" valign="top">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>VC1_DEBUG_ON</code></p></td>
<td align="left" valign="top"><p class="table">Getting debugging information</p></td>
<td align="left" valign="top"><p class="table">After declaration, set type of debug information in umc_vc1_dec_debug.cpp (VC1_DEBUG).<br />
If VC1_FRAME_DEBUG=0 (default value), debug information is provided for all the frames.<br />
If you need debug information about specific frames, set VC1_FRAME_DEBUG equal to 1, VC1_FRAME_MIN equal to the number of the first frame of the required frame string, and VC1_FRAME_MAX equal to the number of the last frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><em>PROJECT_STATISTICS</em></code></p></td>
<td align="left" valign="top"><p class="table">Getting time statistics</p></td>
<td align="left" valign="top"><p class="table">If you need time statistics information, define this macro in umc_vc1_dec_time_statistics.h.<br />
The resulting file StatisticResults.csv is written into directory with *.exe file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ENABLE_VC1_DECODER</code></p></td>
<td align="left" valign="top"><p class="table">Enabling</p></td>
<td align="left" valign="top"><p class="table">This macro is in umc_defs.h file. Each thread has its own trace with time stamps.<br />
The output file _paralel_stat.csv is written into directory with *.exe file.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_vc1videoencoder">UMC::VC1VideoEncoder</h3>
<div class="paragraph"><p>UMC::VC1VideoEncoder is a derived class for compressing YUV format video data to pure VC1 video in compliance with
SMPTE-421M standard (see <a href="#SMPTE421M">[SMPTE421M]</a>). Encoding is done frame by frame.</p></div>
<div class="paragraph"><p>The encoding algorithm is implemented in two major steps - reordering and frame coding.</p></div>
<div class="paragraph"><p><em>Reordering.</em> VC1 encoder reorders input data if a coded sequence should contain B frames. For example, for coding an IBBP subsequence in input order VC1 encoder returns IPBB output coded subsequence. The last P frame is moved to the second place in this subsequence. It is achieved by buffering frames that are coded as B frames. If B picture type is not used, the output order in coded stream is the same as in the input. For details, see [SMPTE421M] (5.4 "Frame reordering").</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_22.png" alt="images/umc/umc_5_22.png" />
</div>
<div class="title">Figure 25. VC1VideoEncoder Output Reordering IBBP Subsequence</div>
</div>
<div class="paragraph"><p><em>Frame coding.</em> Frame coding process includes Frame level operations and Macroblock level
operations.</p></div>
<div class="paragraph"><p>Frame level operations are done for the whole frame at once:</p></div>
<div class="ulist"><ul>
<li>
<p>
Frame buffering - VC1 encoder gets a new frame and puts it into the frame buffer. If it should be B frame, the encoder requests new input data, until I or P frame comes. After that the second reference frame and all B frames are coded.
</p>
</li>
<li>
<p>
Motion estimation (ME) is performed for P and B frames. Motion vector values (MV)
    and macroblock transform type are calculated at this stage for each macroblock.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Macroblock level operations are done for each macroblock (MB):</p></div>
<div class="ulist"><ul>
<li>
<p>
Intra MB: DCT (discrete-cosine transform), Quantization, AC and DC coefficient inverse prediction, VLC coding and reconstruction (inverse quantization, inverse DCT).
</p>
</li>
<li>
<p>
Inter MB: DCT, Quantization, MV coding, VLC coding and reconstruction (motion compensation (MC), inverse quantization, inverse transform).
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">VC1VideoEncoder Pipeline</div><p>image::images/umc/umc_5_23.jpg</p></div>
<div class="paragraph"><div class="title">Derivation</div><p>UMC::VC1VideoEncoder class is inherited from the base UMC::VideoEncoder Class and inherits the basic features of that class. UMC::VideoEncoder is a class derived from UMC::BaseCodec Class for building video data encoders and inherits the basic features of all codecs.</p></div>
<div class="paragraph"><p>UMC::VC1VideoEncoder uses UMC::VC1EncoderParams class derived from UMC::VideoEncoderParams Class derived from UMC::BaseCodecParams Class. Only UMC::VideoEncoderParams or UMC::VC1EncoderParams could be used for initialization of the encoder.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::BaseCodec, UMC::VideoEncoder, UMC::BaseCodecParams, UMC::VideoData, UMC::VideoDecoderParams, UMC::MediaData and UMC::VideoData classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_9">User Interface</h4>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 101. Profile Definitions</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Profile        </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>VC1_ENC_PROFILE_S</code></p></td>
<td align="left" valign="top"><p class="table">Simple profile</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VC1_ENC_PROFILE_M</code></p></td>
<td align="left" valign="top"><p class="table">Main profile</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VC1_ENC_PROFILE_A</code></p></td>
<td align="left" valign="top"><p class="table">Advance profile</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>All required parameters are contained in UMC::VC1EncoderParams interface class derived from UMC::VideoEncoderParams Class. This class can be used for the following tasks:</p></div>
<div class="ulist"><ul>
<li>
<p>
initialize the encoder
</p>
</li>
<li>
<p>
get info from the encoder using GetInfo method
</p>
</li>
<li>
<p>
parse the par-file using ReadParamFile function.
</p>
</li>
</ul></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 102. VC1EncoderParams Members Description</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Type            </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiGOPLength</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">The number of frames in the group of pictures</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiBFrmLength</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Defines the number of consecutive B-frames (0 means no B-frames).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_bVSTransform</code></p></td>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table">If set to 1, variable size transform for inter blocks is used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_bDeblocking</code></p></td>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table">If set to 1, switches on deblocking.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_iConstQuant</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Quantization coefficient for all frames</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiNumFrames</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Number of frames for encoding. This parameter is not used for encoding. Can be filled by ReadParamsFile function and used by application.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pStreamName</code></p></td>
<td align="left" valign="top"><p class="table"><code>vm_char*</code></p></td>
<td align="left" valign="top"><p class="table">Input yuv file name. This parameter is used only for debug logs.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiMESearchSpeed</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Quality/speed coefficient for UMC ME</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiHRDBufferSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">HRD buffer size (see standard <a href="#SMPTE421M">[SMPTE421M]</a> Annex C)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_bFrameRecoding</code></p></td>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table">Allows or disables frame recording.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>See also members of UMC::BaseCodecParams Class and UMC::VideoEncoderParams Class. Note that UMC::VC1EncoderParams ignores the following fields:</p></div>
<div class="ulist"><ul>
<li>
<p>
UMC::BaseCodecParams parameters: m_SuggestedInputSize, m_SuggestedOutputSize, numThreads, and level
</p>
</li>
<li>
<p>
UMC::VideoEncoderParams parameters: info.aspect_ratio_width, info.aspect_ratio_height, info.duration, info.interlace_type, info.stream_subtype, and info.streamPID.
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">Member Functions</div><p>See UMC::BaseCodec Class and UMC::VideoEncoder Class descriptions.</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 103. VC1VideoEncoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes the encoder with specified parameters, allocates memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Frees all memory resources, resets encoder parameters to default values.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets the encoder to initial state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Encodes a new frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Returns encoder parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets encoder working parameters. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>CheckParameters</code></p></td>
<td align="left" valign="top"><p class="table">Checks input encoder parameters. Currently not implemented.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_9" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes encoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams* init);</code></pre>
</div></div>
<h5 id="_parameters_40" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure. Can be a pointer to the UMC::VideoEncoderParams structure with initialization parameters common to all UMC encoders or UMC::VC1EncoderParams with common and VC1 specific parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the encoder, allocates all memory resources. Close() method is called at the beginning of Init(). See the detailed description of this method is in Initialization section.</p></div>
<h5 id="_return_values_56" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input pointer is NULL or input structure is neither UMC::VideoEncoderParams nor UMC::VC1EncoderParams.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The encoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed as the input parameters are incorrect.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_9" class="float">Close</h4>
<div class="paragraph"><p><em>Frees all memory resources, resets encoder parameters to default values.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method frees all allocated memory. This method is called from the class destructor and from Init() before memory allocation. For coding resuming after Close(),
re-initialization is needed.</p></div>
<h5 id="_return_values_57" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_reset_7" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets encoder to initial state.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method reinitializes the encoder with current encoding parameters. The method can be used to start a new video sequence.</p></div>
<h5 id="_return_values_58" class="float">Return Values</h5>
<div class="paragraph"><p>Returns the results of Init() method.</p></div>
<hr />
<h4 id="_getframe_9" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Gets data from input buffer, encodes it and puts result into output buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status GetFrame(UMC::MediaData *pIn, UMC::MediaData *pOut);</code></pre>
</div></div>
<h5 id="_parameters_41" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pIn</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the input YUV data object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pOut</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the output encoded data object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method takes the input YUV video frame from pIn and returns the encoded frame to pOut. Due to internal buffering the output frame usually contains one of the previously encoded input frames, or there can be no output frame at all. To get buffered frames at the end of the encoding process, call GetFrame with pIn set to NULL until it returns UMC_OK. If the encoder is initialized to encode without B-frames, no buffering takes place.</p></div>
<h5 id="_return_values_59" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation. UMC_ERR_NOT_INITIALIZED Encoder is not initialized. UMC_ERR_NOT_IMPLEMENTED Some features are not supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Input frame size is bigger than internal frame buffer size.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">When pIn pointer equals NULL and there are no buffered frames for output.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_9" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Returns encoder parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams* info);</code></pre>
</div></div>
<h5 id="_parameters_42" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>info</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an UMC::BaseCodecParams data object for getting the encoder parameters. This pointer can point to UMC::VideoEncoderParams or UMC::VC1EncoderParams. Destination is filled according to its class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method gets encoder working (initialization) parameters.</p></div>
<h5 id="_return_values_60" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation. UMC_ERR_NOT_INITIALIZED Encoder is not initialized. UMC_ERR_NULL_PTR One of the essetial pointers is NULL.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_9">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize the encoder, create a UMC::VC1VideoEncoder object and call the Init()
method with coding parameters.</p></div>
<div class="paragraph"><p>There are two methods of VC1 encoder initialization:</p></div>
<div class="ulist"><ul>
<li>
<p>
Call Init() method with UMC::VideoEncoderParams structure as input parameters.
It allows initializing the codec with common for all encoder parameters and default VC1
specific parameters.
</p>
</li>
</ul></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 104. Parameters for Initialization with VideoEncoderParams Structure</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Input Parameter               </th>
<th align="left" valign="top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>profile</code></p></td>
<td align="left" valign="top"><p class="table">VC1_ENC_PROFILE_S or VC1_ENC_PROFILE_M or VC1_ENC_PROFILE_A</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.clip_info</code></p></td>
<td align="left" valign="top"><p class="table">Width and height of Y frame. Input YUV sequence must be in 4:2:0 format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.bitrate</code></p></td>
<td align="left" valign="top"><p class="table">&gt;0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.framerate</code></p></td>
<td align="left" valign="top"><p class="table">&gt;0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lpMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to a memory allocator object. Default value is equal to NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="ulist"><ul>
<li>
<p>
Call Init() method with UMC::VC1EncoderParams structure. It allows initializing codec with VC1 specific parameters. The UMC::VC1EncoderParams structure can be initialized via UMC::VC1EncoderParams::ReadParamFile() member function.
</p>
</li>
</ul></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 105. Parameters for Initialization with VC1EncoderParams Structure</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Input Parameter        </th>
<th align="left" valign="top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>profile</code></p></td>
<td align="left" valign="top"><p class="table">VC1_ENC_PROFILE_S or VC1_ENC_PROFILE_M or VC1_ENC_PROFILE_A</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.clip_info</code></p></td>
<td align="left" valign="top"><p class="table">Width and height of Y frame. Input YUV sequence must be in 4:2:0 format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.bitrate</code></p></td>
<td align="left" valign="top"><p class="table">&gt;0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.framerate</code></p></td>
<td align="left" valign="top"><p class="table">&gt;0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lpMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to a memory allocator object or NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiGOPLength</code></p></td>
<td align="left" valign="top"><p class="table">&gt;=1; if set to 1, only intra frames are coded.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiBFrmLength</code></p></td>
<td align="left" valign="top"><p class="table">&gt;=0; defines the number of successive B-frames (0 means no B-frames).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_bVSTransform</code></p></td>
<td align="left" valign="top"><p class="table">0 or 1.<br />
If set to 1, variable size transform for inter blocks (8x4, 4x8, 4x4) will be used; otherwise, (equal to 0) 8x8 transform will be used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_bDeblocking</code></p></td>
<td align="left" valign="top"><p class="table">0 or 1. 1 means switching on of deblocking.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_iConstQuant</code></p></td>
<td align="left" valign="top"><p class="table">0 or in the range [2,62]. If equal to 0, it is calculated by the encoder based on BRC.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiMESearchSpeed</code></p></td>
<td align="left" valign="top"><p class="table">[0,255]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiHRDBufferSize</code></p></td>
<td align="left" valign="top"><p class="table">HRD buffer size (see standard <a href="#SMPTE421M">[SMPTE421M]</a> Annex C)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_bFrameRecoding</code></p></td>
<td align="left" valign="top"><p class="table">0 or 1. 1 means frame recording is allowed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 21. VC1VideoEncoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> err </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1VideoEncoder</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">VC1Encoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1VideoEncoder</span><span style="color: #000000">();</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">params </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1VideoEncoderParams</span><span style="color: #000000">();</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1280</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">720</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">bitrate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">16000000</span><span style="color: #000000">;</span>

<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">framerate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">30</span><span style="color: #000000">;</span>
<span style="color: #000000">err </span><span style="color: #000000">=</span><span style="color: #000000"> VC1Encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">params</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> err</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">//Coding process</span>
<span style="color: #000000">}</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">VC1Encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Close</span><span style="color: #000000">();</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> VC1Encoder</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the encoder, invoke Close() method that can also be invoked by the UMC::VC1VideoEncoder destructor.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>See next example for working cycle code of VC1 Video Encoder.</p></div>
<div class="paragraph"><p>VC1VideoEncoder Usage</p></div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> err </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1VideoEncoder</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">VC1Encoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1VideoEncoder</span><span style="color: #000000">();</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">params </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1VideoEncoderParams</span><span style="color: #000000">();</span>
<span style="color: #000000">err </span><span style="color: #000000">=</span><span style="color: #000000"> params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">ReadParamFile</span><span style="color: #000000">(</span><span style="color: #000000">ParamFileName</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> err</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">//Coding process</span>
<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">have_frames</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status </span><span style="color: #000000">VideoData</span><span style="color: #000000"> in</span><span style="color: #000000">;</span>
<span style="color: #000000">        UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status </span><span style="color: #000000">MediaData</span><span style="color: #000000"> out</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">read_new_frame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">))</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #000000">\\</span><span style="color: #000000"> not end of stream</span>
<span style="color: #000000">            VC1Encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">//no input data, get buffered coded frames</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> VC1Encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">out</span><span style="color: #000000">))</span>
<span style="color: #000000">                </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #000000">write_out_data_to_file</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// while have frames</span>
<span style="color: #000000">}</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">VC1Encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Close</span><span style="color: #000000">();</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> VC1Encoder</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>The par-file can be read by ReadParamFile() method. Structure of the parameter file is the following:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>#any comment
source.yuv #File name of source YUV sequence (Must be in the second row)

Parameter name: parameter value #any comment
...</code></pre>
</div></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 106. Parameter File Description</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Range      </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Profile</p></td>
<td align="left" valign="top"><p class="table">Coding profile. Can be Advanced, Main, Simple (see <a href="#SMPTE421M">[SMPTE421M]</a> 3.1)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Width</p></td>
<td align="left" valign="top"><p class="table">Input stream Y frame width (int &gt; 0)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Height</p></td>
<td align="left" valign="top"><p class="table">Input stream frame height (int &gt; 0)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">GOPLength</p></td>
<td align="left" valign="top"><p class="table">The number of frames in the group of pictures (int ? 1). If equal to 1, only I frame will be coded.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">BFramesLength</p></td>
<td align="left" valign="top"><p class="table">Defines the number of successive B-frames (int &gt;= 0). 0 means no B-frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Bitrate</p></td>
<td align="left" valign="top"><p class="table">Target bitrate bit/sec(int &gt;= 0)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">VSTtransform</p></td>
<td align="left" valign="top"><p class="table">0 or 1.<br />
If set to 1, variable transform for inter blocks (8x4, 4x8, 4X4) will be used; otherwise, (equal to 0) 8x8 transform will be used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Deblocking</p></td>
<td align="left" valign="top"><p class="table">0 or 1.<br />
Switch on/switch off deblocking</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">ConstQuantization</p></td>
<td align="left" valign="top"><p class="table">0 or integer in the range [2,62]. Quantization coefficient for all frames.<br />
If equal to 0, quant coefficient is set inside encoder (switch on BRC)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">MESearchSpeed</p></td>
<td align="left" valign="top"><p class="table">Integer in the range of [0.255].<br />
Quality/speed parameter for UMC ME</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">HRDBufferSize</p></td>
<td align="left" valign="top"><p class="table">Integer &gt;0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">HRD</p></td>
<td align="left" valign="top"><p class="table">buffer size (see standard <a href="#SMPTE421M">[SMPTE421M]</a> Annex C)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">FrameRecoding</p></td>
<td align="left" valign="top"><p class="table">0 or 1.<br />
Switch on/switch off frame recording mode</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_8">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>The encoder is thread-safe.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The UMC::VC1VideoEncoder allocates memory for internal buffers:
* Frame buffer bytesAlloc = [(MBx*16 + 64)<strong>(MBy*16 + 64) + 2 * (MBx*8 + 64)</strong>(MBy*8 + 64) + 96]*(BFramesLength+2);
* MB difference bytesAlloc+ MB parameters bytesAlloc+ Coded MB params bytesAlloc = MBx*3402.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 107. Memory Allocation Correspondence</caption>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="20%" />
<thead>
<tr>
<th align="left" valign="top">BFramesLength      </th>
<th align="left" valign="top">0          </th>
<th align="left" valign="top">1          </th>
<th align="left" valign="top">3          </th>
<th align="left" valign="top">5</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">720X480</p></td>
<td align="left" valign="top"><p class="table">1.45 MB</p></td>
<td align="left" valign="top"><p class="table">2.1 MB</p></td>
<td align="left" valign="top"><p class="table">3.4 MB</p></td>
<td align="left" valign="top"><p class="table">4.7 MB</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">1280X720</p></td>
<td align="left" valign="top"><p class="table">3.4 MB</p></td>
<td align="left" valign="top"><p class="table">4.9 MB</p></td>
<td align="left" valign="top"><p class="table">8.1 MB</p></td>
<td align="left" valign="top"><p class="table">11.2 MB</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">1440X1080</p></td>
<td align="left" valign="top"><p class="table">5.3 MB</p></td>
<td align="left" valign="top"><p class="table">7.9 MB</p></td>
<td align="left" valign="top"><p class="table">13.0 MB</p></td>
<td align="left" valign="top"><p class="table">18.1 MB</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>The input data should contain the whole frame in YUV 4:2:0 format. No possibility to change size or color format inside the encoder.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_8">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_vc1_video_encoder.h</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_mpeg2videodecoder">UMC::MPEG2VideoDecoder</h3>
<div class="paragraph"><p>The MPEG2 Video Decoder is a derived class for decompressing of video data from bitstream encoded in compliance with MPEG-2
standard ISO/IEC 13818-2:1996 <a href="#ISOIEC_96">[ISOIEC_96]</a>.</p></div>
<div class="paragraph"><p>See next figure for the functional scheme of the decoder.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_25.png" alt="images/umc/umc_5_25.png" />
</div>
<div class="title">Figure 26. MPEG2VideoDecoder Functional Scheme</div>
</div>
<div class="paragraph"><p>Motion vectors and quantized DCT coefficients are extracted from input UMC::MediaData in VLD block. Motion vectors together with decoded reference frames from Internal Frame Buffer are used to form Motion Prediction from one of the frames, previous or following in the display order. DCT Coeffs are dequantized and after IDCT are used for motion compensation of the prediction. Decoded frames are stored in Internal Frame Buffer for future references, if necessary. Frames are delivered in output UMC::VideoData either with or without reordering.</p></div>
<div class="paragraph"><div class="title">Derivation</div><p>UMC::MPEG2VideoDecoder class is inherited from UMC::VideoDecoder Class.</p></div>
<div class="paragraph"><p>UMC::VideoDecoder class provides basic interface for all video decoders. It includes methods that perform initialization of the decoder, decompression of the frame, destroying of the decoder, etc.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::MediaData, UMC::VideoData, UMC::VideoDecoder, UMC::VideoDecoderParams, UMC::VideoProcessing and UMC::MemoryAllocator classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_10">User Interface</h4>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 108. MPEG2VideoDecoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes subsequent frame decoding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Decodes the next video frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets the decoder to the initial state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Provides information about stream and decoder parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>PreviewLastFrame</code></p></td>
<td align="left" valign="top"><p class="table">Previews last decoded frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetUserData</code></p></td>
<td align="left" valign="top"><p class="table">Returns closed capture data from GOP user data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Closes decoding and frees all allocated resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets parameters of the decoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetPerformance</code></p></td>
<td align="left" valign="top"><p class="table">Returns performance of the decoder. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ResetSkipCount</code></p></td>
<td align="left" valign="top"><p class="table">Resets counter of skipped frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SkipVideoFrame</code></p></td>
<td align="left" valign="top"><p class="table">Increments counter of skipped frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetNumOfSkippedFrames</code></p></td>
<td align="left" valign="top"><p class="table">Returns the number of skipped frames.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_10" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters_43" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure. The pointer should refer to an object of the UMC::VideoDecoderParams Class, which contains common initialization information for all decoders and the beginning of the stream to be decoded.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the decoder. During initialization the first sequence header is decoded and internal structures are prepared. First <strong>I</strong> frame is decoded, if provided, and remains in the internal buffer.</p></div>
<div class="paragraph"><p>See detailed description of this method in Initialization section.</p></div>
<h5 id="_return_values_61" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to initialize one of the internal objects, such as thread or event, or the input pointer points not to UMC::VideoDecoderParams or derived class.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Incorrect bitstream of a wrong format or a size that is not enough.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_SYNC</code></p></td>
<td align="left" valign="top"><p class="table">Sequence start code was not found in provided UMC::MediaData.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Invalid video parameters provided without bitstream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_UNSUPPORTED</code></p></td>
<td align="left" valign="top"><p class="table">An unsupported flag was specified.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe_10" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Decodes next video frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *pInData, UMC::MediaData *pOutData);</code></pre>
</div></div>
<h5 id="_parameters_44" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInData</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to an input data object. This pointer should refer to the instance of the UMC::MediaData object. The pInData refers to the uncompressed frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pOutData</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an output data object. The pointer should refer to the instance of the UMC::VideoData object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method processes an input compressed frame as part of a sequence. The decompressed image is stored in the output data in the destination color format, which is provided by pOutData. The output data must contain all necessary buffers needed to store image in the destination format, otherwise a memory corruption can occur. For more details, see definition of the UMC::VideoData Class.</p></div>
<div class="paragraph"><p>If the stream is field-coded, only after the second field is decoded the complete output frame is returned. Due to possible internal reordering, the frame returned in pOutData is not necessarily the same as provided by pInData.</p></div>
<div class="paragraph"><p>Data pointer of pInData is advanced to the next frame after the last successfully decoded byte.</p></div>
<h5 id="_return_values_62" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the pInData or pOutData pointers is NULL or pOutData can not be converted to pOutData format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Input buffer does not contain enough data or frame is not ready. It is returned after the first field of the field-coded frame is decoded.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_SYNC</code></p></td>
<td align="left" valign="top"><p class="table">Start code was not found.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Unrecoverable error in the bitstream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset_8" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets skip frame counter.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the decoder and is needed to process sequence header to resume decoding after position in the bitstream is changed.</p></div>
<h5 id="_return_values_63" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_10" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Provides information about current stream and decoder parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_45" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to UMC::BaseCodecParams Class. The pointer should refer to the instance of UMC::VideoDecoderParams  Class, which contains common parameters for all decoders. The type of the structure pointed determines the information level to be returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides information about current stream and decoder parameters.</p></div>
<h5 id="_return_values_64" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter pointer is NULL or of incorrect type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_previewlastframe" class="float">PreviewLastFrame</h4>
<div class="paragraph"><p><em>Previews last decoded frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PreviewLastFrame(UMC::VideoData *out, UMC::BaseCodec *pPostProcessing = NULL);</code></pre>
</div></div>
<h5 id="_parameters_46" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to UMC::VideoData Class - destination for the last decoded frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pPostProcessing</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the required postprocessing. If equals zero, current postprocessing is used.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides access to the latest decoded frame stored in the internal buffer. The method allows specifying separate post processing parameters.</p></div>
<h5 id="_return_values_65" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">There is no decoded frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getuserdata_2" class="float">GetUserData</h4>
<div class="paragraph"><p><em>Returns data from GOP user data.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetUserData(UMC::MediaData* pCC);</code></pre>
</div></div>
<h5 id="_parameters_47" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pCC</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the UMC::MediaData Class. The data gets into buffer and the pointer to buffer with the size value are passed to the input parameter.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns closed capture data from Group of Pictures (GOP) user data.</p></div>
<h5 id="_return_values_66" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">No user data is found in the bitstream.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_10" class="float">Close</h4>
<div class="paragraph"><p><em>Destructs the decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes decoding, that is, stops all additional threads, frees all allocated resources, etc. The return value is always UMC::UMC_OK. The method can be used to release resources prior to decoder destruction.</p></div>
<h5 id="_return_values_67" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_setparams_5" class="float">SetParams</h4>
<div class="paragraph"><p><em>Sets the parameters of the decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::BaseCodecParams* params)</code></pre>
</div></div>
<h5 id="_parameters_48" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the UMC::BaseCodecParams. The pointer must actually refer to the instance of UMC::VideoDecoderParams, which contains common parameters for all the decoders.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets the decoder trick mode parameters based on the input parameter
params&#8594;TrickModesFlag.</p></div>
<h5 id="_return_values_68" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter pointer is NULL or of incorrect type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getperformance" class="float">GetPerformance</h4>
<div class="paragraph"><p><em>Provides information on performance of the decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetPerformance (Ipp64f *perf)</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method is currently not implemented and does not modify *perf.</p></div>
<h5 id="_return_values_69" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_resetskipcount_2" class="float">ResetSkipCount</h4>
<div class="paragraph"><p><em>Resets counter of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status ResetSkipCount()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets counter of skipped frames.</p></div>
<h5 id="_return_values_70" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_skipvideoframe_2" class="float">SkipVideoFrame</h4>
<div class="paragraph"><p><em>Increments counter of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SkipVideoFrame(Ipp32s count)</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method changes counter of skipped frames so that a positive value increases the probability of skipping.</p></div>
<h5 id="_return_values_71" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getnumofskippedframes_2" class="float">GetNumOfSkippedFrames</h4>
<div class="paragraph"><p><em>Returns number of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32u GetNumOfSkippedFrames()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the number of skipped frames.</p></div>
<h5 id="_return_values_72" class="float">Return Values</h5>
<div class="paragraph"><p>The number of skipped frames.</p></div>
</div>
<div class="sect3">
<h4 id="_usage_examples_10">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize MPEG2 decoder, create an instance of the UMC::MPEG2VideoDecoder class and invoke Init() method. The method accepts a pointer of type UMC::BaseCodecParams* (see UMC::BaseCodecParams Class) as its single parameter. The pointer must refer to the instance of UMC::VideoDecoderParams structure, which contains common initialization information for all video decoders. The acquired pointer is converted to the UMC::VideoDecoderParams* (see UMC::VideoDecoderParams Class). If conversion attempt fails, the method returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="paragraph"><p>The following members of the UMC::VideoDecoderParams structure determine initialization of the MPEG2 decoder (for more details see declaration of the UMC::VideoDecoderParams):</p></div>
<div class="paragraph"><p><em>numThreads.</em> If the numThreads is not NULL, then the decoder creates the required number of internal decoding threads, but not greater than 8. If the numThreads is NULL, then the decoder creates optimal number of threads based on the number of CPUs on the host or the number of the available processing units in the OpenMP* environment.</p></div>
<div class="paragraph"><p><em>pPostProcessing.</em> This pointer must either be 0 or refer to the proper UMC::VideoProcessing() object (see UMC::VideoProcessing Class). If the pointer is 0, default processing is used that can perform copying or color conversion and resizing, according to the correspondence between the internal and destination format, specified by output UMC::VideoData.
Note that when the pointer is not 0, the decoder does not create a copy of the UMC::VideoProcessing object. It only saves the pointer to it, so the VideoProcessing object should exist all through the period of the decoder operation. The decoder neither destroys it after finishing decoding nor the Close() method is called. The color converter must be released manually.</p></div>
<div class="paragraph"><p><em>lpMemoryAllocator.</em> This pointer must be either 0 (in this case traditional allocation is used) or refer to UMC::MemoryAllocator Class object that contains color conversion info. A different allocation mechanism is used only for big blocks of internal data, such as buffered frames. See also the note about pPostProcessing.</p></div>
<div class="paragraph"><p><em>lFalgs.</em> The following flag value can be set:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>FLAG_VDEC_REORDER</code></p></td>
<td align="left" valign="top"><p class="table">If specified decoder reorders decompressed frames from original (stream) order to display (presentation) order and delay of one frame is introduced. When the flag is not set, time stamps in the output UMC::VideoData can sometimes be incorrect.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>By default FLAG_VDEC_REORDER is set.</p></div>
<div class="paragraph"><p>See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 22. MPEG2VideoDecoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">using</span><span style="color: #000000"> </span><span style="color: #0000ff">namespace</span><span style="color: #000000"> UMC</span><span style="color: #000000">;</span>
<span style="color: #000000">MPEG2VideoDecoder</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">mpeg2Decoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> MPEG2VideoDecoder</span><span style="color: #000000">;</span>
<span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">params </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> VideoDecoderParams</span><span style="color: #000000">;</span>
<span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pIn </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> MediaData</span><span style="color: #000000">;</span>
<span style="color: #000000">VideoData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pOut </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> VideoData</span><span style="color: #000000">;</span>

<span style="color: #000000">pIn</span><span style="color: #000000">-&gt;</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">buf</span><span style="color: #000000">,</span><span style="color: #000000"> fullness</span><span style="color: #000000">);</span>
<span style="color: #000000">pIn</span><span style="color: #000000">-&gt;</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">fullness</span><span style="color: #000000">);</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> pIn</span><span style="color: #000000">;</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">mpeg2Decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">params</span><span style="color: #000000">)))</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">//Process errors</span>
<span style="color: #000000">}</span>
<span style="color: #000000">...</span>
<span style="color: #000000">pOut</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">width</span><span style="color: #000000">,</span><span style="color: #000000"> height</span><span style="color: #000000">,</span><span style="color: #000000"> color_format</span><span style="color: #000000">);</span>
<span style="color: #000000">pOut</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Alloc</span><span style="color: #000000">();</span>
<span style="color: #008000">// Decoding stream using GetFrame(pIn, pOut) method</span>
<span style="color: #000000">...</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> </span><span style="color: #000000">...;</span><span style="color: #000000"> </span><span style="color: #008000">//destructor automatically calls Close() method.</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. The destructor automatically invokes
Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>If video sequence is field-coded, after the first field is successfully decoded GetFrame returns UMC::UMC_ERR_NOT_ENOUGH_DATA. After the second field is decoded, both fields are returned in output UMC::VideoData and UMC::UMC_OK is returned. To retrieve the last buffered reference frame, GetFrame has to be called with zero input pointer.</p></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_9">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>MPEG2 decoder can create a specified number of decoding threads (but not greater than 8) or determine the optimal number of threads automatically. The number of threads is controlled through numThreads member of UMC::BaseCodecParams structure. For more details see Initialization section.</p></div>
<div class="paragraph"><p>Synchronization is performed automatically by means of events and does not require any additional actions.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The decoder allocates approximately 5*pixels_in_frame bytes to store decoded frames and internal data. For example, if resolution is 720x480 the allocated memory is approximately
1.7 Mb.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>If input data does not contain a full compressed frame, GetFrame() method fails with UMC::UMC_ERR_NOT_ENOUGH_DATA return value. The decoder moves the input data pointer by the size of compressed frame after decoding is finished.</p></div>
<div class="paragraph"><p>When input pointer is zero or input UMC::MediaData is empty, the internally buffered frame is returned.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_9">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mpeg2_dec.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(CODECWS)\codec\mpeg2_dec\include
$(CODECWS)\core\umc\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include
$(CODECWS)\core\vm\include
$(CODECWS)\io\media_buffrs\include
$(IPPROOT)\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
color_space_converter
</p>
</li>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
media_buffers
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippi, ippvc, ippcc.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_MPEG2_VIDEO_DECODER is in umc_defs.h.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_mpeg2videoencoder">UMC::MPEG2VideoEncoder</h3>
<div class="paragraph"><p>UMC::MPEG2VideoEncoder is a derived class for converting of video data in YUV format to pure MPEG2 video standard bitstream. Encoding is performed frame by frame. The output bitstream format is described in ISO/IEC 13818-2:1996 [ISO/IEC_96].</p></div>
<div class="paragraph"><p>See next figure for the functional scheme of the decoder.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_27.png" alt="images/umc/umc_5_27.png" />
</div>
<div class="title">Figure 27. MPEG2VideoEncoder Functional Scheme</div>
</div>
<div class="paragraph"><p>Input video frames are stored in the input reordering frame buffer.</p></div>
<div class="paragraph"><p>Intra macroblocks, which form <strong>I</strong>-frames or do not refer to other frames, are VLD-encoded after DCT and quantization, and pass to the output UMC::MediaData.
<strong>P</strong> and <strong>B</strong> macroblocks pass Motion Estimation, where the best matching block in reference
frames is found.
Macroblock type is chosen depending on matching results. When matching is insufficient, the macroblock is encoded as intra. Otherwise, motion vectors, that is, offset to the best matching position in reference frames, are used to form prediction in the motion compensation block. The difference between the prediction and the macroblock undergoes DCT and quantization. Then quantized coefficients and motion vectors form the encoded frame.
For macroblocks in <strong>I</strong> and <strong>P</strong> frames, reconstruction is performed in the form of inverse quantization and IDCT.</p></div>
<div class="paragraph"><p>For inter-coded macroblocks, the result is also added with prediction from motion compensation. The result of reconstruction is stored in the reconstructed reference frame for future use.</p></div>
<div class="paragraph"><div class="title">Derivation</div><p>UMC::MPEG2VideoEncoder is a class derived from UMC::VideoEncoder Class and inherits the basic features of that class. UMC::VideoEncoder is a class derived from UMC::BaseCodec Class for building video data encoders and inherits the basic features of all codecs. UMC::MPEG2VideoEncoder uses UMC::MPEG2EncoderParams class derived from UMC::VideoEncoderParams Class derived from UMC::BaseCodecParams Class. Either MUMC::MPEG2EncoderParams or UMC::VideoEncoderParams is required for initialization of the encoder.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::MediaData, UMC::VideoData, UMC::VideoEncoder, UMC::VideoEncoderParams and UMC::BaseCodecParams classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_11">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p>UMC::MPEG2EncoderParams is an interface class derived from UMC::VideoEncoderParams Class and is used to set or modify encoder parameters and read them from the parameter file.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 109. Rate Control Modes</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Define         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>RC_CBR</code></p></td>
<td align="left" valign="top"><p class="table">Constant bit rate mode of rate control</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RC_VBR<br />
RC_UVBR</code></p></td>
<td align="left" valign="top"><p class="table">Unrestricted variable bit rate mode of the rate control</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RC_RVBR</code></p></td>
<td align="left" valign="top"><p class="table">Restricted variable bit rate mode of rate control</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Some UMC::MPEG2EncoderParams members are used as input to specify encoding parameters, some are used to get current state or information from encoder, and some are ignored.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 110. MPEG2EncoderParams Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                       </th>
<th align="left" valign="top">Type               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><strong>BaseCodecParams members</strong></code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_SuggestedInputSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">[out] Suggested input frame size in bytes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_SuggestedOutputSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">[out] Suggested maximum input frame size in bytes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>numThreads</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Maximum number of threads to use. If 0, use the number equal to the number of logical processors.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>M_pData</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::MediaData*</code></p></td>
<td align="left" valign="top"><p class="table">Ignored by encoders</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lpMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::MemoryAllocator*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the external Memory allocator or NULL</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>profile</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] Standard defined profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>level</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] Standard defined level.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><strong>VideoEncoderParams members</strong></code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::VideoStreamInfo</code></p></td>
<td align="left" valign="top"><p class="table">Structure with video stream parameters</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.clip_info</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::ClipInfo</code></p></td>
<td align="left" valign="top"><p class="table">[in] Members width and height, video frame size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.color_format</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::ColorFormat</code></p></td>
<td align="left" valign="top"><p class="table">[in] Color format of the encoded video</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.bitrate</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">[in] Bit rate in bits per second</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.aspect_ratio_width</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Pixel aspect ratio</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.aspect_ratio_height</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Pixel aspect ratio</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.framerate</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table">[in] Frame rate of the encoded video</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.duration</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table">Duration of video stream, ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.interlace_type</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::InterlaceType</code></p></td>
<td align="left" valign="top"><p class="table">[in] Interlacing information</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.stream_type</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::VideoStreamType</code></p></td>
<td align="left" valign="top"><p class="table">[out] Stream type, set to MPEG2_VIDEO</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.stream_subtype</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::VideoStreamSubType</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.profile</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] standard defined profile</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.level</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] standard defined level</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.streamPID</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>numEncodedFrames</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] Number of encoded frames</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>qualityMeasure</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] Quantization precision, in percents</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><strong>MPEG2EncoderParams members</strong></code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lFlags</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] FLAG_VENC_REORDER or 0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>mpeg1</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored, only 0 supported - mpeg2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>IPDistance</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Distance between key-frames, positive</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>gopSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Number of frames in the group of pictures</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>FieldPicture</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Frames encoded as a pair of fields, if not 0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VBV_BufferSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] VBV size in 16 kbit units</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>low_delay</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored, not supported</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>rangeP</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s[2]</code></p></td>
<td align="left" valign="top"><p class="table">Motion estimation range for <strong>P</strong> frames <code>[x,y</code>]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>rangeB</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s[2][2]</code></p></td>
<td align="left" valign="top"><p class="table">Motion estimation range for <strong>B</strong> frames <code>[nearest reference, farthest]</code>[x,y]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>pMotionData</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::bhMotionData*</code></p></td>
<td align="left" valign="top"><p class="table">[in] Motion estimation ranges for <strong>P</strong>, B0, B1, &#8230;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>nonLinearQScale</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s[3]</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>frame_pred_frame_dct</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s[3]</code></p></td>
<td align="left" valign="top"><p class="table">[in] Only frame dct and prediction for <strong>I</strong>, <strong>P</strong>, <strong>B</strong></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>intraVLCFormat</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s[3]</code></p></td>
<td align="left" valign="top"><p class="table">[in] Table selection for <strong>I</strong>, <strong>P</strong>, <strong>B</strong></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>altscan_tab</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s[3]</code></p></td>
<td align="left" valign="top"><p class="table">[in] Zigzag or alternate scan for <strong>I</strong>, <strong>P</strong>, <strong>B</strong></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>CustomIntraQMatrix</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] IntraQMatrix below is to be used</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>CustomNonIntraQMatrix</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] NonIntraQMatrix below is to be used</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>IntraQMatrix</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp16s[64]</code></p></td>
<td align="left" valign="top"><p class="table">[in] Particular intra quantization matrix</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>NonIntraQMatrix</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp16s[64]</code></p></td>
<td align="left" valign="top"><p class="table">[in] Particular inter quantization matrix</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>me_alg_num</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Motion estimation algorithm: 1-local, 2-log, 3-both, 9-full, +10-full pixel only</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>me_auto_range</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Dynamically adjust search range, if not 0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>allow_prediction16x8</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Allows field coded MB in frame pictures</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>rc_mode</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Rate control mode</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>quant_vbr</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s[3]</code></p></td>
<td align="left" valign="top"><p class="table">[in] Quantizers for VBR modes for <strong>I</strong>, <strong>P</strong>, <strong>B</strong></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UserData</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u*</code></p></td>
<td align="left" valign="top"><p class="table">[out] User data to be coded with next picture</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UserDataLen</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] Current user data length</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>idStr</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u[]</code></p></td>
<td align="left" valign="top"><p class="table">[] Default user data to put to each sequence</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 111. MPEG2EncoderParams Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>ReadParamFile</code></p></td>
<td align="left" valign="top"><p class="table">Opens and reads MSSG standard parameter file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ReadQMatrices</code></p></td>
<td align="left" valign="top"><p class="table">Opens and reads two text files with quantizer matrices.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Profile_and_Level_Checks</code></p></td>
<td align="left" valign="top"><p class="table">Checks and fixes profile and level.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RelationChecks</code></p></td>
<td align="left" valign="top"><p class="table">Checks and fixes dependent parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Member Functions</div><p>See UMC::BaseCodec Class and UMC::VideoEncoder Class.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 112. MPEG2VideoEncoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes the encoder with specified parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Gets current encoder working parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Encodes the next video frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RepeatLastFrame</code></p></td>
<td align="left" valign="top"><p class="table">Repeats last encoded frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets the encoder into initial state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Defines the working parameters for the encoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetNextYUVBuffer</code></p></td>
<td align="left" valign="top"><p class="table">Gets buffer for the next input frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetBitRate</code></p></td>
<td align="left" valign="top"><p class="table">Sets value of BitRate encoder parameter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Destructs the encoder and closes all encoder resources.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_11" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the encoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters_49" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure. The pointer should refer to an object of the UMC::VideoEncoderParams Class, which contains common initialization information for all encoders, or to UMC::MPEG2EncoderParams with more detailed MPEG2 specific parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the encoder. See detailed description of this method in Initialization section.</p></div>
<h5 id="_return_values_73" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The input pointer is NULL or neither UMC::VideoEncoderParams nor derived from it.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Incorrect bitstream of a wrong format or a size that is not enough.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The encoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_11" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Gets current encoder working parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *info);</code></pre>
</div></div>
<h5 id="_parameters_50" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>info</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to UMC::BaseCodecParams Class data object for getting the encoder parameters. The pointer can point to the instance of UMC::VideoEncoderParams Class or UMC::MPEG2EncoderParams. Destination is filled according to its class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method gets encoder working (initialization) parameters.</p></div>
<div class="paragraph"><p>This method can be used to obtain current profile/level information. Suggested sizes of input and output buffers are BaseCodecParams::m_SuggestedOutputSize and BaseCodecParams::m_SuggestedInputSize.</p></div>
<h5 id="_return_values_74" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the essential pointers is NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe_11" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Encodes next video frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *pInData, UMC::MediaData *pOutData);</code></pre>
</div></div>
<h5 id="_parameters_51" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInData</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to an input data object. If the pointer refers to the instance of the UMC::VideoData object, it is assumed to be the next uncompressed video frame to encode. If the size of the input frame differs from the one used for initialization it is resized, and when color format differs it is converted. If pInData points to UMC::MediaData object with positive data size, it is assumed to be user data and is put to video user data with the next video picture. When pInData is 0, frames buffered for reordering are returned, if any.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pOutData</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an output data object, which is UMC::MediaData with encoded bitstream. If pOutData is not empty, new data is appended to the end. At start of encoding, GetFrame() can return UMC_OK but stores nothing to pOutData because of the internal frame reordering buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method takes a YUV frame provided by pInData and returns an encoded frame to pOutData. Due to internal buffering, the output frame comes usually earlier than the input frame or can be missed. To get buffered frames in the end of the encoding process, GetFrame should be called with pInData equal to NULL while it returns UMC::UMC_OK.</p></div>
<h5 id="_return_values_75" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Invalid input parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the essential pointers is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">The set size is not enough to save the buffer for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">No output was generated due to frame reorder and delay.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_repeatlastframe" class="float">RepeatLastFrame</h4>
<div class="paragraph"><p><em>Repeats last encoded frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status RepeatLastFrame(Ipp64f PTS, UMC::MediaData *pOutData);</code></pre>
</div></div>
<h5 id="_parameters_52" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>PTS</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Presentation time stamp for output data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pOutData</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an output data object. The pointer should refer to the instance of the UMC::MediaData Class object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method currently repeats the last encoded frame. The method is not yet implemented.</p></div>
<h5 id="_return_values_76" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_IMPLEMENTED</code></p></td>
<td align="left" valign="top"><p class="table">The method is not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the essential pointers is NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset_9" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets the encoder into initial state.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method reinitializes the encoder with current encoding parameters. The method can be used to start a new video sequence.</p></div>
<h5 id="_return_values_77" class="float">Return Values</h5>
<div class="paragraph"><p>Returns the results of Init() calling method.</p></div>
<hr />
<h4 id="_setparams_6" class="float">SetParams</h4>
<div class="paragraph"><p><em>Defines the working parameters for the encoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_53" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to UMC::BaseCodecParams Class. The pointer can point to the instance of UMC::VideoEncoderParams  Class or UMC::MPEG2EncoderParams. Encoder parameters are changed according to the class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method changes the working parameters of the encoder. This method starts a new sequence.</p></div>
<h5 id="_return_values_78" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the essential pointers is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The encoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Error that indicates that the defined values of the encoder parameters are unsupported or do not exist.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getnextyuvbuffer" class="float">GetNextYUVBuffer</h4>
<div class="paragraph"><p><em>Gets buffer for the next input frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetNextYUVBuffer(UMC::VideoData *data);</code></pre>
</div></div>
<h5 id="_parameters_54" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>data</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to UMC::VideoData Class that is used to set desctination buffer pointers and pitches.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method gets a buffer for the next frame, sets a pointer to internal allocated buffer which is used as destination for input data. This method can allow optimizing memory usage or avoiding internal copying.</p></div>
<h5 id="_return_values_79" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Allocation of internal buffer failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_setbitrate" class="float">SetBitRate</h4>
<div class="paragraph"><p><em>Sets value of BitRate encoder parameter.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetBitRate(Ipp32s BitRate);</code></pre>
</div></div>
<h5 id="_parameters_55" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>BitRate</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. New bit rate value to set.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method changes the current bit rate and reinitializes rate control mechanism.</p></div>
<h5 id="_return_values_80" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_11" class="float">Close</h4>
<div class="paragraph"><p><em>Closes and frees all encoder resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes encoding, that is, closes and releases all encoder resources.</p></div>
<h5 id="_return_values_81" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_11">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize MPEG2 video encoder, create an instance of the UMC::MPEG2VideoEncoder class and invoke  Init() method. The method accepts a pointer of type UMC::BaseCodecParams* (see UMC::BaseCodecParams Class) as its single parameter. The pointer must refer to the instance of UMC::VideoEncoderParams structure or UMC::MPEG2EncoderParams structure, which contains common initialization information for the codec. If casting of the input pointer to UMC::VideoEncoderParams fails, the method returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="paragraph"><p>Data members in UMC::VideoEncoderParams and UMC::MPEG2EncoderParams marked with [in] affect encoder initialization. All of them, except frame dimension, are set by default to appropriate values.</p></div>
<div class="paragraph"><p>When used for initialization, UMC::MPEG2EncoderParams provides additional possibilities in configuration.</p></div>
<div class="paragraph"><div class="title">Sequence parameters:</div><p><em>VBV_BufferSize.</em> Size of VBV_Buffer in 16 Kbit units. Adjusted, if the value is too low.</p></div>
<div class="paragraph"><p><em>rc_mode.</em> Rate control mode; can be:</p></div>
<div class="ulist"><ul>
<li>
<p>
RC_CBR - constant bit rate (default)
</p>
</li>
<li>
<p>
RC_[U]VBR - unrestricted variable bit rate
</p>
</li>
<li>
<p>
RC_RVBR - restricted variable bit rate.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Constant bit rate is defined by hypothetical VBV buffer that is filled with each encoded frame data at its decoding time moment. At the same time the buffer is drained with given constant bit rate. When rate control works properly there is no over- or underflow of the buffer. Unrestricted variable rate control means that there is no rate control, only quantizers from quant_vbr[3] are used. When variable rate control is restricted it is similar to CBR, but quantizers given can be increased to avoid exceeding the given bit rate.</p></div>
<div class="paragraph"><p><em>rangeP, rangeB.</em> Motion estimation ranges for <strong>P</strong> and <strong>B</strong> frames. Last index in an array denotes x and y components. The first index of rangeB represent the range for the closest and farthest reference frame in display order. If only one <strong>B</strong> frame in a row is used, the farthest range is ignored. If there are more than 2 <strong>B</strong> frames in a row, the range is linearly interpolated. Motion estimation ranges are dependent from f_code, so the obtained values are adjusted in the UMC::MPEG2VideoEncoder::RelationChecks method.</p></div>
<div class="paragraph"><p>The following members of the UMC::MPEG2EncoderParams class are initialized with default values during in its constructor:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>lFlag</code></p></td>
<td align="left" valign="top"><p class="table">Default value = FLAG_VENC_REORDER.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>IPDistance</code></p></td>
<td align="left" valign="top"><p class="table">Default value = 3.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>gopSize</code></p></td>
<td align="left" valign="top"><p class="table">Default value = 15.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>profile</code></p></td>
<td align="left" valign="top"><p class="table">Default value = 4 (Main Profile).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>level</code></p></td>
<td align="left" valign="top"><p class="table">Default value = 8 (Main Level).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Flags:</div><p>FLAG_VENC_REORDER - reordering of input frames.</p></div>
<div class="paragraph"><p>When this flag is not set, reordering has to be performed by the application so that frames on input are in encoding order. UMC::MediaData::SetFrameType is used to provide the frame type (<strong>I</strong>, <strong>P</strong> or <strong>B</strong>).</p></div>
<div class="paragraph"><p>Other bits in flag field are ignored.</p></div>
<div class="paragraph"><div class="title">Initialization Examples:</div><p>There are two methods of MPEG2 encoder initialization:</p></div>
<div class="ulist"><ul>
<li>
<p>
Call UMC::MPEG2VideoEncoder::Init(UMC::BasicCodecParams*) member function with a parameter that is a pointer to UMC::VideoEncoderParams class object. This is a method when user does not want to change the default values of specific MPEG-2 encoding parameters and only sets general encoding parameters like width, height, bit rate, etc.
</p>
</li>
<li>
<p>
Call UMC::MPEG2VideoEncoder::Init(UMC::BasicCodecParams*) member function with a parameter that is a pointer to UMC::MPEG2EncoderParams class object. This is a method when the user wants not only to set general encoding parameters, but also to set specific parameters for MPEG-2 codec. UMC::MPEG2EncoderParams object can be initialized via UMC::MPEG2EncoderParams::ReadParamFile() member function.
</p>
</li>
</ul></div>
<div class="paragraph"><p>See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 23. MPEG2VideoEncoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG2VideoEncoder</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">mpeg2Encoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG2VideoEncoder</span><span style="color: #000000">();</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">params </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000">();</span>

<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">720</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">480</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">bitrate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">4000000</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">framerate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">30</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">4</span><span style="color: #000000">;</span>

<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">mpeg2Encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">params</span><span style="color: #000000">)))</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">//Process errors</span>
<span style="color: #000000">}</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">...</span>
<span style="color: #008000">// Encoding stream</span>
<span style="color: #000000">...</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> mpeg2Encoder</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">//destructor automatically calls Close() method.</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. The destructor automatically invokes
Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>For encoder initialization with parameters from par-file and from command line, for main working cycle example see $(CODECWS)\application\umc_video_enc_con\. See an example of par-file in $(CODECWS)\test\streams\video\video_enc\.</p></div>
<div class="exampleblock">
<div class="title">Example 24. MPEG2VideoEncoder Typical Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG2EncoderParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG2VideoEncoder</span><span style="color: #000000"> encoder</span><span style="color: #000000">;</span>
<span style="color: #008000">// Set encoder params</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width </span><span style="color: #000000">=</span><span style="color: #000000"> x</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> y</span><span style="color: #000000">;</span>
<span style="color: #000000">...</span><span style="color: #000000"> encoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">params</span><span style="color: #000000">);</span>

<span style="color: #008000">//main loop</span>
<span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">have_frames</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> in</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> out</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">want_to_change_anything</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000"> newpar</span><span style="color: #000000">;</span>
<span style="color: #000000">        encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">newpar</span><span style="color: #000000">);</span>
<span style="color: #000000">        newpar</span><span style="color: #000000">.</span><span style="color: #000000">Bitrate </span><span style="color: #000000">=</span><span style="color: #000000"> newbrate</span><span style="color: #000000">;</span>
<span style="color: #000000">        encoder</span><span style="color: #000000">.</span><span style="color: #000000">SetParams</span><span style="color: #000000">(&amp;</span><span style="color: #000000">newpar</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #008000">// change encoder params except frame size, number of threads, chroma format</span>
<span style="color: #000000">        </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// parameters changed</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">want_restart_sequence</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        encoder</span><span style="color: #000000">.</span><span style="color: #000000">Reset</span><span style="color: #000000">();</span>
<span style="color: #000000">        </span><span style="color: #008000">//or encoder.SetParams(0);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">want_add_user_data</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// for the next frame</span>
<span style="color: #000000">        UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">the_user_data </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">get_somewhere</span><span style="color: #000000">();</span>
<span style="color: #000000">        encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">the_user_data</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #008000">// MAIN THINGS IN THE LOOP //</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000"> </span><span style="color: #000000">prepare_input</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// not the end;</span>
<span style="color: #000000">        encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// no more input frames, take buffered</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">out</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// done</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">do_smth_with_out</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">want_quality_info</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000"> newpar</span><span style="color: #000000">;</span>
<span style="color: #000000">        encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">newpar</span><span style="color: #000000">);</span><span style="color: #000000"> </span><span style="color: #008000">// can use MPEG2EncoderParams as well</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">newpar</span><span style="color: #000000">.</span><span style="color: #000000">qualityMeasure </span><span style="color: #000000">&lt;</span><span style="color: #000000"> </span><span style="color: #000000">30</span><span style="color: #000000"> </span><span style="color: #008000">/* 30% */</span><span style="color: #000000">)</span>
<span style="color: #000000">            want_to_change_anything </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// f.e.</span>
<span style="color: #000000">            </span><span style="color: #008000">// Here also can get current rates, etc.</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>

<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// while have frames</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_10">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>MPEG2 video encoder can create a specified number of encoding threads or determine the optimal number of threads automatically. The number of threads is set in UMC::BaseCodecParams::numThreads. If this number is set to 0, the encoder sets and uses the number of logical processors in system. Each thread encodes a number of consequent slices.</p></div>
<div class="paragraph"><p>Synchronization and internal threads management are performed automatically by means of events and do not require any additional actions.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_29.png" alt="images/umc/umc_5_29.png" />
</div>
<div class="title">Figure 28. MPEG2VideoEncoder Data Threading Model</div>
</div>
<div class="paragraph"><div class="title">Memory Usage</div><p>UMC::MPEG2VideoEncoder allocates a little more than YUV frame size multiplied by IPDistance+3. For example, for a 720x480 frame and default IPDistance of 3, it allocates about 3.5 MB.</p></div>
<div class="paragraph"><p>The encoder supports UMC::MemoryAllocator Class interface.</p></div>
<div class="paragraph"><p>The encoder uses internal buffering of the frames to perform reordering necessary for encoding with <strong>B</strong> frames. It also holds encoded and reconstructed frames to perform temporal prediction.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>To get buffered frames at the end of stream, GetFrame() is called with 0 input pointer. The UMC::UMC_ERR_NOT_ENOUGH_DATA code returned by the method means that no more frames are buffered internally.
SetParams() method fails with UMC::UMC_ERR_UNSUPPORTED error if the input values of the width or height of source media are not equal to current values. Change of the frame size is only possible with encoder reinitialization.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_10">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mpeg2_video_encoder.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(IPPROOT)\include
$(CODECWS)\codec\mpeg2_enc\include
$(CODECWS)\core\umc\include
$(CODECWS)\codec\color_space_converter\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
color_space_converter.
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippi, ippvc, ippcc.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_MPEG2_VIDEO_ENCODER is in umc_defs.h.</p></div>
</div>
<div class="sect3">
<h4 id="_features_and_notes_2">Features and Notes</h4>
<div class="paragraph"><div class="title">Rate Control</div><p>The UMC::MPEG2VideoEncoder supports CBR (default) and both restricted and unrestricted VBR rate control. Rate control mode is controlled by UMC::MPEG2EncoderParams::rc_mode parameter. Default mode is CBR. With CBR obtained bitstream size is time*(bit rate) plus/minus VBV buffer size.</p></div>
<div class="paragraph"><p>To use VBR modes, UMC::MPEG2EncoderParams::quant_vbr array should be set. Unrestricted VBR is enabled when bit rate is set to 0. In this mode, the same quantizers are always used and resulting bit rate is unlimited. Restricted VBR requires both bit rate and quantizers to be set. This mode is similar to CBR but resulting bit rate is not greater than the bit rate provided in parameters. The quantizer can be increased to decrease size of the encoded frame. Restricted VBR can be slow if quantizers are too small for the bit rate.</p></div>
<div class="paragraph"><div class="title">Other UMC Components</div><p>Other UMC components can be used to extend encoder abilities. For example, UMC::VideoProcessing Class can be used before the encoder to perform image transformations or filtering or UMC::MPEG2Muxer can be used for packetization of output pure video stream.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_mpeg4videodecoder">UMC::MPEG4VideoDecoder</h3>
<div class="paragraph"><p>UMC::MPEG4VideoDecoder is a derived class for decoding of video data from bitstream encoded in compliance with
MPEG-4:2 standard ISO/IEC 14496-2:2004 <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>.</p></div>
<div class="paragraph"><p>See next figure for the functional scheme of the decoder.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_30.png" alt="images/umc/umc_5_30.png" />
</div>
<div class="title">Figure 29. MPEG4VideoDecoder Functional Scheme</div>
</div>
<div class="paragraph"><p>Motion vectors and quantized DCT coefficients are extracted from input UMC::MediaData in VLD block. Motion vectors together with decoded reference frames from Internal Frame Buffer are used to form Motion Prediction from one of the frames, previous or following in the display order. DCT Coeffs are dequantized and after IDCT are used for motion compensation of the prediction. Decoded frames are stored in Internal Frame Buffer for future references, if necessary. Frames are delivered in output UMC::VideoData either with or without reordering. The deblocking and/or deringing filters may be applied to output UMC::VideoData before return.</p></div>
<div class="paragraph"><div class="title">Derivation</div><p>UMC::MPEG4VideoDecoder class is inherited from UMC::VideoDecoder Class.</p></div>
<div class="paragraph"><p>UMC::VideoDecoder class provides basic interface for all video decoders. It includes methods that perform initialization of the decoder, decompression of the frame, destroying of the decoder, etc.</p></div>
<div class="dlist"><div class="title">See Also</div><dl>
<dt class="hdlist1">
UMC::MediaData, UMC::VideoData, UMC::BaseCodec, UMC::VideoDecoder,UMC
</dt>
<dd>
<p>
VideoDecoderParams, UMC::VideoProcessing, UMC::MemoryAllocator
and UMC::DefaultMemoryAllocator classes.
</p>
</dd>
</dl></div>
<div class="sect3">
<h4 id="_user_interface_12">User Interface</h4>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 113. MPEG4VideoDecoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes the decoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Decodes the next video frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets the decoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Provides information about stream and decoder parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetPerformance</code></p></td>
<td align="left" valign="top"><p class="table">Gets performance. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ResetSkipCount</code></p></td>
<td align="left" valign="top"><p class="table">Resets counter of skipped frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SkipVideoFrame</code></p></td>
<td align="left" valign="top"><p class="table">Increments counter of skipped frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetNumOfSkippedFrames</code></p></td>
<td align="left" valign="top"><p class="table">Returns the number of skipped frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetDeblockingParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets post-processing deblocking parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetDeringingParams</code></p></td>
<td align="left" valign="top"><p class="table">Sets post-processing deringing parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Closes decoding and frees all allocated resources.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_12" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters_56" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to an object of the UMC::BaseCodecParams Class or derived UMC::VideoDecoderParams Class, which contains specific information to initialze the decoder.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the decoder. See detailed description of this method in Initialization section.</p></div>
<div class="paragraph"><p>The init must be the pointer to UMC::VideoDecoderParams class.</p></div>
<div class="paragraph"><p>If init&#8594;m_pData != NULL, then the bit stream parsing (Visual Object Header, VideoObject Header) and internal initialization are started.</p></div>
<div class="paragraph"><p>If init&#8594;m_pData == NULL, then the bit stream parsing (Visual Object Header, VideoObject Header) and internal initialization are performed at first GetFrame() call. Close() method is called in Init().</p></div>
<h5 id="_return_values_82" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Init() was called without data and pParam&#8594;info.clip_info.width is equal to zero or pParam&#8594;info.clip_info.height is equal to zero.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">An error is present during decoding of MPEG-4 headers at the initialization stage.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_SYNC</code></p></td>
<td align="left" valign="top"><p class="table">MPEG-4 start codes were not found.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframe_12" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Decodes next video frame and returns one of decoded and buffered frames to display.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *in, UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_57" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an object of the UMC::MediaData Class or derived classes, which contains input video frame data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an object of the UMC::VideoData Class or derived classes, which contains output video frame data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method decodes the next compressed video frame and returns one of the decoded and buffered frames to display.</p></div>
<div class="paragraph"><p>If in == NULL and there are no internally buffered frames, then UMC::UMC_ERR_NOT_ENOUGH_DATA is returned, otherwise the buffered decoded frame is returned.</p></div>
<div class="paragraph"><p>If the decoder is initialized to work in VDEC_REORDER mode, the first frame is buffered. The encoded data pointed to by in must contain at least one frame. After decoding one frame, the pointer is moved.</p></div>
<h5 id="_return_values_83" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">If out == NULL or out is not a VideoData object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">The decoder requires the next portion of data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">An error is present in the decoded MPEG-4 headers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_SYNC</code></p></td>
<td align="left" valign="top"><p class="table">MPEG-4 start codes were not found.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder was not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_WRN_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">An error is present during decoding of the frame data.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset_10" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets skip frame counter.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the decoder and is needed to resume decoding after position in the bitstream is changed.</p></div>
<div class="paragraph"><p>After calling the Reset() method the decoder skips all not I-frames in GetFrame()
method.</p></div>
<h5 id="_return_values_84" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Decoder was not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_12" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Provides information about current stream and decoder parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_58" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to UMC::BaseCodecParams Class. The pointer can refer to the instance of UMC::VideoDecoderParams  Class as well, which contains common parameters for all decoders. The type of the structure pointed determines the information level to be returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides information about current stream and decoder parameters.</p></div>
<h5 id="_return_values_85" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter pointer is NULL or of incorrect type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getperformance_2" class="float">GetPerformance</h4>
<div class="paragraph"><p><em>Gets performance.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetPerformance(Ipp64f *perf);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method is currently not implemented and does not modify *perf.</p></div>
<h5 id="_return_values_86" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_IMPLEMENTED</code></p></td>
<td align="left" valign="top"><p class="table">The method is not implemented.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_resetskipcount_3" class="float">ResetSkipCount</h4>
<div class="paragraph"><p><em>Resets counter of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status ResetSkipCount();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the internal counter of skipped frames.</p></div>
<h5 id="_return_values_87" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_skipvideoframe_3" class="float">SkipVideoFrame</h4>
<div class="paragraph"><p><em>Increments counter of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status SkipVideoFrame(Ipp32s count);</code></pre>
</div></div>
<h5 id="_parameters_59" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>count</em></p></td>
<td align="left" valign="top"><p class="table">Number of frames to be skipped.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method changes frame skipping state counter so that positive value increases probability of skipping.</p></div>
<h5 id="_return_values_88" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getnumofskippedframes_3" class="float">GetNumOfSkippedFrames</h4>
<div class="paragraph"><p><em>Returns number of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>Ipp32u GetNumOfSkippedFrames();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the number of skipped frames.</p></div>
<h5 id="_return_values_89" class="float">Return Values</h5>
<div class="paragraph"><p>The number of skipped frames.</p></div>
<hr />
<h4 id="_setdeblockingparams" class="float">SetDeblockingParams</h4>
<div class="paragraph"><p><em>Sets post-processing deblocking parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status SetDeblockingParams(bool procPlane0, bool procPlane1, bool procPlane2, Ipp32s THR1 = 2, Ipp32s THR2 = 6);</code></pre>
</div></div>
<h5 id="_parameters_60" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>procPlane0</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that indicates processing of Y plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>procPlane1</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that indicates processing of U plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>procPlane2</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that indicates processing of V plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>THR1</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that indicates the first threshold for deblocking (see Annex F of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>THR2</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that indicates the second threshold for deblocking (see Annex F of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets the parameters for post-process deblocking (see Annex F of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>).</p></div>
<h5 id="_return_values_90" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_setderingingparams" class="float">SetDeringingParams</h4>
<div class="paragraph"><p><em>Sets post-processing deblocking parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status SetDeringingParams(bool procPlane0, bool procPlane1, bool procPlane2);</code></pre>
</div></div>
<h5 id="_parameters_61" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>procPlane0</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that indicates processing of Y plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>procPlane1</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that indicates processing of U plane.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>procPlane2</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that indicates processing of V plane.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets the parameters for post-process deringing (see Annex F of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>).</p></div>
<h5 id="_return_values_91" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_12" class="float">Close</h4>
<div class="paragraph"><p><em>Closes decoding and frees all allocated resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes decoding, that is, stops all additional threads, releases all allocated resources, etc. The return value is always UMC::UMC_OK. The method can be used to release resources prior to decoder destruction.</p></div>
<h5 id="_return_values_92" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_12">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize MPEG4 decoder, create an instance of the UMC::MPEG4VideoDecoder class and invoke Init() method. The method accepts a pointer of type UMC::BaseCodecParams* (see UMC::BaseCodecParams Class) as its single parameter. The pointer must refer to the instance of UMC::VideoDecoderParams structure, which contains common initialization information for all video decoders. The acquired pointer is converted to the UMC::VideoDecoderParams* (see UMC::VideoDecoderParams Class). If conversion attempt fails, the method returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="paragraph"><p>The following members of the UMC::VideoDecoderParams structure determine initialization of the MPEG4 decoder (for more details see declaration of the UMC::VideoDecoderParams):</p></div>
<div class="paragraph"><p><em>numThreads.</em> If the numThreads is greater than 0, the decoder creates the required number of internal decoding threads. If the numThreads is less than 1 or is too big, the decoder creates the optimal number of threads based on the number of CPUs on the host or the number of the available processing units in the OpenMP* environment.</p></div>
<div class="paragraph"><p><em>pPostProcessing.</em> This pointer must either be NULL or refer to the proper UMC::VideoProcessing() object (see UMC::VideoProcessing Class). If the pointer is NULL, default processing is used that can perform copying or color conversion and resizing, according to the correspondence between the internal and destination formats, the latter specified by output UMC::VideoData.
Note that when the pointer is not NULL, the decoder does not create a copy of the
UMC::VideoProcessing object. It only saves the pointer to it, so the
UMC::VideoProcessing object should exist all through the decoding process. The
decoder neither destroys it after decoding is finished nor when the Close() method is
called. The UMC::VideoProcessing object must be released manually.</p></div>
<div class="paragraph"><p><em>lpMemoryAllocator.</em> This pointer must be either 0 (in this case UMC::DefaultMemoryAllocator is used) or refer to a UMC::MemoryAllocator Class object that contains color conversion info. A different allocation mechanism is used only for big blocks of internal data, such as buffered frames. See also the note about pPostProcessing.</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table">lFlags. FLAG_VDEC_REORDER</p></td>
<td align="left" valign="top"><p class="table">If specified decoder reorders decompressed frames from original (stream) order to display (presentation) order and delay of one frame is introduced. When the flag is not set, time stamps in the output UMC::VideoData can sometimes be incorrect.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 25. MPEG4VideoDecoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG4VideoDecoder</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">mpeg4Decoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG4VideoDecoder</span><span style="color: #000000">();</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">params </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000">();</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pIn </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000">();</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pOut </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000">();</span>

<span style="color: #000000">pIn</span><span style="color: #000000">-&gt;</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">buf</span><span style="color: #000000">,</span><span style="color: #000000"> fullness</span><span style="color: #000000">);</span>
<span style="color: #000000">pIn</span><span style="color: #000000">-&gt;</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">fullness</span><span style="color: #000000">);</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> pIn</span><span style="color: #000000">;</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">mpeg4Decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">params</span><span style="color: #000000">)))</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">//Process errors</span>
<span style="color: #000000">}</span>
<span style="color: #000000">...</span>
<span style="color: #000000">pOut</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">width</span><span style="color: #000000">,</span><span style="color: #000000"> height</span><span style="color: #000000">,</span><span style="color: #000000"> color_format</span><span style="color: #000000">);</span>
<span style="color: #000000">pOut</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Alloc</span><span style="color: #000000">();</span>
<span style="color: #008000">// Decoding stream using GetFrame(pIn, pOut) method</span>
<span style="color: #000000">...</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> mpeg4Decoder</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">//destructor automatically calls Close() method.</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>The example below shows how to decode *.AVI files with MPEG-4 content and dump YUV
output to a file.</p></div>
<div class="exampleblock">
<div class="title">Example 26. AVI Decoding</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_defs.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"vm_time.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_structures.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_data_reader.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_splitter.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_video_decoder.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_video_data.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_video_render.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_file_reader.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_fio_reader.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_avi_splitter.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"umc_mpeg4_video_decoder.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"fw_video_render.h"</span>

<span style="color: #0000ff">int</span><span style="color: #000000"> </span><span style="color: #000000">main</span><span style="color: #000000">(</span><span style="color: #0000ff">int</span><span style="color: #000000"> argc</span><span style="color: #000000">,</span><span style="color: #000000"> vm_char</span><span style="color: #000000">*</span><span style="color: #000000"> argv</span><span style="color: #000000">[])</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">ippStaticInit</span><span style="color: #000000">();</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">argc </span><span style="color: #000000">&lt;</span><span style="color: #000000"> </span><span style="color: #000000">2</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"expected AVI file name"</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> sts</span><span style="color: #000000">,</span><span style="color: #000000"> sSts</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FIOReader</span><span style="color: #000000"> Reader</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">AVISplitter</span><span style="color: #000000"> Splitter</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">StreamInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG4VideoDecoder</span><span style="color: #000000"> Decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FWVideoRender</span><span style="color: #000000"> Render</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> in</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> out</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #008000">// Initialize data reader component</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReaderParams</span><span style="color: #000000"> FileParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    FileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">FileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> argv</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">]);</span>
<span style="color: #000000">    sts </span><span style="color: #000000">=</span><span style="color: #000000"> Reader</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">FileParams</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Reader Init error</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #008000">// Initialize splitter component</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterParams</span><span style="color: #000000"> SplParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    SplParams</span><span style="color: #000000">.</span><span style="color: #000000">m_lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VIDEO_SPLITTER</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// extract only video</span>
<span style="color: #000000">    SplParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pDataReader </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">Reader</span><span style="color: #000000">;</span>
<span style="color: #000000">    sts </span><span style="color: #000000">=</span><span style="color: #000000"> Splitter</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">SplParams</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Splitter Init error</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    sts </span><span style="color: #000000">=</span><span style="color: #000000"> Splitter</span><span style="color: #000000">.</span><span style="color: #000000">Run</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Splitter Run error</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #008000">// Get stream info</span>
<span style="color: #000000">    sts </span><span style="color: #000000">=</span><span style="color: #000000"> Splitter</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">StreamInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Splitter GetInfo error</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #008000">// find MPEG4 video track</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> videoTrack</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">for</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">videoTrack </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span><span style="color: #000000"> videoTrack </span><span style="color: #000000">&lt;</span><span style="color: #000000"> StreamInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_nOfTracks</span><span style="color: #000000">;</span><span style="color: #000000"> videoTrack</span><span style="color: #000000">++)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">StreamInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">videoTrack</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_Type </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_MPEG4V</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">videoTrack </span><span style="color: #000000">==</span><span style="color: #000000"> StreamInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_nOfTracks</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"AVI does not contain MPEG-4 video</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">videoTrackInfo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">*((</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000">*)</span><span style="color: #000000">StreamInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">videoTrack</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_pStreamInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #008000">// Initialize video decoder component</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> VDecParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    VDecParams</span><span style="color: #000000">.</span><span style="color: #000000">info </span><span style="color: #000000">=</span><span style="color: #000000"> videoTrackInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    VDecParams</span><span style="color: #000000">.</span><span style="color: #000000">lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FLAG_VDEC_REORDER</span><span style="color: #000000">;</span>
<span style="color: #000000">    VDecParams</span><span style="color: #000000">.</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    VDecParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span>
<span style="color: #000000">            StreamInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">videoTrack</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_pDecSpecInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    sts </span><span style="color: #000000">=</span><span style="color: #000000"> Decoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">VDecParams</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Decoder Init error</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #008000">// Initialize video render component</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoRenderParams</span><span style="color: #000000"> render_params</span><span style="color: #000000">;</span>
<span style="color: #000000">    sts </span><span style="color: #000000">=</span><span style="color: #000000"> render_params</span><span style="color: #000000">.</span><span style="color: #000000">out_data_template</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">videoTrackInfo</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">,</span><span style="color: #000000"> videoTrackInfo</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">,</span><span style="color: #000000"> videoTrackInfo</span><span style="color: #000000">.</span><span style="color: #000000">color_format</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Render Init error</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    sts </span><span style="color: #000000">=</span><span style="color: #000000"> Render</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">render_params</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Render Init error</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"AVI - %s</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">,</span><span style="color: #000000"> argv</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">]);</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"size - %dx%d</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">,</span><span style="color: #000000"> videoTrackInfo</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">,</span>
<span style="color: #000000">            videoTrackInfo</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> nframes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_tick</span><span style="color: #000000"> t0</span><span style="color: #000000">,</span><span style="color: #000000"> t1</span><span style="color: #000000">,</span><span style="color: #000000"> total </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">,</span><span style="color: #000000"> freq </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">vm_time_get_frequency</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">double</span><span style="color: #000000"> fps</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #008000">// decoding &amp; rendering loop</span>
<span style="color: #000000">    </span><span style="color: #0000ff">for</span><span style="color: #000000"> </span><span style="color: #000000">(;;)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA </span><span style="color: #000000">==</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">=</span><span style="color: #000000"> Splitter</span><span style="color: #000000">.</span><span style="color: #000000">GetNextData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000"> videoTrack</span><span style="color: #000000">)))</span>
<span style="color: #000000">            </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">5</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_END_OF_STREAM</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Splitter error (%d), frame %d</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">,</span><span style="color: #000000"> sts</span><span style="color: #000000">,</span><span style="color: #000000"> nframes</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">        sSts </span><span style="color: #000000">=</span><span style="color: #000000"> sts</span><span style="color: #000000">;</span>
<span style="color: #000000">        Render</span><span style="color: #000000">.</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">        t0 </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">vm_time_get_tick</span><span style="color: #000000">();</span>
<span style="color: #000000">        sts </span><span style="color: #000000">=</span><span style="color: #000000"> Decoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">sSts </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">?</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">in </span><span style="color: #000000">:</span><span style="color: #000000"> NULL</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">        t1 </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">vm_time_get_tick</span><span style="color: #000000">();</span>
<span style="color: #000000">        total </span><span style="color: #000000">+=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">t1 </span><span style="color: #000000">-</span><span style="color: #000000"> t0</span><span style="color: #000000">);</span>

<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Decoder error (%d), frame %d</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">,</span><span style="color: #000000"> sts</span><span style="color: #000000">,</span><span style="color: #000000"> nframes</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">        Render</span><span style="color: #000000">.</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"frame %4d, FPS - %4.1f</span><span style="color: #A31515">\r</span><span style="color: #A31515">"</span><span style="color: #000000">,</span><span style="color: #000000"> nframes</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">double</span><span style="color: #000000">)</span><span style="color: #000000">1.0</span><span style="color: #000000"> </span><span style="color: #000000">/</span><span style="color: #000000"> </span><span style="color: #000000">((</span><span style="color: #000000">t1 </span><span style="color: #000000">-</span><span style="color: #000000"> t0</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">/</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">double</span><span style="color: #000000">)</span><span style="color: #000000">freq</span><span style="color: #000000">));</span>
<span style="color: #000000">            </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> time </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_TIMEOUT </span><span style="color: #000000">==</span><span style="color: #000000"> Render</span><span style="color: #000000">.</span><span style="color: #000000">GetRenderFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">time</span><span style="color: #000000">));</span>
<span style="color: #000000">                sts </span><span style="color: #000000">=</span><span style="color: #000000"> Render</span><span style="color: #000000">.</span><span style="color: #000000">RenderFrame</span><span style="color: #000000">();</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">                </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">            nframes </span><span style="color: #000000">++;</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">sSts </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_END_OF_STREAM</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    fps </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">double</span><span style="color: #000000">)(</span><span style="color: #000000">freq </span><span style="color: #000000">/</span><span style="color: #000000"> </span><span style="color: #000000">((</span><span style="color: #0000ff">double</span><span style="color: #000000">)</span><span style="color: #000000">total </span><span style="color: #000000">/</span><span style="color: #000000"> nframes</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"processed %d frames, with avg performance %4.1f FPS</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">,</span><span style="color: #000000"> nframes</span><span style="color: #000000">,</span><span style="color: #000000"> fps</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_11">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>The UMC::MPEG4VideoDecoder creates a specified number of decoding threads if it is compiled by a compiler that supports the OpenMP*. The number of threads is controlled through numThreads member of UMC::BaseCodecParams structure provided at the initialization stage.</p></div>
<div class="paragraph"><p>Synchronization is performed by internal OpenMP* mechanism. At a given time only one thread parses bitstream for one row and many threads do Inverse DCT and Motion Compensation on rows.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The UMC::MPEG4VideoDecoder allocates some memory for internal buffers. The amount of the allocated memory can be calculated as</p></div>
<div class="paragraph"><p>bytesAlloc = MBx*MBy*1172 + MBx*2593 + MBy*2304 + 4897 + (Threaded) ?
num_threads * MBx*1664 : 0,</p></div>
<div class="paragraph"><p>where MBx is the number of macroblocks in row and is (frame_width + 15) / 16. MBy is the number of macroblocks in column and is (frame_height + 15) / 16.</p></div>
<div class="paragraph"><p>For example, the memory is ~2 Mb for a 720x480 video.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>If input data does not contain a full compressed frame, GetFrame() method fails with UMC::UMC_ERR_NOT_ENOUGH_DATA return value. The decoder moves the input data pointer by the size of compressed frame after decoding is finished.</p></div>
<div class="paragraph"><p>When input pointer is zero or input UMC::MediaData is empty, the internally buffered frame is returned.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_11">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mpeg4_video_decoder.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(CODECWS)\codec\mpeg4_dec\include
$(CODECWS)\core\umc\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include
$(CODECWS)\codec\color_space_converter\include
$(CODECWS)\core\common\include
$(CODECWS)\core\io\umc_va\include
$(IPPROOT)\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
color_space_converter
</p>
</li>
<li>
<p>
umc
</p>
</li>
<li>
<p>
umc_va
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
common
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippi, ippvc, ippcc.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>_OPENMP - needed to compile a threaded version</p></div>
<div class="paragraph"><p>The enabling macro UMC_ENABLE_MPEG4_VIDEO_DECODER is in umc_defs.h.</p></div>
</div>
<div class="sect3">
<h4 id="_features_and_notes_3">Features and Notes</h4>
<div class="paragraph"><p>The UMC::MPEG4VideoDecoder decodes a bitstream that contains video data encoded in compliance with MPEG-4:2 standard SimpleProfile and Advance Simple Profile. This means that decoder supports such features of MPEG-4 as:</p></div>
<div class="ulist"><ul>
<li>
<p>
I-VOP
</p>
</li>
<li>
<p>
P-VOP
</p>
</li>
<li>
<p>
B-VOP
</p>
</li>
<li>
<p>
S-VOP
</p>
</li>
<li>
<p>
AC/DC Prediction
</p>
</li>
<li>
<p>
Four Motion Vectors per Macroblock
</p>
</li>
<li>
<p>
Un-restricted Motion Vectors
</p>
</li>
<li>
<p>
P-VOP with OBMC
</p>
</li>
<li>
<p>
Quantization Method 1,2
</p>
</li>
<li>
<p>
Video-packets
</p>
</li>
<li>
<p>
Short video header
</p>
</li>
<li>
<p>
Data partitioning
</p>
</li>
<li>
<p>
Reversible VLC
</p>
</li>
<li>
<p>
Basic sprites
</p>
</li>
<li>
<p>
Interlacing
</p>
</li>
<li>
<p>
Quarter-Pixel Motion Compensation
</p>
</li>
<li>
<p>
Global Motion Compensation
</p>
</li>
<li>
<p>
Deringing and Deblocking are supported as post-processing.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_mpeg4videoencoder">UMC::MPEG4VideoEncoder</h3>
<div class="paragraph"><p>UMC::MPEG4VideoEncoder is a derived class for converting of video data in YUV format to raw bitstream in compliance with MPEG4:2
video standard <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>. Encoding is performed frame by frame.</p></div>
<div class="paragraph"><p>See next figure for the functional scheme of the decoder.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_32.png" alt="images/umc/umc_5_32.png" />
</div>
<div class="title">Figure 30. MPEG4VideoEncoder Functional Scheme</div>
</div>
<div class="paragraph"><p>Input video frames are stored in the input reordering frame buffer.</p></div>
<div class="paragraph"><p>Intra macroblocks, which form I-frames or do not refer to other frames, are VLD-encoded after DCT and quantization, and go to the output UMC::MediaData.
P and B macroblocks go to Motion Estimation, where the best matching block in reference
frames is found.
Macroblock type is chosen depending on matching results. When matching is insufficient, the macroblock is encoded as intra. Otherwise, motion vectors, that is, offset to best matching position in reference frames, are used to form prediction in the motion compensation block. The difference between the prediction and the macroblock goes to DCT and quantization. Then quantized coefficients and motion vectors form the encoded frame.
For macroblocks in I and P frames, reconstruction is performed in the form of inverse quantization and IDCT.</p></div>
<div class="paragraph"><p>For inter-coded macroblocks, the result is also added with prediction from motion compensation. The result of reconstruction is stored in the reconstructed reference frame for future use.</p></div>
<div class="paragraph"><div class="title">Derivation</div><p>UMC::MPEG4VideoEncoder is a class derived from UMC::VideoEncoder Class and inherits the basic features of that class. UMC::VideoEncoder is a class derived from UMC::BaseCodec Class for building video data encoders and inherits the basic features of all codes. UMC::MPEG4VideoEncoder uses UMC::MPEG4EncoderParams class derived from UMC::VideoEncoderParams Class, which is derived from UMC::BaseCodecParams  Class. UMC::MPEG4EncoderParams or UMC::VideoEncoderParams is required for initialization of the encoder.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::MediaData, UMC::VideoData, UMC::VideoEncoder, UMC::VideoEncoderParams and UMC:BaseCodecParams classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_13">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p>UMC::MPEG4VideoEncoderParams is an interface class derived from UMC::VideoEncoderParams class and is used to set or modify encoder parameters and read them from the parameter file.</p></div>
<div class="paragraph"><p>UMC::MPEG4VideoEncoderParams class employs ReadParamFile method that opens and reads the parameter file.</p></div>
<div class="paragraph"><p>Some UMC::MPEG4VideoEncoderParams members are used as input to specify encoding parameters, some are used to get current state or information from encoder, and some are ignored.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 114. MPEG4EncoderParams Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                        </th>
<th align="left" valign="top">Type                        </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>BaseCodecParams members</code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_SuggestedInputSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">[out] Suggested input frame size in bytes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_SuggestedOutputSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">[out] Suggested maximum input frame size in bytes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>numThreads</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Maximum number of threads to use. If 0, use the number equal to the number of logical processors.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pData</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::MediaData*</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>lpMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::MemoryAllocator*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the external Memory allocator or NULL</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>profile</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] Standard defined profile.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>level</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] Standard defined level.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VideoEncoderParams members</code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::VideoStreamInfo</code></p></td>
<td align="left" valign="top"><p class="table">Structure with video stream parameters</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.clip_info</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::ClipInfo</code></p></td>
<td align="left" valign="top"><p class="table">[in] Members width and height, video frame size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.color_format</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::ColorFormat</code></p></td>
<td align="left" valign="top"><p class="table">[in] Color format of the encoded video</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.bitrate</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">[in] Bit rate in bits per second</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.aspect_ratio_width</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Pixel aspect ratio</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.aspect_ratio_height</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Pixel aspect ratio</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.frame</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table">[in] Frame rate of the encoded video</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.duration</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table">Duration of video stream, ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.interlace_type</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::InterlaceType</code></p></td>
<td align="left" valign="top"><p class="table">[in] Interlacing information</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.stream_type</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::VideoStreamType</code></p></td>
<td align="left" valign="top"><p class="table">[out] Stream type, set to MPEG4_VIDEO</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.stream_subtype</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::VideoStreamSubType</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>profile</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] standard defined profile</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>level</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] standard defined level</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>info.streamPID</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>numEncodedFrames</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] Number of encoded frames</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>qualityMeasure</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[out] Quantization precision, in percents</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG4EncoderParams members</code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Width</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Height</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TimeResolution</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TimeIncrement</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>short_video_header</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If not equal to 0, the short_video_header stream will be generated (see 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>load_intra_quant_mat</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If not equal to 0 and quant_type = 1, the intra_quant_mat will be used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>load_intra_quant_mat_len</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Defines the number of elements in intra_quant_mat.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>intra_quant_mat</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u[64]</code></p></td>
<td align="left" valign="top"><p class="table">[in] User-defined quantization matrix for Intra blocks</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>load_nonintra_quant_mat</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If not equal to 0 and quant_type = 1, the nonintra_quant_mat will be used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>load_nonintra_quant_mat_len</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Defines the number of elements in nonintra_quant_mat.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>nonintra_quant_mat</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u[64]</code></p></td>
<td align="left" valign="top"><p class="table">[in] User-defined quantization matrix for Inter blocks</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>quant_type</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Defines the type of quantization (0 or 1). See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>quantIVOP</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] The default quantizers for I-frames, used when RateControl = 0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>quantPVOP</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] The default quantizers for P-frames, used when RateControl = 0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>quantBVOP</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] The default quantizers for B-frames, used when RateControl = 0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>IVOPdist</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Defines the maximal distance between I-frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BVOPdist</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Defines the number of successive B-frames (0 means no B-frames).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>PVOPsearchWidth</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Width of search rectangle in pixels for ME process for P-frames</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>PVOPsearchHeight</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Height of search rectangle in pixels for ME process for P-frames</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BVOPsearchWidthForw</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Width of search rectangle in pixels for ME process for B-frames in forward direction</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BVOPsearchHeightForw</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Height of search rectangle in pixels for ME process for B-frames in forward direction</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BVOPsearchWidthBack</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Width of search rectangle in pixels for ME process for B-frames in backward direction</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BVOPsearchHeightBack</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Height of search rectangle in pixels for ME process for B-frames in backward direction</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MEalgorithm</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Motion Estimation algorithm: 0 - full search, 1 - fast search. Additionally +16 - fast 1/2 ME, +32 - Chroma ME, +32768 - RD based mode decision</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MEaccuracy</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Motion estimation accuracy: 1 - full pel, 2 - half pel, 4 - quarter pel</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ME4mv</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If set to 0, one MV per macroblock will be used, otherwise 4 MVs per macroblock will be used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>obmc_disable</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If set to 0, OBMC will be used. See 6.3.3 of <a href="#ISO/IEC_Visual">[ISO/IEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RoundingControl</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If not equal to 0, rounding control will be changed from frame to frame. See 7.6.2 of <a href="#ISO/IEC_Visual">[ISO/IEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>calcPSNR</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>insertGOV</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If not equal to 0, Group of Video Object Plane Header will be inserted before each I-frame. See 6.2.4 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>repeatHeaders</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If not equal to 0, VideoObjectLayer Header will be repeated before each I-frame. See 6.2.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>resync</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If not equal to 0, GOB resync markers will be inserted in case of short_video_header. If short_video_header = 0, the frame will be divided into video packets with min length VideoPacketLenght and resync markers will be inserted. See 6.2.5 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VideoPacketLenght</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Minimal length of video packet in bits</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>data_partitioned</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If set to non-zero, a data partitioned stream will be generated. See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>reversible_vlc</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Used only when data_partitioned is not equal to 0. If not equal to 0, RVLC will be used for DCT coefficients coding. See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>interlaced</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] If not equal to 0, an interlaced stream is generated.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>top_field_first</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] 1-bit flag, which when set to 1 indicates that the top field (that is, the field containing the top line) of reconstructed frame is the first field to be displayed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>alternate_vertical_scan_flag</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] 1-bit flag, which when set to 1 indicates the use of alternate vertical scan for interlaced frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>interlacedME</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] In interlaced mode means: 0 - field only ME; 1 - frame only ME; 2 - field+frame ME.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>sprite_enable</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Defines using of sprites. 0 - none, 1 - basic sprites, 2 - GMC (S-VOPs). See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>sprite_width</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>sprite_height</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>sprite_left_coordinate</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>sprite_top_coordinate</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>no_of_sprite_warping_points</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] The number of sprite warping points in case that sprite_enable != 0. See 6.3.3 of <a href="#ISO/IEC_Visual">[ISO/IEC_Visual]</a> for details</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>sprite_warping_accuracy</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Accuracy of warping in case sprite_enable not equal to 0. See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>sprite_warping_change</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>warping_mv_code_du</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s*</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>warping_mv_code_dv</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s*</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>brightness_change_factor</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s*</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bsBuffer</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u*</code></p></td>
<td align="left" valign="top"><p class="table">Reserved, must not be NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>bsBuffSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Reserved, must not be 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>padType</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Reserved, must be == 0</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>RateControl</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] The rate control algorithm. 0 - ConstQuality with quantIVOP, quantPVOP, quantBVOP; 1 - Frame Level AVBR; 2 - Macroblock Level CBR</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>BitRate</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Ignored.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SceneChangeThreshold</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">[in] Defines the threshold of scene changing in %. If current VOP is coded as P-VOP but the scene is changed more than SceneChangeThreshold, VOP will be coded as an I-frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>numThread</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>profile_and_level</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>aspect_ratio_width</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>aspect_ratio_height</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table">Ignored</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Member Functions</div><p>See UMC::BaseCodec Class and UMC::VideoEncoder Class.</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 115. MPEG4VideoEncoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes the encoder with specified parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Destructs the encoder and closes all encoder resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Encodes the next video frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets the encoder into initial state. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Gets current encoder working parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SetParams</code></p></td>
<td align="left" valign="top"><p class="table">Defines the working parameters for the encoder. Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrameMacroBlockPerRow</code></p></td>
<td align="left" valign="top"><p class="table">Returns the number of macroblocks in the frame row.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrameMacroBlockPerCol</code></p></td>
<td align="left" valign="top"><p class="table">Returns the number of macroblocks in the frame column.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrameQuant</code></p></td>
<td align="left" valign="top"><p class="table">Returns the pointer to the internal array of quantization parameters for the whole frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrameMVpred</code></p></td>
<td align="left" valign="top"><p class="table">Returns the pointer to internal array of motion vector predictors for all macroblocks in the frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrameMBpos</code></p></td>
<td align="left" valign="top"><p class="table">Returns the pointer to the internal array of bit offsets for all macroblocks in the frame.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_13" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the encoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters_62" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure. The pointer should refer to an object of the UMC::VideoEncoderParams Class, which contains common initialization information for all encoders or pointer to UMC::MPEG4EncoderParams with more detailed MPEG4 specific parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the encoder. See detailed description of this method in Initialization section.</p></div>
<h5 id="_return_values_93" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The input pointer is NULL or is neither UMC::VideoEncoderParams nor derived from it.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed due to an error in parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The encoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_13" class="float">Close</h4>
<div class="paragraph"><p><em>Closes and frees all encoder resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes encoding, that is, closes and releases all encoder resources. The method can be called from the class destructor as well. To resume processing after Close() was called, re-initialization is required.</p></div>
<h5 id="_return_values_94" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close. The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_getframe_13" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Encodes next video frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *pInData, UMC::MediaData *pOutData);</code></pre>
</div></div>
<h5 id="_parameters_63" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInData</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to an input data object. If the pointer refers to the instance of the UMC::VideoData object, it is assumed to be the next uncompressed video frame to encode. If the size of the input frame differs from the one used for initialization it is resized, and when the color format differs it is converted. If pInData points to UMC::MediaData object with positive data size, it is assumed to be user data and is put to video user data with the next encoded video picture. When pInData is 0, a frame buffered for reordering, if any, is encoded, returned, and removed from the internal buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pOutData</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an output data object, which is UMC::MediaData with encoded bitstream. If pOutData is not empty, new data is appended to the end. At start of encoding GetFrame() can return UMC::UMC_OK but stores nothing to pOutData because of the internal frame reordering buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method takes a YUV frame provided by pInData and returns an encoded frame to pOutData. Due to internal buffering, the output frame comes usually earlier than the input frame or can be missed. To get buffered frames in the end of the encoding process, GetFrame should be called with pInData equal to NULL while it returns UMC::UMC_OK. If the encoder is initialized to encode without B-frames, no buffering takes place.</p></div>
<h5 id="_return_values_95" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">No more new data is expected within the current stream when pInData == NULL and there are no buffered frames for output.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the essential pointers is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">The set size is not enough to save the buffer for one of the internal objects or buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset_11" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets the encoder into initial state.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method reinitializes the encoder with current encoding parameters. The method can be used to start a new video sequence.</p></div>
<h5 id="_return_values_96" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The input pointer is neither a pointer to a valid object of UMC::VideoEncoderParams class nor a pointer to an object derived from this class.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The encoder failed to allocate memory for one of the internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Error in parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_13" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Gets current encoder working parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *info);</code></pre>
</div></div>
<h5 id="_parameters_64" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>info</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to UMC::BaseCodecParams Class data object for getting the encoder parameters. The pointer can point to the instance of UMC::VideoEncoderParams Class or UMC::MPEG4EncoderParams. Destination is filled according to its class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method gets encoder working (initialization) parameters.</p></div>
<div class="paragraph"><p>This method can be used to obtain current profile/level information. Suggested sizes of input and output buffers are UMC::BaseCodecParams::m_SuggestedOutputSize and UMC::BaseCodecParams::m_SuggestedInputSize.</p></div>
<h5 id="_return_values_97" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The encoder is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the essential pointers is NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_setparams_7" class="float">SetParams</h4>
<div class="paragraph"><p><em>Defines the working parameters for the encoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_65" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to UMC::BaseCodecParams data object to set the encoder parameters. This pointer can point to UMC::VideoEncoderParams class object or UMC::MPEG4EncoderParams class as well. Encoder parameters are changed according to this class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method changes the working parameters of the encoder. This method starts a new sequence.</p></div>
<h5 id="_return_values_98" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_UNSUPPORTED</code></p></td>
<td align="left" valign="top"><p class="table">Only params&#8594;info.bitrate and params&#8594;info.framerate can be different from parameters which were used at Init() call.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getframemacroblockperrow" class="float">GetFrameMacroBlockPerRow</h4>
<div class="paragraph"><p><em>Returns the number of macroblocks in the frame row.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>Ipp32s GetFrameMacroBlockPerRow();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the number of macroblocks in the frame row.</p></div>
<h5 id="_return_values_99" class="float">Return Values</h5>
<div class="paragraph"><p>The number of macroblocks in the frame row.</p></div>
<hr />
<h4 id="_getframemacroblockpercol" class="float">GetFrameMacroBlockPerCol</h4>
<div class="paragraph"><p><em>Returns the number of macroblocks in the frame column.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>Ipp32s GetFrameMacroBlockPerCol();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the number of macroblocks in the frame column.</p></div>
<h5 id="_return_values_100" class="float">Return Values</h5>
<div class="paragraph"><p>The number of macroblocks in the frame column.</p></div>
<hr />
<h4 id="_getframequant" class="float">GetFrameQuant</h4>
<div class="paragraph"><p><em>Returns pointer to internal array of quantization parameters for the whole frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>Ipp8u* GetFrameQuant();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the pointer to internal array of quantization parameters for all macroblocks in the frame. This method works only when MPEG4EncoderParam.short_video_header is set. It may be used for RTP paketization of an encoded frame according to RFC 2190 [RFC2190].</p></div>
<h5 id="_return_values_101" class="float">Return Values</h5>
<div class="paragraph"><p>The pointer to the internal array that contains quantization parameters for all macroblocks in the frame.</p></div>
<hr />
<h4 id="_getframemvpred" class="float">GetFrameMVpred</h4>
<div class="paragraph"><p><em>Returns pointer to internal array of motion vector predictors for all macroblocks in frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>IppMotionVector* GetFrameMVpred();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the pointer to internal array of motion vector predictors for all macroblocks in the frame. This method works only when MPEG4EncoderParam.short_video_header is set. It may be used for RTP paketization of an encoded frame according to RFC 2190 [RFC2190].</p></div>
<h5 id="_return_values_102" class="float">Return Values</h5>
<div class="paragraph"><p>The pointer to the internal array that contains motion vector predictors for all macroblocks in the frame.</p></div>
<hr />
<h4 id="_getframembpos" class="float">GetFrameMBpos</h4>
<div class="paragraph"><p><em>Returns pointer to internal array of bit offsets for all macroblocks in the frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>IppMotionVector* GetFrameBpos();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the pointer to internal array of bit offsets for all macroblocks in the frame. This method works only when MPEG4EncoderParam.short_video_header is set. It may be used for RTP paketization of an encoded frame according to RFC 2190 [RFC2190].</p></div>
<h5 id="_return_values_103" class="float">Return Values</h5>
<div class="paragraph"><p>The pointer to the internal array that contains bit offsets in the encoded stream for all macroblocks in the frame.</p></div>
</div>
<div class="sect3">
<h4 id="_usage_examples_13">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize MPEG4 encoder, create an instance of the UMC::MPEG4VideoEncoder class and invoke Init() method. The method accepts a pointer of type UMC::BaseCodecParams* (see UMC::BaseCodecParams Class) as its single parameter. The pointer must refer to the instance of UMC::VideoEncoderParams structure or UMC::MPEG4EncoderParams structure, which contains common initialization information for the codec. If casting of the input pointer to UMC::VideoEncoderParams fails, the method returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="paragraph"><p>Data members in UMC::VideoEncoderParams and UMC::MPEG4EncoderParams marked with [in] affect encoder initialization. All of them, except frame dimension, are set by default to appropriate values.</p></div>
<div class="paragraph"><p>When used for initialization, UMC::MPEG4EncoderParams provides additional possibilities in configuration.</p></div>
<div class="paragraph"><div class="title">Initialization Examples</div><p>There are two methods of MPEG4 encoder initialization:</p></div>
<div class="ulist"><ul>
<li>
<p>
Call UMC::MPEG4VideoEncoder::Init(UMC::BasicCodecParams*) member function with a parameter that is a pointer to UMC::VideoEncoderParams class object. This is a method when user does not want to change the default values of specific MPEG4 encoding parameters and only sets general encoding parameters like width, height, bit rate, etc.
</p>
</li>
<li>
<p>
Call UMC::MPEG4VideoEncoder::Init(UMC::BasicCodecParams*) member function with a parameter that is a pointer to UMC::MPEG4EncoderParams class object. This is a method when user does want not only to set general encoding parameters, but also to set specific parameters for MPEG4 codec. UMC::MPEG2EncoderParams object can be initialized via UMC::MPEG4EncoderParams::ReadParamFile() member function.
</p>
</li>
</ul></div>
<div class="paragraph"><p>See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 27. MPEG4VideoEncoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG4VideoEncoder</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">mpeg4Encoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG4VideoEncoder</span><span style="color: #000000">();</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">params </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoEncoderParams</span><span style="color: #000000">();</span>

<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">720</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">480</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">bitrate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1000000</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">framerate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">30</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">numFramesToEncode </span><span style="color: #000000">=</span><span style="color: #000000"> INT_MAX</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// all frames</span>
<span style="color: #000000">params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">mpeg4Encoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">params</span><span style="color: #000000">)))</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">//Process errors</span>
<span style="color: #000000">}</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">...</span>
<span style="color: #008000">// Encode stream</span>
<span style="color: #000000">...</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> mpeg4Encoder</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">//destructor will automatically call Close() method.</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. The destructor automatically invokes
Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>For encoder initialization with parameters from par-file and from command line, for main working cycle example see ..\..\application\umc_video_enc_con\.</p></div>
<div class="exampleblock">
<div class="title">Example 28. MPEG4VideoEncoder Typical Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG4EncoderParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG4VideoEncoder</span><span style="color: #000000"> encoder</span><span style="color: #000000">;</span>
<span style="color: #008000">// Set encoder params</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width </span><span style="color: #000000">=</span><span style="color: #000000"> x</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> y</span><span style="color: #000000">;</span>

<span style="color: #000000">...</span><span style="color: #000000"> encoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">params</span><span style="color: #000000">);</span>

<span style="color: #008000">//main loop</span>
<span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">have_frames</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> in</span><span style="color: #000000">;</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> out</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">prepare_input</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">))</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #000000">\\</span><span style="color: #000000"> not the end</span>
<span style="color: #000000">        encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// no more input frames, take buffered</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">out</span><span style="color: #000000">))</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// done</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">do_smth_with_out</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #008000">// while have frames</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>An example of the par-file can be found in ..\..\test\streams\video\video_enc\. The par-file can be read by ReadParamFile method. See next table for the structure of the parameter file.</p></div>
<div class="tableblock">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 116. Par-File Description</caption>
<col width="12%" />
<col width="12%" />
<col width="25%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top">Line Number                 </th>
<th align="left" valign="top">Type                </th>
<th align="left" valign="top">Range                       </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">1</p></td>
<td align="left" valign="top"><p class="table"><code>string</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">Reserved</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">2</p></td>
<td align="left" valign="top"><p class="table"><code>string</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">The name of source YUV file</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">3</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">1 - 8191</p></td>
<td align="left" valign="top"><p class="table">Width of source</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">4</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">1 - 8191</p></td>
<td align="left" valign="top"><p class="table">Height of source</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">5</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Number of frames</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">6</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Time Resolution</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">7</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Time Increment (FrameRate = TimeResolution / TimeIncrement)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">8</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">Quant Type (0 - H263, 1 - the first quantization method). See 6.3.3 of <a href="#ISO/IEC_Visual">[ISO/IEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">9</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">1-31</p></td>
<td align="left" valign="top"><p class="table">Quantization parameter for I-VOPs (used for RateControlMethod = 0)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">10</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">1-31</p></td>
<td align="left" valign="top"><p class="table">Quantization parameter for P-VOPs (used for RateControlMethod = 0)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">11</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">1-31</p></td>
<td align="left" valign="top"><p class="table">Quantization parameter for B-VOPs (used for RateControlMethod = 0)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">12</p></td>
<td align="left" valign="top"><p class="table"><code>string</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">Name of intra quant matrix file for QuantType = 1 ("-" means default matrix)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">13</p></td>
<td align="left" valign="top"><p class="table"><code>string</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
<td align="left" valign="top"><p class="table">Name of inter quant matrix file for QuantType = 1 ("-" means default matrix)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">14</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If not equal to 0, the short_video_header stream will be generated (see 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">15</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 1</p></td>
<td align="left" valign="top"><p class="table">Defines the maximal distance between I-VOPs.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">16</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Number of successive B-VOPs (0 means encoding without B-VOPs)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">17</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Width of search rectangle in pixels for ME process in P-VOPs</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">18</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Height of search rectangle in pixels for ME process in P-VOPs</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">19</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Width of search rectangle in pixels for ME process in B-VOPs (forward direction)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">20</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Height of search rectangle in pixels for ME process in B-VOPs (forward direction)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">21</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Width of search rectangle in pixels for ME process in B-VOPs (backward direction)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">22</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Height of search rectangle in pixels for ME process in B-VOPs (backward direction)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">23</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Motion Estimation algorithm: 0 - full search, 1 - fast search (+16 - fast 1/2 ME, +32 - ChromaME, +32768 - RD based mode decision)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">24</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">1,2,4</p></td>
<td align="left" valign="top"><p class="table">Motion Estimation accuracy: 1 - full pel, 2 - half pel, 4 - quarter pel</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">25</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If set to 0, one MV per macroblock will be used; otherwise, 4 MVs per macroblock will be used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">26</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If set to 0, OBMC will be used. See 6.3.3 of <a href="#ISO/IEC_Visual">[ISO/IEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">27</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If not equal to 0, rounding control will be changed from frame to frame. See 7.6.2 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">28</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If set to 1, the encoder will reconstruct B-VOPs.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">29</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1,2</p></td>
<td align="left" valign="top"><p class="table">The Rate Control Method: 0 - ConstQuality with fixed quants 1 - Frame Level AVBR 2 - Macroblock Level CBR</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">30</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;0</p></td>
<td align="left" valign="top"><p class="table">Defines the target bit rate (bits per second) for RateControlMethod not equal to 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">31</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;= 0</p></td>
<td align="left" valign="top"><p class="table">Defines the threshold of scene changing in%. If current VOP is coded as P-VOP but the scene is changed more than SceneChangeThreshold, VOP will be coded as I-VOP.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">32</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If not equal to 0, Group of Video Object Plane Header will be inserted before each I-VOP. See 6.2.4 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">33</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If not equal to 0, Video Object Layer Header will be repeated before each I-VOP. See 6.2.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">34</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If not equal to 0, GOB resync markers will be inserted in case of short_video_header. If short_video_header = 0, the frame will be divided into video packets with min length VideoPacketLenght and resync markers will be inserted. See 6.2.5 of <a href="#ISO/IEC_Visual">[ISO/IEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">35</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">&gt;0</p></td>
<td align="left" valign="top"><p class="table">Minimal length of video packet in bits</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">36</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If set to non-zero, data partitioned stream will be generated. See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">37</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">Used only when data_partitioned is not equal to 0. If it is not equal to 0, RVLC will be used for DCT coefficients coding. See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">38</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">If not equal to 0, an interlaced stream will be generated.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">39</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">1-bit flag, which when set to 1 indicates that the top field (that is, the field containing the top line) of reconstructed VOP is the first field to be displayed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">40</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1</p></td>
<td align="left" valign="top"><p class="table">1-bit flag that when set to 1 indicates the use of alternate vertical scan for interlaced VOPs</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">41</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,1,2</p></td>
<td align="left" valign="top"><p class="table">In interlaced mode means: 0 - field only ME, 1 - frame only ME, 2 - field+frame ME</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">42</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0,2</p></td>
<td align="left" valign="top"><p class="table">Defines the using of sprites: 0 - none, 2 - GMC (S-VOPs). See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">43</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0-3</p></td>
<td align="left" valign="top"><p class="table">Number of warping points in case sprite_enable is not equal to 0. See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">44</p></td>
<td align="left" valign="top"><p class="table"><code>int</code></p></td>
<td align="left" valign="top"><p class="table">0-3</p></td>
<td align="left" valign="top"><p class="table">Accuracy of warping points in case sprite_enable is not equal to 0. See 6.3.3 of <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> for details.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_12">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>MPEG4 encoder can create a specified number of encoding threads or determine the optimal number of threads automatically. The number of threads is set in UMC::BaseCodecParams::numThreads. If this number is set to 0, the encoder sets and uses the number of logical processors in system. The frame is divided into videopackets and each thread encodes its own videopacket. The UMC::MPEG4VideoEncoder creates threads if it is compiled by a compiler that supports OpenMP*. The _OPENMP macro must be defined during compilation. Synchronization is done by internal OpenMP mechanism.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_34.png" alt="images/umc/umc_5_34.png" />
</div>
<div class="title">Figure 31. MPEG4VideoEncoder Data Threading Model</div>
</div>
<div class="paragraph"><div class="title">Memory Usage</div><p>UMC::MPEG4VideoEncoder allocates memory for internal buffers. The amount of the allocated memory is calculated as follows:</p></div>
<div class="paragraph"><p>bytesAlloc = MBx*MBy*384*(numBframes+2) + MBx*310 + (Threaded) ? (num_threads * MBx*1664 + width * height * (num_threads-1)) : 0,
where MBx is the number of macroblocks in row and is (frame_width + 15) / 16, MBy is the number of macroblocks in column and is (frame_height + 15) / 16, numBframes is number of successive B-frames.
For example, for 720x480 video with numBframes = 2, the amount of memory allocated by the non-threaded encoder is ~2.2 Mb.</p></div>
<div class="paragraph"><p>There is no possibility to reduce or control memory. The memory is controlled internally. The encoder supports UMC::MemoryAllocator Class interface.
The encoder uses internal buffering of the frames to perform reordering necessary for encoding with B frames. It also holds encoded and reconstructed frames to perform temporal prediction.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>The input data should contain the whole frame in YUV 4:2:0 format.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_12">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mpeg4_video_encoder.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(IPPROOT)\include
$(CODECWS)\codec\mpeg4_enc\include
$(CODECWS)\core\umc\include
$(CODECWS)\codec\color_space_converter\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\vm_plus\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
color_space_converter.
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippi, ippvc, ippcc.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_MPEG4_VIDEO_ENCODER is in umc_defs.h.</p></div>
</div>
<div class="sect3">
<h4 id="_features_and_notes_4">Features and Notes</h4>
<div class="paragraph"><div class="title">Rate Control</div><p>The UMC::MPEG4VideoEncoder creates a bit stream that contains video data encoded in compliance with MPEG-4:2 standard Simple Profile and Advance Simple Profile. This means that the encoder supports such features of MPEG-4 as</p></div>
<div class="ulist"><ul>
<li>
<p>
I-VOP
</p>
</li>
<li>
<p>
P-VOP
</p>
</li>
<li>
<p>
B-VOP
</p>
</li>
<li>
<p>
S-VOP
</p>
</li>
<li>
<p>
AC/DC Prediction
</p>
</li>
<li>
<p>
Four Motion Vectors per Macroblock
</p>
</li>
<li>
<p>
Un-restricted Motion Vectors
</p>
</li>
<li>
<p>
P-VOP with OBMC
</p>
</li>
<li>
<p>
Quantization Method 1,2
</p>
</li>
<li>
<p>
Video-packets
</p>
</li>
<li>
<p>
Short video header
</p>
</li>
<li>
<p>
Data partitioning
</p>
</li>
<li>
<p>
Reversible VLC
</p>
</li>
<li>
<p>
Basic sprites
</p>
</li>
<li>
<p>
Interlacing
</p>
</li>
<li>
<p>
Quarter-Pixel Motion Compensation
</p>
</li>
<li>
<p>
Global Motion Compensation.
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">Other UMC Components</div><p>Other UMC components can be used to extend encoder abilities. For example, UMC::VideoProcessing Class can be used before the encoder to perform image transformations or filtering or UMC::MPEG4Muxer can be used for packetization of output pure video stream.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_mjpegvideodecoder">UMC::MJPEGVideoDecoder</h3>
<div class="paragraph"><p>UMC::MJPEGVideoDecoder is a derived class for decoding of video data from a JPEG
bitstream into a YUV or RGB output frame.</p></div>
<div class="paragraph"><p>Decoding process is defined in ISO/IEC 10918-1 <a href="#ISOIEC10918-1">[ISOIEC10918-1]</a>.
The decoder is also compatible with requirements defined in the OpenDML* AVI M-JPEG File Format in part of support APP0 "AVI1" segments. <a href="#OpenDML">[OpenDML]</a>.</p></div>
<div class="paragraph"><div class="title">Derivation</div><p>UMC::MJPEGVideoDecoder class is inherited from UMC::VideoDecoder Class.</p></div>
<div class="paragraph"><div class="title">See Also</div><p>UMC::BaseCodec and UMC::VideoDecoder classes.</p></div>
<div class="sect3">
<h4 id="_user_interface_14">User Interface</h4>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 117. MJPEGVideoDecoder Class Methods</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Init</code></p></td>
<td align="left" valign="top"><p class="table">Initializes internal data for subsequent frame decoding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Reset</code></p></td>
<td align="left" valign="top"><p class="table">Resets the decoder to initial state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Close</code></p></td>
<td align="left" valign="top"><p class="table">Closes decoding and frees all allocated resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetFrame</code></p></td>
<td align="left" valign="top"><p class="table">Decodes the next video frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetInfo</code></p></td>
<td align="left" valign="top"><p class="table">Provides information about stream and decoder parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>ResetSkipCount</code></p></td>
<td align="left" valign="top"><p class="table">Resets counter of skipped frames. NOT IMPLEMENTED.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SkipVideoFrame</code></p></td>
<td align="left" valign="top"><p class="table">Increments counter of skipped frames. NOT IMPLEMENTED.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetNumOfSkippedFrames</code></p></td>
<td align="left" valign="top"><p class="table">Returns the number of skipped frames.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_init_14" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the decoder.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *init);</code></pre>
</div></div>
<h5 id="_parameters_66" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the decoder.</p></div>
<div class="paragraph"><p>The init parameter must be the pointer to an instance of the UMC::VideoDecoderParams  Class structure, which contains common initialization information for all decoders.</p></div>
<h5 id="_return_values_104" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">The decoder has failed to initialize one of the internal objects.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory for one of the internal objects.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_reset_12" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets decoder to initial state.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the decoder to the initial state.</p></div>
<h5 id="_return_values_105" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_close_14" class="float">Close</h4>
<div class="paragraph"><p><em>Closes decoding and frees all allocated resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes decoding, that is, stops all additional threads, releases all allocated resources, etc. The return value is always UMC::UMC_OK. The method can be used to release resources prior to decoder destruction.</p></div>
<h5 id="_return_values_106" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_getframe_14" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Decodes next video frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *in, UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_67" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an object of the UMC::MediaData Class or derived classes, which contains input video frame data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an object of the UMC::VideoData Class or derived classes, which contains output video frame data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method decodes the next compressed video frame.</p></div>
<h5 id="_return_values_107" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the essential pointers is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Corrupted or incomplete input JPEG bitstream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Internal error of the decoder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Invalid MJPEG stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The decoder failed to allocate memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_SYNC</code></p></td>
<td align="left" valign="top"><p class="table">Syncword not found.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder was not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getinfo_14" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Provides information about current stream and decoder parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::BaseCodecParams *lpInfo);</code></pre>
</div></div>
<h5 id="_parameters_68" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>lpInfo</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an object of the UMC::BaseCodecParams Class or a derived class. The object is filled with decoder initialization parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides information about the current stream and decoder parameters.</p></div>
<h5 id="_return_values_108" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter pointer is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The decoder is not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_resetskipcount_4" class="float">ResetSkipCount</h4>
<div class="paragraph"><p><em>Resets counter of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status ResetSkipCount();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the internal counter of skipped frames. Currently not implemented.</p></div>
<h5 id="_return_values_109" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_IMPLEMENTED</code></p></td>
<td align="left" valign="top"><p class="table">This functionalty is not implemented.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_skipvideoframe_4" class="float">SkipVideoFrame</h4>
<div class="paragraph"><p><em>Increments counter of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status SkipVideoFrame(Ipp32s count);</code></pre>
</div></div>
<h5 id="_parameters_69" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>count</em></p></td>
<td align="left" valign="top"><p class="table">Integer number of frames to be skipped.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method changes frame skipping state counter. Currently not implemented.</p></div>
<h5 id="_return_values_110" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_IMPLEMENTED</code></p></td>
<td align="left" valign="top"><p class="table">This functionalty is not implemented.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_getnumofskippedframes_4" class="float">GetNumOfSkippedFrames</h4>
<div class="paragraph"><p><em>Returns number of skipped frames.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>Ipp32u GetNumOfSkippedFrames();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the number of skipped frames.</p></div>
<h5 id="_return_values_111" class="float">Return Values</h5>
<div class="paragraph"><p>The number of skipped frames. Currently the method returns 0.</p></div>
</div>
<div class="sect3">
<h4 id="_usage_examples_14">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize the MJPEG decoder, create an instance of the UMC::MJPEGVideoDecoder class and a UMC::VideoDecoderParams Class object. The UMC::VideoDecoderParams* object should then be filled with necessary information (see example below). Invoke Init() method after that.</p></div>
<div class="exampleblock">
<div class="title">Example 29. MJPEGVideoDecoder Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000"> video_info</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> VDecParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MJPEGVideoDecoder</span><span style="color: #000000"> mjpeg_dec</span><span style="color: #000000">;</span>

<span style="color: #000000">VDecParams</span><span style="color: #000000">.</span><span style="color: #000000">info     </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">video_info</span><span style="color: #000000">;</span>
<span style="color: #000000">VDecParams</span><span style="color: #000000">.</span><span style="color: #000000">lFlags   </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">VDecParams</span><span style="color: #000000">.</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>

<span style="color: #000000">mjpeg_dec</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">VDecParams</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
<div class="exampleblock">
<div class="title">Example 30. MJPEGVideoDecoder Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> in</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> out</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MJPEGVideoDecoder</span><span style="color: #000000"> dec</span><span style="color: #000000">;</span>

<span style="color: #008000">// add initialization code here</span>
<span style="color: #000000">dec</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000">out</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_13">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>The UMC::MJPEGVideoDecoder is built on basis of the IPP JPEG decoder that uses OpenMP* threading. To activate this feature, compile the decoder with a compiler that supports OpenMP*, for example, the Intel&#174; C++ Compiler.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The decoder use internal buffer for one minimum coding unit (MCU) row per thread in case of a baseline sequential JPEG stream. The decoder uses an MCU buffer with image size for progressive and baseline non-interleaved JPEG streams.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>If input data does not contain a full compressed frame, the GetFrame() method fails with
UMC::UMC_ERR_NOT_ENOUGH_BUFFER return value.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_13">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mjpeg_video_decoder.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>$(IPPROOT)\include
$(CODECWS)\core\vm\include
$(CODECWS)\core\umc\include
$(CODECWS)\codec\color_space_converter\include
$(CODECWS)\codec\jpeg\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
color_space_converter
</p>
</li>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ippcore, ipps, ippi, ippcv, ippj, ippcc.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_MJPEG_VIDEO_DECODER is defined in umc_defs.h.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_splitters_and_demuxers">Splitters and Demuxers</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_umc_mp4splitter">UMC::MP4Splitter</h3>
<div class="paragraph"><p><code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> is a derived class for demultiplexing of media streams created in accordance with
ISO 14996:1 (<a href="#ISOIEC_Sys">[ISOIEC_Sys]</a>), chapetr 12 file format specification.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_36.png" alt="images/umc/umc_5_36.png" />
</div>
<div class="title">Figure 32. MP4Splitter Functional Scheme</div>
</div>
<div class="paragraph"><p>The algorithm of <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> operation is based on a number of standards
(see <a href="#ISOIEC_Sys">[ISOIEC_Sys]</a>, <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>, <a href="#ISOIEC_Audio">[ISOIEC_Audio]</a>, <a href="#ISOIEC_12">[ISOIEC_12]</a>, <a href="#ISOIEC_15">[ISOIEC_15]</a>). See figure for the splitting algorithm diagram.</p></div>
<div class="paragraph"><p>During initialization of <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code>, the parser reads the content of the MP4 header to get full information about the presentation and its elementary streams. Along with reading the header, an internal UMC::SplitterInfo structure is filled up. When common information about the tracks is read, track indexes are generated - one index tree for each track. The indexes keep information about all samples of the track along with their sizes, time stamps, and offsets from the beginning of the stream. The indexes are further used for quick access to any sample of the track.</p></div>
<div class="paragraph"><p>After initialization, call the <code>Run</code> method to create splitting threads. Threads are created only for enabled tracks. By default, all tracks are enabled. You can get the current state with the help of the GetInfo method and change it via the EnableTrack method.</p></div>
<div class="imageblock" id="mp4_splitter_algo">
<div class="content">
<img src="images/umc/umc_5_37.png" alt="images/umc/umc_5_37.png" />
</div>
<div class="title">Figure 33. MP4Splitter Algorithm Block Diagram</div>
</div>
<div class="paragraph"><p>Each thread starts searching for the next frame of the track in the stream and copies it to its internal buffer. You can access those buffers via the GetNextData method of the base UMC::Splitter class.  During call of GetNextData, <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> returns the pointer to the next frame via a UMC::MediaData object and locks its content so that it is not corrupted outside the process. Here you can use this frame, for example, pass it to the decoder. The next call of GetNextData unlocks the previous frame and locks the current one. <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> does not synchronize this procedure and returns frames in the order of incoming GetNextData calls.</p></div>
<div class="paragraph"><p>To pause the process of splitting, use the <code>Stop</code> method.</p></div>
<div class="paragraph"><p>To change the process of splitting, use the following order of calls:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Call <code>Stop</code> to pause the process of splitting (filling of internal buffers is broken).
</p>
</li>
<li>
<p>
Change the necessary parameters of the splitter, for example. move to some other time position (SetTimePosition), switch to another track (EnableTrack), change the speed of playback (SetRate), etc.
</p>
</li>
<li>
<p>
Call <code>Run</code> to create threads that fill internal buffers in new circumstances.
</p>
</li>
</ol></div>
<div class="sect4">
<h5 id="_derivation">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> is a child class for the UMC::IndexSplitter class, which keeps common functionality for AVI and MP4 splitters and is derived from the base UMC::Splitter class. (See also <code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code>).</p></div>
</div>
<div class="sect4">
<h5 id="_see_also">See Also</h5>
<div class="paragraph"><p>UMC::Splitter, UMC::SplitterParams, UMC::MediaData, UMC::DataReader and <code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code> classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_15">User Interface</h4>
<div class="paragraph"><div class="title">Related Classes</div><p>There is a UMC::IndexSplitter class that unifies MP4 and AVI splitters functionality (see Figure 5-38). UMC::IndexSplitter operates with track indexes whereas MP4 and AVI splitters implement parsing the input stream and building these indexes. See description of the methods related to <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> and derived both from UMC::Splitter and UMC::IndexSplitter classes in the Member Functions section below.</p></div>
<div class="paragraph"><p>For related types and data members, see UMC::Splitter Class. No new types or members are used in <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code>.</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 118. IndexSplitter Class Methods</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the splitter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Destroys the object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_run">Run</a></code></p></td>
<td align="left" valign="top"><p class="table">Starts internal threads.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_stop">Stop</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops all internal threads.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_getnextdata">GetNextData</a></code></p></td>
<td align="left" valign="top"><p class="table">Provides access to the next portion of data for a specific track. Unlocks the previous frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_checknextdata">CheckNextData</a></code></p></td>
<td align="left" valign="top"><p class="table">Provides access to the next portion of data for a specific track. Does not unlock the previously returned frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_setrate">SetRate</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets palyback rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_settimeposition">SetTimePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets time position in seconds from beginning of the source, usually time position of the first enabled video track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_gettimeposition">GetTimePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets time position in seconds from beginning of the source, usually time position of the first enabled video track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_getinfo">GetInfo</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns pointer to the UMC::SplitterInfo structure where all splitter information is kept.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4splitter_enabletrack">EnableTrack</a></code></p></td>
<td align="left" valign="top"><p class="table">Enables required tracks.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes splitter and allocates memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::SplitterParams &amp;init);</code></pre>
</div></div>
<h5 id="_parameters_70" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. An object of the UMC::SplitterParams class that contains specific information required to initialize the splitter.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method saves the UMC::DataReader pointer from the init variable and initializes mutex for the UMC::DataReader Class object.</p></div>
<h5 id="_return_values_112" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation. Any other value indicates mutex initilazation failure.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_close" class="float">Close</h4>
<div class="paragraph"><p><em>Destroys the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method stops the splitter, that is, breaks the internal threads and resets the internal buffers, and destroys the UMC::DataReader mutex.</p></div>
<h5 id="_return_values_113" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Any other value indicates failure of internal buffers reset and means the splitter cannot be stopped.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling Close. The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_mp4splitter_run" class="float">Run</h4>
<div class="paragraph"><p><em>Starts internal threads.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Run(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method creates one processing thread for each enabled track. If playback speed is not equal to 1, threads are created only for enabled video tracks.</p></div>
<h5 id="_return_values_114" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Error in creating a thread.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_stop" class="float">Stop</h4>
<div class="paragraph"><p><em>Stops all internal threads.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Stop(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method stops all the internal threads. The process of filling internal buffers stops. Use the <code>Run</code> method to start it again. Between calling <code>Stop</code> and <code>Run</code> you can change tracks to be split or call SetTimePosition for repositioning.</p></div>
<h5 id="_return_values_115" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The UMC::IndexSplitter object is not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_getnextdata" class="float">GetNextData</h4>
<div class="paragraph"><p><em>Provides access to the next portion of data for a specific track.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetNextData(UMC::MediaData* data, Ipp32u nTrack);</code></pre>
</div></div>
<h5 id="_parameters_71" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>data</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the output data object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>nTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of the track.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides access to the next portion of data for a specific track. All information about tracks and their numbers can be obtained via the GetInfo method.</p></div>
<h5 id="_return_values_116" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The next portion of data for the specified track cannot be obtained because the track number is wrong or the track with this number is disabled.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">End of the input stream. Data in the internal buffer is exhausted and no more data is expected.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input data parameter is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Input buffer does not contain enough data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The UMC::IndexSplitter object is not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Output buffer is not sufficient to accommodate data.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_checknextdata" class="float">CheckNextData</h4>
<div class="paragraph"><p><em>Provides access to the next portion of data for a specific track with no forwarding of DataReader pointer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status CheckNextData(UMC::MediaData* data, Ipp32u nTrack);</code></pre>
</div></div>
<h5 id="_parameters_72" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>data</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the output data object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>nTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of the track.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides access to the next portion of data for a specific track but unlike GetNextData does not forward the UMC::DataReader pointer. So the next call of CheckNextData returns the same data.</p></div>
<div class="paragraph"><p>All information about tracks and their numbers can be obtained via the GetInfo method.</p></div>
<h5 id="_return_values_117" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The next portion of data for the specified track cannot be obtained because the track number is wrong or the track with this number is disabled.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">End of the input stream. Data in the internal buffer is exhausted and no more data is expected.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input data parameter is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Input buffer does not contain enough data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The UMC::IndexSplitter object is not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Output buffer is not sufficient to accommodate data.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_setrate" class="float">SetRate</h4>
<div class="paragraph"><p><em>Sets palyback rate.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetRate(Ipp64f rate);</code></pre>
</div></div>
<h5 id="_parameters_73" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>rate</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Value of the palyback rate.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method saves a new value of playback speed into the internal structure and stops the splitter. To continue splitting, use the <code>Run</code> method.</p></div>
<h5 id="_return_values_118" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The UMC::IndexSplitter object is not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_settimeposition" class="float">SetTimePosition</h4>
<div class="paragraph"><p><em>Sets time position.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetTimePosition(Ipp64f timePos);</code></pre>
</div></div>
<h5 id="_parameters_74" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>timePos</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Time in seconds from the beginning of the input stream; should be in the range from 0 to the entire stream duration value.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method stops the splitter and goes to the data portion with the time stamp (PTS)
closest to the specified one.</p></div>
<div class="paragraph"><p>With several tracks in the stream, SetTimePosition works with the first enabled video track and other enabled tracks are aligned to it. If no video tracks are enabled, all tracks are aligned to the first audio track.
During the search for the video frame with the closest PTS the following rule is observed. If the chosen frame is not a random access point (I-frame), the nearest previous I-frame is
chosen for forward playback and the nearest following I-frame is chosen for backward playback.</p></div>
<div class="paragraph"><p>To continue splitting, call the <code>Run</code> method afterwards.</p></div>
<h5 id="_return_values_119" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_gettimeposition" class="float">GetTimePosition</h4>
<div class="paragraph"><p><em>Returns current time position.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetTimePosition(Ipp64f &amp;timePos);</code></pre>
</div></div>
<h5 id="_parameters_75" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>timePos</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The address of a variable where the current time position will be returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the current time position of the stream that is being split.</p></div>
<div class="paragraph"><p>With several tracks in the stream, GetTimePosition returns the time position of the first enabled video track. If no video tracks are available, the method returns the time position of the first enabled audio track.</p></div>
<h5 id="_return_values_120" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_getinfo" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Provides access to internal structure with all information about the stream.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(SplitterInfo** ppInfo);</code></pre>
</div></div>
<h5 id="_parameters_76" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>ppInfo</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The address of a variable of type UMC::SplitterInfo* where the pointer to the internal structure will be returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides access to the internal structure of <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> where all information about the stream is kept. The address of the internal structure is returned via
*ppInfo variable.</p></div>
<h5 id="_return_values_121" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4splitter_enabletrack" class="float">EnableTrack</h4>
<div class="paragraph"><p><em>Enables required tracks.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status EnableTrack(Ipp32u nTrack, Ipp32s iState);</code></pre>
</div></div>
<h5 id="_parameters_77" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>nTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of the track the status of which will be changed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>iState</em></p></td>
<td align="left" valign="top"><p class="table">New status for track nTrack; 1 is enable, 0 is disable.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method creates an additional processing thread if a track becomes enabled. If playback speed is not equal to 1, threads are created only for enabled video tracks. If a track becomes disabled, the corresponding thread is stopped.</p></div>
<div class="paragraph"><p>All information about tracks and their numbers can be obtained via the GetInfo method.</p></div>
<h5 id="_return_values_122" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Wrong track number or an error during creation of the additional thread.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_15">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize the MPEG4 splitter, create an instance of the <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> class and invoke the <code>Init()</code> method. The method accepts reference of type UMC::SplitterParams* as its single parameter. The reference must actually refer to an instance of class UMC::MP4SplitterParams, otherwise MP4Splitter returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="paragraph"><p>Set m_lFlags depending on what tracks you want to receive (audio, video, etc.) and provide a valid pointer to the instance of the UMC::DataReader Class. All necessary information is read from the file. All found elementary streams are marked as "enabled". You can later call the GetInfo() method to get complete information about the stream and use the EnableTrack() method to mark tracks for splitting.
When all the required tracks are chosen, call the <code>Run</code> method to begin splitting. See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 31. MP4Splitter Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReader</span><span style="color: #000000"> reader</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReaderParams</span><span style="color: #000000"> readerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP4Splitter</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP4SplitterParams</span><span style="color: #000000"> splitterParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> data</span><span style="color: #000000">;</span>

<span style="color: #000000">readerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">readerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #A31515">"stream.mp4"</span><span style="color: #000000">);</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> reader</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">readerParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">splitterParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pDataReader </span><span style="color: #000000">=</span><span style="color: #000000"> reader</span><span style="color: #000000">;</span>
<span style="color: #000000">splitterParams</span><span style="color: #000000">.</span><span style="color: #000000">m_lFlags</span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">AUDIO_SPLITTER </span><span style="color: #000000">|</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VIDEO_SPLITTER</span><span style="color: #000000">;</span>

<span style="color: #008000">/* with above parameters all video and audio elementary streams will be found*/</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">splitterParams</span><span style="color: #000000">);</span>

<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization">De-Initialization</h5>
<div class="paragraph"><p>To de-initialize the splitter, invoke the <code>Close()</code> method. The destructor invokes the
<code>Close()</code> method automatically.</p></div>
<div class="paragraph"><div class="title">Typical Usage</div><p>In the next example video and first audio tracks are split and passed to the decoders:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Call the <code>Init</code> method to search for all audio and video elementary streams. See example for details.
</p>
</li>
<li>
<p>
Set a flag in the SplitterInfo structure for the elementary streams you need to split.
</p>
</li>
<li>
<p>
Call the <code>Run</code> method to begin splitting.
</p>
</li>
</ol></div>
<div class="paragraph"><p>This example creates two threads to work with audio and video separately.</p></div>
<div class="exampleblock">
<div class="title">Example 32. MP4Splitter Usage Example</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">MainProc</span><span style="color: #000000">()</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> data</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> trNumber </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">,</span><span style="color: #000000"> trNumberAudio </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">,</span><span style="color: #000000"> trNumberVideo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">splitterInfo</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// . . . . .</span>
<span style="color: #000000">    </span><span style="color: #008000">// init</span>
<span style="color: #000000">    </span><span style="color: #008000">// . . . . .</span>

<span style="color: #000000">    </span><span style="color: #008000">// Get info about the stream</span>
<span style="color: #000000">    splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">splitterInfo</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// turn on 1st audio and 1st video tracks only</span>
<span style="color: #000000">    </span><span style="color: #0000ff">for</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">trNumber </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span><span style="color: #000000"> trNumber </span><span style="color: #000000">&lt;</span><span style="color: #000000"> splitterInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_nOfTracks</span><span style="color: #000000">;</span><span style="color: #000000"> trNumber</span><span style="color: #000000">++)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">splitterInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">trNumber</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_Type </span><span style="color: #000000">&amp;</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_ANY_AUDIO</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">trNumberAudio </span><span style="color: #000000">&lt;</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                trNumberAudio </span><span style="color: #000000">=</span><span style="color: #000000"> trNumber</span><span style="color: #000000">;</span>
<span style="color: #000000">                splitterInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">trNumber</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_isSelected </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                splitterInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">trNumber</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_isSelected </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">splitterInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">trNumber</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_Type </span><span style="color: #000000">&amp;</span>
<span style="color: #000000">                                        UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_ANY_VIDEO</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">trNumberVideo </span><span style="color: #000000">&lt;</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                    trNumberVideo </span><span style="color: #000000">=</span><span style="color: #000000"> trNumber</span><span style="color: #000000">;</span>
<span style="color: #000000">                    splitterInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">trNumber</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_isSelected </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">                </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                    splitterInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">trNumber</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_isSelected </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">                </span><span style="color: #000000">}</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                splitterInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">trNumber</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_isSelected </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #008000">// start splitting selected tracks</span>
<span style="color: #000000">    Splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Run</span><span style="color: #000000">();</span>


<span style="color: #000000">    </span><span style="color: #008000">// create separate threads for audio and video</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">trNumberAudio </span><span style="color: #000000">&gt;=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #000000">CreateAudioThread</span><span style="color: #000000">(</span><span style="color: #000000">trNumberAudio</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">trNumberVideo </span><span style="color: #000000">&gt;=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #000000">CreateVideoThread</span><span style="color: #000000">(</span><span style="color: #000000">trNumberVideo</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// callback functions for audio thread</span>
<span style="color: #000000">Ipp32s</span><span style="color: #000000"> </span><span style="color: #000000">AudioCallbackRoutine</span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> trNumber</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> data</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pDecSpecInfo </span><span style="color: #000000">=</span>
<span style="color: #000000">            spliter</span><span style="color: #000000">.</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">trNumber</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_pDecSpecInfo</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// if there's DecSpecInfo, then pass it to Decoder Init</span>
<span style="color: #000000">    </span><span style="color: #000000">InitAudioDecoder</span><span style="color: #000000">(</span><span style="color: #000000">pDecSpecInfo</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">.</span><span style="color: #000000">GetNextData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">data</span><span style="color: #000000">,</span><span style="color: #000000"> trNumber</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">DecodeAudioFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">data</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">                </span><span style="color: #000000">sleep</span><span style="color: #000000">(</span><span style="color: #000000">5</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_END_OF_STREAM</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_14">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p><code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> runs one thread on initializing. This thread parses the input stream, allocates internal buffers and structures, and builds track indexes. After calling the <code>Run</code> method, the splitter starts filling output buffers with data being split. This data becomes available via the  GetNextData() or CheckNextData() methods. These methods can be called asynchronously for each track from external threads.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_39.png" alt="images/umc/umc_5_39.png" />
</div>
<div class="title">Figure 34. MP4Splitter Threading Model</div>
</div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p><code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> receives data from UMC::DataReader object provided by the user.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_14">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mp4_spl.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>$(IPPROOT)\include;
&lt;samples-dir&gt;\sources\audio-video-codecs\codec\mpeg4_spl\include;
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include;
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include;
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include;</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_avisplitter">UMC::AVISplitter</h3>
<div class="paragraph"><p><code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code> is a derived class for extraction of separate tracks from AVI resources shown in the next figure.</p></div>
<div class="imageblock">
<div class="content">
<img src="images/umc/umc_5_40.png" alt="images/umc/umc_5_40.png" />
</div>
<div class="title">Figure 35. AVISplitter Functional Scheme</div>
</div>
<div class="paragraph"><p>The algorithm of <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> operation is based on a number of standards
(see <a href="#ISOIEC_Sys">[ISOIEC_Sys]</a>, <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>, <a href="#ISOIEC_Audio">[ISOIEC_Audio]</a>, <a href="#ISOIEC_12">[ISOIEC_12]</a>, <a href="#ISOIEC_15">[ISOIEC_15]</a>). See <a href="#mp4_split_algo">MP4 splitting figure</a> for the splitting algorithm diagram.</p></div>
<div class="paragraph"><p><code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code> provides samples ready for decoding.</p></div>
<div class="paragraph"><p><code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code> supports any number of audio/video tracks muxed into an AVI container.</p></div>
<div class="paragraph"><p><code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code> provides information about each track.</p></div>
<div class="paragraph"><p>Currently the AVI splitter supports audio and video tracks of the following type:</p></div>
<div class="ulist"><ul>
<li>
<p>
PCM_Audio
</p>
</li>
<li>
<p>
MPEG Audio (MPEG1 layer 3 and MPEG2 layer 3, MPEG4)
</p>
</li>
<li>
<p>
AC3 Audio
</p>
</li>
<li>
<p>
AMR Audio (ALAW, MULAW)
</p>
</li>
<li>
<p>
MPEG4 Video
</p>
</li>
<li>
<p>
DVHD
</p>
</li>
<li>
<p>
DV50
</p>
</li>
<li>
<p>
DVSD
</p>
</li>
<li>
<p>
WMV
</p>
</li>
<li>
<p>
H.263
</p>
</li>
<li>
<p>
H.261
</p>
</li>
<li>
<p>
MJPEG
</p>
</li>
<li>
<p>
Uncompressed video (some FOURCCs)
</p>
</li>
</ul></div>
<div class="paragraph"><p>The implemented algorithm is described in Microsoft documents <a href="#AVI_RIFF">[AVI_RIFF]</a> and <a href="#DV_AVI">[DV_AVI]</a>.</p></div>
<div class="sect4">
<h5 id="_derivation_2">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code> is a child class for the UMC::IndexSplitter abstract class, which keeps common functionality for AVI and MP4 splitters and is derived from the base UMC::Splitter class. (See also <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code>).</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_2">See Also</h5>
<div class="paragraph"><p>UMC::Splitter, UMC::SplitterParams, UMC::MediaData, UMC::DataReader and <code><a href="#_umc_mp4splitter">UMC::MP4Splitter</a></code> classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_16">User Interface</h4>
<div class="paragraph"><div class="title">Related Classes</div><p>There is a UMC::IndexSplitter class that unifies MP4 and AVI splitters functionality. UMC::IndexSplitter operates with track indexes whereas MP4 and AVI splitters implement parsing the input stream and building these indexes. See description of the methods related to <code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code> and derived both from UMC::Splitter and UMC::IndexSplitter classes in the Member Functions section below.</p></div>
<div class="paragraph"><p>For related types and data members, see UMC::Splitter Class. No new types or members are used in <code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code>.</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 119. AVISplitter Class Methods</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_avisplitter_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the splitter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_avisplitter_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the splitter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_avisplitter_run">Run</a></code></p></td>
<td align="left" valign="top"><p class="table">Starts internal threads; has to be called after <code>Init()</code> or Stop().</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_avisplitter_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes splitter and allocates memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::SplitterParams &amp;init);</code></pre>
</div></div>
<h5 id="_parameters_78" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. An object of the UMC::SplitterParams class that contains specific information required to initialize the splitter.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the AVI splitter. It parses the input stream to obtain the number of tracks and information about each track.</p></div>
<div class="paragraph"><p>The method starts internal threads for reading samples.</p></div>
<h5 id="_return_values_123" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Error in allocating memory for internal structures or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the data reader is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The splitter has already been initialized or the splitter failed to parse the AVI headers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">UMC::DataReader object in the init parameter is invalid.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_avisplitter_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes the splitter.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the splitter, that is, stops the internal threads and frees the allocated objects and buffers.</p></div>
<h5 id="_return_values_124" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_avisplitter_run" class="float">Run</h4>
<div class="paragraph"><p><em>Starts internal threads.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Run();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method starts internal threads. This method is supposed to be called after calling
Init() or Stop().</p></div>
<h5 id="_return_values_125" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The splitter has not been initialized yet.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Error in allocating memory for internal structures or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The splitter failed to run one of the internal threads.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_16">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize the AVI splitter, create an instance of the <code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code> class and invoke the <code>Init()</code> method. The method accepts reference of type UMC::SplitterParams as its single parameter.</p></div>
<div class="paragraph"><p>See <a href="#splitterparams_parameters">SplitterParams table</a> for the description of the m_pDataReader member of the UMC::SplitterParams class that influences initialization of the AVI splitter:</p></div>
<div class="paragraph"><p>See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 33. AVISplitter Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReader</span><span style="color: #000000"> reader</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReaderParams</span><span style="color: #000000"> readerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AVISplitter</span><span style="color: #000000"> spl</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterParams</span><span style="color: #000000"> splParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000">*</span><span style="color: #000000"> pSplInfo</span><span style="color: #000000">;</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> data</span><span style="color: #000000">;</span>

<span style="color: #000000">readerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">readerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #A31515">"file.avi"</span><span style="color: #000000">);</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> reader</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">readerParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">splParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pDataReader </span><span style="color: #000000">=</span><span style="color: #000000"> reader</span><span style="color: #000000">;</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> spl</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">splParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">spl</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">pSplInfo</span><span style="color: #000000">);</span>

<span style="color: #000000">spl</span><span style="color: #000000">.</span><span style="color: #000000">Close</span><span style="color: #000000">();</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_2">De-Initialization</h5>
<div class="listingblock">
<div class="content">
<pre><code>UMC::Splitter* spl = CreateAviSplitter();
UseAviSplitter(spl);

delete spl</code></pre>
</div></div>
<div class="exampleblock">
<div class="title">Example 34. AVISplitter Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">RunTrackProcessingRoutine</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// runs TrackProcessingRoutine in separate thread</span>
<span style="color: #000000">}</span>

<span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">WaitUnlessAllThreadsExit</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// waits somehow until all run threads finish</span>
<span style="color: #000000">}</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MainProc</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Splitter</span><span style="color: #000000">&amp;</span><span style="color: #000000"> spl</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> data</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">splInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> audioTrack </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> videoTrack </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>

<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> spl</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">splInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// Analyze detected elementary streams</span>
<span style="color: #000000">    </span><span style="color: #0000ff">for</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> i </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span><span style="color: #000000"> i </span><span style="color: #000000">&lt;</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_nOfTracks</span><span style="color: #000000">;</span><span style="color: #000000"> i</span><span style="color: #000000">++)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        UMC</span><span style="color: #000000">::</span><span style="color: #000000">TrackInfo</span><span style="color: #000000">*</span><span style="color: #000000"> info </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">i</span><span style="color: #000000">];</span>
<span style="color: #000000">        </span><span style="color: #008000">// choose video track if didn't yet</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">videoTrack </span><span style="color: #000000">&lt;</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_Type </span><span style="color: #000000">&amp;</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_ANY_VIDEO </span><span style="color: #000000">&amp;&amp;</span>
<span style="color: #000000">                    info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_isSelected</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #000000">RunTrackProcessingRoutine</span><span style="color: #000000">();</span><span style="color: #000000"> </span><span style="color: #008000">// run thread that processes video data</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>

<span style="color: #000000">        </span><span style="color: #008000">// choose audio track if didn't yet</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">audioTrack </span><span style="color: #000000">&lt;</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_Type </span><span style="color: #000000">&amp;</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_ANY_AUDIO </span><span style="color: #000000">&amp;&amp;</span>
<span style="color: #000000">                    info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_isSelected</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #000000">RunTrackProcessingRoutine</span><span style="color: #000000">();</span><span style="color: #000000"> </span><span style="color: #008000">// run thread that processes audio data</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>

<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">videoTrack </span><span style="color: #000000">&gt;=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> audioTrack </span><span style="color: #000000">&gt;=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #000000">WaitUnlessAllThreadsExit</span><span style="color: #000000">();</span>
<span style="color: #000000">}</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ProcessSample</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> data</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// somehow processes data</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">TrackProcessingRoutine</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Splitter</span><span style="color: #000000">&amp;</span><span style="color: #000000"> spl</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> data</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> spl</span><span style="color: #000000">.</span><span style="color: #000000">GetNextData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">data</span><span style="color: #000000">,</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ProcessSample</span><span style="color: #000000">(&amp;</span><span style="color: #000000">data</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_15">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p><code><a href="#_umc_acisplitter">UMC::AVISplitter</a></code> runs internal threads for reading data. The number of threads depends on the number of tracks, one reading thread for each "selected" track.</p></div>
<div class="paragraph"><p>By default, the AVI splitter marks all tracks as "selected".</p></div>
<div class="paragraph"><p>You can disable or re-enable any track by calling the EnableTrack method . The track reading thread is stopped when the thread is disabled and run when re-enabled.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The AVI splitter allocates a buffer for each track. Size of the buffer depends on track parameters parsed from the AVI stream. Disabling/re-enabling of a track has no effect on memory usage. Track toggling stops/re-runs reading threads but does not
release/re-allocate memory buffers.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_15">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_avi_splitter.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>$(IPPROOT)\include;
&lt;samples-dir&gt;\sources\audio-video-codecs\codec\avi_spl\include;
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include;
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include;
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include;
&lt;samples-dir&gt;\sources\audio-video-codecs\codec\common\include;</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
common
</p>
</li>
<li>
<p>
spl_common
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ippcore, ipps, ippi, ippcc, ippj.</p></div>
<div class="paragraph"><div class="title">Macros</div><p><em>BIG_ENDIAN</em> is a macro for big-endian platforms.</p></div>
<div class="paragraph"><div class="title">Platform Specific</div><p>The AVI splitter for big-endian platforms must be built with the <em>BIG_ENDIAN</em> macro.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_vc1splitter">UMC::VC1Splitter</h3>
<div class="paragraph"><p><code><a href="#_umc_vc1splitter">UMC::VC1Splitter</a></code> is a derived class for parsing video format input streams and dividing them into separate header, entry-point header, and frames.</p></div>
<div class="imageblock" id="fig_umc_5_45">
<div class="content">
<img src="./images/umc_5_45.png" alt="./images/umc_5_45.png" />
</div>
<div class="title">Figure 36. VC1Splitter Functional Scheme</div>
</div>
<div class="paragraph"><p><code><a href="#_umc_vc1splitter">UMC::VC1Splitter</a></code> receives data from the input file by chunks. VC1 Splitter analyzes data and reads required quantity of chunks for forming decoder
data, which can be a sequence header, a frame, entry points or another item, in a special frame buffer.
Unused data from the last read chunk is saved in the internal buffer and is used for the next time when decoder input data is formed.
Separation of frames corresponds to SMPTE-421M standard (Annex E) <a href="#SMPTE421M">[SMPTE421M]</a> standard.</p></div>
<div class="paragraph"><p>See next figure for an illustration of <code><a href="#_umc_vc1splitter">UMC::VC1Splitter</a></code> working principle.</p></div>
<div class="imageblock" id="fig_umc_5_46">
<div class="content">
<img src="images/umc/umc_5_46.png" alt="images/umc/umc_5_46.png" />
</div>
<div class="title">Figure 37. VC1Splitter Working Principle</div>
</div>
<div class="imageblock" id="fig_umc_5_47">
<div class="content">
<img src="images/umc/umc_5_47.png" alt="images/umc/umc_5_47.png" />
</div>
<div class="title">Figure 38. VC1Splitter Algorithm Block Diagram</div>
</div>
<div class="sect4">
<h5 id="_derivation_3">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_vc1splitter">UMC::VC1Splitter</a></code> class is inherited from the base UMC::Splitter Class. Current implementation uses one thread model and supports video interface functions (no audio).</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_3">See Also</h5>
<div class="paragraph"><p>UMC::MediaData, UMC::MediaDataEx and UMC::FileReader classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_17">User Interface</h4>
<div class="paragraph"><div class="title">Type Definitions</div><p>All type definitions are defined in <em>vc1_common</em> component.</p></div>
<div class="paragraph"><div class="title">Member Functions</div><p>The class constructor UMC::VClSplitter() initializes read buffer and frame buffer sizes as 1024 bytes, while the rest parameters are set to zero.</p></div>
<div class="tableblock" id="tab_umc_5_56">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 120. VC1Splitter Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_vc1splitter_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes splitter and allocates memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_vc1splitter_getnextdata">GetNextData</a></code></p></td>
<td align="left" valign="top"><p class="table">Writes a new frame, data size, frame start codes and offsets in UMC::MediaData during the function call.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_vc1splitter_checknextdata">CheckNextData</a></code></p></td>
<td align="left" valign="top"><p class="table">Checks the next video data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_vc1splitter_getinfo">GetInfo</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns pointer to current splitters parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_vc1splitter_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Frees all allocated memory.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_vc1splitter_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes splitter and allocates memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status Init(UMC::SplitterParams &amp;init);</code></pre>
</div></div>
<h5 id="_parameters_79" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Structure with initialization parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the splitter, allocates memory for the read buffer, frame buffer, start codes, and offsets, tracks the parameters structure. The method reads the first sequence header for initialization splitter parameters.</p></div>
<div class="paragraph"><p>The m_pDataReader field in the init structure is mandatory.</p></div>
<h5 id="_return_values_126" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">m_pDataReader in init structure is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Method is unable to allocate memory needed for internal buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed as the method fails to parse the sequence header.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation of input file reading failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_vc1splitter_getnextdata" class="float">GetNextData</h4>
<div class="paragraph"><p><em>Writes a new frame, data size, frame start codes, and offsets in mediaData.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status GetNextData(UMC::MediaData *mediaData, Ipp32u nTrack);</code></pre>
</div></div>
<h5 id="_parameters_80" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>mediaData</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to UMC::MediaData object or to UMC::MediaDataEx object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>nTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of the track. A formal parameter, <code><a href="#_umc_vc1splitter">UMC::VC1Splitter</a></code> works with only vc1 pure video. The number of the track is equal to 1.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method writes a new frame and data size into mediaData during the function call.</p></div>
<div class="paragraph"><p>If mediaData points to UMC::MediaDataEx object, additional information is passed that contains the start codes and offsets. This data is unavailable if mediaData is of UMC::MediaData type.</p></div>
<div class="paragraph"><p>If an error occurs during reading from file, data reader status is returned.</p></div>
<h5 id="_return_values_127" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">The frame buffer is smaller than required.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">End of the input stream. If an error occurs during file reading, data reader status is returned.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_vc1splitter_checknextdata" class="float">CheckNextData</h4>
<div class="paragraph"><p><em>Checks the next video data.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status CheckNextData(UMC::MediaData *mediaData, Ipp32u nTrack);</code></pre>
</div></div>
<h5 id="_parameters_81" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>mediaData</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to UMC::MediaData object or to UMC::MediaDataEx object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>nTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of the track. A formal parameter, <code><a href="#_umc_vc1splitter">UMC::VC1Splitter</a></code> works with only vc1 pure video. The number of the track is equal to 1.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method allows the user to receive the next ready-to-use portion of video data from the splitter. At the first call, the method returns a new frame. At the next call, it returns the same frame. After call of GetNextData(), the method returns a new frame.</p></div>
<div class="paragraph"><p>If mediaData points to UMC::MediaDataEx object, additional information is passed that contains the start codes and offsets. This data is unavailable if mediaData is of UMC::MediaData type.</p></div>
<h5 id="_return_values_128" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">The frame buffer is smaller than required.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">End of the input stream. If an error occurs during file reading, data reader status is returned.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_vc1splitter_getinfo" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Returns pointer to current splitters parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status GetInfo(UMC::SplitterInfo** ppInfo);</code></pre>
</div></div>
<h5 id="_parameters_82" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>ppInfo</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the splitter parameters pointer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns pointer to the current splitters parameters.</p></div>
<h5 id="_return_values_129" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_vc1splitter_close" class="float">Close</h4>
<div class="paragraph"><p><em>Frees allocated memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method frees all allocated memory. All parameters are set to the init values.</p></div>
<h5 id="_return_values_130" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_17">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>The UMC::SplitterParams contains all parameters for splitter initialization
(See UMC::SplitterParams Class). You need to initialize the m_pDataReader field in UMC::SplitterParams,
the remaining parameters are equal to zero as default value.</p></div>
<div class="paragraph"><p>The m_lFlags field in UMC::SplitterParams structure contains initialization flags for the splitter. You cannot change the flags after initialization.</p></div>
<div class="paragraph"><p>If at splitter initialization m_lFlags has FLAG_VSPL_4BYTE_ACCESS value, the resulting frame will contain swapped data. VC1 Splitter does not support AUDIO_SPLITTER flag.</p></div>
<div class="paragraph"><p>To get the splitter flags, call the GetInfo method. The values are written into the following fields:
Ipp32u m_splitter_flags splitter flags UMC::VideoStreamInfo m_video_infovideo input file parameters. There are no forbidden combinations of flags.
Initialization parameters should be set before <code>Init</code> call. See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 35. VC1Splitter Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterParams</span><span style="color: #000000"> splParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">splInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1Splitter</span><span style="color: #000000">*</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReader</span><span style="color: #000000">*</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReaderParams</span><span style="color: #000000"> fileParams</span><span style="color: #000000">;</span>

<span style="color: #008000">//FILE READER</span>
<span style="color: #000000">fileReader </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReader</span><span style="color: #000000">();</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">fileReader </span><span style="color: #000000">==</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">fileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">fileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000">argv</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">]);</span>

<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> fileReader</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">fileParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcSts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcSts</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #008000">//SPLITTER</span>
<span style="color: #000000">splInfo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1Splitter</span><span style="color: #000000">();</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">splitter </span><span style="color: #000000">==</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">splitter </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1Splitter</span><span style="color: #000000">();</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">splitter </span><span style="color: #000000">==</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">splParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pDataReader </span><span style="color: #000000">=</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">splParams</span><span style="color: #000000">.</span><span style="color: #000000">m_lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> FLAG_VSPL_4BYTE_ACCESS</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">//for swap data</span>

<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">splParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcSts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_3">De-Initialization</h5>
<div class="paragraph"><p>To de-initialize the splitter, invoke <code>Close()</code> method that frees all allocated memory and sets the remaining parameters to init values.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>splitter-&gt;Close();</code></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_typical_usage_cases_2">Typical Usage Cases</h5>
<div class="paragraph"><p>See next example for working cycle code for joint operation of VC1 Splitter and Decoder.</p></div>
<div class="exampleblock">
<div class="title">Example 36. VC1Splitter and VC1VideoDecoder Working Cycle</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #008000">//FILE READER</span>
<span style="color: #000000">fileReader </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReader</span><span style="color: #000000">();</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">fileReader </span><span style="color: #000000">==</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">fileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">fileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000">FILE_NAME</span><span style="color: #000000">);</span>

<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> fileReader</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">fileParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">umcSts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #008000">//SPLITTER</span>
<span style="color: #000000">splitter </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1Splitter</span><span style="color: #000000">();</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">splitter </span><span style="color: #000000">==</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>


<span style="color: #000000">splParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pDataReader </span><span style="color: #000000">=</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">splParams</span><span style="color: #000000">.</span><span style="color: #000000">m_lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> FLAG_VSPL_4BYTE_ACCESS</span><span style="color: #000000">;</span>

<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">splParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">umcSts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>


<span style="color: #000000">splInfo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000">();</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">splInfo </span><span style="color: #000000">==</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #008000">//DECODER</span>
<span style="color: #000000">decoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VC1VideoDecoder</span><span style="color: #000000">;</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">decoder </span><span style="color: #000000">==</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #008000">//return sequence header</span>

<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">CetNextVideoData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">,</span><span style="color: #000000">0</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">umcSts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>
<span style="color: #008000">//return splitter parameters</span>
<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">splInfo</span><span style="color: #000000">);</span>

<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">;</span>
<span style="color: #000000">videoInfo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000">*)(</span><span style="color: #000000">splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_pStreamInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width </span><span style="color: #000000">=</span><span style="color: #000000"> videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_splitter_flags</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">stream_type </span><span style="color: #000000">=</span><span style="color: #000000"> videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">stream_type</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">stream_subtype </span><span style="color: #000000">=</span><span style="color: #000000"> videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">stream_subtype</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">interlace_type </span><span style="color: #000000">=</span><span style="color: #000000"> videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">interlace_type</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">color_format </span><span style="color: #000000">=</span><span style="color: #000000"> videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">color_format</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_video_info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">streamName </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000">*)</span><span style="color: #000000">argv</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">];</span>

<span style="color: #000000">umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">umcSts </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_FAILED</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #008000">//main cycle</span>

<span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">umcSpl </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">//get new frame</span>
<span style="color: #000000">    umcSpl </span><span style="color: #000000">=</span><span style="color: #000000"> splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetNextData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">umcSpl</span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">//decoding</span>
<span style="color: #000000">    umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">yuv_data</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">switch</span><span style="color: #000000">(</span><span style="color: #000000">umcSts</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #0000ff">case</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA</span><span style="color: #000000">:</span>
<span style="color: #000000">            umcSts </span><span style="color: #000000">=</span><span style="color: #000000"> decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">yuv_data</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #0000ff">case</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">:</span>
<span style="color: #000000">            frameCount</span><span style="color: #000000">++;</span>
<span style="color: #000000">            </span><span style="color: #008000">// yuv_data contains decoding result</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #0000ff">default</span><span style="color: #000000">:</span>
<span style="color: #000000">            umcSpl </span><span style="color: #000000">=</span><span style="color: #000000"> umcSts</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">printf</span><span style="color: #000000">(</span><span style="color: #A31515">"Frame decoding error</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">}</span>

<span style="color: #000000">decoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Close</span><span style="color: #000000">();</span>
<span style="color: #000000">splitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Close</span><span style="color: #000000">();</span>
<span style="color: #000000">fileReader</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Close</span><span style="color: #000000">();</span>

<span style="color: #0000ff">delete</span><span style="color: #000000"> fileReader</span><span style="color: #000000">;</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> splitter</span><span style="color: #000000">;</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> decoder</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_16">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p><code><a href="#_umc_vc1splitter">UMC::VC1Splitter</a></code> does not spawn any threads internally.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p><code><a href="#_umc_vc1splitter">UMC::VC1Splitter</a></code> has two memory buffers: for reading from input file and for frames. The reading buffer size is equal to 1024 bytes. The size of the frame buffer is 1024 bytes as init value, which is adjusted after parsing the header (see Annex D of SMPTE421M). Frame buffer = (height + 128)<strong>(width + 128) + height / 2 + 64)</strong>(width / 2 + 64*2.</p></div>
<div class="paragraph"><p>The splitter also allocates memory for UMC::MediaDataEx structure, for saving start codes and values, it takes sizeof(UMC::MediaDataEx::_MediaDataEx) + sizeof(int)*2*START_CODE_NUMBER (in VC1 START_CODE_NUMBER = 600).</p></div>
<div class="paragraph"><p>There is no possibility for external buffers resizing.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>If frame size is bigger than frame buffer size the splitter increases buffer size by 2048 bytes. The current frame is lost in this case.</p></div>
<div class="paragraph"><p>If the file reader is unable to read data or open the input file, data reader status is returned.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_16">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_vc1_spl.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;samples-dir&gt;\sources\audio-video-codecs\codec\vc1_spl\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include
&lt;samples-dir&gt;\sources\audio-video-codecs\codec\vc1_common\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
color_space_converter
</p>
</li>
<li>
<p>
vc1_common
</p>
</li>
<li>
<p>
vm
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippi, ippvc.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC::UMC_ENABLE_VC1_SPLITTER is in umc_defs.h.</p></div>
</div>
<div class="sect3">
<h4 id="_features_and_notes_5">Features and Notes</h4>
<div class="paragraph"><p>In the vc1 input file format:</p></div>
<div class="ulist"><ul>
<li>
<p>
If input data is of UMC::MediaDataEx type, the splitter forms one frame that contains frame data and information on input file format: frame start code, all slice start codes, and field start code. To facilitate search, all start codes in frame align to int (with necessary zeroes added). The splitter also deletes redundant 0x03 in 0x00000300,
0x00000301, 0x00000302, 0x00000303 sequences (see standard Annex E of SMPTE421M). The UMC::MediaData pointer points to the first byte of the first start code in frame.
</p>
</li>
<li>
<p>
If input data is of UMC::MediaData type, the splitter returns unswapped frame data with 0x00000300, 0x00000301, 0x00000302, 0x00000303 sequences without start codes and offsets.
</p>
</li>
</ul></div>
<div class="paragraph"><p>In the rcv input file format:</p></div>
<div class="ulist"><ul>
<li>
<p>
The first 4 bytes represent size of the frame, the next 4 bytes are reserved data. The mediaData pointer points to first byte of the frame size.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_threadeddemuxer">UMC::ThreadedDemuxer</h3>
<div class="paragraph"><p>The Threaded Demuxer filters packets of elementary streams, or tracks, carried in MPEG1/MPEG2 system streams in line with <a href="#ISOIEC93_1">[ISOIEC93_1]</a>.
The following types of system streams are supported:</p></div>
<div class="ulist"><ul>
<li>
<p>
MPEG1 Program Stream (PS)
</p>
</li>
<li>
<p>
MPEG2 Program Stream (PS)
</p>
</li>
<li>
<p>
MPEG2 Transport Stream (TS)
</p>
</li>
<li>
<p>
MPEG2 Time-stamped Transport Stream (TTS)
</p>
</li>
<li>
<p>
MPEG2 Packetized Elementary Stream (PES).
</p>
</li>
</ul></div>
<div class="imageblock" id="fig_umc_5_49">
<div class="content">
<img src="images/umc/umc_5_49.png" alt="images/umc/umc_5_49.png" />
</div>
<div class="title">Figure 39. Packet Filtering</div>
</div>
<div class="paragraph"><p><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> also combines payloads of filtered packets into access units (AU), or frames, that the application accesses through API.</p></div>
<div class="paragraph"><p>In the case of a video track, an access unit corresponds to the definition given in ISO/IEC
13818-1 <a href="#ISOIEC00">[ISOIEC00]</a>. The following types of video are supported:</p></div>
<div class="ulist"><ul>
<li>
<p>
MPEG1<a href="#ISOIEC93_2">[ISOIEC93_2]</a>
</p>
</li>
<li>
<p>
MPEG2<a href="#ISOIEC96">[ISOIEC96]</a>
</p>
</li>
<li>
<p>
MPEG4<a href="#ISOIEC_Visual">[ISOIEC_Visual]</a>
</p>
</li>
<li>
<p>
H.261<a href="#ITUH261">[ITUH261]</a>
</p>
</li>
<li>
<p>
H.263<a href="#ITUH263">[ITUH263]</a>
</p>
</li>
<li>
<p>
H.264<a href="#ITUH264">[ITUH264]</a>.
</p>
</li>
</ul></div>
<div class="paragraph"><p>In the case of an audio track, an access unit starts from time-stamped payload (the packets contain Presentation Time Stamp (PTS)) and
includes all non-time-stamped payloads that follow it. This guarantees that each audio AU has a time stamp. The following types of audio are supported:</p></div>
<div class="ulist"><ul>
<li>
<p>
MPEG Audio <a href="#ISOIEC93_3">[ISOIEC93_3]</a>
</p>
</li>
<li>
<p>
MPEG4 Audio <a href="#ISOIEC_Audio">[ISOIEC_Audio]</a>
</p>
</li>
<li>
<p>
AC-3 <a href="#ATSC05">[ATSC05]</a>
</p>
</li>
<li>
<p>
DTS <a href="#ETSI02">[ETSI02]</a>
</p>
</li>
<li>
<p>
LPCM.
</p>
</li>
</ul></div>
<div class="paragraph"><p>In all other cases, the access unit includes payload of one PES packet. The following special types are supported:</p></div>
<div class="ulist"><ul>
<li>
<p>
DVD sub-pictures
</p>
</li>
<li>
<p>
DVD navigation packets
</p>
</li>
<li>
<p>
VBI data (teletext, inverted teletext, VPS, WSS, closed captioning, monochrome 4:2:2).
</p>
</li>
</ul></div>
<div class="paragraph"><p><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> can also be used as a frame constructor and an info extractor for pure audio and video streams.</p></div>
<div class="imageblock" id="fig_umc_5_50">
<div class="content">
<img src="images/umc/umc_5_50.png" alt="images/umc/umc_5_50.png" />
</div>
<div class="title">Figure 40. Frame Construction</div>
</div>
<div class="paragraph"><p>See next for the demuxer functional scheme:</p></div>
<div class="paragraph" id="fig_umc_5_51"><div class="title">Threaded Demuxer Algorithm Block Diagram</div><p>image::images/umc/umc_5_51.jpg</p></div>
<div class="paragraph"><p>The block System Stream Parser operates in compliance with ISO/IEC 13818-1 <a href="#ISOIEC00">[ISOIEC00]</a>.
It parses the input system stream, provides packet payloads along with its PID and some information about the entire elementary stream.
This information is used for selection of an appropriate frame constructor.</p></div>
<div class="paragraph"><p>Implementation of a Frame Constructor is based on the corresponding media standard. See <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code>.</p></div>
<div class="sect4">
<h5 id="_derivation_4">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> class is derived from UMC::Splitter Class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_4">See Also</h5>
<div class="paragraph"><p>UMC::Splitter, UMC::SplitterParams, UMC::DemuxerParams, UMC::MediaData,  <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> and UMC::DataReader classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_18">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p>The UMC::DemuxerParams class contains the following parameters:</p></div>
<div class="tableblock" id="tab_umc_5_58">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 121. DemuxerParams Class Parameters</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                                           </th>
<th align="left" valign="top">Type                                    </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiRules</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Number of UMC::TrackRule structures</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pRules</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::TrackRule*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the array of UMC::TrackRule structures</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_dAudToBuf</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table">Defines minimal duration (in seconds) of output audio samples. Any value greater than 0.0 forces <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> to buffer audio. Default value is 0.05 sec.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pOnPSIChangeEvent</code></p></td>
<td align="left" valign="top"><p class="table"><code>Event*</code></p></td>
<td align="left" valign="top"><p class="table">Invokes detection of changes in PAT/PMT tables in the streaming system and notifies the user&#8217;s application accordingly. Re-run <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> on receiving the information or pass <code>NULL</code> pointer to ignore.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_59">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 122. struct TrackRule Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                           </th>
<th align="left" valign="top">Type                    </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_TypeMask</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::TrackType</code></p></td>
<td align="left" valign="top"><p class="table">Defines types of the tracks that should be automatically enabled by <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_iPID</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp16s</code></p></td>
<td align="left" valign="top"><p class="table">Defines PID of the track that should be automatically enabled by <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code>. Value -1 (default) means any PID.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_Limit</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Maximum number of tracks that complies with a rule automatically enabled by <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code>. Value -1 means no limitations. The default value is 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_bValidAfterInit</code></p></td>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table">Flag that indicates validity of the rule after initialization is finished. If false (default), <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> does not use this rule for tracks that appear after initialization. It does, otherwise.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_60">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 123. struct TrackInfo Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                                   </th>
<th align="left" valign="top">Type                    </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_Type</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::TrackType</code></p></td>
<td align="left" valign="top"><p class="table">Generalized type of the track (common enumeration for audio/video/auxiliary tracks).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_PID</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">PID of the track assigned inside the system stream. [ISO/IEC93_1]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_isSelected</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Flag that indicates if a track or enabled or not. If enabled, <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> parses packets belonging to this track. Otherwise, it ignores all of them. When <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> detects a new track, it assigns this flag in accordance with the defined rules. The application can change this flag through the EnableTrack method.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pDecSpecInfo</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::MediaData*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData, which may contain the DecoderSpecificInfo structure [ISO/IEC_Sys]. This info is vital only for audio tracks of type AAC_MPEG4_STREAM, because such audio tracks have no header. This UMC::MediaData may also contain an MPEG2 sequence header, an H264 SPS/PPS and MPEG4 video object layer header, which can be useful for pipeline building.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pStreamInfo</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::StreamInfo*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to an empty base class UMC::StreamInfo; points to structures of one of the derived types: UMC::AudioStreamInfo, UMC::VideoStreamInfo or UMC::TeletextStreamInfo.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_61">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 124. struct MPEG2TrackInfo Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                                   </th>
<th align="left" valign="top">Type                    </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiProgNum</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Number of the Transport Stream program which the track belongs to. Applicable to MPEG2TS only.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiFramesReady</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Number of samples that are ready in the internal buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_iFirstFrameOrder</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">For testing purposes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_62">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 125. struct TeletextStreamInfo Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                       </th>
<th align="left" valign="top">Type                </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>szLanguage</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u[4]</code></p></td>
<td align="left" valign="top"><p class="table">First three bytes that are ASCII symbols representing the language. The last byte is equal to zero.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>uiType</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table">Type of Teletext page as defined in ESTI EN 300 468 <a href="#ETSI06">[ETSI06]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>uiMagazineNumber</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table">Magazine number as defined in ESTI EN 300 706 <a href="#ETSI06">[ETSI06]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>uiPageNumber</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table">Page number as defined in ESTI EN 300 706 <a href="#ETSI06">[ETSI06]</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_63">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 126. enum TrackType Members</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Value                          </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MPEG1V</code></p></td>
<td align="left" valign="top"><p class="table">MPEG1 Video, defined in ISOIEC 11172-2 <a href="#ISOIEC93_2">[ISOIEC93_2]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MPEG2V</code></p></td>
<td align="left" valign="top"><p class="table">MPEG2 Video, defined in ISOIEC 13818-2 <a href="#ISOIEC96">[ISOIEC96]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MPEG4V</code></p></td>
<td align="left" valign="top"><p class="table">MPEG4 Video, defined in ISOIEC 14496-2 <a href="#ISOIEC_Visual">[ISOIEC_Visual]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_H261</code></p></td>
<td align="left" valign="top"><p class="table">H.261 Video, defined in ITU-T Recommendation H.261 <a href="#ITUH261">[ITUH261]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_H263</code></p></td>
<td align="left" valign="top"><p class="table">H.263 Video, defined in ITU-T Recommendation H.263 <a href="#ITUH263">[ITUH263]</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_H264</code></p></td>
<td align="left" valign="top"><p class="table">H.264 Video, defined in ITU-T Recommendation H.264 <a href="#ITUH264">[ITUH264]</a> or ISOIEC 14496-10 <a href="#ISOIEC_10">[ISOIEC_10]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DVSD</code></p></td>
<td align="left" valign="top"><p class="table">DV Video. NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DV50</code></p></td>
<td align="left" valign="top"><p class="table">DV Video. NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DVHD</code></p></td>
<td align="left" valign="top"><p class="table">DV Video. NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DVSL</code></p></td>
<td align="left" valign="top"><p class="table">DV Video. NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_VC1</code></p></td>
<td align="left" valign="top"><p class="table">VC1 Video. NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_WMV</code></p></td>
<td align="left" valign="top"><p class="table">WMV Video. NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MJPEG</code></p></td>
<td align="left" valign="top"><p class="table">Motion JPEG. NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_YUV</code></p></td>
<td align="left" valign="top"><p class="table">Uncompressed video. NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_VIDEO</code></p></td>
<td align="left" valign="top"><p class="table">Mask that covers all types of video.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_PCM</code></p></td>
<td align="left" valign="top"><p class="table">PCM           audio. Uncompressed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_LPCM</code></p></td>
<td align="left" valign="top"><p class="table">LPCM         audio. Uncompressed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_AC3</code></p></td>
<td align="left" valign="top"><p class="table">AC-3 Audio. Defined in ATSC Document A52B <a href="#ATSC05">[ATSC05]</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_AAC</code></p></td>
<td align="left" valign="top"><p class="table">MPEG4 Audio. Means either ADTS AAC or raw AAC. The stream_type field of the structure UMC::AudioStreamInfo defines it more precisely.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_MPEGA</code></p></td>
<td align="left" valign="top"><p class="table">MPEG Audio. MPEG1 (defined in ISOIEC 11172-3 <a href="#ISOIEC93_3">[ISOIEC93_3]</a>) and MPEG2 (defined in ISOIEC 13818-3 <a href="#ISOIEC98">[ISOIEC98]</a>) of layers 1, 2 or 3.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_TWINVO</code></p></td>
<td align="left" valign="top"><p class="table">NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DTS</code></p></td>
<td align="left" valign="top"><p class="table">DTS Audio. Defined in ETSI TS 102 114 <a href="#ETSI02">[ETSI02]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_VORBIS</code></p></td>
<td align="left" valign="top"><p class="table">NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_AMR</code></p></td>
<td align="left" valign="top"><p class="table">NA for <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_AUDIO</code></p></td>
<td align="left" valign="top"><p class="table">Mask that covers all types of audio.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_SUB_PIC</code></p></td>
<td align="left" valign="top"><p class="table">DVD sub-picture. Defined in DVD Specification. <a href="#DVD">[DVD]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_DVD_NAV</code></p></td>
<td align="left" valign="top"><p class="table">DVD sub-picture. Defined in DVD Specification. <a href="#DVD">[DVD]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_DVD</code></p></td>
<td align="left" valign="top"><p class="table">Mask that covers all DVD-specified track types.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_VBI_TXT</code></p></td>
<td align="left" valign="top"><p class="table">VBI Teletext. Defined in ESTI EN 301 775 <a href="#ESTI03">[ESTI03]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_VBI_SPEC</code></p></td>
<td align="left" valign="top"><p class="table">VPS, WSS, CC or Monochrome 4:2:2. Defined in ESTI EN 301 775 <a href="#ESTI03">[ESTI03]</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_VBI</code></p></td>
<td align="left" valign="top"><p class="table">Mask that covers all VBI-specified track types.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_ANY_SPECIAL</code></p></td>
<td align="left" valign="top"><p class="table">Mask that covers all supported auxiliary track types: DVD-specified and VBI-specified.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>TRACK_UNKNOWN</code></p></td>
<td align="left" valign="top"><p class="table">Unknown track type.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_64">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 127. ThreadedDemuxer Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes demuxer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Releases resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_run">Run</a></code></p></td>
<td align="left" valign="top"><p class="table">Runs internal thread.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_stop">Stop</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops internal thread.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_getnextdata">GetNextData</a></code></p></td>
<td align="left" valign="top"><p class="table">Provides the next access unit from a particular track and unlocks the previously returned access unit from that track.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_checknextdata">CheckNextData</a></code></p></td>
<td align="left" valign="top"><p class="table">Provides an access unit from a particular track and does not unlock the previous access unit.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_setrate">SetRate</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets a new playback rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_settimeposition">SetTimePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets a new time position in seconds from the beginning of the source.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_gettimeposition">GetTimePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets current time position.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_getinfo">GetInfo</a></code></p></td>
<td align="left" valign="top"><p class="table">Provides information about an entire system stream and all detected tracks.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_alterquality">AlterQuality</a></code></p></td>
<td align="left" valign="top"><p class="table">Informs the demuxer about the quality of rendering.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer_enabletrack">EnableTrack</a></code></p></td>
<td align="left" valign="top"><p class="table">Enables or disables a specific track.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes demuxer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::SplitterParams &amp;init);</code></pre>
</div></div>
<h5 id="_parameters_83" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Reference to the initialization structure. This parameter must be a reference to an instance of UMC::DemuxerParams class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes demuxer. The method detects type of the input stream and selects an appropriate object for packet filtering. In the case of an MPEG1/2 system stream or pure audio streams, it estimates duration of media content. The method runs an internal thread and waits until the thread signals that the initialization is completed.</p></div>
<div class="paragraph"><p>The initialization is completed when one of the following happens:</p></div>
<div class="ulist"><ul>
<li>
<p>
All tracks specified by the rules were detected. The internal thread continues parsing.
</p>
</li>
<li>
<p>
One of the output buffers is full (no more room for the next portion of data). The internal thread is blocked and waits until the application gets data from this buffer or disables the track through the EnableTrack method.
</p>
</li>
<li>
<p>
The input stream was finished (UMC::UMC_ERR_END_OF_STREAM was received from UMC::DataReader). The thread exits.
</p>
</li>
<li>
<p>
If FLAG_VSPL_FAST_INIT is set, <code>Init</code> returns control to the caller immediately after the internal thread started.
</p>
</li>
</ul></div>
<h5 id="_return_values_131" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the data reader is <code>NULL</code> or initialization structure is not an instance of the UMC::DemuxerParams class.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> failed to allocate memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> failed to parse the input stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> has already been initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Bad UMC::TrackRules was provided.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_close" class="float">Close</h4>
<div class="paragraph"><p><em>Stops demuxer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method stops the internal thread and deletes all allocated memory.</p></div>
<h5 id="_return_values_132" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> was not initialized before closing.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_run" class="float">Run</h4>
<div class="paragraph"><p><em>Runs internal thread.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Run(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method runs the internal thread if it is stopped. All data stored in the output buffers is available.</p></div>
<h5 id="_return_values_133" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The thread cannot be created.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The demuxer was not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_stop" class="float">Stop</h4>
<div class="paragraph"><p><em>Stops internal thread.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Stop(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method stops the internal thread if it is run. All data stored in the output buffers is available.</p></div>
<h5 id="_return_values_134" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The demuxer was not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_getnextdata" class="float">GetNextData</h4>
<div class="paragraph"><p><em>Provides the next access unit from a particular track and unlocks the previously returned access unit from that track.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetNextData(UMC::MediaData* data, Ipp32u uiTrack);</code></pre>
</div></div>
<h5 id="_parameters_84" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>data</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the output data object</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>uiTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of the track to get data from; should be less than the total number of tracks detected.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides access to the output buffers that contain constructed frames (AUs). First, it unlocks the frame that was previously returned from the buffer associated with the specified track. Then it tries to lock the next frame in this buffer.</p></div>
<div class="paragraph"><p>When the frame is unlocked, it may be overwritten by data that comes from the input stream.</p></div>
<div class="paragraph"><p>If the internal thread was blocked by overflowing of this buffer, it is awaken again.</p></div>
<h5 id="_return_values_135" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Wrong track number was specified or the referenced track is currently disabled.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">The buffer associated with the specified track does not contain constructed frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The buffer associated with the specified track does not contain constructed frames and the input stream was finished.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The demuxer was not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_checknextdata" class="float">CheckNextData</h4>
<div class="paragraph"><p><em>Provides an access unit from a particular track and does not unlock the previous access unit.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status CheckNextData(UMC::MediaData* data, Ipp32u uiTrack);</code></pre>
</div></div>
<h5 id="_parameters_85" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>data</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to the output data object</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>uiTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of the track to check data in; should be less than the total number of tracks detected.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides access to the output buffers that contain constructed frames (AUs). Similar to GetNextData(), but does not unlock any frames and only provides the first available frame in the buffer associated with the specified track.</p></div>
<div class="paragraph"><p>The method leaves the output buffer unchanged. All repeated calls provide the same frame.</p></div>
<h5 id="_return_values_136" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Wrong track number was specified or the referenced track is currently disabled.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">The buffer associated with the specified track does not contain constructed frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The buffer associated with the specified track does not contain constructed frames and teh input stream was finished.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The demuxer was not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_setrate" class="float">SetRate</h4>
<div class="paragraph"><p><em>Sets playback rate.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetRate(Ipp64f rate);</code></pre>
</div></div>
<h5 id="_parameters_86" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>rate</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Value of playback rate.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets new playback rate value and flushes all output buffers.</p></div>
<div class="paragraph"><p>The method does not stop the internal thread, so to make sure the operation is correct, the application should call the Stop() method before and the Run() method after the playback rate is changed.</p></div>
<div class="paragraph"><p>If the playback rate value equals 1, playback is normal.</p></div>
<div class="paragraph"><p>If the playback rate value is not normal, packets from non-video tracks are ignored. For video tracks, Ta ble 5-65 shows some predefined threshold values of playback rate.</p></div>
<div class="paragraph"><p>If the playback rate value is negative, the demuxer provides GOPs of video frames in reverse order (video frames inside each GOP are in direct order).</p></div>
<div class="tableblock" id="tab_umc_5_65">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 128. Predefined Ranges of Playback Rate Values</caption>
<col width="20%" />
<col width="40%" />
<col width="40%" />
<thead>
<tr>
<th align="left" valign="top">Range of playback rate value            </th>
<th align="left" valign="top">Action(MPEG2/MPEG4)             </th>
<th align="left" valign="top">Action(H.264)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">rate &lt; -4</p></td>
<td align="left" valign="top"><p class="table">Reverse. Skip all except for I-frames. Adaptive jumping through the stream to maintain rendering quality.</p></td>
<td align="left" valign="top"><p class="table">Reverse. Skip all except for I-frames. Adaptive jumping through the stream to maintain rendering quality.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">rate = -4</p></td>
<td align="left" valign="top"><p class="table">Reverse. Skip all except for I-frames.</p></td>
<td align="left" valign="top"><p class="table">Reverse. Skip all except for I-frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">-4 &lt; rate &#8656; -3</p></td>
<td align="left" valign="top"><p class="table">Reverse. Skip all B-frames.</p></td>
<td align="left" valign="top"><p class="table">Reverse. Skip all except for I-frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">-3 &lt; rate &lt; 0</p></td>
<td align="left" valign="top"><p class="table">Reverse. Skip nothing.</p></td>
<td align="left" valign="top"><p class="table">Reverse. Skip all except for I-frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">0 &#8656; rate &#8656; 1</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip nothing.</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip nothing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">1 &lt; rate &lt; 3</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip nothing.</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip all except for I-frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">3 &#8656; rate &lt; 4</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip all B-frames.</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip all except for I-frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">rate = 4</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip all except for I-frames.</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip all except for I-frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">rate &gt; 4</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip all except for I-frames. Adaptive jumping through the stream to maintain rendering quality.</p></td>
<td align="left" valign="top"><p class="table">Direct. Skip all except for I-frames. Adaptive jumping through the stream to maintain rendering quality.</p></td>
</tr>
</tbody>
</table>
</div>
<h5 id="_return_values_137" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The demuxer has not been initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_settimeposition" class="float">SetTimePosition</h4>
<div class="paragraph"><p><em>Sets time position.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetTimePosition(Ipp64f timePos);</code></pre>
</div></div>
<h5 id="_parameters_87" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>timePos</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Time in seconds from the beginning of the input stream; should be within the range from 0.0 to the entire stream duration value.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method seeks position in the input stream that is closest to the specified time position. This method also flushes all output buffers.</p></div>
<div class="paragraph"><p>If UMC::DataReader is unable to provide size of the source, the method only flushes the buffers.</p></div>
<h5 id="_return_values_138" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The demuxer has not been initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_gettimeposition" class="float">GetTimePosition</h4>
<div class="paragraph"><p><em>Gets current time position.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetTimePosition(Ipp64f&amp; time);</code></pre>
</div></div>
<h5 id="_parameters_88" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>time</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Time in seconds from the beginning of the input stream.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method gets the current time position over the media stream.</p></div>
<div class="paragraph"><p>The application can use GetNextData or CheckNextData to obtain time position for a specific track.</p></div>
<h5 id="_return_values_139" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The demuxer has not been initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_IMPLEMENTED</code></p></td>
<td align="left" valign="top"><p class="table">The method is not implemeted in the current product version.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_getinfo" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Provides information on the entire system stream and all detected tracks.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetInfo(UMC::SplitterInfo** ppInfo);</code></pre>
</div></div>
<h5 id="_parameters_89" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>ppInfo</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to a structure of the type UMC::SplitterInfo* where the pointer to the internal structure is returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method provides access to an internal structure of the UMC::Splitter type that keeps all the information about the stream.</p></div>
<h5 id="_return_values_140" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The demuxer has not been initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The pointer to UMC::SplitterInfo* is <code>NULL</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_alterquality" class="float">AlterQuality</h4>
<div class="paragraph"><p><em>Informs demuxer about quality of rendering.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual void AlterQuality(Ipp64f time);</code></pre>
</div></div>
<h5 id="_parameters_90" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>time</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Difference between time when the video frame is ready to be presented and its presentation time stamp. Positive values mean that playback lags. Increasing positive values mean that playback is not smooth.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method informs <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> about rendering quality.</p></div>
<div class="paragraph"><p><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> considers this quality report only when the absolute value of playback rate is greater than 4. <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> adapts size of jumps to maintain rendering quality.</p></div>
<div class="paragraph"><p>If the time difference value is positive and greater than the previous one
<code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> increases jumps adaptively. Otherwise, it does nothing.</p></div>
<div class="paragraph"><p>When the playback rate changes, <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> resets the adapted jump size.</p></div>
<h5 id="_return_values_141" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_threadeddemuxer_enabletrack" class="float">EnableTrack</h4>
<div class="paragraph"><p><em>Enables or disables a specific track.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual void EnableTrack(Ipp32u uiTrack, Ipp32s iState);</code></pre>
</div></div>
<h5 id="_parameters_91" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>uiTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Number of the tracks to enable or disable. It should be less than the total number of tracks detected.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>iState</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. 0 means to disable a track; 1 means to enable a track.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method enables or disables a specific track. <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> ignores packets from disabled tracks. The user&#8217;s application is responsible for getting data from all the enabled tracks. The application can check flag UMC::TrackInfo::m_isSelected to identify which tracks are enabled.</p></div>
<h5 id="_return_values_142" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Wrong track number is specified.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The demuxer has not been initialized.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_18">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code>, create an instance of the <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> class and invoke  <code>Init()</code> method. The method accepts a reference of type UMC::SplitterParams&amp; (see UMC::SplitterParams Class) as its single parameter. The reference may be to an instance of UMC::DemuxerParams class that provides some advanced initialization parameters.</p></div>
<div class="paragraph"><p>First of all, the application should provide a valid pointer to an instance of the
UMC::DataReader class that is used to access the media stream.</p></div>
<div class="paragraph"><p>Then the application has to define which detected tracks <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> should automatically enable and which automatically disable. There are 2 options:
- using the base UMC::SplitterParams class for initialization and its field m_lFlags to choose one of predefined strategies (see Flags below).
- using derived parameters UMC::DemuxerParams to initialize <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code>. The application needs to allocate memory for array of structures UMC::TrackRule (m_uiNOfRules indicates how many structures are allocated) and fill them.</p></div>
<div class="paragraph"><p>Each rule defines a set of tracks to be enabled automatically. There are four parameters to define:</p></div>
<div class="ulist"><ul>
<li>
<p>
m_TypeMask - types covered by the mask, for example, TRACK_MPEG2V | TRACK_MPEG4V | TRACK_H264
</p>
</li>
<li>
<p>
m_iPID - if positive, defines the eaxct PID of the track to be enabled
</p>
</li>
<li>
<p>
m_Limit - if positive, imposes a limit of the number of tracks that can be enabled by applying this rule.
</p>
</li>
<li>
<p>
m_bValidAfterInit - flag that defines if the rule is still active after initialization stage
</p>
</li>
</ul></div>
<div class="paragraph"><p><em>Flags.</em> Below is a list of flags that affect <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> initialization throughUMC::SplitterParams::m_lFlags:</p></div>
<div class="ulist"><ul>
<li>
<p>
FLAG_VSPL_PRESET_1A_0V - enable 1 audio track (first detected at initialization stage) and ignore all other tracks.Equivalent to the former AUDIO_SPLITTER flag.
</p>
</li>
<li>
<p>
FLAG_VSPL_PRESET_0A_1V - enable 1 video track (first detected at initialization stage) and ignore all other tracks. Equivalent to the former AUDIO_SPLITTER flag.
</p>
</li>
<li>
<p>
FLAG_VSPL_PRESET_1A_1V - enable 1 audio and 1 video tracks (first detected at initialization stage) and ignore all other tracks. Equivalent to the former AV_SPLITTER flag.
</p>
</li>
<li>
<p>
FLAG_VSPL_PRESET_2A_1V - enable 2 audio and 1 video tracks (first detected at initialization stage) and ignore all other tracks.
</p>
</li>
<li>
<p>
FLAG_VSPL_PRESET_AA_1V - enable all audio and 1 video tracks (first detected at initialization stage) and ignore all other tracks.
</p>
</li>
<li>
<p>
FLAG_VSPL_PRESET_AA_AV - enable all audio and all video tracks (first detected at initialization stage) and ignore all other tracks.
</p>
</li>
<li>
<p>
FLAG_VSPL_FAST_INIT - forces the <code>Init</code> method to return immediately after the internal thread is started. Note that when this flag is set all rules (including the predefined rules) are considered as "valid after Init". Though the application gets <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> initialized as fast as possible it needs to trace newly detected tracks and handle them (get data or disable).
</p>
</li>
<li>
<p>
FLAG_VSPL_STOP_AFTER_INIT - the internal thread stops right after the initialization stage is completed.
</p>
</li>
<li>
<p>
FLAG_VSPL_ENCRYPTED_DATA - The application must set this flag when the payload of MPEG2 Transport Stream packets is encrypted. In this case, <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> filters packets from other tracks without constructing access units.
</p>
</li>
</ul></div>
<div class="paragraph"><p><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> uses the FLAG_VSPL_NEW_TRACK flag to notify the user about major events through UMC::SplitterInfo::m_splitter_flags. Setting this flag means a new track is detected or info on the existing track(s) has been updated. This flag is useful for the application that allows tracks be enabled after the initialization stage.</p></div>
<div class="paragraph"><p>The application can compare UMC::SplitterInfo with the previous information to find out what exactly has changed.</p></div>
<div class="paragraph"><div class="title">Initialization Examples</div><p>See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 37. AdvancedThreadedDemuxer Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReader</span><span style="color: #000000"> reader</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReaderParams</span><span style="color: #000000"> readerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">ThreadedDemuxer</span><span style="color: #000000"> demuxer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">DemuxerParams</span><span style="color: #000000"> demuxerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> data</span><span style="color: #000000">;</span>

<span style="color: #000000">readerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">readerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #A31515">"stream.mpg"</span><span style="color: #000000">);</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> reader</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">readerParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pDataReader </span><span style="color: #000000">=</span><span style="color: #000000"> reader</span><span style="color: #000000">;</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_uiRules </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">2</span><span style="color: #000000">;</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pRules </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TrackRule</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">];</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pRules</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">m_TypeMask </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_ANY_VIDEO</span><span style="color: #000000">;</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pRules</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">m_iPID </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pRules</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">m_iLimit </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pRules</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">m_bValidAfterInit </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">false</span><span style="color: #000000">;</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pRules</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">m_TypeMask </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_ANY_AUDIO</span><span style="color: #000000">;</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pRules</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">m_iPID </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0xC0</span><span style="color: #000000">;</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pRules</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">m_iLimit </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">2</span><span style="color: #000000">;</span>
<span style="color: #000000">demuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pRules</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">m_bValidAfterInit </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">false</span><span style="color: #000000">;</span>

<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> demuxer</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">demuxerParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_4">De-Initialization</h5>
<div class="paragraph"><p>To de-initialize the demuxer, invoke <code>Close()</code> method. The destructor automatically invokes
<code>Close()</code> method. The application is also supposed to delete the rules array.</p></div>
</div>
<div class="sect4">
<h5 id="_typical_usage_cases_3">Typical Usage Cases</h5>
<div class="paragraph"><p>In this usage example <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> is initialized in the main thread. The detected tracks are analyzed and a processing thread for each track of interest is run.
Each processing thread initializes an appropriate decoder, gets frames from <code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code>, and passes them to the decoder. When all track frames are processed and UMC::UMC_ERR_END_OF_STREAM is received the thread exits.</p></div>
<div class="exampleblock">
<div class="title">Example 38. ThreadedDemuxer Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">RunTrackProcessingRoutine</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// runs TrackProcessingRoutine in separate thread</span>
<span style="color: #000000">}</span>

<span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">WaitUnlessAllThreadsExit</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// waits somehow until all run threads finish</span>
<span style="color: #000000">}</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">MainProc</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Splitter</span><span style="color: #000000">&amp;</span><span style="color: #000000"> spl</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> data</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">splInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> audioTrack </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> videoTrack </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">-</span><span style="color: #000000">1</span><span style="color: #000000">;</span>

<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> spl</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">splInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// Analyze detected elementary streams</span>
<span style="color: #000000">    </span><span style="color: #0000ff">for</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> i </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span><span style="color: #000000"> i </span><span style="color: #000000">&lt;</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_nOfTracks</span><span style="color: #000000">;</span><span style="color: #000000"> i</span><span style="color: #000000">++)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        UMC</span><span style="color: #000000">::</span><span style="color: #000000">TrackInfo</span><span style="color: #000000">*</span><span style="color: #000000"> info </span><span style="color: #000000">=</span><span style="color: #000000"> splInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">i</span><span style="color: #000000">];</span>
<span style="color: #000000">        </span><span style="color: #008000">// choose video track if didn't yet</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">videoTrack </span><span style="color: #000000">&lt;</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_Type </span><span style="color: #000000">&amp;</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_ANY_VIDEO </span><span style="color: #000000">&amp;&amp;</span>
<span style="color: #000000">                                info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_isSelected</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #000000">RunTrackProcessingRoutine</span><span style="color: #000000">();</span><span style="color: #000000"> </span><span style="color: #008000">// run thread that processes video data</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>

<span style="color: #000000">        </span><span style="color: #008000">// choose audio track if didn't yet</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">audioTrack </span><span style="color: #000000">&lt;</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_Type </span><span style="color: #000000">&amp;</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_ANY_AUDIO </span><span style="color: #000000">&amp;&amp;</span>
<span style="color: #000000">                                info</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_isSelected</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #000000">RunTrackProcessingRoutine</span><span style="color: #000000">();</span><span style="color: #000000"> </span><span style="color: #008000">// run thread that processes audio data</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>

<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">videoTrack </span><span style="color: #000000">&gt;=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> audioTrack </span><span style="color: #000000">&gt;=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #000000">WaitUnlessAllThreadsExit</span><span style="color: #000000">();</span>
<span style="color: #000000">}</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ProcessSample</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> data</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// somehow processes data</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">TrackProcessingRoutine</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Splitter</span><span style="color: #000000">&amp;</span><span style="color: #000000"> spl</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp32s</span><span style="color: #000000"> iTrack</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> data</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> spl</span><span style="color: #000000">.</span><span style="color: #000000">GetNextData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">data</span><span style="color: #000000">,</span><span style="color: #000000"> iTrack</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ProcessSample</span><span style="color: #000000">(&amp;</span><span style="color: #000000">data</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_17">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> runs one thread when initialized. This thread reads the input stream, parses it, constructs frames, and places them into buffers. The constructed frames are available through GetNextData() and CheckNextData() methods. These methods can be invoked from the threads of another application.</p></div>
<div class="imageblock" id="fig_umc_5_53">
<div class="content">
<img src="./images/umc_5_53.png" alt="./images/umc_5_53.png" />
</div>
<div class="title">Figure 41. AdvancedThreadedDemuxer Threading Model</div>
</div>
<div class="paragraph"><div class="title">Memory Usage</div><p><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> allocates an output buffer for each track. Size of the buffer depends on the track type. Currently it is 4 Mb for each video track and 1 Mb for all others. Output buffers are allocated as the first packet of a new track is received from the input stream.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> gets data from UMC::DataReader Class object provided by the user.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_17">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_threaded_demuxer.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;samples-dir&gt;\sources\audio-video-codecs\codec\demuxer\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps.</p></div>
<div class="paragraph"><div class="title">Macros</div><p><em>BIG_ENDIAN</em> is a macro for big-endian platforms. It is applied only for LPCM audio tracks.</p></div>
<div class="paragraph"><div class="title">Platform Specific</div><p><code><a href="#_umc_threadeddemuxer">UMC::ThreadedDemuxer</a></code> for big-endian platforms must be built with <em>BIG_ENDIAN</em>
macro, which is applied only for LPCM audio tracks.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_mpeg2muxer">UMC::MPEG2Muxer</h3>
<div class="paragraph"><p><code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> performs multiplexing of elementary streams (ES) corresponding
to ISO/IEC 13818-1: Systems <a href="#ISOIEC_2000">[ISOIEC_2000]</a>. Multiplexing is the process of combining several separate digital media streams into a single media stream.</p></div>
<div class="paragraph"><p><code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> can produce system streams of both types:</p></div>
<div class="ulist"><ul>
<li>
<p>
MPEG2 Program Stream (MPEG2PS)
</p>
</li>
<li>
<p>
MPEG2 Packetized Elementary Stream (MPEG2PES)
</p>
</li>
<li>
<p>
MPEG2 Transport Stream (MPEG2TS)
</p>
</li>
<li>
<p>
MPEG2 Time-stamped Transport Stream (MPEG2TTS) with valid or zero timestamps.
</p>
</li>
</ul></div>
<div class="paragraph"><p>In the case of MPEG2PES or MPEG2PS each ES consisting of access units (AU), or frames, is divided into Packetized Elementary Stream (PES) packets as shown on Figure 5-54.</p></div>
<div class="imageblock" id="fig_umc_5_54">
<div class="content">
<img src="images/umc/umc_5_54.png" alt="images/umc/umc_5_54.png" />
</div>
<div class="title">Figure 42. Elementary Stream Division into PES Packets</div>
</div>
<div class="paragraph"><p>Note that in the case of MPEG2PES output stream can contain only one ES.</p></div>
<div class="paragraph"><p>In the case of MPEG2TS, each access unit is wrapped into one PES packet without fragmentation. This PES packet is divided then into transport stream (TS) packets of length equal to 188 bytes as shown in the next figure.</p></div>
<div class="paragraph" id="fig_umc_5_55"><div class="title">PES Packets Division into Transport Packets</div><p>image::images/umc/umc_5_55.jpg</p></div>
<div class="paragraph"><p>After packetization, <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> interleaves packets of different elementary streams depending on their time stamps.
<code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> writes a packet with the earliest time stamp into the output stream.
Packet time stamps are derived from access units time stamps according to ISO/IEC 13818-1:Systems (<a href="#ISOIEC_2000">[ISOIEC_2000]</a>).</p></div>
<div class="paragraph"><p><code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> also repeatedly enters special headers required by ISO/IEC 13818-1:Systems into the output stream:</p></div>
<div class="ulist"><ul>
<li>
<p>
in MPEG2PS, each PES packet starts from a pack header and the pack header is succeeded by a system header (at least one system header per 5.0 seconds);
</p>
</li>
<li>
<p>
in MPEG2TS/MPEG2TTS, a PES packet contains neither a pack header nor a system header but <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> repeatedly writes two special TS packets that contain Program Association Table (PAT) and Program Map Table (PMT).
</p>
</li>
</ul></div>
<div class="paragraph"><p>See next figure for the functional scheme of the demuxer.</p></div>
<div class="imageblock" id="fig_umc_5_56">
<div class="content">
<img src="images/umc/umc_5_56.png" alt="images/umc/umc_5_56.png" />
</div>
<div class="title">Figure 43. MPEG2Muxer Functional Scheme</div>
</div>
<div class="sect4">
<h5 id="_derivation_5">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> class is inherited from UMC::Muxer.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_5">See Also</h5>
<div class="paragraph"><p>UMC::MediaData, UMC::DataWriter, UMC::Muxer and UMC::MuxerParams classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_19">User Interface</h4>
<div class="paragraph"><div class="title">Data Members</div><p>UMC::MPEG2MuxerParams class contains parameters required for initialization of <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code>.</p></div>
<div class="tableblock" id="tab_umc_5_66">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 129. MPEG2MuxerParams Class Members</caption>
<col width="33%" />
<col width="16%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top">Name                       </th>
<th align="left" valign="top">Type                        </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_SystemType</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::SystemStreamType</code></p></td>
<td align="left" valign="top"><p class="table">Required type of the output stream</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_lFlags</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Unused</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_nNumberOfTracks</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Number of input elementary streams to be multiplexed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>pTrackParams</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::TrackParams*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to array of elementary stream parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_lChunkSizeLimit</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Max size of data chunk. It applies only to MPEG2_PROGRAMM_STREAM and MPEG2_PES_PACKETS_STREAM.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_nNumberOfAudioStreams</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Number of audio streams m_nNumberOfVideoStreams Ipp32u Number of video streams m_lpDataWriter UMC::DataWriter* Pointer to the active data writer. The muxer uses this pointer for writing the resulting stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiAlignmentFlags</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp8u</code></p></td>
<td align="left" valign="top"><p class="table">Flags that define alignment of access units inside PES packets, applicable for MPEG2PS only. Default value is 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_dSystemTimeDelay</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table">Delay (in seconds) of system time clock (SCR/PCR) relative to elementary streams clock (PTS/DTS). Default value is 0.3.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_uiChunkSizeLimit</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp16u</code></p></td>
<td align="left" valign="top"><p class="table">Total size of PES packet including PES header and payload, applicable for MPEG2PS only. Default value is 2048.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_67">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 130. Enum MPEG2MuxerAlignment Members</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Value                      </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2MUX_ALIGN_I</code></p></td>
<td align="left" valign="top"><p class="table">All video access units (AUs) of type I start from beginning of PES packets.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2MUX_ALIGN_P</code></p></td>
<td align="left" valign="top"><p class="table">All video AUs of type P start from beginning of PES packets.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2MUX_ALIGN_B</code></p></td>
<td align="left" valign="top"><p class="table">All video AUs of type B start from beginning of PES packets.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2MUX_ALIGN_UNDEF</code></p></td>
<td align="left" valign="top"><p class="table">All access units of undefined type (for example, non-video AU) start from beginning of PES packets.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2MUX_ALIGN_IP</code></p></td>
<td align="left" valign="top"><p class="table">Mask. All video AUs of type I or P start from beginning of PES packets.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2MUX_ALIGN_IPB</code></p></td>
<td align="left" valign="top"><p class="table">Mask. All video AUs of type I, P or B start from beginning of PES packets.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MPEG2MUX_ALIGN_ALL</code></p></td>
<td align="left" valign="top"><p class="table">Mask All AUs start from beginning of PES packets.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_68">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 131. MPEG2Muxer Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the muxer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Releases the muxer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_lockbuffer_">LockBuffer</a>*</code></p></td>
<td align="left" valign="top"><p class="table">Locks input buffer, returns free space. Implemented  in the base class.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_unlockbuffer">UnlockBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Unlocks input buffer, accepts next access unit.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_putendofstream">PutEndOfStream</a></code></p></td>
<td align="left" valign="top"><p class="table">Notifies about the end of frames passing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_flush">Flush</a></code></p></td>
<td align="left" valign="top"><p class="table">Forces the muxer to write all samples into output buffers regardless of emptiness of any buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_gettrackindex">GetTrackIndex</a>*</code></p></td>
<td align="left" valign="top"><p class="table">Returns index of elementary stream of a certain type. It is redundant method, but may be convenient. Implemented in base class.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_putdata">PutData</a>*</code></p></td>
<td align="left" valign="top"><p class="table">Locks the buffer, copies sample to free space and unlocks the buffer. A redundant method, but may be convenient. Implemented in the base class.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_putaudiodata">PutAudioData</a>*</code></p></td>
<td align="left" valign="top"><p class="table">Locks the first audio buffer, copies sample to free space and unlocks the buffer. A redundant method, but may be convenient. Implemented in the base class.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mpeg2muxer_putvideodata">PutVideoData</a>*</code></p></td>
<td align="left" valign="top"><p class="table">Locks the first video buffer, copies sample to free space and unlocks the buffer. A redundant method, but may be convenient. Implemented in the base class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="ulist"><ul>
<li>
<p>
- Methods inherited form UMC::Muxer class.
</p>
</li>
</ul></div>
<hr />
<h4 id="_umc_mpeg2muxer_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the muxer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MuxerParams *init);</code></pre>
</div></div>
<h5 id="_parameters_92" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure; must be a pointer to an instance of base UMC::MuxerParams class or derived UMC::MPEG2MuxerParams class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the muxer. It analyzes input parameters, allocates input buffers and other internal objects.</p></div>
<div class="paragraph"><p>The muxer may be initialized by either UMC::MuxerParams or UMC::MPEG2MuxerParams structures. In the case of UMC::MuxerParams, additional fields from the
UMC::MPEG2MuxerParams derived class are initialized with default zero values.</p></div>
<h5 id="_return_values_143" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the initialization structure is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Method is unable to allocate memory needed for internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_UNSUPPORTED</code></p></td>
<td align="left" valign="top"><p class="table">Type of some elementary stream or combination of some elementary stream type and required system type is not supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong combination of elementary streams was defined. For example, more than 8 AC3 elementary streams were defined to multiplex into MPEGPS.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mpeg2muxer_close" class="float">Close</h4>
<div class="paragraph"><p><em>Releases the muxer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method flushes all samples remaining in the internal buffers, closes the muxer, and releases all allocated objects and buffers.</p></div>
<h5 id="_return_values_144" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The muxer was not initialized before closing.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after <code>Close</code> calling.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_mpeg2muxer_lockbuffer_" class="float">LockBuffer</h4>
<div class="paragraph"><p><em>Locks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockBuffer(UMC::MediaData *lpData, Ipp32s iTrack);</code></pre>
</div></div>
<h5 id="_parameters_93" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>lpData</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to a UMC::MediaData object. This pointer specifies space available in the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>iTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. This parameter specifies the number of elementary stream. It should be an index of elementary stream in the array of UMC::TrackParams passed to <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> on initialization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method locks free space in an input buffer. If the operation is successful, the object of UMC::MediaData class contains a pointer to free space and a number of bytes available for writing. The application should avoid overrunning.</p></div>
<div class="paragraph"><p>After calling this method, call UnlockBuffer.</p></div>
<h5 id="_return_values_145" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong number of the elementary stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Available space in the buffer is less than the preferred input size specified in initialization parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The muxer is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mpeg2muxer_unlockbuffer" class="float">UnlockBuffer</h4>
<div class="paragraph"><p><em>Unlocks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnlockBuffer(UMC::MediaData *lpData, Ipp32s iTrack);</code></pre>
</div></div>
<h5 id="_parameters_94" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>lpData</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to a UMC::MediaData object. This pointer specifies space available in the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>iTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. This parameter specifies the number of elementary stream. It should be an index of elementary stream in the array of UMC::TrackParams passed to <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> on initialization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method unlocks free space in the input buffer and accepts the next portion of data. The size of the data should be defined by data size of the passed UMC::MediaData object.</p></div>
<div class="paragraph"><p>Before calling this method, call the LockBuffer method.</p></div>
<h5 id="_return_values_146" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong number of the elementary stream or no valid timestamp for the first given sample.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Size of the next portion of data is greater than currently available space. Overrunning is possible.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The muxer is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mpeg2muxer_putendofstream" class="float">PutEndOfStream</h4>
<div class="paragraph"><p><em>Notifies about end of frames passing.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PutEndOfStream(Ipp32s iTrack);</code></pre>
</div></div>
<h5 id="_parameters_95" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>iTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. This parameter specifies the number of elementary stream. It should be an index of elementary stream in the array of UMC::TrackParams passed to <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> on initialization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method notifies <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> that data for a certain elementary stream is over.
<code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> will ignore emptiness of this buffer.</p></div>
<div class="paragraph"><p>Call this method to avoid stalling of <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> when it selects an elementary stream to write the next packet. If some buffer is empty and End Of Stream (EOS) flag is not up yet, <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> will wait until all buffers are empty.</p></div>
<h5 id="_return_values_147" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong number of the elementary stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The muxer is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mpeg2muxer_flush" class="float">Flush</h4>
<div class="paragraph"><p><em>Forces muxer to write all samples into output buffers regardless of emptiness of any buffers.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Flush();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method forces the muxer to write all samples into the output buffers regardless of emptiness of any buffers.</p></div>
<h5 id="_return_values_148" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mpeg2muxer_gettrackindex" class="float">GetTrackIndex</h4>
<div class="paragraph"><p><em>Returns index of elementary stream of certain type.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32s GetTrackIndex(UMC::MuxerTrackType type, Ipp32s index = 0)</code></pre>
</div></div>
<h5 id="_parameters_96" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>type</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Type of elementary stream. index Input parameter. Number of appearance.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method detects the appearance of elementary stream of certain type in an array of UMC::TrackParams and returns its index. The method returns -1 when it is unable to find the required elementary stream. It is redundant method, but may be convenient when old API methods PutAudioData or PutVideoData are used.</p></div>
<hr />
<h4 id="_umc_mpeg2muxer_putdata" class="float">PutData</h4>
<div class="paragraph"><p><em>Copies sample to free space.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PutData(UMC::MediaData *lpData, Ipp32s iTrack);</code></pre>
</div></div>
<h5 id="_parameters_97" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>lpData</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to a UMC::MediaData object that contains user data to be placed into the buffer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>iTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. This parameter specifies the number of elementary stream. It should be an index of elementary stream in the array of UMC::TrackParams passed to <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> on initialization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method locks the input buffer, if available size is enough, copies the next data portion from the UMC::MediaData object into the buffer and unlocks it.</p></div>
<div class="paragraph"><p>This method is redundant. The same operation can be done by sequential calls of methods LockBuffer and UnlockBuffer. In the case of PutData, create a UMC::MediaData object for your data and use PutData to make the muxer lock the buffer, copy its content, and unlock the buffer.</p></div>
<h5 id="_return_values_149" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong number of the elementary stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Available space in the buffer is less than the preferred input size specified in the initialization parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The muxer is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mpeg2muxer_putaudiodata" class="float">PutAudioData</h4>
<div class="paragraph"><p><em>Locks the first audio buffer, copies sample to free space, and unlocks the buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PutAudioData(UMC::MediaData *lpData, Ipp32s iAudioIndex);</code></pre>
</div></div>
<h5 id="_parameters_98" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>lpData</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to a UMC::MediaData object that contains the next portion of user data to be placed into the buffer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>iAudioIndex</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. This parameter specifies the number of audio elementary stream in a subset of audio ESs from all declared ESs.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method locks a certain audio buffer, if available size is enough, copies the next data portion from the UMC::MediaData object into the buffer, and unlocks it.</p></div>
<div class="paragraph"><p>Note that the method receives the number of audio elementary stream rather than the number of elementary stream in the array of UMC::TrackParams like the PutData method does. The application can evaluate this number from the array of UMC::TrackParams or gets it through the PutData method.</p></div>
<h5 id="_return_values_150" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong number of the elementary stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Available space in the buffer is less than the preferred input size specified in the initialization parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The muxer is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mpeg2muxer_putvideodata" class="float">PutVideoData</h4>
<div class="paragraph"><p><em>Locks the first video buffer, copies sample to free space, and unlocks the buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PutVideoData(UMC::MediaData *lpData, Ipp32s iVideoIndex);</code></pre>
</div></div>
<h5 id="_parameters_99" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>lpData</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to a UMC::MediaData object that contains the next portion of user data to be placed into the buffer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>iVideoIndex</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. This parameter specifies the number of video elementary stream in a subset of video ESs from all declared ESs.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method locks a certain video buffer, if available size is enough, copies the next data portion from the UMC::MediaData object into the buffer, and unlocks it.</p></div>
<div class="paragraph"><p>Note that the method receives the number of video elementary stream rather than the number of elementary stream in the array of UMC::TrackParams like the PutData method does. The application can evaluate this number from the array of UMC::TrackParams or gets it through the PutData method.</p></div>
<h5 id="_return_values_151" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong number of the elementary stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Available space in the buffer is less than the preferred input size specified in the initialization parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The muxer is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_19">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code>, create an instance of the <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> class and invoke <code>Init()</code> method. The method accepts a pointer of type UMC::MuxerParams as its single parameter. The pointer must refer to an instance of UMC::MPEG2MuxerParams derived class or UMC::MuxerParams class. In the latter case additional fields of UMC::MPEG2MuxerParams take on the following default values:</p></div>
<div class="ulist"><ul>
<li>
<p>
m_uiAlignmentFlags = 0
</p>
</li>
<li>
<p>
m_dSystemTimeDelay = 0.3
</p>
</li>
<li>
<p>
m_uiChunkSizeLimit = 2048.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The application should create and initialize any implementation of UMC::DataWriter  Class and provide a valid pointer to it.</p></div>
<div class="paragraph"><p>The application should allocate memory for the array of objects of UMC::TrackParams class, fill them properly and indicate in the m_nNumberOfTracks field how many objects were allocated.</p></div>
<div class="paragraph"><p>The UMC::TrackParams class contains 2 important sections: elementary stream specific info (currently it may be UMC::AudioStreamInfo or UMC::VideoStreamInfo) and UMC::MediaBufferParams. The latter allows the application to define explicitly size of the input buffers that <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> will allocate (see Memory usage section). The following members of UMC::AudioStreamInfo and UMC::VideoStreamInfo structures are taken into account by <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code>:</p></div>
<div class="ulist"><ul>
<li>
<p>
stream_type is mandatory;
</p>
</li>
<li>
<p>
bitrate is highly desirable (<code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> is able to operate without it but interleaving may be not perfect)
</p>
</li>
<li>
<p>
framerate (video ESs only) is desirable (<code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> is able to operate without it but interleaving may be not perfect).
</p>
</li>
</ul></div>
<div class="paragraph"><p>The application should specify a required type of the output stream. If it conflicts with collection of elementary streams described by the array of UMC::TrackParams, <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> returns an error.</p></div>
<div class="paragraph"><p>In addition to MPEG2PS, MPEG2TS and MPEG2TTS types, <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> is able to pass pure streams if such an output system type is specified by the application.</p></div>
<div class="paragraph"><p>At initialization stage, <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> analyzes collection of elementary streams and their compatibility with required system stream type. The following constraints are validated:</p></div>
<div class="ulist"><ul>
<li>
<p>
Audio ESs of types LPCM, AC3, MPEG Audio and AAC are supported;
</p>
</li>
<li>
<p>
AAC is compatible with MPEG2TS only.
</p>
</li>
<li>
<p>
Maximum 8 AC3 ESs are available for MPEG2PS.
</p>
</li>
<li>
<p>
Maximum 8 LPCM ESs are available for MPEG2PS.
</p>
</li>
<li>
<p>
Maximum 32 MPEG Audio ESs are available for MPEG2PS.
</p>
</li>
<li>
<p>
Video ES of types MPEG1, MPEG2, MPEG4, and H264 are supported.
</p>
</li>
<li>
<p>
MPEG4 and H264 are compatible with MPEG2TS only.
</p>
</li>
<li>
<p>
Maximum 16 MPEG1/MPEG2 Video ESs are available for MPEG2PS.
</p>
</li>
<li>
<p>
At least one audio ES should be declared for pure audio as output.
</p>
</li>
<li>
<p>
At least one video ES should be declared for pure video as output.
</p>
</li>
</ul></div>
<div class="exampleblock">
<div class="title">Example 39. MPEG2Muxer Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG2Muxer</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pMPEG2Muxer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG2MuxerParams</span><span style="color: #000000"> muxerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileWriter</span><span style="color: #000000"> writer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileWriterParams</span><span style="color: #000000"> writerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AudioStreamInfo</span><span style="color: #000000"> audioInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AudioStreamInfo</span><span style="color: #000000"> audioInfoAux</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000"> videoInfo</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialize file writer</span>
<span style="color: #000000">writerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">writerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"output_stream.mpg"</span><span style="color: #000000">));</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> writer</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">writerParams</span><span style="color: #000000">);</span>

<span style="color: #008000">// Fill params structure</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_lpDataWriter </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">writer</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_SystemType </span><span style="color: #000000">=</span><span style="color: #000000"> MPEG2_PROGRAMM_STREAM</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_uiChunkSizeLimit </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">2048</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_uiAlignment </span><span style="color: #000000">=</span><span style="color: #000000"> MPEG2MUX_ALIGN_I</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_dSystemTimeDelay </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0.3</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_nNumberOfAudioStreams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_nNumberOfTracks </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">3</span><span style="color: #000000">;</span>

<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TrackParams</span><span style="color: #000000">[</span><span style="color: #000000">3</span><span style="color: #000000">];</span>

<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">type </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">AUDIO_TRACK</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">audio </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">audioInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefOutputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefInputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_numberOfFrame </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">20</span><span style="color: #000000">;</span>

<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">type </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VIDEO_TRACK</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">video </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">videoInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefOutputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">100000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefInputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">100000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_numberOfFrame </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">30</span><span style="color: #000000">;</span>

<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">].</span><span style="color: #000000">type </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">AUDIO_TRACK</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">].</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">audio </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">audioInfoAux</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefOutputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">2000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefInputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">2000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_numberOfFrame </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">20</span><span style="color: #000000">;</span>

<span style="color: #008000">// call init</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pMPEG2Muxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">muxerParams</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_5">De-Initialization</h5>
<div class="paragraph"><p>To de-initialize the muxer, invoke <code>Close()</code> method. The destructor automatically invokes <code>Close()</code> method. The application is also responsible for releasing of initialization parameters.</p></div>
</div>
<div class="sect4">
<h5 id="_typical_usage_cases_4">Typical Usage Cases</h5>
<div class="exampleblock">
<div class="title">Example 40. MPEG2Muxer Typical Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> rawAudioData</span><span style="color: #000000">,</span><span style="color: #000000"> rawAudioDataAux</span><span style="color: #000000">,</span>
<span style="color: #000000">    rawVideoData</span><span style="color: #000000">,</span><span style="color: #000000"> audioData</span><span style="color: #000000">,</span><span style="color: #000000"> audioDataAux</span><span style="color: #000000">,</span><span style="color: #000000"> videoData</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseCodec</span><span style="color: #000000">*</span><span style="color: #000000"> pAudioEncoder</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #000000">*</span><span style="color: #000000">pVideoEncoder</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pAudioEncoderAux</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Muxer</span><span style="color: #000000">*</span><span style="color: #000000"> pMuxer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #0000ff">bool</span><span style="color: #000000"> endOfAudio </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">false</span><span style="color: #000000">,</span><span style="color: #000000"> endOfVideo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">false</span><span style="color: #000000">,</span>
<span style="color: #000000">    endOfAudioAux </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">false</span><span style="color: #000000">;</span>
<span style="color: #000000">Ipp32s</span><span style="color: #000000"> iAudioPin</span><span style="color: #000000">,</span><span style="color: #000000"> iVideoPin</span><span style="color: #000000">,</span><span style="color: #000000"> iAudioPinAux</span><span style="color: #000000">;</span>

<span style="color: #008000">// Receive data from encoders</span>
<span style="color: #000000">pAudioEncoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">rawAudioData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">audioData</span><span style="color: #000000">);</span>
<span style="color: #000000">pVideoEncoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">rawVideoData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">videoData</span><span style="color: #000000">);</span>
<span style="color: #000000">pAudioEncoderAux</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">rawAudioDataAux</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">audioDataAux</span><span style="color: #000000">);</span>

<span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(!(</span><span style="color: #000000">endOfAudio </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> endOfVideo </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> endOfAudioAux</span><span style="color: #000000">))</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(!</span><span style="color: #000000">endOfAudio</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// ask for audio input buffer</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audioData</span><span style="color: #000000">,</span><span style="color: #000000"> iAudioPin</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #008000">// if there is enough free space, encode sample and push it into muxer</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            pAudioEncoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">rawAudioData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">audioData</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnlockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audioData</span><span style="color: #000000">,</span><span style="color: #000000"> iAudioPin</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// EOS for audio, inform muxer about it</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">PutEndOfStream</span><span style="color: #000000">(</span><span style="color: #000000">iAudioPin</span><span style="color: #000000">);</span>
<span style="color: #000000">                endOfAudio </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">true</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(!</span><span style="color: #000000">endOfVideo</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// ask for video input buffer</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoData</span><span style="color: #000000">,</span><span style="color: #000000"> iVideoPin</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #008000">// if there is enough free space, encode sample and push it into muxer</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            pVideoEncoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">rawVideoData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">videoData</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnlockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoData</span><span style="color: #000000">,</span><span style="color: #000000"> iVideoPin</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// EOS for video, inform muxer about it</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">PutEndOfStream</span><span style="color: #000000">(</span><span style="color: #000000">iVideoPin</span><span style="color: #000000">);</span>
<span style="color: #000000">                endOfVideo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">true</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(!</span><span style="color: #000000">endOfAudioAux</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// ask for auxiliary audio input buffer</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audioDataAux</span><span style="color: #000000">,</span><span style="color: #000000"> iAudioPinAux</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #008000">// if there is enough free space, encode sample and push it into muxer</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            pAudioEncoderAux</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">rawAudioDataAux</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">audioDataAux</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnlockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audioDataAux</span><span style="color: #000000">,</span><span style="color: #000000"> iAudioPinAux</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// EOS for auxiliary audio, inform muxer about it</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">PutEndOfStream</span><span style="color: #000000">(</span><span style="color: #000000">iAudioPinAux</span><span style="color: #000000">);</span>
<span style="color: #000000">                endOfAudioAux </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">true</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_useful_technical_information">Useful Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p><code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> does not currently run internal threads. But it is a thread-safe component and the application can deliver data for different ESs from separate threads.</p></div>
<div class="imageblock" id="fig_umc_5_58">
<div class="content">
<img src="images/umc/umc_5_58.png" alt="images/umc/umc_5_58.png" />
</div>
<div class="title">Figure 44. MPEG2Muxer in Multi-Threaded Application</div>
</div>
<div class="paragraph"><div class="title">Memory Usage</div><p>At initialization stage <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> allocates input buffers for each ES declared by the array of UMC::TrackParams. Size of each buffer is evaluated from UMC::MediaBufferParams and is a product of m_prefInputBufferSize and m_numberOfFrame values.</p></div>
<div class="paragraph"><p>If for any ES m_prefInputBufferSize is 0, this value is supposed to be equal to the bitrate specified in TrackParams.</p></div>
<div class="paragraph"><p>If for any ES m_prefInputBufferSize and the bitrate are 0, m_prefInputBufferSize is supposed to be equal to 500000 bytes for video ESs, 12500 bytes for audio ESs, and <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> returns UMC::UMC_ERR_INVALID_PARAMS for all other ESs.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>The following are <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> requirements for input data:</p></div>
<div class="ulist"><ul>
<li>
<p>
First received AU for every ES should have valid PTS, otherwise <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> returns UMC::UMC_ERR_INVALID_PARAMS. This statement is valid only for non-pure output system type. When <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> passes a pure elementary stream it does not require any timestamps.
</p>
</li>
<li>
<p>
Non-video AUs should not have DTS (they should be negative values). <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> resets DTSs of non-video AUs.
</p>
</li>
<li>
<p>
If a video AU has DTS, it should be less than PTS. <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> resets DTSs that is greater or equal to PTS.
</p>
</li>
<li>
<p>
It is desirable to start timestamps of every ES with a value that is not less than the m_dSystemTimeDelay parameter. <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> tries to keep SCR/PCR delayed relatively to PTS/DTS by value of the m_dSystemTimeDelay parameter and SCR/PCR should not be negative. Keeping of this delay is extremely important for hardware
de-multiplexers. This statement is valid only for non-pure output system type. When <code><a href="#_umc_mpeg2muxer">UMC::MPEG2Muxer</a></code> passes a pure elementary stream it does not require any timestamps.
</p>
</li>
</ul></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_18">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mpeg2_muxer.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;samples-dir&gt;\sources\audio-video-codecs\codec\mpeg2_mux\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include
&lt;samples-dir&gt;\sources\audio-video-codecs\io\media_buffers\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus.
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippdc, ippcorel</p></div>
<div class="paragraph"><div class="title">Macros</div><p><em>BIG_ENDIAN</em> is a macro for big-endian platforms. This macro is applied only to LPCM
audio ESs.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_mp4muxer">UMC::MP4Muxer</h3>
<div class="paragraph"><p><code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> performs multiplexing of media streams created in accordance with ISO/IEC
14496-12:2005 <a href="#ISOIEC_12">[ISOIEC_12]</a>. Multiplexing is the process of combining several separate digital media streams into a single media stream.</p></div>
<div class="paragraph"><p>See next figure for the functional scheme of the muxer.</p></div>
<div class="imageblock" id="fig_umc_5_59">
<div class="content">
<img src="images/umc/umc_5_59.png" alt="images/umc/umc_5_59.png" />
</div>
<div class="title">Figure 45. MP4Muxer Functional Scheme</div>
</div>
<div class="paragraph"><p>A standard stream contains a header, a video track, and an audio track. The header is a container that defines meta data for a stream, that is, samples sizes, offsets in streams, types, timestamps and so on. Each track consists of frames (for video) or samples (for audio). Tracks are stored in the data container, where they could be placed as an interleaved or continuous set of samples. Streams can also have a fragmented structure, that is, when a stream has no permanent header and data structure.</p></div>
<div class="paragraph"><p>The <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> algorithm is based on the following standards:</p></div>
<div class="ulist"><ul>
<li>
<p>
ISO/IEC 14496-1:2001 <a href="#ISOIEC_Sys">[ISOIEC_Sys]</a>
</p>
</li>
<li>
<p>
ISO/IEC 14496-12:2005 <a href="#ISOIEC_12">[ISOIEC_12]</a>
</p>
</li>
<li>
<p>
ISO/IEC 14496-14:2003 <a href="#ISOIEC_14">[ISOIEC_14]</a>
</p>
</li>
<li>
<p>
ISO/IEC 14496-15:2004 <a href="#ISOIEC_15">[ISOIEC_15]</a>
</p>
</li>
</ul></div>
<div class="paragraph"><p>See next figure for the algorithm block diagram.</p></div>
<div class="imageblock" id="fig_umc_5_60">
<div class="content">
<img src="images/umc/umc_5_60.png" alt="images/umc/umc_5_60.png" />
</div>
<div class="title">Figure 46. MP4Muxer Algorithm Block Diagram</div>
</div>
<div class="sect4">
<h5 id="_derivation_6">Derivation</h5>
<div class="paragraph"><p>The <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> class is inherited from UMC::Muxer.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_6">See Also</h5>
<div class="paragraph"><p>UMC::MediaData, UMC::DataWriter, UMC::Muxer and UMC::MuxerParams classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_20">User Interface</h4>
<div class="tableblock" id="tab_umc_5_69">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 132. MP4Muxer Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4muxer_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the muxer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4muxer_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Releases the muxer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4muxer_unlockbuffer">UnlockBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Unlocks input buffer, initiates muxing procedure.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4muxer_putendofstream">PutEndOfStream</a></code></p></td>
<td align="left" valign="top"><p class="table">Notifies of End of stream (EOS).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_mp4muxer_flush">Flush</a></code></p></td>
<td align="left" valign="top"><p class="table">Forces the muxer to write all samples into output buffers regardless of emptiness of any buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4muxer_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the muxer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MuxerParams *init);</code></pre>
</div></div>
<h5 id="_parameters_100" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>init</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure; must be a pointer to an instance of base UMC::MuxerParams class.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the muxer. It analyzes input parameters, allocates input buffers and other internal objects.</p></div>
<h5 id="_return_values_152" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the initialization structure is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Method is unable to allocate memory needed for internal objects or buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong combination of elementary streams was defined.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4muxer_close" class="float">Close</h4>
<div class="paragraph"><p><em>Releases the muxer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method flushes all samples remaining in the internal buffers, writes the MPEG4 header, and releases all allocated resources.</p></div>
<h5 id="_return_values_153" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The muxer failed to write the MPEG4 header.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after <code>Close</code> calling.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_mp4muxer_unlockbuffer" class="float">UnlockBuffer</h4>
<div class="paragraph"><p><em>Unlocks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnlockBuffer(UMC::MediaData *lpData, Ipp32s iTrack);</code></pre>
</div></div>
<h5 id="_parameters_101" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>lpData</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to a UMC::MediaData object that contains the next portion of data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>iTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. This parameter specifies the number of elementary stream. It should be an index of elementary stream in the array of UMC::TrackParams passed to <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> on initialization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method accepts the next portion of data and initiates muxing process for ready frames. The size of the data should be defined by data size of the passed UMC::MediaData object.</p></div>
<h5 id="_return_values_154" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong number of the elementary stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Size of the next portion of data is greater than currently available space. Overrunning is possible.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Wrong number of elementary stream.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4muxer_putendofstream" class="float">PutEndOfStream</h4>
<div class="paragraph"><p><em>Notifies about end of stream.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PutEndOfStream(Ipp32s iTrack);</code></pre>
</div></div>
<h5 id="_parameters_102" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>iTrack</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. This parameter specifies the number of elementary stream. It should be an index of elementary stream in the array of UMC::TrackParams passed to <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> on initialization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method notifies <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> that data for a certain elementary stream is over. The data remained in the muxer at that moment will be muxed.</p></div>
<h5 id="_return_values_155" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Wrong number of the elementary stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The muxer is not yet initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_mp4muxer_flush" class="float">Flush</h4>
<div class="paragraph"><p><em>Forces muxer to write all samples into output buffers regardless of emptiness of any buffers.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Flush(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method forces the muxer to write all samples from all buffers into the output stream regardless of emptiness of any buffers.</p></div>
<h5 id="_return_values_156" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_20">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code>, create an instance of the <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> class and invoke <code>Init()</code> method. The method accepts a pointer of type UMC::MuxerParams as its single parameter.</p></div>
<div class="paragraph"><p>The application should create and initialize any implementation of UMC::DataWriter  Class and provide a valid pointer to it.</p></div>
<div class="paragraph"><p>The application should allocate memory for the array of objects of TrackParams class, fill them properly and indicate in the m_nNumberOfTracks field how many objects were allocated.</p></div>
<div class="paragraph"><p>The UMC::TrackParams class contains 2 important sections: elementary stream specific info (currently it may be UMC::AudioStreamInfo or UMC::VideoStreamInfo) and UMC::MediaBufferParams. The latter allows the application to define explicitly size of the input buffers that UMC::MP42Muxer will allocate (see Memory usage section). The following members of UMC::AudioStreamInfo and UMC::VideoStreamInfo structures are taken into account by <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code>:</p></div>
<div class="ulist"><ul>
<li>
<p>
stream_type is mandatory
</p>
</li>
<li>
<p>
framerate (video ESs only) is desirable (if not set, 30 fps is used).
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">Initialization Examples</div><p>The next example prepares multiplexer for 1 video and 1 audio stream.</p></div>
<div class="paragraph"><p>The output MP4 stream is fragmented by pieces where video always starts with I-frame.</p></div>
<div class="exampleblock">
<div class="title">Example 41. MP4Muxer Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP4Muxer</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pMP4Muxer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MuxerParams</span><span style="color: #000000"> muxerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileWriter</span><span style="color: #000000"> writer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileWriterParams</span><span style="color: #000000"> writerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">AudioStreamInfo</span><span style="color: #000000"> audioInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000"> videoInfo</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialize file writer</span>
<span style="color: #000000">writerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">writerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span>
<span style="color: #000000">VM_STRING</span><span style="color: #000000">(</span><span style="color: #A31515">"output_stream.mp4"</span><span style="color: #000000">));</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> writer</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">writerParams</span><span style="color: #000000">);</span>

<span style="color: #008000">// Fill params structure</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_lpDataWriter </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">writer</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_SystemType </span><span style="color: #000000">=</span><span style="color: #000000"> MPEG4_SYSTEM_STREAM</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000"> m_lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> FLAG_FRAGMENTED_AT_I_PICTURES</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_nNumberOfTracks </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">2</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TrackParams</span><span style="color: #000000">[</span><span style="color: #000000">2</span><span style="color: #000000">];</span>

<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">type </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">AUDIO_TRACK</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">audio </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">audioInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefOutputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefInputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_numberOfFrame </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">20</span><span style="color: #000000">;</span>

<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">type </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VIDEO_TRACK</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">video </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">videoInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefOutputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">100000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefInputSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">100000</span><span style="color: #000000">;</span>
<span style="color: #000000">muxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">1</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_numberOfFrame </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">30</span><span style="color: #000000">;</span>

<span style="color: #008000">// call init</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pMP4Muxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">muxerParams</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_6">De-Initialization</h5>
<div class="paragraph"><p>To de-initialize the muxer, invoke <code>Close()</code> method. The destructor automatically invokes <code>Close()</code> method. The application is also responsible for releasing of initialization parameters.</p></div>
</div>
<div class="sect4">
<h5 id="_typical_usage_cases_5">Typical Usage Cases</h5>
<div class="paragraph"><p>Next example shows how to multiplex audio and video data received from encoder.</p></div>
<div class="exampleblock">
<div class="title">Example 42. MP4Muxer Typical Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> audioData</span><span style="color: #000000">,</span><span style="color: #000000"> VideoData</span><span style="color: #000000">;</span>
<span style="color: #0000ff">bool</span><span style="color: #000000"> endOfAudio </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">false</span><span style="color: #000000">,</span><span style="color: #000000"> endOfVideo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">false</span><span style="color: #000000">,</span>
<span style="color: #000000">        endOfAudioAux </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">false</span><span style="color: #000000">;</span>
<span style="color: #000000">Ipp32s</span><span style="color: #000000"> iAudioPin </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">,</span><span style="color: #000000"> iVideoPin </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(!(</span><span style="color: #000000">endOfAudio </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> endOfVideo</span><span style="color: #000000">))</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(!</span><span style="color: #000000">endOfAudio</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// ask for audio input buffer</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audioData</span><span style="color: #000000">,</span><span style="color: #000000"> iAudioPin</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #008000">// if there is enough free space, encode sample and push it into muxer</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            pAudioEncoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">uncompresseedAudioData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">audioData</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnlockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">audioData</span><span style="color: #000000">,</span><span style="color: #000000"> iAudioPin</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// EOS for audio, inform muxer about it</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">PutEndOfStream</span><span style="color: #000000">(</span><span style="color: #000000">iAudioPin</span><span style="color: #000000">);</span>
<span style="color: #000000">                endOfAudio </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">true</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(!</span><span style="color: #000000">endOfVideo</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// ask for video input buffer</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">VideoData</span><span style="color: #000000">,</span><span style="color: #000000"> iVideoPin</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #008000">// if there is enough free space, encode sample and push it into muxer</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">//code video data</span>
<span style="color: #000000">            pVideoEncoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">uncompressedVideoData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">VideoData</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnlockBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">VideoData</span><span style="color: #000000">,</span><span style="color: #000000"> iVideoPin</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #008000">// EOS for video, inform muxer about it</span>
<span style="color: #000000">                pMuxer</span><span style="color: #000000">-&gt;</span><span style="color: #000000">PutEndOfStream</span><span style="color: #000000">(</span><span style="color: #000000">iVideoPin</span><span style="color: #000000">);</span>
<span style="color: #000000">                endOfVideo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">true</span><span style="color: #000000">;</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect4">
<h5 id="_useful_technical_information_2">Useful Technical Information</h5>
<div class="paragraph"><div class="title">Threading Capabilities</div><p><code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> does not currently run internal threads. But it is a thread-safe component and the application can deliver data for different ESs from separate threads.</p></div>
<div class="imageblock" id="fig_umc_5_62">
<div class="content">
<img src="images/umc/umc_5_62.png" alt="images/umc/umc_5_62.png" />
</div>
<div class="title">Figure 47. MP4Muxer in Multi-Threaded Application</div>
</div>
<div class="paragraph"><div class="title">Memory Usage</div><p>At initialization stage <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> allocates input buffers for each ES declared by the array of UMC::TrackParams. Size of each buffer is evaluated from UMC::MediaBufferParams and is a product of m_prefInputBufferSize and m_numberOfFrame values.</p></div>
<div class="paragraph"><p>If for any ES m_prefInputBufferSize is 0, <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> calculates the value in accordance with the bitrate specified in UMC::TrackParams.</p></div>
<div class="paragraph"><div class="title">Features of Component Behavior With Respect to Input Data</div><p>The following are <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> requirements for input data:</p></div>
<div class="ulist"><ul>
<li>
<p>
All frames passes to <code><a href="#_umc_mp4muxer">UMC::MP4Muxer</a></code> must have valid PTS. Otherwise a corrupted stream may be created.
</p>
</li>
<li>
<p>
All presentation time stamps from the incoming frames should be in the increasing order.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_19">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_mp4_mux.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;samples-dir&gt;\sources\audio-video-codecs\codec\mpeg4_mux\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include
&lt;samples-dir&gt;\sources\audio-video-codecs\io\media_buffers\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
io.
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_input_output_devices">Input/Output Devices</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_umc_audio_renders">UMC Audio Renders</h3>
<div class="paragraph"><p>UMC features a number of audio renderers. Each renderer is designed for a certain operating system (Windows* OS, Linux* OS, OS X* OS) and may use API of additional software installed (for example, DirectSound). Some renderers work on all platforms (e.g. UMC::FWAudioRenderer, <code><a href="#_umc_nullaudiorender">UMC::NULLAudioRender</a>+er). Most of the renderers are derived from +<a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> class where the main concept is implemented. The hierarchy, functionality, and purpose of UMC audio renderers are described below.</p></div>
<div class="imageblock" id="fig_umc_5_75">
<div class="content">
<img src="images/umc/umc_5_75.png" alt="images/umc/umc_5_75.png" />
</div>
<div class="title">Figure 48. Derivation of UMC Audio Renders</div>
</div>
<div class="tableblock" id="tab_umc_5_83">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 133. Summary of Derivative Audio Renders</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Render                             </th>
<th align="left" valign="top">Render Class Name                   </th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Parameters Class Name</code></p></td>
<td align="left" valign="top"><p class="table">Purpose</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>NULL</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullaudiorender">UMC::NULLAudioRender</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::AudioRenderParams UMC::NULLAudioRenderParams</code></p></td>
<td align="left" valign="top"><p class="table">Gets PTSes without rendering (for example, performance measurement, plays video without audio).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>File Writer</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwaudiorender">UMC::FWAudioRender</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::AudioRenderParams UMC::FWAudioRenderParams</code></p></td>
<td align="left" valign="top"><p class="table">Dumps output stream in wav format.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DirectShow</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dsoundaudiorender">UMC::DSoundAudioRender</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::AudioRenderParams</code></p></td>
<td align="left" valign="top"><p class="table">Renders audio streams using Microsoft DirectShow* API.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>SDL</code></p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sdlaudiorender">UMC::SDLAudioRender</a></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::AudioRenderParams</code></p></td>
<td align="left" valign="top"><p class="table">Renders audio streams using Simple Directmedia Layer library.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Parameters classes described below are derived from UMC::AudioRenderParams. Only new data members are described.</p></div>
<div class="tableblock" id="tab_umc_5_84">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 134. Derivative Audio Renders Parameters Classes</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Type                </th>
<th align="left" valign="top">Parameter Name              </th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Default Value</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::NULLAudioRenderParams</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table">m_InitPTS</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>0</code></p></td>
<td align="left" valign="top"><p class="table">Initial PTS. Use this parameter to set start point.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::FWAudioRenderParams</code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_char*</code></p></td>
<td align="left" valign="top"><p class="table">pOutFile</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>NULL</code></p></td>
<td align="left" valign="top"><p class="table">Output file name. If the class is not used, output.wav file is created by default.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_umc_basicaudiorender">UMC::BasicAudioRender</h3>
<div class="paragraph"><p><code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> provides basic implementation for the whole variety of audio renderers. In this implementation, a separate thread pulls out audio data from the internal buffer and feeds it to the corresponding audio device. The user should only copy user data to the renderer. The renderer plays all the data and closes the thread.</p></div>
<div class="imageblock" id="fig_umc_5_76">
<div class="content">
<img src="images/umc/umc_5_76.png" alt="images/umc/umc_5_76.png" />
</div>
<div class="title">Figure 49. BasicAudioRender Functional Scheme</div>
</div>
<div class="paragraph"><p><code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> allows the user to manage the buffer, that is, to feed the buffer with data safely and get information about the current status of the buffer.</p></div>
<div class="sect4">
<h5 id="_derivation_7">Derivation</h5>
<div class="paragraph"><p>MC::BasicAudioRender is inherited from UMC::AudioRender class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_7">See Also</h5>
<div class="paragraph"><p>UMC::MediaReceiver, UMC::AudioRender and UMC::MediaData classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_21">User Interface</h4>
<div class="paragraph"><div class="title">Data Members</div><p><code>ThreadProc()</code> is a callback function for internal threading.</p></div>
<div class="tableblock" id="tab_umc_5_85">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 135. BasicAudioRender Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method                                                         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the basic
audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">De-initializes the
basic audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_lockinputbuffer">LockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Makes the input buffer
inaccessible for other processes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_unlockinputbuffer">UnlockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Unlocks the input buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the internal
buffer with audio data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_stop">Stop</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops playback
(interrupts the internal thread).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_pause">Pause</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops playback
temporarily.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_gettime">GetTime</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns audio
renderer PTS.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_getdelay">GetDelay</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns audio
device latency.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basicaudiorender_setparams">SetParams</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets new
parameters of the renderer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basicaudiorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes basic audio renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams* pInit);</code></pre>
</div></div>
<h5 id="_parameters_103" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Object of UMC::MediaReceiverParams class that contains specific information about the audio stream to be rendered.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method creates and initializes the internal media buffer taking into account information from pInit parameter. This method also creates an internal thread. Callback function for this thread should be implemented in derived classes.</p></div>
<h5 id="_return_values_157" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basicaudiorender_close" class="float">Close</h4>
<div class="paragraph"><p><em>Deinitializes basic audio renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method waits until the internal thread is closed and then closes the internal media buffer.</p></div>
<div class="paragraph"><p>If the playback is paused, the method interrupts the thread.</p></div>
<div class="paragraph"><p>Note that if playback is not paused or stopped, the renderer waits for audio data to come to the internal buffer. To notify the renderer that no more audio data is expected, use UnLockInputBuffer with UMC::UMC_ERR_END_OF_STREAM value of StreamStatus parameter when sending the final portion of data.</p></div>
<h5 id="_return_values_158" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Closing of media buffer failed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_basicaudiorender_lockinputbuffer" class="float">LockInputBuffer</h4>
<div class="paragraph"><p><em>Locks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockInputBuffer(UMC::MediaData *in);</code></pre>
</div></div>
<h5 id="_parameters_104" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The object is filled with information on buffer, where user can place a new portion of data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method closes access to the media buffer for other processes and returns pointer to a part of the buffer where user&#8217;s audio data must be copied.</p></div>
<h5 id="_return_values_159" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the internal pointers is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Valid data object cannot be returned due to lack of free space in the buffer. This value depends on the stream characteristics (number of channels, bits per sample, etc.)</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basicaudiorender_unlockinputbuffer" class="float">UnLockInputBuffer</h4>
<div class="paragraph"><p><em>Unlocks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnLockInputBuffer(UMC::MediaData *in, UMC::Status StreamStatus);</code></pre>
</div></div>
<h5 id="_parameters_105" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Object that keeps the pointer to the area that has been filled with audio data and its size in bytes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>StreamStatus Input parameter. Current stream status parameter that is UMC::UMC_OK (default value) if the stream continues and UMC::UMC_ERR_END_OF_STREAM if no more data within the current stream is expected. In the latter case the renderer should play the rest of the data and close the internal thread.</p></div>
<div class="paragraph"><div class="title">Description</div><p>The method opens access to the buffer for other processes when feeding the buffer with audio data is finished.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">To avoid mistakes, the size of input data should not exceed the size returned by LockInputBuffer method.</td>
</tr></table>
</div>
<h5 id="_return_values_160" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One of the internal pointers is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Internal structure is full and the buffer cannot be unlocked.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Too much data was fed in and the buffer cannot be unlocked.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basicaudiorender_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets internal media buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method waits for the internal thread to be finished and resets the internal media buffer.</p></div>
<h5 id="_return_values_161" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basicaudiorender_stop" class="float">Stop</h4>
<div class="paragraph"><p><em>Interrupts playback.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Stop();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method interrupts the internal thread that feeds the audio device with audio data.</p></div>
<h5 id="_return_values_162" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basicaudiorender_pause" class="float">Pause</h4>
<div class="paragraph"><p><em>Interrupts playback.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Pause(bool pause);</code></pre>
</div></div>
<h5 id="_parameters_106" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pause</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. When TRUE, rendering is stopped; when FALSE, rendering is resumed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method stops or resumes playback depending on the pause value. During the pause the media buffer is full of audio data and LockInputBuffer method always returns UMC::UMC_ERR_NOT_ENOUGH_BUFFER status.</p></div>
<h5 id="_return_values_163" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basicaudiorender_gettime" class="float">GetTime</h4>
<div class="paragraph"><p><em>Returns audio renderer PTS.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>Ipp64f GetTime();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns current time position in seconds from the beginning of playback. Calculating of time position depends on renderer and is implemented in derived classes.</p></div>
<h5 id="_return_values_164" class="float">Return Values</h5>
<div class="paragraph"><p>Time, in seconds, that has passed from the start of playback.</p></div>
<hr />
<h4 id="_umc_basicaudiorender_getdelay" class="float">GetDelay</h4>
<div class="paragraph"><p><em>Returns renderer latency.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>Ipp64f GetDelay();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns estimated value of renderer latency.</p></div>
<h5 id="_return_values_165" class="float">Return Values</h5>
<div class="paragraph"><p>0 means playback is stopped.</p></div>
<hr />
<h4 id="_umc_basicaudiorender_setparams" class="float">SetParams</h4>
<div class="paragraph"><p><em>Sets new parameters of renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::MediaReceiverParams* pParams, Ipp32u trickModes);</code></pre>
</div></div>
<h5 id="_parameters_107" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pParams</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the UMC::AudioRenderParams object that keeps new renderer parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>trickModes</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Used in inherited class UMC::NULLAudioRender only. The default value is UMC::MC_TRICK_MODES_NO.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets new parameters for the renderer (for example, number of channels, sample rate, etc.)</p></div>
<h5 id="_return_values_166" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Parameters object is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Failed to set new parameters.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_20">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>basic_audio_render.h</p></div>
<div class="paragraph"><div class="title">Include paths to required UMC components</div><p>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\io\audio_renders\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
$(IPPROOT)\include</p></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_dsoundaudiorender">UMC::DSoundAudioRender</h3>
<div class="paragraph"><p><code><a href="#_umc_dsoundaudiorender">UMC::DSoundAudioRender</a></code> class provides playback of audio files using DirectX API (DirectSound component). <code><a href="#_umc_dsoundaudiorender">UMC::DSoundAudioRender</a></code> class keeps the realization of SendFrame method only. It manages audio data flow between internal media buffer and DSound buffer where it is played by audio device. The SendFrame method of <code><a href="#_umc_dsoundaudiorender">UMC::DSoundAudioRender</a></code> works in a separate thread and constantly feeds DSound buffer with audio data synchronizing the whole process.</p></div>
<div class="sect4">
<h5 id="_derivation_8">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_dsoundaudiorender">UMC::DSoundAudioRender</a></code> is inherited from <code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_8">See Also</h5>
<div class="paragraph"><p>UMC::MediaReceiver, UMC::AudioRender, UMC::MediaData.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_22">User Interface</h4>
<div class="tableblock" id="tab_umc_5_87">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 136. DSoundAudioRender Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dsoundaudiorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes DSound audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dsoundaudiorender_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">De-initializes DSound audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dsoundaudiorender_sendframe">SendFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Sends a portion of audio data to
DS buffer and synchronizes the process.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dsoundaudiorender_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the internal buffer with audio
data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dsoundaudiorender_pause">Pause</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops playback temporarily.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dsoundaudiorender_getvolume">GetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets volume level (from 0 to 1).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dsoundaudiorender_setvolume">SetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets volume level (from 0 to 1).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dsoundaudiorender_setparams">SetParams</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets new parameters of the
renderer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_dsoundaudiorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes DSound audio renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams* pInit);</code></pre>
</div></div>
<h5 id="_parameters_108" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Object of UMC::MediaReceiverParams class that contains specific information about the audio stream to be rendered.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>This method initializes specific environment required to communicate with audio device via DirectSound API. Depending on the input parameters it creates DSound buffer, a special buffer to keep time stamps of the frames, creates and initializes handles, etc.)</p></div>
<h5 id="_return_values_167" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter pInit is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">pModuleContext in pInit is 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Error during memory allocation for internal buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_OPEN_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Error during work with DirectSound buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_dsoundaudiorender_close" class="float">Close</h4>
<div class="paragraph"><p><em>De-initializes DSound audio renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes DSound buffer and PTS buffer.</p></div>
<h5 id="_return_values_168" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_dsoundaudiorender_sendframe" class="float">SendFrame</h4>
<div class="paragraph"><p><em>Sends a portion of audio data to DSound buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SendFrame(UMC::MediaData *in);</code></pre>
</div></div>
<h5 id="_parameters_109" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The object is filled with information on buffer, where you can place a new portion of data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method implements communication with DSound buffer. It is called from internal thread of <code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> and provides safe copying of audio data from media buffer of <code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> to DSound buffer from where they will be rendered by the audio device.</p></div>
<h5 id="_return_values_169" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The input parameter is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The operation failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Error during memory allocation for internal linear buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">DSound buffer is not initialized.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_dsoundaudiorender_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets internal media buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets DSound buffer and the buffer with PTS.</p></div>
<h5 id="_return_values_170" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_dsoundaudiorender_pause" class="float">Pause</h4>
<div class="paragraph"><p><em>Implements pause and resume functions of playback.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Pause(bool pause);</code></pre>
</div></div>
<h5 id="_parameters_110" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pause</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. When TRUE, rendering is stopped; when FALSE, rendering is resumed.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>Implements pause and resume functions of playback directly via DSound buffer API.</p></div>
<h5 id="_return_values_171" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">DSound buffer is not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_dsoundaudiorender_getvolume" class="float">GetVolume</h4>
<div class="paragraph"><p><em>Returns the current volume level.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32f GetVolume();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>Returns the current volume level (from 0 to 1).</p></div>
<h5 id="_return_values_172" class="float">Return Values</h5>
<div class="paragraph"><p>Volume level.</p></div>
<hr />
<h4 id="_umc_dsoundaudiorender_setvolume" class="float">SetVolume</h4>
<div class="paragraph"><p><em>Changes the level of volume.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32f SetVolume(Ipp32f volume);</code></pre>
</div></div>
<h5 id="_parameters_111" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>volume</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Sets the new volume level (from 0 to 1).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method changes the level of volume.</p></div>
<h5 id="_return_values_173" class="float">Return Values</h5>
<div class="paragraph"><p>The set volume level.</p></div>
<hr />
<h4 id="_umc_dsoundaudiorender_setvolume" class="float">SetParams</h4>
<div class="paragraph"><p><em>Reinitializes DSound buffer and PTS array depending on new parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::MediaReceiverParams* pParams, Ipp32u trickModes);</code></pre>
</div></div>
<h5 id="_parameters_112" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pParams</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the UMC::AudioRenderParams object that keeps new parameters of the renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>trickModes</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Used in inherited UMC::NULLAudioRender class only. The default value is UMC::MC_TRICK_MODES_NO.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method reinitializes DSound buffer and PTS array depending on new parameters.</p></div>
<h5 id="_return_values_174" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Parameters object is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Failed to set new parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Error during memory allocation for internal buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_OPEN_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Error during work with DSound buffer.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_21">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>directsound_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\io\audio_renders\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>Libraries</p></div>
<div class="paragraph"><p>dsound.lib</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_DSOUND_AUDIO_RENDER is in umc_defs.h.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_fwaudiorender">UMC::FWAudioRender</h3>
<div class="paragraph"><p><code><a href="#_umc_fwaudiorender">UMC::FWAudioRender</a></code> writes output audio data into the output file in WAV format. It provides saving output audio stream without playing. It does not use any audio device, so it can be used on any platform and operating system.</p></div>
<div class="sect4">
<h5 id="_derivation_9">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_fwaudiorender">UMC::FWAudioRender</a></code> is inherited from <code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_9">See Also</h5>
<div class="paragraph"><p>UMC::MediaReceiver, UMC Audio Renders, UMC::MediaData.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_23">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p><code><a href="#_umc_fwaudiorender">UMC::FWAudioRender</a></code> class contains the following parameters:</p></div>
<div class="tableblock" id="tab_umc_5_88">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 137. FWAudioRender Class Parameters</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Type                    </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>pOutFile</code></p></td>
<td align="left" valign="top"><p class="table"><code>vm_char*</code></p></td>
<td align="left" valign="top"><p class="table">Output filename</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_89">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 138. FWAudioRenderClass Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwaudiorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes FW audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwaudiorender_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">De-initializes FW audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwaudiorender_sendframe">SendFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Copies audio data from input frame
into output *.wav file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwaudiorender_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwaudiorender_pause">Pause</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops playback (with the following
resuming).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwaudiorender_getvolume">GetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets volume level (from 0 to 1).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwaudiorender_setvolume">SetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets volume level (from 0 to 1).</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwaudiorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes FW audio renderer and creates the output file.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams* pInit)</code></pre>
</div></div>
<h5 id="_parameters_113" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Internal parameter. An object of UMC::MediaReceiverParams class that contains specific information about audio stream which will be rendered. This parameter is required to create output *.wav file. If you want to pass your own filename for the output *.wav file, use UMC::FWAudioRenderParams. The default output filename is output.wav.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method creates the output file.</p></div>
<h5 id="_return_values_175" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter pInit is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">pModuleContext in pInit is 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Error during memory allocation for internal buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwaudiorender_close" class="float">Close</h4>
<div class="paragraph"><p><em>De-initializes FW audio renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void)</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the output *.wav file after creating wav header.</p></div>
<h5 id="_return_values_176" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwaudiorender_sendframe" class="float">SendFrame</h4>
<div class="paragraph"><p><em>Copies audio data from input frame into output *.wav file.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SendFrame(UMC::MediaData* in)</code></pre>
</div></div>
<h5 id="_parameters_114" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Keeps the pointer and the size of audio data portion which is sent to the renderer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method copies audio data from input frame into output *.wav file.</p></div>
<h5 id="_return_values_177" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The operation failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter is invalid.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwaudiorender_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets waveform audio buffers, internal handlers and other internal infrastructure.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets internal variables used for synchronization.</p></div>
<h5 id="_return_values_178" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwaudiorender_pause" class="float">Pause</h4>
<div class="paragraph"><p><em>Implements pause and resume functions of playback.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Pause(bool pause)</code></pre>
</div></div>
<h5 id="_parameters_115" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pause</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. TRUE stops rendering, FALSE resumes rendering.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>Implements pause and resume functions of playback. Currently it only updates internal variables used for synchronization.</p></div>
<h5 id="_return_values_179" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwaudiorender_getvolume" class="float">GetVolume</h4>
<div class="paragraph"><p><em>Returns the current volume level.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32f GetVolume()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>This method is not implemented in <code><a href="#_umc_fwaudiorender">UMC::FWAudioRender</a></code>.</p></div>
<h5 id="_return_values_180" class="float">Return Values</h5>
<div class="paragraph"><p>-1</p></div>
<hr />
<h4 id="_umc_fwaudiorender_setvolume" class="float">SetVolume</h4>
<div class="paragraph"><p><em>Changes the level of volume.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32f SetVolume(Ipp32f volume)</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>This method is not used in <code><a href="#_umc_fwaudiorender">UMC::FWAudioRender</a></code>.</p></div>
<h5 id="_return_values_181" class="float">Return Values</h5>
<div class="paragraph"><p>-1</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_22">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>fw_audio_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\io\audio_renders\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_FW_AUDIO_RENDER is in umc_defs.h.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_sdlaudiorender">UMC::SDLAudioRender</h3>
<div class="paragraph"><p><code><a href="#_umc_sdlaudiorender">UMC::SDLAudioRender</a></code> class provides playback of audio files using SDL library API (for Linux).</p></div>
<div class="paragraph"><p><code><a href="#_umc_sdlaudiorender">UMC::SDLAudioRender</a></code> class keeps the realization of SendFrame method only. It manages audio data flow between internal media buffer (<code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code>) and audio device by means of SDL API.</p></div>
<div class="sect4">
<h5 id="_derivation_10">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_sdlaudiorender">UMC::SDLAudioRender</a></code> is inherited from <code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> class. See Figure 5-75 for UMC audio renders derivation diagram.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_10">See Also</h5>
<div class="paragraph"><p>UMC::MediaReceiver, UMC Audio Renders, UMC::MediaData.</p></div>
<div class="tableblock" id="tab_umc_5_90">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 139. SDLAudioRender Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sdlaudiorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes SDL audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sdlaudiorender_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">De-initializes SDL audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sdlaudiorender_sendframe">SendFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Implements communication with SDL
buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sdlaudiorender_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sdlaudiorender_pause">Pause</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops playback (with the following
resuming).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sdlaudiorender_getvolume">GetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets volume level (from 0 to 1).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sdlaudiorender_setvolume">SetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets volume level (from 0 to 1).</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_sdlaudiorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes SDL audio renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init UMC::(MediaReceiverParams* pInit)</code></pre>
</div></div>
<h5 id="_parameters_116" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Internal parameter. An object of UMC::MediaReceiverParams class that contains specific information about audio stream to be rendered.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>In addition to initialization performed in parent <code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> class this method initializes specific environment required to communicate with audio device via SDL API.</p></div>
<h5 id="_return_values_182" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter pInit is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Error during initialization of internal linear buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Error during memory allocation for internal linear buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_sdlaudiorender_close" class="float">Close</h4>
<div class="paragraph"><p><em>De-initializes SDL audio renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void)</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>In addition to behavior implemented in parent class this method closes audio device and other internal infrastructure (buffers, semaphores, etc.).</p></div>
<h5 id="_return_values_183" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_sdlaudiorender_sendframe" class="float">SendFrame</h4>
<div class="paragraph"><p><em>Implements communication with SDL buffers.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SendFrame(UMC::MediaData* in)</code></pre>
</div></div>
<h5 id="_parameters_117" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Keeps the pointer and the size of audio data portion being sent to the audio device.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method implements communication with SDL buffers. It is called from internal thread of <code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> and provides safe copying of audio data from media buffer of <code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> to SDL buffers from where they will be rendered by the audio device.</p></div>
<h5 id="_return_values_184" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter is invalid.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_sdlaudiorender_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets SDL audio device.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets SDL audio device.</p></div>
<h5 id="_return_values_185" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_sdlaudiorender_pause" class="float">Pause</h4>
<div class="paragraph"><p><em>Implements pause and resume functions of playback.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Pause(bool pause)</code></pre>
</div></div>
<h5 id="_parameters_118" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pause</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. TRUE stops rendering, FALSE resumes rendering.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>Implements pause and resume functions of playback directly via SDL API.</p></div>
<h5 id="_return_values_186" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The operation failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_sdlaudiorender_getvolume" class="float">GetVolume</h4>
<div class="paragraph"><p><em>Returns the current volume level.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32f GetVolume()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the current volume level (from 0 to 1) received from the SDL driver.</p></div>
<h5 id="_return_values_187" class="float">Return Values</h5>
<div class="paragraph"><p>Volume level.</p></div>
<hr />
<h4 id="_umc_sdlaudiorender_setvolume" class="float">SetVolume</h4>
<div class="paragraph"><p><em>Changes the volume level.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32f SetVolume(Ipp32f volume)</code></pre>
</div></div>
<h5 id="_parameters_119" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>volume</em></p></td>
<td align="left" valign="top"><p class="table">Internal parameter. Sets the new volume level (from 0 to 1).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method changes the volume level.</p></div>
<h5 id="_return_values_188" class="float">Return Values</h5>
<div class="paragraph"><p>The set volume level.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_23">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>sdlaudio_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\io\audio_renders\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>Libraries</p></div>
<div class="ulist"><ul>
<li>
<p>
sdl.dll
</p>
</li>
<li>
<p>
sdlmain.dll
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_SDL_AUDIO_RENDER is in umc_defs.h.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_nullaudiorender">UMC::NULLAudioRender</h3>
<div class="paragraph"><p><code><a href="#_umc_nullaudiorender">UMC::NULLAudioRender</a></code> is a separate  renderer which can be used
for synchronization with video. If you synchronize audio and video,  and audio stream
finishes before video, or audio stream is not present at all, it is  possible to use
<code><a href="#_umc_nullaudiorender">UMC::NULLAudioRender</a></code> to get PTS.</p></div>
<div class="sect4">
<h5 id="_derivation_11">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_nullaudiorender">UMC::NULLAudioRender</a></code> is inherited from <code><a href="#_umc_basicaudiorender">UMC::BasicAudioRender</a></code> class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_11">See Also</h5>
<div class="paragraph"><p>UMC::MediaReceiver,  UMC Audio Renders, UMC::MediaData.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_24">User Interface</h4>
<div class="paragraph"><div class="title">Related types</div><p><code><a href="#_umc_nullaudiorender">UMC::NULLAudioRender</a></code> class contains the following parameters:</p></div>
<div class="tableblock" id="tab_umc_5_91">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 140. NULLAudioRender Class Parameters</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Type                Description</th>
<th align="left" valign="top">m_InitPTS              </th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_92">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 141. NULLAudioRender Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullaudiorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes NULL audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullaudiorender_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">De-initializes NULL audio renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullaudiorender_sendframe">SendFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Implements communication with
waveform audio device and synchronizes the process.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullaudiorender_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullaudiorender_pause">Pause</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops playback (with the following
resuming).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullaudiorender_getvolume">GetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets volume level (from 0 to 1).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullaudiorender_setvolume">SetVolume</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets volume level (from 0 to 1).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullaudiorender_setparams">SetParams</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets new parameters of the
renderer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_nullaudiorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes NULL audio renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams* pInit)</code></pre>
</div></div>
<h5 id="_parameters_120" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Internal parameter. An object of UMC::MediaReceiverParams class that contains specific information about audio stream which will be rendered.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method resets internal variables.</p></div>
<h5 id="_return_values_189" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Input parameter pInit is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">pModuleContext in pInit is 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Error during memory allocation for internal buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_nullaudiorender_close" class="float">Close</h4>
<div class="paragraph"><p><em>De-initializes NULL audio renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void)</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets internal variables.</p></div>
<h5 id="_return_values_190" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_nullaudiorender_sendframe" class="float">SendFrame</h4>
<div class="paragraph"><p><em>Emulates rendering audio.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SendFrame(UMC::MediaData* in)</code></pre>
</div></div>
<h5 id="_parameters_121" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The pointer to the UMC::MediaData object that starts and stops frame PTS.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method emulates rendering audio by waiting the time equal to the portion of audio data passed via UMC::MediaData parameter.</p></div>
<h5 id="_return_values_191" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_nullaudiorender_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets waveform audio buffers, internal handlers and other internal infrastructure.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets waveform audio buffers, internal handlers and other internal infrastructure.</p></div>
<h5 id="_return_values_192" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_nullaudiorender_pause" class="float">Pause</h4>
<div class="paragraph"><p><em>Implements pause and resume functions of playback.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Pause(bool pause)</code></pre>
</div></div>
<h5 id="_parameters_122" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pause</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. TRUE stops rendering, FALSE resumes rendering.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>Implements pause and resume functions of playback.</p></div>
<h5 id="_return_values_193" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_nullaudiorender_getvolume" class="float">GetVolume</h4>
<div class="paragraph"><p><em>Returns the current volume level.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32f GetVolume()</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method is not implemented in <code><a href="#_umc_nullaudiorender">UMC::NULLAudioRender</a></code>.</p></div>
<h5 id="_return_values_194" class="float">Return Values</h5>
<div class="paragraph"><p>-1</p></div>
<hr />
<h4 id="_umc_nullaudiorender_setvolume" class="float">SetVolume</h4>
<div class="paragraph"><p><em>Changes the level of volume.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Ipp32f SetVolume(Ipp32f volume)</code></pre>
</div></div>
<h5 id="_parameters_123" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>volume</em></p></td>
<td align="left" valign="top"><p class="table">Internal parameter. Sets the new volume level (from 0 to 1).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method is not implemented in <code><a href="#_umc_nullaudiorender">UMC::NULLAudioRender</a></code>.</p></div>
<h5 id="_return_values_195" class="float">Return Values</h5>
<div class="paragraph"><p>-1</p></div>
<hr />
<h4 id="_umc_nullaudiorender_setparams" class="float">SetParams</h4>
<div class="paragraph"><p><em>Sets new initial time stamp.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetParams(UMC::MediaReceiverParams *pParams, Ipp32u trickModes)</code></pre>
</div></div>
<h5 id="_parameters_124" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pParams</em></p></td>
<td align="left" valign="top"><p class="table">Internal parameter. Pointer to the UMC::AudioRenderParams that keeps new initial PTS value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>trickModes</em></p></td>
<td align="left" valign="top"><p class="table">Internal parameter. Sets playback rate.The type of this parameter is UMC::TrickModesType enum which can be one of the following:<br />
UMC_TRICK_MODES_NO - no trick modes<br />
UMC_TRICK_MODES_FORWARD - playback rate is more than 0 (forward)<br />
UMC_TRICK_MODES_FAST - playback rate is 2x<br />
UMC_TRICK_MODES_FASTER - playback rate is 4x<br />
UMC_TRICK_MODES_SLOW - playback rate is 0.5x<br />
UMC_TRICK_MODES_SLOWER - playback rate is 0.25x<br />
UMC_TRICK_MODES_REVERSE- playback rate is &lt; 0 (backward)<br />
UMC_TRICK_MODES_FFW_FAST = UMC_TRICK_MODES_FAST `</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>UMC_TRICK_MODES_FORWARD<br />
UMC_TRICK_MODES_FFW_FASTER = UMC_TRICK_MODES_FASTER `</em></p></td>
<td align="left" valign="top"><p class="table">UMC_TRICK_MODES_FORWARD<br />
UMC_TRICK_MODES_SFW_SLOW = UMC_TRICK_MODES_SLOW `</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>UMC_TRICK_MODES_FORWARD<br />
UMC_TRICK_MODES_SFW_SLOWER = UMC_TRICK_MODES_SLOWER `</em></p></td>
<td align="left" valign="top"><p class="table">UMC_TRICK_MODES_FORWARD<br />
UMC_TRICK_MODES_FR_FAST = UMC_TRICK_MODES_FAST `</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>UMC_TRICK_MODES_REVERSE<br />
UMC_TRICK_MODES_FR_FASTER = UMC_TRICK_MODES_FASTER `</em></p></td>
<td align="left" valign="top"><p class="table">UMC_TRICK_MODES_REVERSE<br />
UMC_TRICK_MODES_SR_SLOW = UMC_TRICK_MODES_SLOW `</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>UMC_TRICK_MODES_REVERSE<br />
UMC_TRICK_MODES_SR_SLOWER = UMC_TRICK_MODES_SLOWER `</em></p></td>
<td align="left" valign="top"><p class="table">UMC_TRICK_MODES_REVERSE</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The default value is MC_TRICK_MODES_NO.</p></div>
<div class="paragraph"><div class="title">Description</div><p>This method sets new initial time stamp.</p></div>
<h5 id="_return_values_196" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Parameters object is invalid.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_24">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header Name</div><p>null_audio_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\io\audio_renders\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_umc_video_renders">UMC Video Renders</h2>
<div class="sectionbody">
<div class="paragraph"><p>UMC  features a number of video renderers. Each renderer is designed for a certain
operating  system. Some renderers work on all platforms (e.g. <code><a href="#_umc_fwvideorender">UMC::FWVideoRender</a></code>,
<code><a href="#_umc_nullvideorender">UMC::NULLVideoRender</a></code>).  Most of the renderers are derived from <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> and
<code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code>  classes where the main concept is implemented. The hierarchy,
functionality and purpose of UMC video renderers are described below.</p></div>
<div class="imageblock" id="fig_umc_5_77">
<div class="content">
<img src="images/umc/umc_5_77.png" alt="images/umc/umc_5_77.png" />
</div>
<div class="title">Figure 50. Derivation of UMC Video Renders</div>
</div>
<div class="paragraph"><p>To initialize a UMC video render, invoke Init() method with a parameter of proper type.</p></div>
<div class="paragraph"><p>Each video render supports only a certain number of UMC color formats. See next table for the respective information.</p></div>
<div class="tableblock" id="tab_umc_5_93">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 142. Video Renders: Supported Color Formats</caption>
<col width="11%" />
<col width="22%" />
<col width="22%" />
<col width="11%" />
<col width="33%" />
<thead>
<tr>
<th align="left" valign="top">Render          </th>
<th align="left" valign="top">Render Class Name                   </th>
<th align="left" valign="top">Parameters Class Name                               </th>
<th align="left" valign="top">Supported Color Format                  </th>
<th align="left" valign="top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">File Writer</p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender">UMC::FWVideoRender</a></code></p></td>
<td align="left" valign="top"><p class="table">UMC::VideoRenderParams or FWVideoRenderParams</p></td>
<td align="left" valign="top"><p class="table">All UMC color formats</p></td>
<td align="left" valign="top"><p class="table">Dumps output frames to file (default file is output.yuv). Can be used for later estimation of quality of video decoders.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Fake</p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullvideorender">UMC::NULLVideoRender</a></code></p></td>
<td align="left" valign="top"><p class="table">UMC::VideoRenderParams</p></td>
<td align="left" valign="top"><p class="table">All UMC color formats</p></td>
<td align="left" valign="top"><p class="table">Renders frames to fake surfaces.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">DirectShow* Overlay</p></td>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dxvideorender">UMC::DXVideoRender</a></code></p></td>
<td align="left" valign="top"><p class="table">UMC::DXVideoRenderParams</p></td>
<td align="left" valign="top"><p class="table">UMC::YV12 UMC::YUV12 UMC::UYVY UMC::NV12 UMC::RGB565</p></td>
<td align="left" valign="top"><p class="table">Win32* video renderer</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Parameters classes described  below are derived from UMC::VideoRenderParams. Only new data
members are described.</p></div>
<div class="tableblock" id="tab_umc_5_94">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 143. Derivative Video Renders Parameters Classes</caption>
<col width="20%" />
<col width="20%" />
<col width="20%" />
<col width="40%" />
<thead>
<tr>
<th align="left" valign="top">Type                          </th>
<th align="left" valign="top">Parameter Name                  </th>
<th align="left" valign="top">Default Value                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::DXVideoRenderParams</code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>HWND</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_hWnd</code></p></td>
<td align="left" valign="top"><p class="table"><code>NULL</code></p></td>
<td align="left" valign="top"><p class="table">Handle to a window</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>COLORREF</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_ColorKey</code></p></td>
<td align="left" valign="top"><p class="table"><code>0</code></p></td>
<td align="left" valign="top"><p class="table">Color key for a window</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::FWVideoRenderParams</code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"><code></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_char*</code></p></td>
<td align="left" valign="top"><p class="table"><code>pOutFile</code></p></td>
<td align="left" valign="top"><p class="table"><code>NULL</code></p></td>
<td align="left" valign="top"><p class="table">Output file name</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_umc_basevideorender">UMC::BaseVideoRender</h3>
<div class="paragraph"><p><code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> is a video render class for buffering support, which serves as a base class for UMC video renders.</p></div>
<div class="sect4">
<h5 id="_see_also_12">See Also</h5>
<div class="paragraph"><p>UMC::VideoRender, UMC::VideoRenderParams, UMC::VideoData.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_25">User Interface</h4>
<div class="tableblock" id="tab_umc_5_96">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 144. sFrameBuffer Structure Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Type                Description</th>
<th align="left" valign="top">frame_time             </th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f              Frame time stamp</code></p></td>
<td align="left" valign="top"><p class="table"><code>frame_type</code></p></td>
<td align="left" valign="top"><p class="table">UMC::FrameType      Frame type (I, B, P or D frame)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_97">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 145. BaseVideoRender Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the render.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Releases all render resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_lockinputbuffer">LockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Locks input buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_unlockinputbuffer">UnlockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Unlocks input
buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_getrenderframe">GetRenderFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Peeks presentation of the
next frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_resizedisplay">ResizeDisplay</a></code></p></td>
<td align="left" valign="top"><p class="table">Resizes the display
rectangular.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_showsyrface">ShowSurface</a></code></p></td>
<td align="left" valign="top"><p class="table">Shows rendering surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_hidesurface">HideSurface</a></code></p></td>
<td align="left" valign="top"><p class="table">Hides rendering surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_stop">Stop</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops rendering and breaks all operations in
waiting mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_prepareforreposition">PrepareForRePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Prepares the
render for repositioning of a stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_basevideorender_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the render into the initial state.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basevideorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the render.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams* pInit);</code></pre>
</div></div>
<h5 id="_parameters_125" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure. The pointer must refer to an instance of UMC::VideoRenderParams, which contains common initialization info for all video renders.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method performs initialization of the render. If the function fails the Close method is called automatically.</p></div>
<h5 id="_return_values_197" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The pInit pointer is NULL or does not refer to the instance of UMC::VideoRenderParams or some parameter in pInit points to NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basevideorender_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes the render.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the render and releases all resources allocated by Init. The return value is always UMC::UMC_OK.</p></div>
<h5 id="_return_values_198" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_basevideorender_lockinputbuffer" class="float">LockInputBuffer</h4>
<div class="paragraph"><p><em>Locks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockInputBuffer(UMC::MediaData* buffer);</code></pre>
</div></div>
<h5 id="_parameters_126" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>buffer</em></p></td>
<td align="left" valign="top"><p class="table">Pointer to the input data object. The pointer must refer to an instance of UMC::VideoData. On exit, buffer refers to the video render buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method obtains a pointer to a free video render buffer. Decoding of the frame can be done directly to the buffer of the render.</p></div>
<div class="paragraph"><p>The function modifies some fields of buffer by calling UMC::VideoData::SetSurface. Call this function before calling UMC::VideoRender::UnlockInputBuffer.</p></div>
<h5 id="_return_values_199" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The buffer pointer is NULL or does not refer to the instance of UMC::VideoData.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The render cannot lock surface (for some reason the video render cannot provide reference to the buffer; for example, the graphic driver is busy).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed, that is, some error occured at the rendering stage and the render cannot work properly any longer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">May be returned as an internal synchronization problems result.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basevideorender_unlockinputbuffer" class="float">UnlockInputBuffer</h4>
<div class="paragraph"><p><em>Unlocks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnlockInputBuffer(UMC::MediaData* buffer, UMC::Status StreamStatus);</code></pre>
</div></div>
<h5 id="_parameters_127" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>buffer</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the input data object. The pointer must refer to an instance of UMC::VideoData. On exit, buffer refers to the video render buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>StreamStatus</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Value equal to UMC::UMC_ERR_END_OF_STREAM notifies the video render that the media stream is finished; any other values are ignored.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method informs the video render that data is already placed in the buffer and can be rendered.</p></div>
<div class="paragraph"><p>Call this function after calling UMC::VideoRender::LockInputBuffer.</p></div>
<h5 id="_return_values_200" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The buffer pointer is NULL or does not refer to the instance of UMC::VideoData.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed, that is, some error occured at the rendering stage and the render cannot work properly any longer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Incomplete render initialization.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basevideorender_getrenderframe" class="float">GetRenderFrame</h4>
<div class="paragraph"><p><em>Peeks presentation of the next frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetRenderFrame(Ipp64f *pTime);</code></pre>
</div></div>
<h5 id="_parameters_128" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pTime</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Frame time stamp.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method peeks presentation of the next frame.</p></div>
<div class="paragraph"><p>This function should be called after UMC::VideoRender::UnlockInputBuffer (or in another thread).</p></div>
<div class="paragraph"><p>This function should be called before UMC::VideoRender::RenderFrame.</p></div>
<h5 id="_return_values_201" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer pTime is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed; possible causes for this method: * The renderer was stopped. * The renderer is in reposition mode. * Some error occurred in process of rendering.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_TIMEOUT</code></p></td>
<td align="left" valign="top"><p class="table">Internal synchronization timeout.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Internal synchronization objects were not initialized. The work cannot be contiunued with the current <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> object.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basevideorender_resizedisplay" class="float">ResizeDisplay</h4>
<div class="paragraph"><p><em>Resizes the display rectangle.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status ResizeDisplay(UMC::RECT &amp;disp, UMC::RECT &amp;range);</code></pre>
</div></div>
<h5 id="_parameters_129" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>disp</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Display rectangle, defines rendering field on the screen.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>range</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Range rectangle, defines resolution of display rectangle.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method resizes the display rectangular. The return value is always UMC::UMC_OK.</p></div>
<h5 id="_return_values_202" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basevideorender_showsyrface" class="float">ShowSurface</h4>
<div class="paragraph"><p><em>Shows rendering surface.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual void ShowSurface();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method shows the rendering surface.</p></div>
<hr />
<h4 id="_umc_basevideorender_hidesurface" class="float">HideSurface</h4>
<div class="paragraph"><p><em>Hides rendering surface.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual void HideSurface();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method hides the rendering surface.</p></div>
<hr />
<h4 id="_umc_basevideorender_stop" class="float">Stop</h4>
<div class="paragraph"><p><em>Stops rendering.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual Status Stop();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method stops rendering and breaks all operations in waiting mode.</p></div>
<h5 id="_return_values_203" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Internal synchronization problem.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_TIMEOUT</code></p></td>
<td align="left" valign="top"><p class="table">Internal synchronization timeout.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Internal synchronization objects were not initialized. The work cannot be contiunued with the current <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> object.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basevideorender_prepareforreposition" class="float">PrepareForRePosition</h4>
<div class="paragraph"><p><em>Prepares render for repositioning of a stream.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PrepareForRePosition();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method prepares the render for repositioning of a stream. The return value is always
UMC::UMC_OK.</p></div>
<h5 id="_return_values_204" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_basevideorender_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets the render.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the render into the initial state. The return value is always
UMC::UMC_OK.</p></div>
<h5 id="_return_values_205" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_21">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code>, create an instance of the <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> class and invoke Init() method. The method accepts a pointer of type UMC::MediaReceiverParams* as its single parameter.</p></div>
<div class="paragraph"><p>The pointer must refer to the instance of UMC::VideoRenderParams structure, which contains common initialization information for all video renders. The acquired pointer is converted to UMC::VideoRenderParams*. If conversion fails, the method returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="paragraph"><p>When <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> is initialized with FLAG_VREN_REORDER flag, it renders frames in the proper display order. Otherwise, rendering is performed in the decoding order, that is, in the order frames are passed to the render.</p></div>
<div class="exampleblock">
<div class="title">Example 43. BaseVideoRender Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseVideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pBaseVideoRender </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseVideoRender</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoRenderParams</span><span style="color: #000000">*</span><span style="color: #000000"> pBaseParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoRenderParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> rectDisp</span><span style="color: #000000">,</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">ClipInfo</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>

<span style="color: #008000">// Obtaining UMC::ClipInfo from video decoder.</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> dec_params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoDecoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">();</span>
<span style="color: #000000">pVideoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">dec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">clipInfo </span><span style="color: #000000">=</span><span style="color: #000000"> dec_params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">;</span>

<span style="color: #008000">// Setting display and range rectangles.</span>
<span style="color: #000000">rectDisp</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">...</span>

<span style="color: #000000">...</span>

<span style="color: #008000">// Initialization of UMC::VideoRenderParams fields:</span>
<span style="color: #008000">// Setting color format, possible values: any (for Base render).</span>
<span style="color: #000000">pBaseParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">color_format </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">YV12</span><span style="color: #000000">;</span>
<span style="color: #008000">// Setting frame information.</span>
<span style="color: #000000">pBaseParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info </span><span style="color: #000000">=</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">pBaseParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">disp </span><span style="color: #000000">=</span><span style="color: #000000"> rectDisp</span><span style="color: #000000">;</span>
<span style="color: #000000">pBaseParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">range </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #008000">// Setting render flags, possible values: 0, UMC::FLAG_VREN_REORDER (for Base render).</span>
<span style="color: #000000">pBaseParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FLAG_VREN_REORDER</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialization of Base Video Render:</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pBaseVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">pBaseParams</span><span style="color: #000000">);</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseVideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pBaseVideoRender </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseVideoRender</span><span style="color: #000000">;</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #A31515">"Failed to initialize</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> pBaseParams</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Parameters structure isn't needed any more.</span>
<span style="color: #000000">...</span>

<span style="color: #0000ff">delete</span><span style="color: #000000"> pBaseVideoRender</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Close() method will be called automatically.</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the render, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p><code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> is used as an ancestor for video renders for concrete video libraries. See the following example.</p></div>
<div class="exampleblock">
<div class="title">Example 44. BaseVideoRender Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">SomeVideoRender</span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseVideoRender</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*</span><span style="color: #000000"> pInit</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ResizeDisplay</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">disp</span><span style="color: #000000">,</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">range</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">}</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> SomeVideoRender</span><span style="color: #000000">::</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*</span><span style="color: #000000"> pInit</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">    SomeVideoRenderParams</span><span style="color: #000000">*</span><span style="color: #000000"> pParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">DynamicCast</span><span style="color: #000000">(</span><span style="color: #000000">pInit</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// Errors checking.</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">NULL </span><span style="color: #000000">==</span><span style="color: #000000"> pParams</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NULL_PTR</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #008000">// Some render initialization.</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #008000">// Base video render initialization.</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseVideoRender</span><span style="color: #000000">::</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">pInit</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> UnifiedVideoRender</span><span style="color: #000000">::</span><span style="color: #000000">ResizeDisplay</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">disp</span><span style="color: #000000">,</span>
<span style="color: #000000">                UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">range</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseVideoRender</span><span style="color: #000000">::</span><span style="color: #000000">ResizeDisplay</span><span style="color: #000000">(</span><span style="color: #000000">disp</span><span style="color: #000000">,</span><span style="color: #000000"> range</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// Resizing of the display (using some library functions).</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content"><code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> is not used directly for rendering video data. This class provides only basic methods for working with video buffers. Rendering to some surface should be done with some graphical driver. However, this class is a common ancestor for all specific graphical renders and it is used in all cross-platform applications when a concrete render should not be specified. See the following examples of usage of <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> as a complete graphical render.</td>
</tr></table>
</div>
<div class="paragraph"><p>There are two steps of video render usage: loading decoded information to the render buffer ("Decoding") and rendering proper ("Rendering"). These steps can be combined as follows:</p></div>
<div class="ulist"><ul>
<li>
<p>
One threading model: "Decoding" &#8594; "Rendering";
</p>
</li>
<li>
<p>
Two threading model: "Decoding" (first thread) | "Rendering" (second thread). See next example for the Decoding step implementation.
</p>
</li>
</ul></div>
<div class="exampleblock">
<div class="title">Example 45. Decoding Directly to Render Buffer (optimized variant)</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Splitter</span><span style="color: #000000">*</span><span style="color: #000000"> pSplitter</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// UMC splitter is just example.</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoDecoder</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// UMC decoder is just example.</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">BaseVideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">;</span>

<span style="color: #008000">// Memory allocation, initialization:</span>
<span style="color: #000000">...</span><span style="color: #000000"> </span><span style="color: #008000">// see section 3.1 of this manual for details</span>

<span style="color: #008000">// Working cycle:</span>
<span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(!</span><span style="color: #000000">exit_flag </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> </span><span style="color: #000000">!</span><span style="color: #000000">end_of_stream_flag</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">vframe</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Coded video frame.</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">dec_vframe</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Decoded video frame.</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>

<span style="color: #000000">    </span><span style="color: #008000">// Getting coded video frame from splitter or some buffer.</span>
<span style="color: #000000">    pSplitter</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetNextVideoData</span><span style="color: #000000">(</span><span style="color: #000000">vframe</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #008000">// Getting free video render buffer.</span>
<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">dec_vframe</span><span style="color: #000000">))</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(...);</span><span style="color: #000000"> </span><span style="color: #008000">// Waiting for the free video render buffer.</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #008000">// Decoding frame to the buffer.</span>
<span style="color: #000000">    pVideoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">vframe</span><span style="color: #000000">,</span><span style="color: #000000"> dec_vframe</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>

<span style="color: #000000">    </span><span style="color: #008000">// Unlocking buffer: after this render can render frame.</span>
<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">dec_vframe</span><span style="color: #000000">))</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(...);</span><span style="color: #000000"> </span><span style="color: #008000">// Waiting while unlocking will be available.</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>See next example for Rendering step implementation.</p></div>
<div class="exampleblock">
<div class="title">Example 46. Rendering</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> time</span><span style="color: #000000">,</span><span style="color: #000000"> frame_time</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// Getting time (from the moment then playing started).</span>
<span style="color: #000000">    time </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">GetTime</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #008000">// Getting frame time stamp.</span>
<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_TIMEOUT </span><span style="color: #000000">==</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000">m_pVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetRenderFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">frame_time</span><span style="color: #000000">)))</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #008000">// Waiting...</span>
<span style="color: #000000">        </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #008000">// Some error occured, maybe application should be stoped</span>
<span style="color: #000000">        </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #008000">// Some synchronization.</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">frame_time </span><span style="color: #000000">&gt;</span><span style="color: #000000"> time</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #000000">...</span>
<span style="color: #000000">        </span><span style="color: #008000">// It's not time to render frame - waiting.</span>
<span style="color: #000000">        </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> sleep_msec </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">Ipp32u</span><span style="color: #000000">)(</span><span style="color: #000000">1000</span><span style="color: #000000">*(</span><span style="color: #000000">frame_time</span><span style="color: #000000">-</span><span style="color: #000000">time</span><span style="color: #000000">));</span>
<span style="color: #000000">        </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">sleep_msec</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    m_pVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">RenderFrame</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_18">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>There are no threads creations in current implementation of <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code>.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>There is no memory allocation in current implementation of <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code>.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_25">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>base_video_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components:</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\io\video_renders\include
&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">Macros</div><p>MAX_FRAME_BUFFERS - maximum number of video render buffers.</p></div>
<div class="paragraph"><p>MIN_FRAME_BUFFERS - minimum number of video render buffers.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_unifiedvideorender">UMC::UnifiedVideoRender</h3>
<div class="paragraph"><p><code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code> provides basic implementation for UMC video renderers. It supports an abstract video driver (a driver for a specific video library). The driver defines basic functions for working with graphical library: initialization of the library, rendering of an image, switching between video modes, etc.</p></div>
<div class="sect4">
<h5 id="_derivation_12">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code> is inherited from <code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code> class, which provides management of video render buffers.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_13">See Also</h5>
<div class="paragraph"><p><code><a href="#_umc_basevideorender">UMC::BaseVideoRender</a></code>, UMC::VideoRender, UMC::VideoRenderParams, UMC::VideoData,  <code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code>.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_26">User Interface</h4>
<div class="tableblock" id="umc_tab_5_99">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 146. enum VideoDrvVideoMemType Values</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Value              </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>VideoDrvVideoMemInternal</code></p></td>
<td align="left" valign="top"><p class="table">Internal memory allocation for video buffers should be used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VideoDrvVideoMemExternal</code></p></td>
<td align="left" valign="top"><p class="table">Externally provided memory for video buffers should be used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VideoDrvVideoMemLibrary</code></p></td>
<td align="left" valign="top"><p class="table">Graphical library allocates memory for video buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_100">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 147. VideoDrvVideoMemInfo Structure Description</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                       </th>
<th align="left" valign="top">Type                    Description</th>
<th align="left" valign="top">m_pVideoMem                </th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void*                   Pointer to video memory for video buffers</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_nMemSize</code></p></td>
<td align="left" valign="top"><p class="table">size_t                  Video memory size (several video buffers combined together)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_nAlignment</code></p></td>
<td align="left" valign="top"><p class="table"><code>size_t                  Pointers and pitch alignment</code></p></td>
<td align="left" valign="top"><p class="table">m_nBufSize</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t                  Single video buffer size</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_nPitch</code></p></td>
<td align="left" valign="top"><p class="table">size_t                  Frame pitch</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_101">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 148. VideoDrvSpec Structure Description</caption>
<col width="16%" />
<col width="16%" />
<col width="66%" />
<thead>
<tr>
<th align="left" valign="top">Name                  </th>
<th align="left" valign="top">Type                        </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>drv_name</code></p></td>
<td align="left" valign="top"><p class="table"><code>vm_char*</code></p></td>
<td align="left" valign="top"><p class="table">Name of a driver</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drv_rebuf</code></p></td>
<td align="left" valign="top"><p class="table"><code>enum VideoDrvBool</code></p></td>
<td align="left" valign="top"><p class="table">Defines rebuffering requirement after change of video mode for some graphical libraries. Possible values: VideoDrvTrue, VideoDrvFalse</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drv_videomem_type</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Combination of flags: VideoDrvVideoMemInternal - use internal memory allocation for video buffers, VideoDrvVideoMemExternal - use externally provided memory for video buffers, VideoDrvVideoMemLibrary - graphical library allocates the memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvInit</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvInitFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the buffer initialization function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvClose</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvCloseFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the buffer de-initialization function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvCreateBuffers</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvCreateBuffersFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the buffer placing function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvFreeBuffers</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvFreeBuffersFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the buffer freeing function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvCreateSurface</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvCreateSurfaceFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the single buffer placing function. Usually, if drvCreateBuffers function exists, drvCreateSurface is NULL. This is a parallel mechanism for creation of buffers (see also drvFreeSurface). Typically used then VideoDrvVideoMemLibrary is specified as drv_videomem_type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvFreeSurface</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvFreeSurfaceFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the single buffer freeing function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvLockSurface</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvLockSurfaceFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the single buffer locking function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvUnlockSurface</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvUnlockSurfaceFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the single buffer unlocking function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvRenderFrame</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvRenderFrameFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the frame rendering function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvSetVideoMode</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvSetVideoModeFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the video mode setting function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvGetWindow</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvGetWindowFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the window getting function</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>drvRunEventLoop</code></p></td>
<td align="left" valign="top"><p class="table"><code>VideoDrvRunEventLoopFunc*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the function that runs the event loop</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">All pointers to a function (for example, drvLockSurface) can be set to NULL. No errors will occur in this case and the function will be ignored.</td>
</tr></table>
</div>
<div class="tableblock" id="tab_umc_5_102">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 149. UnifiedVideoRender Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_unifiedvideorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the renderer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_unifiedvideorender_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the renderer and releases all resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_unifiedvideorender_getrenderframe">GetRenderFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Peeks presentation of
the next frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_unifiedvideorender_renderframe">RenderFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Renders a frame to
destination surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_unifiedvideorender_showlastframe">ShowLastFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Renders the last frame
to destination surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_unifiedvideorender_setfullscreen">SetFullScreen</a></code></p></td>
<td align="left" valign="top"><p class="table">Switches between full
screen and window screen modes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_unifiedvideorender_resizedisplay">ResizeDisplay</a></code></p></td>
<td align="left" valign="top"><p class="table">Resizes displayed
screen region.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_unifiedvideorender_getwindow">GetWindow</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns window reference.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>&lt;&lt;_umc_unifiedvideorender_runeventloop,RunEventLoop</code></p></td>
<td align="left" valign="top"><p class="table">Runs event loop in the current
thread.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_unifiedvideorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams* pInit);</code></pre>
</div></div>
<h5 id="_parameters_130" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure. The pointer must refer to the instance of <code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code>, which contains initialization info for Unified Video Render.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the renderer.</p></div>
<div class="paragraph"><p>The method can return unspecified values if other methods are called
(UMC::BaseVideoRender::Init).</p></div>
<div class="paragraph"><p>After <code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code> specific initialization is completed,
UMC::BaseVideoRender::Init is called to initialize a parent class object.</p></div>
<h5 id="_return_values_206" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer pInit is NULL or does not refer to the instance of <code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code>; some parameter in pInit points to NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The current stream contains an error or errors. The color format specified in the parameters is unsupported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed: initialization of video driver or video render buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_unifiedvideorender_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes renderer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the renderer and releases all allocated resources. The return value is always UMC::UMC_OK.</p></div>
<h5 id="_return_values_207" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_unifiedvideorender_getrenderframe" class="float">GetRenderFrame</h4>
<div class="paragraph"><p><em>Peeks presentation of next frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetRenderFrame(Ipp64f* pTime);</code></pre>
</div></div>
<h5 id="_parameters_131" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pTime</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Frame time stamp.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method peeks presentation of the next frame.</p></div>
<div class="paragraph"><p>Call this method after UMC::VideoRender::UnlockInputBuffer (or in another thread) and before UMC::VideoRender::RenderFrame (see UMC::VideoRender Class description).</p></div>
<h5 id="_return_values_208" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer pTime is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed; possible causes for this method: * The renderer was stopped. * The renderer is in reposition mode. * Some error occurred in process of rendering.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_unifiedvideorender_renderframe" class="float">RenderFrame</h4>
<div class="paragraph"><p><em>Renders frame to destination surface.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status RenderFrame();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method renders a frame to the destination surface.</p></div>
<div class="paragraph"><p>Call this method after UMC::VideoRender::UnlockInputBuffer (or in another thread) and before UMC::VideoRender::GetRenderFrame (see UMC::VideoRender Class description).</p></div>
<h5 id="_return_values_209" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Some pointer is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The renderer is not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Rendering operation failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_unifiedvideorender_showlastframe" class="float">ShowLastFrame</h4>
<div class="paragraph"><p><em>Renders last frame to destination surface.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status ShowLastFrame();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method renders the last frame to the destination surface.</p></div>
<div class="paragraph"><p>Call this method after UMC::VideoRender::UnlockInputBuffer (or in another thread) and before UMC::VideoRender::GetRenderFrame (see UMC::VideoRender Class description).</p></div>
<div class="paragraph"><p>This method performs the same operation as UMC::VideoRender::RenderFrame but stops the renderer after rendering is completed.</p></div>
<h5 id="_return_values_210" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Some pointer is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The renderer is not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Rendering operation failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_unifiedvideorender_setfullscreen" class="float">SetFullScreen</h4>
<div class="paragraph"><p><em>Sets and resets full screen playback mode.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetFullScreen(UMC::ModuleContext &amp;rContext, bool onFullScreen);</code></pre>
</div></div>
<h5 id="_parameters_132" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>rContext</em></p></td>
<td align="left" valign="top"><p class="table">Unused in the current version.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>onFullScreen</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that selects the mode to be set: true to turn on full screen mode, false - update current video mode, for example, resize window.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method switches video renderer between to full screen mode and ordinary mode after resizing.</p></div>
<h5 id="_return_values_211" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Some pointer is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed: video mode modification or reinitialization of video render buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_unifiedvideorender_resizedisplay" class="float">ResizeDisplay</h4>
<div class="paragraph"><p><em>Resizes displayed screen region.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status ResizeDisplay(UMC::RECT &amp;disp, UMC::RECT &amp;range);</code></pre>
</div></div>
<h5 id="_parameters_133" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>disp</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that sets a new displayed region size.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>range</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter that defines resolution of the display rectangle.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method resizes the display rectangular and is based on
UMC::VideoRender::SetFullScreen.</p></div>
<h5 id="_return_values_212" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Some pointer is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed: video mode modification or reinitialization of video render buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_unifiedvideorender_getwindow" class="float">GetWindow</h4>
<div class="paragraph"><p><em>Returns window reference.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual void* GetWindow();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns a pointer to the window description. Type of the pointer depends on the video driver that was used.</p></div>
<h5 id="_return_values_213" class="float">Return Values</h5>
<div class="paragraph"><p>Pointer to the window description.</p></div>
<hr />
<h4 id="_umc_unifiedvideorender_runeventloop" class="float">RunEventLoop</h4>
<div class="paragraph"><p><em>Runs event loop in current thread.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status RunEventLoop();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method runs event loop in the current thread. Events are checked in the loop and handled. When the event queue is empty, the method returns UMC::UMC_OK.</p></div>
<h5 id="_return_values_214" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Some pointer is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed: errors occurred in process of event checking.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_22">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code>, create an instance of the <code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code> class and invoke Init() method. The method accepts a pointer of type UMC::MediaReceiverParams* as its single parameter.</p></div>
<div class="paragraph"><p>The pointer must refer to the instance of <code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code> structure, which contains common initialization information for all video renders. The acquired pointer is converted to <code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code>*. If conversion fails, the method returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="exampleblock">
<div class="title">Example 47. UnifiedVideoRender Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRender</span><span style="color: #000000">*</span><span style="color: #000000">  pVideoRender </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRender</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRenderParams</span><span style="color: #000000">*</span><span style="color: #000000"> pParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRenderParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000">  rectDisp</span><span style="color: #000000">,</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">ClipInfo</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">VideoDrvSpec</span><span style="color: #000000"> SOME_DRIVER_VideoDrvSpec </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #A31515">"SomeDriver"</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #008000">// Driver name.</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Driver specification</span>
<span style="color: #000000">SomeDriverParams</span><span style="color: #000000"> SOME_DRIVER_DrvParams</span><span style="color: #000000">;</span>

<span style="color: #008000">// Obtaining UMC::ClipInfo from video decoder.</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> dec_params</span><span style="color: #000000">;</span>
<span style="color: #000000">pVideoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">dec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">clipInfo </span><span style="color: #000000">=</span><span style="color: #000000"> dec_params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">;</span>

<span style="color: #008000">// Setting display and range rectangles.</span>
<span style="color: #000000">rectDisp</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">...</span>

<span style="color: #000000">...</span>

<span style="color: #008000">// Initialization of the driver parameters structure (depends on driver type).</span>
<span style="color: #000000">DrvParams</span><span style="color: #000000">.</span><span style="color: #000000">some_field </span><span style="color: #000000">=</span><span style="color: #000000"> some_value</span><span style="color: #000000">;</span>

<span style="color: #000000">...</span>

<span style="color: #008000">// Initialization of the UMC::UnifiedVideoRenderParams fields:</span>
<span style="color: #000000">pParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pDrvSpec </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">SOME_DRIVER_VideoDrvSpec</span><span style="color: #000000">;</span>
<span style="color: #000000">pParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pDrvParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">SOME_DRIVER_DrvParams</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialization of UMC::VideoRenderParams fields:</span>
<span style="color: #008000">// Setting color format, possible values: any supported by the driver.</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">color_format </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">YV12</span><span style="color: #000000">;</span>
<span style="color: #008000">// Setting frame information.</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info </span><span style="color: #000000">=</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">disp </span><span style="color: #000000">=</span><span style="color: #000000"> rectDisp</span><span style="color: #000000">;</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">range </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #008000">// Setting render flags.</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FLAG_VREN_REORDER</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialization of Unified Video Render:</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">pParams</span><span style="color: #000000">);</span>

<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #A31515">"Failed to initialize</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> pParams</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Parameters structure isn't needed any more.</span>
<span style="color: #000000">...</span>

<span style="color: #0000ff">delete</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Close() method will be called automatically.</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the render, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p><code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code> is used as an ancestor for video renders for concrete video libraries. To use this renderer, a video driver is required. See the following example.</p></div>
<div class="exampleblock">
<div class="title">Example 48. UnifiedVideoRender Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">SomeVideoRender</span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRender</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #008000">// Default constructor</span>
<span style="color: #000000">    </span><span style="color: #000000">SomeVideoRender</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #000000">...</span><span style="color: #000000"> </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #008000">// Destructor</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">~</span><span style="color: #000000">SomeVideoRender</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #000000">Close</span><span style="color: #000000">();</span><span style="color: #000000"> </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #008000">// Initialize the render</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaReceiverParams</span><span style="color: #000000">*</span><span style="color: #000000"> pInit</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">...</span>
<span style="color: #000000">        </span><span style="color: #008000">// Initialization of the driver.</span>
<span style="color: #000000">        </span><span style="color: #000000">...</span>
<span style="color: #000000">        </span><span style="color: #008000">// Initialization of the Unified render.</span>
<span style="color: #000000">        UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRender</span><span style="color: #000000">::</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">pInit</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #008000">// Peek presentation of next frame, return presentation time</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #000000">Ipp64f</span><span style="color: #000000"> </span><span style="color: #000000">GetRenderFrame</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #008000">// Some functions can be overloaded.</span>
<span style="color: #000000">        </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">}</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_19">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>There are no threads creations in current implementation of <code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code>.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>There is no memory allocation in current implementation of <code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code>.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_26">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>unified_video_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP component: ipps.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</h3>
<div class="paragraph"><p><code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code> class contains initialization info for Unified Video Render. This class is derived from UMC::VideoRenderParams Class that contains common initialization information for all UMC video renders.</p></div>
<div class="sect3">
<h4 id="_user_interface_27">User Interface</h4>
<div class="tableblock" id="tab_umc_5_103">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 150. UnifiedVideoRenderParams Data Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Type                            </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pDrvSpec</code></p></td>
<td align="left" valign="top"><p class="table"><code>struct VideoDrvSpec*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the driver specification that defines basic driver functions. Default value is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_VideoMemType</code></p></td>
<td align="left" valign="top"><p class="table"><code>enum VideoDrvVideoMemType</code></p></td>
<td align="left" valign="top"><p class="table">Video memory to use. Possible values: VideoDrvVideoMemInternal, VideoDrvVideoMemExternal, VideoDrvVideoMemLibrary (default)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pVideoMemInfo</code></p></td>
<td align="left" valign="top"><p class="table"><code>struct VideoDrvVideoMemInfo*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the video memory (memory for video buffers) information. Default value is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pDrvParams</code></p></td>
<td align="left" valign="top"><p class="table"><code>void*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the video driver parameters structure. Default value is NULL.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_104">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 151. UnifiedVideoRenderParams Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method                         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_unifiedvideorenderparams_unifiedvideorenderparams">UnifiedVideoRenderParams</a></code></p></td>
<td align="left" valign="top"><p class="table">Special constructor that simplifies usage of the class</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>&lt;&lt;_umc_unifiedvideorenderparams_operator,operator&#8658;&gt;</code></p></td>
<td align="left" valign="top"><p class="table">Loads fields
of
UMC::VideoRenderParams to <code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_unifiedvideorenderparams_unifiedvideorenderparams" class="float">UnifiedVideoRenderParams</h4>
<div class="paragraph"><p><em>Simplifies usage of the class.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::UnifiedVideoRenderParams::UnifiedVideoRenderParams(VideoDrvSpec* pDrvSpec, void* pDrvParams);</code></pre>
</div></div>
<h5 id="_parameters_134" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pDrvSpec</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Video driver specification. The value is assigned to m_pDrvSpec.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>pDrvParams</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Video driver parameters. The value is assigned to m_pDrvParams.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method is a special constructor to simplify usage of
<code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code> class.</p></div>
<hr />
<h4 id="_umc_unifiedvideorenderparams_operator" class="float">operator=</h4>
<div class="paragraph"><p><em>Loads fields of UMC::VideoRenderParams to UMC::UnifiedVideoRenderParams.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>UMC::UnifiedVideoRenderParams &amp;operator=(const UMC::VideoRenderParams &amp;From);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method loads fields of UMC::VideoRenderParams to
<code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code>.</p></div>
</div>
<div class="sect3">
<h4 id="_usage_examples_23">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_unifiedvideorenderparams">UMC::UnifiedVideoRenderParams</a></code>, set the following data fields:
m_pDrvSpec, m_VideoMemType, m_pVideoMemInfo, m_pDrvParams.</p></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the render, invoke the delete operator.</p></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>This class is used to pass initialization information to Init() method of <code><a href="#_umc_unifiedvideorender">UMC::UnifiedVideoRender</a></code>.</p></div>
<div class="exampleblock">
<div class="title">Example 49. UnifiedVideoRenderParams Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoRender </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRender</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRenderParams</span><span style="color: #000000">*</span><span style="color: #000000"> pPparams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UnifiedVideoRenderParams</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialization of the UMC::VideoRenderParams fields.</span>
<span style="color: #000000">...</span>

<span style="color: #008000">// Initialization of the UMC::UnifiedVideoRenderParams fields.</span>
<span style="color: #000000">m_pDrvSpec </span><span style="color: #000000">=...;</span>
<span style="color: #000000">m_VideoMemType </span><span style="color: #000000">=...;</span>
<span style="color: #000000">m_pVideoMemInfo </span><span style="color: #000000">=...;</span>
<span style="color: #000000">m_pDrvParams   </span><span style="color: #000000">=...;</span>

<span style="color: #008000">// Initialization of the Unified Video Render.</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">pParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #A31515">"Failed to initialize</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> pParams</span><span style="color: #000000">;</span><span style="color: #000000">        </span><span style="color: #008000">// Parameters structure is not needed any more.</span>
<span style="color: #000000">...</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">;</span><span style="color: #000000">   </span><span style="color: #008000">// Close() method will be called automatically.</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_27">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>unified_video_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP component: ipps.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_fwvideorender">UMC::FWVideoRender</h3>
<div class="paragraph"><p>File Writer (FW) video render is a video renderer designed for rendering video data on a virtual surface and copying it to a file. The default file name is currently output.yuv.</p></div>
<div class="paragraph"><p><code><a href="#_umc_fwvideorender">UMC::FWVideoRender</a></code> supports all UMC color formats for rendering.</p></div>
<div class="sect4">
<h5 id="_derivation_13">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_fwvideorender">UMC::FWVideoRender</a></code> is inherited from UMC::VideoRender class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_14">See Also</h5>
<div class="paragraph"><p>UMC::VideoRender, UMC::FWVideoRenderParams, UMC::VideoRenderParams, UMC::VideoData, <code><a href="#_umc_filewriter">UMC::FileWriter</a></code>.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_28">User Interface</h4>
<div class="tableblock" id="tab_umc_5_106">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 152. FWVideoRender Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the render.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Releases all render resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_lockinputbuffer">LockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Locks input buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_unlockinputbuffer">UnlockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Unlocks input
buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_getrenderframe">GetRenderFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Peeks presentation of the
next frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_renderframe">RenderFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Renders a frame to the destination
surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_showlastframe">ShowLastFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Renders the last frame to
the destination surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_setfullscreen">SetFullScreen</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets/resets full screen
playback.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_resizedisplay">ResizeDisplay</a></code></p></td>
<td align="left" valign="top"><p class="table">Resizes the display
rectangular.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_showsurface">ShowSurface</a></code></p></td>
<td align="left" valign="top"><p class="table">Shows rendering surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_hidesurface">HideSurface</a></code></p></td>
<td align="left" valign="top"><p class="table">Hides rendering surface.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_stop">Stop</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops rendering and breaks all operations in
waiting mode.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_rpepareforreposition">PrepareForRePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Prepares the
render for repositioning of a stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_fwvideorender_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the render into the initial state.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the render.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams *pInit);</code></pre>
</div></div>
<h5 id="_parameters_135" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Pointer to the initialization structure. The pointer must refer to the instance of UMC::VideoRenderParams, which contains common initialization information for all video renders, or UMC::FWVideoRenderParams, which contains initialization information for FW video render.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method performs initialization of the render. The method can return values unspecified above because of calling UMC::NULLVideoRender::Init.</p></div>
<h5 id="_return_values_215" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The pInit pointer is NULL or does not refer to the instance of UMC::VideoRenderParams.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The specified color format is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The method is unable to allocate memory needed for internal buffers; allocation of UMC file writer failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">FW object initialization failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes the render.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method releases all resources allocated by Init(). The return value is always
UMC::UMC_OK.</p></div>
<h5 id="_return_values_216" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_fwvideorender_lockinputbuffer" class="float">LockInputBuffer</h4>
<div class="paragraph"><p><em>Locks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockInputBuffer(UMC::MediaData* buffer);</code></pre>
</div></div>
<h5 id="_parameters_136" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>buffer</em></p></td>
<td align="left" valign="top"><p class="table">Pointer to the input data object. The pointer must refer to an instance of UMC::VideoData. On exit, buffer refers to the video render buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method obtains a pointer to a free buffer of the video render. The frame can be decoded directly to the buffer of the render.</p></div>
<div class="paragraph"><p>The function can return values unspecified below if you call other functions
(UMC::Semaphore::Wait).</p></div>
<div class="paragraph"><p>The function modifies some fields of buffer by calling UMC::VideoData::SetSurface. Call this function before calling UMC::VideoRender::UnlockInputBuffer.</p></div>
<h5 id="_return_values_217" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The buffer pointer is NULL or does not refer to the instance of UMC::VideoData.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">The render cannot lock the surface (the video render cannot provide reference to the buffer; for example, the graphic driver is busy).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed; some error occured at the rendering stage and the render cannot work properly any longer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The specified color format is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_WRN_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The alignment is not a power of 2.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Internal UMC::SampleBuffer was not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Internal UMC::SampleBuffer has no more space.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_unlockinputbuffer" class="float">UnlockInputBuffer</h4>
<div class="paragraph"><p><em>Unlocks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnlockInputBuffer(UMC::MediaData* buffer, UMC::Status StreamStatus);</code></pre>
</div></div>
<h5 id="_parameters_137" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>buffer</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the input data object. The pointer must refer to an instance of UMC::VideoData. On exit, buffer refers to the video render buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>StreamStatus</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Value equal to UMC::UMC_ERR_END_OF_STREAM notifies the video render that the media stream is finished; any other values are ignored.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method informs the video render that data is already placed in the buffer and can be rendered.</p></div>
<div class="paragraph"><p>Call this function after calling UMC::VideoRender::LockInputBuffer.</p></div>
<h5 id="_return_values_218" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The buffer pointer is NULL or does not refer to the instance of UMC::VideoData.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed; some error occurred at the rendering stage and the render cannot work properly any longer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The selected color format for internal UMC::VideoData is invalid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_WRN_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Internal UMC::VideoData allocation failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Internal UMC::SampleBuffer was not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Internal UMC::SampleBuffer has no more space.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_getrenderframe" class="float">GetRenderFrame</h4>
<div class="paragraph"><p><em>Peeks presentation of the next frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetRenderFrame(Ipp64f* pTime);</code></pre>
</div></div>
<h5 id="_parameters_138" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pTime</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Frame time stamp.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method peeks presentation of the next frame.</p></div>
<div class="paragraph"><p>This function should be called after UMC::VideoRender::UnlockInputBuffer (or in another thread).</p></div>
<div class="paragraph"><p>This function should be called before UMC::VideoRender::RenderFrame.</p></div>
<h5 id="_return_values_219" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer pTime is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_TIMEOUT</code></p></td>
<td align="left" valign="top"><p class="table">The internal UMC::SampleBuffer has no more space.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The internal UMC::SampleBuffer was not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">End of stream in the UMC::SampleBuffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Internal UMC::SampleBuffer has no more space.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_renderframe" class="float">RenderFrame</h4>
<div class="paragraph"><p><em>Renders a frame to the destination surface.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status RenderFrame();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method renders a frame to the destination surface. This method should be called after
UnlockInputBuffer or in another thread.</p></div>
<div class="paragraph"><p>This method should be called after UMC::VideoRender::GetRenderFrame.</p></div>
<div class="paragraph"><p>The method can return values unspecified below if you call UMC::FileWriter::PutData or
UMC::NULLVideoRender::RenderFrame.</p></div>
<h5 id="_return_values_220" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed; writing data to the file failed or an internal UMC::SampleBuffer error occured.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer pTime is NULL.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The internal UMC::SampleBuffer was not initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">End of stream in the UMC::SampleBuffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Internal UMC::SampleBuffer has no more space.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_showlastframe" class="float">ShowLastFrame</h4>
<div class="paragraph"><p><em>Renders the last frame to the destination surface.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status ShowLastFrame();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method renders the last frame to the destination surface. This method is currently not implemented. The return value is always UMC::UMC_OK.</p></div>
<hr />
<h4 id="_umc_fwvideorender_setfullscreen" class="float">SetFullScreen</h4>
<div class="paragraph"><p><em>Sets/resets full screen playback.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetFullScreen(UMC::ModuleContext &amp;, bool)</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method sets or resets full screen playback.</p></div>
<div class="paragraph"><p>The method is currently not implemented. The return value is always UMC::UMC_OK.</p></div>
<h5 id="_return_values_221" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_resizedisplay" class="float">ResizeDisplay</h4>
<div class="paragraph"><p><em>Resizes the display rectangle.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status ResizeDisplay(UMC::RECT &amp;disp, UMC::RECT &amp;range);</code></pre>
</div></div>
<h5 id="_parameters_139" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>disp</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Display rectangle, defines rendering field on the screen.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>range</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Range rectangle, defines resolution of display rectangle.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method resizes the display rectangle. The return value is always UMC::UMC_OK.</p></div>
<h5 id="_return_values_222" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_showsurface" class="float">ShowSurface</h4>
<div class="paragraph"><p><em>Shows rendering surface.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual void ShowSurface();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method shows the rendering surface.</p></div>
<hr />
<h4 id="_umc_fwvideorender_hidesurface" class="float">HideSurface</h4>
<div class="paragraph"><p><em>Hides rendering surface.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual void HideSurface();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method hides the rendering surface.</p></div>
<hr />
<h4 id="_umc_fwvideorender_stop" class="float">Stop</h4>
<div class="paragraph"><p><em>Stops rendering.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Stop();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method stops rendering and breaks all operations in waiting mode.</p></div>
<h5 id="_return_values_223" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_rpepareforreposition" class="float">PrepareForRePosition</h4>
<div class="paragraph"><p><em>Prepares render for repositioning of a stream.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PrepareForRePosition();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method prepares the render for repositioning of a stream. The return value is always
UMC::UMC_OK.</p></div>
<h5 id="_return_values_224" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_fwvideorender_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets the render.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the render into the initial state. The return value is always
UMC::UMC_OK.</p></div>
<h5 id="_return_values_225" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_24">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize FW video render, create an instance of the <code><a href="#_umc_fwvideorender">UMC::FWVideoRender</a></code> class and invoke Init() method. The method accepts a pointer of UMC::MediaReceiverParams* type as its single parameter.</p></div>
<div class="paragraph"><p>The pointer must refer to the instance of UMC::VideoRenderParams structure, which contains common initialization information for all video renders, or UMC::FWVideoRenderParams, which contains initialization information for FW video render. In the first case, FW video render copies output data to the file with default file name, currently output.yuv. In the second case, FileWriter opens the output file with the name you specify.</p></div>
<div class="paragraph"><p>If the acquired pointer cannot be converted to UMC::VideoRenderParams*, the method returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="exampleblock">
<div class="title">Example 50. FWVideoRender Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FWVideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pFWVideoRender </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FWVideoRender</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FWVideoRenderParams</span><span style="color: #000000">*</span><span style="color: #000000"> fw_params </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FWVideoRenderParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> rectDisp</span><span style="color: #000000">,</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">ClipInfo</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>

<span style="color: #008000">// Obtaining UMC::ClipInfo from video decoder:</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> dec_params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoDecoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">();</span>

<span style="color: #008000">//... Make correct initialization of the decoder</span>
<span style="color: #000000">pVideoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">dec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">clipInfo </span><span style="color: #000000">=</span><span style="color: #000000"> dec_params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">;</span>

<span style="color: #008000">// Setting display and range rectangles:</span>
<span style="color: #000000">rectDisp</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">...</span>

<span style="color: #000000">...</span>

<span style="color: #008000">// Initialization of the UMC::VideoRenderParams fields:</span>
<span style="color: #008000">// Setting color format, possible values: UMC::YV12, UMC::YUV422, UMC::YUV444</span>
<span style="color: #000000">fw_params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">color_format </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">YV12</span><span style="color: #000000">;</span>
<span style="color: #000000">fw_params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info </span><span style="color: #000000">=</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">fw_params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">disp </span><span style="color: #000000">=</span><span style="color: #000000"> rectDisp</span><span style="color: #000000">;</span>
<span style="color: #000000">fw_params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">range </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #008000">// Setting render flags, possible values: 0, FLAG_VREN_REORDER.</span>
<span style="color: #000000">fw_params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> FLAG_VREN_REORDER</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialization of the UMC::FWVideoRenderParams fields:</span>
<span style="color: #000000">fw_params</span><span style="color: #000000">-&gt;</span><span style="color: #000000">pOutFile </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #A31515">"My_yuv_output_file.yuv"</span><span style="color: #000000">;</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FWVideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pFWVideoRender </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FWVideoRender</span><span style="color: #000000">;</span>
<span style="color: #008000">// Initialization of the FW video render:</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pFWVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">fw_params</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #A31515">"Failed to initialize</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> fw_params</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Parameters structure isn't needed any more.</span>
<span style="color: #000000">...</span>

<span style="color: #0000ff">delete</span><span style="color: #000000"> pFWVideoRender</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Close() method will be called automatically.</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_20">Important Technical Information</h4>
<div class="paragraph"><div class="title">Memory Usage</div><p>FW video render allocates a <code><a href="#_umc_filewriter">UMC::FileWriter</a></code> object.</p></div>
<div class="sect4">
<h5 id="_build_specific_information_28">Build Specific Information</h5>
<div class="paragraph"><div class="title">Header name</div><p>fw_video_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\io\umc_io\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
&lt;sample-dir\sources\audio-video-codecs\\codec\color_space_converter\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
umc_io
</p>
</li>
<li>
<p>
color_space_converter.
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP: ipps</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_FILE_WRITER is in umc_defs.h.</p></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_nullvideorender">UMC::NULLVideoRender</h3>
<div class="paragraph"><p><code><a href="#_umc_nullvideorender">UMC::NULLVideoRender</a></code> is a video render designed for rendering video data on a virtual surface. No output on the screen or in the file is performed.</p></div>
<div class="paragraph"><p>NULL Video Render supports all UMC color formats for rendering.</p></div>
<div class="sect4">
<h5 id="_derivation_14">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_nullvideorender">UMC::NULLVideoRender</a></code> is inherited from UMC::VideoRender class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_15">See Also</h5>
<div class="paragraph"><p>UMC::VideoRender, UMC::FWVideoRenderParams, UMC::VideoRenderParams, UMC::VideoData,  <code><a href="#_umc_fwvideorender">UMC::FWVideoRender</a></code>.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_29">User Interface</h4>
<div class="tableblock" id="tab_5_108">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 153. NULLVideoRender Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_nullvideorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the render.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_nullvideorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the render.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams *pInit);</code></pre>
</div></div>
<h5 id="_parameters_140" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Pointer to the initialization structure. The pointer must refer to the instance of UMC::VideoRenderParams, which contains common initialization information for all video renders.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the render. After NULL video render specific initialization is completed, UMC::VideoRender::Init is called to initialize parent class object.</p></div>
<h5 id="_return_values_226" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The pInit pointer is NULL or does not refer to the instance of UMC::VideoRenderParams.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The color format specified in the parameters is unsupported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Internal memory buffer allocation failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed, that is, an error occured during video driver or video render buffers initialization.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_25">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize NULL video render, create an instance of the <code><a href="#_umc_nullvideorender">UMC::NULLVideoRender</a></code> class and invoke Init() method. The method accepts pointer of type UMC::MediaReceiverParams* as its single parameter. The pointer must refer to the instance of UMC::VideoRenderParams structure, which contains common initialization information for all renders. The acquired pointer is converted to the UMC::VideoRenderParams*. If conversion attempt fails, the method returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="exampleblock">
<div class="title">Example 51. NULLVideoRender Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">NULLVideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoRender </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">NULLVideoRender</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">NULLVideoRenderParams</span><span style="color: #000000">*</span><span style="color: #000000"> pParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">NULLVideoRenderParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> rectDisp</span><span style="color: #000000">,</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">ClipInfo</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>

<span style="color: #008000">// Obtaining UMC::ClipInfo from video decoder.</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> dec_params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoDecoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">();</span>
<span style="color: #008000">//..... necessary decoder initialization</span>
<span style="color: #000000">pVideoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">dec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">clipInfo </span><span style="color: #000000">=</span><span style="color: #000000"> dec_params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">;</span>

<span style="color: #008000">// Setting display and range rectangles.</span>
<span style="color: #000000">rectDisp</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">...</span>
<span style="color: #000000">...</span>
<span style="color: #008000">// Initialization of UMC::VideoRenderParams fields:</span>
<span style="color: #008000">// Setting color format.</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">color_format </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">YV12</span><span style="color: #000000">;</span>
<span style="color: #008000">// Setting frame information.</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info </span><span style="color: #000000">=</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">disp </span><span style="color: #000000">=</span><span style="color: #000000"> rectDisp</span><span style="color: #000000">;</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">range </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #008000">// Setting render flags.</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FLAG_VREN_REORDER</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialization of NULL Video Render:</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">pParams</span><span style="color: #000000">);</span>

<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #A31515">"Failed to initialize, status is %d</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">,</span><span style="color: #000000"> umcRes</span><span style="color: #000000">);</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> pParams</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Parameters structure isn't needed any more.</span>
<span style="color: #000000">...</span>

<span style="color: #0000ff">delete</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Close() method will be called automatically.</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the decoder, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_21">Important Technical Information</h4>
<div class="paragraph"><div class="title">Memory Usage</div><p>NULL video render creates a number of overlay surfaces, which is defined dynamically (range for buffers number is from MAX_FRAME_BUFFERS to MIN_FRAME_BUFFERS). Each surface uses some memory according to the specified color format and width and height of the video frame.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_29">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>null_video_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\io\umc_io\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
&lt;sample-dir\sources\audio-video-codecs\\codec\color_space_converter\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
color_space_converter
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP: ipps</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_dxvideorender">UMC::DXVideoRender</h3>
<div class="paragraph"><p><code><a href="#_umc_dxvideorender">UMC::DXVideoRender</a></code> is a video render based on DirectX library.</p></div>
<div class="paragraph"><p>DX video render supports the following color formats for rendering:</p></div>
<div class="ulist"><ul>
<li>
<p>
UMC::YV12
</p>
</li>
<li>
<p>
UMC::YUY2
</p>
</li>
<li>
<p>
UMC::UYVY
</p>
</li>
<li>
<p>
UMC::NV12
</p>
</li>
<li>
<p>
UMC::RGB565
</p>
</li>
</ul></div>
<div class="paragraph"><p>One of these values should be chosen and set as video render parameter.</p></div>
<div class="sect4">
<h5 id="_derivation_15">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_dxvideorender">UMC::DXVideoRender</a></code> is inherited from UMC::VideoRender class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_16">See Also</h5>
<div class="paragraph"><p>UMC::VideoRender, UMC::FWVideoRenderParams, UMC::VideoRenderParams, UMC::VideoData, <code><a href="#_umc_filewriter">UMC::FileWriter</a></code>.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_30">User Interface</h4>
<div class="tableblock" id="tab_umc_5_110">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 154. FWVideoRender Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_dxvideorender_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the render.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_dxvideorender_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the render.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams *pInit);</code></pre>
</div></div>
<h5 id="_parameters_141" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Internal parameter. Pointer to the initialization structure. The pointer must refer to the instance of UMC::DXVideoRenderParams, which contains common initialization information for all video renders.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the render. After DX video render specific initialization is completed,
UMC::UnifiedVideoRender::Init is called to initialize parent class object.</p></div>
<h5 id="_return_values_227" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The pInit pointer is NULL or does not refer to the instance of UMC::VideoRenderParams.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Color format specified in parameters is unsupported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed, that is, an error occured during initialization of video driver or video render buffers.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_26">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize DX video render, create an instance of the <code><a href="#_umc_dxvideorender">UMC::DXVideoRender</a></code> class and invoke the Init() method. The method accepts pointer of type UMC::MediaReceiverParams* as its single parameter. The pointer must refer to the instance of UMC::DXVideoRenderParams structure, which contains common initialization information for all renders. The acquired pointer is converted to the UMC::DXVideoRenderParams*. If the conversion fails the method returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="exampleblock">
<div class="title">Example 52. DXVideoRender Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">DXVideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoRender </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">DXVideoRender</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">DXVideoRenderParams</span><span style="color: #000000">*</span><span style="color: #000000"> pParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">DXVideoRenderParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">RECT</span><span style="color: #000000"> rectDisp</span><span style="color: #000000">,</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">ClipInfo</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>

<span style="color: #008000">// Obtaining UMC::ClipInfo from video decoder.</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> dec_params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoDecoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">();</span>
<span style="color: #008000">//.... Perform necessary decoder initialization</span>
<span style="color: #000000">pVideoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">dec_params</span><span style="color: #000000">);</span>
<span style="color: #000000">clipInfo </span><span style="color: #000000">=</span><span style="color: #000000"> dec_params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">;</span>

<span style="color: #008000">// Setting display and range rectangles.</span>
<span style="color: #000000">rectDisp</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">.</span><span style="color: #000000">left </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">...</span>

<span style="color: #008000">//...</span>

<span style="color: #008000">// Initialization of UMC::VideoRenderParams fields:</span>
<span style="color: #008000">// Setting color format, possible values: UMC::YV12, UMC::YUY2, UMC::UYVY,</span>
<span style="color: #008000">// UMC::NV12, UMC::RGB565.</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">color_format </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">YV12</span><span style="color: #000000">;</span>
<span style="color: #008000">// Setting frame information.</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">info </span><span style="color: #000000">=</span><span style="color: #000000"> clipInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">disp </span><span style="color: #000000">=</span><span style="color: #000000"> rectDisp</span><span style="color: #000000">;</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">range </span><span style="color: #000000">=</span><span style="color: #000000"> rectRange</span><span style="color: #000000">;</span>
<span style="color: #008000">// Setting render flags.</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FLAG_VREN_REORDER</span><span style="color: #000000">;</span>

<span style="color: #008000">// Initialization of the UMC::DXVideoRenderParams fields:</span>
<span style="color: #000000">POINT</span><span style="color: #000000"> Point </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000">0</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">}</span><span style="color: #000000">;</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_hWnd </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">::</span><span style="color: #000000">WindowFromPoint</span><span style="color: #000000">(</span><span style="color: #000000">Point</span><span style="color: #000000">);</span>
<span style="color: #000000">pParams</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_hColorKey </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">RGB</span><span style="color: #000000">(</span><span style="color: #000000">0</span><span style="color: #000000">,</span><span style="color: #000000">0</span><span style="color: #000000">,</span><span style="color: #000000">0</span><span style="color: #000000">);</span>

<span style="color: #008000">// Initialization of DX Video Render:</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">pParams</span><span style="color: #000000">);</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">DXVideoRender</span><span style="color: #000000">*</span><span style="color: #000000"> pVideoRender </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">DXVideoRender</span><span style="color: #000000">;</span>

<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #000000">printf</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #A31515">"Failed to initialize</span><span style="color: #A31515">\n</span><span style="color: #A31515">"</span><span style="color: #000000">);</span>
<span style="color: #0000ff">delete</span><span style="color: #000000"> pParams</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Parameters structure isn't needed any more.</span>
<span style="color: #008000">//...</span>

<span style="color: #0000ff">delete</span><span style="color: #000000"> pVideoRender</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// Close() method will be called automatically.</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>To de-initialize the render, invoke Close() method. No restrictions are applied. The destructor automatically invokes Close() method.</p></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_22">Important Technical Information</h4>
<div class="paragraph"><div class="title">Memory Usage</div><p>DX video render creates a number of overlay surfaces by calling IDirectDraw::CreateSurface. This function allocates some memory according to the specified color format and width and height of the video frame. The number of overlays created by video render is equal to the number of overlays supported by DirectDraw and is defined dynamically (range for buffers number is from MAX_FRAME_BUFFERS to MIN_FRAME_BUFFERS).</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_30">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>dx_video_render.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include
&lt;sample-dir\sources\audio-video-codecs\\io\video_renders\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP: ipps</p></div>
<div class="paragraph"><div class="title">Macros</div><p>The enabling macro UMC_ENABLE_DX_VIDEO_RENDER is in umc_defs.h.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_filewriter">UMC::FileWriter</h3>
<div class="paragraph"><p><code><a href="#_umc_filewriter">UMC::FileWriter</a></code> is a derived class with basic functionality for saving data to a file. The class provides file handle manipulation and autiomatic fmanagement of file resources.</p></div>
<div class="sect4">
<h5 id="_derivation_16">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_filewriter">UMC::FileWriter</a></code> class is inherited from the base UMC::DataWriter Class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_17">See Also</h5>
<div class="paragraph"><p>UMC::DataWriter, UMC::FileWriterParams.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_31">User Interface</h4>
<div class="tableblock" id="tab_umc_5_113">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 155. FileWriter Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filewriter_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes an instance of the class, opens a corresponding file for writing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filewriter_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Deallocates internal memory buffers and closes internal handles and files.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filewriter_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the object into the initial state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filewriter_putdata">PutData</a></code></p></td>
<td align="left" valign="top"><p class="table">Writes data to the file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filewriter_setposition">SetPosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets the writing position in the
working file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filewriter_getposition">GetPosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Obtains the writing position in the
working file.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filewriter_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes an object of the class.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::DataWriterParams *InitParams);</code></pre>
</div></div>
<h5 id="_parameters_142" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>InitParams</em></p></td>
<td align="left" valign="top"><p class="table">Pointer to the initialization structure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes an instance of the class. After initialization, the method opens a corresponfding file and allocates internal memory buffers.</p></div>
<div class="paragraph"><p>The parameters for initialization should contain a valid file name or a file path and the user should have enough rights to write a file by the path passed.</p></div>
<h5 id="_return_values_228" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the method.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed. In most cases this value means that the file is absent or write-protected.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Method is unable to allocate memory needed for internal buffers; that is, no free dynamic memory is available.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filewriter_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method de-initializes the object, closes all handles and de-allocates all memory buffers.</p></div>
<h5 id="_return_values_229" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_filewriter_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets the object into the initial state.</p></div>
<h5 id="_return_values_230" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filewriter_putdata" class="float">PutData</h4>
<div class="paragraph"><p><em>Writes data to file.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PutData(void *data, Ipp32s &amp;nsize);</code></pre>
</div></div>
<h5 id="_parameters_143" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>data</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to data for writing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>nsize</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Variable for passing the amount of data to write and carrying out the amount of the written data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method writes given data to the destination file and moves the current writing position.</p></div>
<h5 id="_return_values_231" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized yet.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Dynamic memory allocation failed when the object was working in the "mapping" mode.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filewriter_setposition" class="float">SetPosition</h4>
<div class="paragraph"><p><em>Sets writing position in destination file.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetPosition(Ipp32u nPosLow, Ipp32u *lpnPosHigh, Ipp32u nMethod);</code></pre>
</div></div>
<h5 id="_parameters_144" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>nPosLow</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Holds lower 32 bits of the writing position in the destination file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>lpnPosHigh</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Holds upper 32 bits of the writing position in the destination file. Sometimes support of large files is not required and this parameter may be omitted by passing zero to the method.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>nMethod</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Holds the type of the writing position change. The allowed reference points are as follows:
SEEK_CUR - move the writing position with respect to the current value of the writing position,
SEEK_END - move the writing position back from the end of the file,
SEEK_SET - move the writing position from the beginning of the file.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets the current writing position in the destination file.</p></div>
<h5 id="_return_values_232" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized yet.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The implementation has restrictions and cannot perform operation. Currently, large files (&gt; 2 Gb) are not supported.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_UNSUPPORTED</code></p></td>
<td align="left" valign="top"><p class="table">The file pointer cannot be moved to the given position. In most cases, this value means that the specified positions are located outside the file bounds.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filewriter_getposition" class="float">GetPosition</h4>
<div class="paragraph"><p><em>Obtains writing position in destination file.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetPosition(Ipp32u *lpnPosLow, Ipp32u *lpnPosHigh);</code></pre>
</div></div>
<h5 id="_parameters_145" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>lpnPosLow</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Holds a pointer to a variable to store lower 32 bits of the writing position in the destination file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>lpnPosHigh</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Holds a pointer to a variable to store upper 32 bits of the writing position in the destination file. Sometimes support of large files is not required and this parameter may be omitted by passing zero to the method.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method gets the writing position in the destination file.</p></div>
<div class="paragraph"><p>Some media is unable to return any writing position. Currently, the implementation does not support large files (&gt; 2 Gb). Upper 32 bits are always zero.</p></div>
<h5 id="_return_values_233" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized yet.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">NULL pointer is passed to the method.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_27">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_filewriter">UMC::FileWriter</a></code>, use the InitParams pointer to an instance of UMC::DataWriterParams class. The pointer should actually point to an instance of UMC::FileWriterParams class, which holds a name of the destination file and size of minimal writing portion size. This portion size means the minimal amount of collected data for transmitting from the memory buffer to the destination data medium. Typically, it equals zero, but in several cases of performance issues it may be a derivation of 4096.</p></div>
<div class="exampleblock">
<div class="title">Example 53. FileWriter Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileWriterParams</span><span style="color: #000000"> params</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileWriter</span><span style="color: #000000"> writer</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #A31515">"c:</span><span style="color: #A31515">\\</span><span style="color: #A31515">output_file.dat"</span><span style="color: #000000">;</span>
<span style="color: #000000">params</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> writer</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">params</span><span style="color: #000000">))</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">/* everything is OK */</span>
<span style="color: #000000">}</span>
<span style="color: #0000ff">else</span><span style="color: #000000">    </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">/* something is wrong. Time to print the error message and quit. */</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><div class="title">De-Initialization</div><p>There is no special feature of de-initialization.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Writer.Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>Typically, instances of <code><a href="#_umc_filewriter">UMC::FileWriter</a></code> are used in objects that are last in the media pipeline, like muxers. The object is initialized in the Init method of the object and
de-initialized in the Close method of the object. While processing media data the owning object writes data to the object using the PutData method of the <code><a href="#_umc_filewriter">UMC::FileWriter</a></code> class.</p></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_23">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>There are no threading capabilities in the current implementation of <code><a href="#_umc_filewriter">UMC::FileWriter</a></code>.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p><code><a href="#_umc_filewriter">UMC::FileWriter</a></code> allocates negligible amount of memory.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_31">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_file_writer.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include;
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include;
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include;
$(IPPROOT)\include;</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>UMC_ENABLE_FILE_WRITER - Enabling macro in umc_defs.h.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_filereader">UMC::FileReader</h3>
<div class="paragraph"><p><code><a href="#_umc_filereader">UMC::FileReader</a></code> is a derived class with basic functionality for acquiring data from a file. Its operation is based on file mapping from the VM component.</p></div>
<div class="sect4">
<h5 id="_derivation_17">Derivation</h5>
<div class="paragraph"><p><code><a href="#_umc_filereader">UMC::FileReader</a></code> class is inherited from the base UMC::DataReader Class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_18">See Also</h5>
<div class="paragraph"><p>UMC::DataReader.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_32">User Interface</h4>
<div class="tableblock" id="tab_umc_5_114">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 156. FileReader Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filereader_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Creates an object and maps the first portion of data from the file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filereader_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filereader_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets all internal parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filereader_readdata">ReadData</a></code></p></td>
<td align="left" valign="top"><p class="table">Reads data from the file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filereader_moveposition">MovePosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Moves the reading position.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filereader_cachedata">CacheData</a></code></p></td>
<td align="left" valign="top"><p class="table">Caches data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filereader_setposition">SetPosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets the reading position.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filereader_getposition">GetPosition</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets the reading position.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_filereader_getsize">GetSize</a></code></p></td>
<td align="left" valign="top"><p class="table">Gets the file size.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filereader_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes an object of the class.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::DataReaderParams *InitParams);</code></pre>
</div></div>
<h5 id="_parameters_146" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>InitParams</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the initialization structure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes an instance of the class and maps the first portion of data from the file. File name and partition size should be provided. If the partition size is equal to 0, the default size is used.</p></div>
<h5 id="_return_values_234" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization parameter is incorrect.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_OPEN_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">File failed to open.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filereader_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the file.</p></div>
<h5 id="_return_values_235" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The Close function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the Init method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_filereader_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets all internal parameters.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets all internal parameters.</p></div>
<h5 id="_return_values_236" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized yet.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filereader_readdata" class="float">ReadData</h4>
<div class="paragraph"><p><em>Reads data from file.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status ReadData(void *data, Ipp32s *nsize);</code></pre>
</div></div>
<h5 id="_parameters_147" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>data</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the buffer where to put data from the file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>nsize</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Variable in bytes for passing the amount of the read data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method reads data from the file and moves the current reading position by the number of actually read bytes.</p></div>
<h5 id="_return_values_237" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">No more new data is expected within the current stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized yet.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">A mapping error has occurred.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filereader_moveposition" class="float">MovePosition</h4>
<div class="paragraph"><p><em>Moves reading position.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status MovePosition(Ipp64u npos);</code></pre>
</div></div>
<h5 id="_parameters_148" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>npos</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Offset in bytes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method moves the read pointer by a specified number of bytes. A positive value moves the pointer to the end of the file, negative - to the head of the file.</p></div>
<h5 id="_return_values_238" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized yet.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filereader_cachedata" class="float">CacheData</h4>
<div class="paragraph"><p><em>Caches data.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status CacheData(void *data, Ipp32u *nsize, Ipp32s how_far);</code></pre>
</div></div>
<h5 id="_parameters_149" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>data</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to the buffer for placing the data read from the file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>nsize</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Number of bytes to read; size of the actually read data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>how_far</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Offset to data; should be positive.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method reads (caches) from a specified offset from the current reading position. Unlike
ReadData, the reading position remains unchanged after this method is called.</p></div>
<h5 id="_return_values_239" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">No more new data is expected within the current stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized yet.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">A mapping error has occurred.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filereader_setposition" class="float">SetPosition</h4>
<div class="paragraph"><p><em>Sets reading position.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SetPosition(Ipp64f pos);</code></pre>
</div></div>
<h5 id="_parameters_150" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pos</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Position to move to, from 0.0 to 1.0.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets the reading position. Note that SetPosition accepts a float number from
0 to 1, but GetPosition returns an integer value from 0 to FileSize-1.</p></div>
<h5 id="_return_values_240" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized yet.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_filereader_getposition" class="float">GetPosition</h4>
<div class="paragraph"><p><em>Gets reading position.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetPosition();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method gets the current reading position.</p></div>
<div class="paragraph"><p>Some media is unable to return any writing position. Note that SetPosition accepts a float number from 0 to 1, but GetPosition returns an integer value from 0 to FileSize-1.</p></div>
<h5 id="_return_values_241" class="float">Return Values</h5>
<div class="paragraph"><p>Current reading position.</p></div>
<hr />
<h4 id="_umc_filereader_getsize" class="float">GetSize</h4>
<div class="paragraph"><p><em>Gets file size.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>Ipp64u GetSize();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method gets the file size.</p></div>
<div class="paragraph"><p>Some media is unable to return any writing position. Currently, the implementation does not support large files (&gt; 2 Gb). Upper 32bits are always zero.</p></div>
<h5 id="_return_values_242" class="float">Return Values</h5>
<div class="paragraph"><p>File size.</p></div>
</div>
<div class="sect3">
<h4 id="_usage_examples_28">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>UMC::FileReaderParams class should be used to pass initialization parameters to
<code><a href="#_umc_filereader">UMC::FileReader</a></code> . If the portion size is equal to 0, the default value is used.</p></div>
<div class="exampleblock">
<div class="title">Example 54. FileReader Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">FileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #A31515">"test.dat"</span><span style="color: #000000">);</span>
<span style="color: #000000">pFileReader</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">FileParams</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="listingblock">
<div class="title">De-Initialization</div>
<div class="content">
<pre><code>pFileReader-&gt;Close();</code></pre>
</div></div>
<div class="paragraph"><div class="title">Typical Usage Cases</div><p>See next example of reading 16 bytes from "test.dat" file.</p></div>
<div class="exampleblock">
<div class="title">Example 55. FileReader Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">Ipp8u</span><span style="color: #000000"> buf</span><span style="color: #000000">[</span><span style="color: #000000">16</span><span style="color: #000000">];</span>
<span style="color: #000000">Ipp32u</span><span style="color: #000000"> nsize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">16</span><span style="color: #000000">;</span>

<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReader</span><span style="color: #000000">*</span><span style="color: #000000"> pFileReader </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReader</span><span style="color: #000000">();</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReaderParams</span><span style="color: #000000"> FileParams</span><span style="color: #000000">;</span>

<span style="color: #000000">FileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">FileParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #A31515">"test.dat"</span><span style="color: #000000">);</span>
<span style="color: #000000">pFileReader</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">FileParams</span><span style="color: #000000">);</span>

<span style="color: #000000">pFileReader</span><span style="color: #000000">-&gt;</span><span style="color: #000000">MovePosition</span><span style="color: #000000">(</span><span style="color: #000000">13</span><span style="color: #000000">);</span>
<span style="color: #000000">pFileReader</span><span style="color: #000000">-&gt;</span><span style="color: #000000">ReadData</span><span style="color: #000000">(</span><span style="color: #000000">buf</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">nsize</span><span style="color: #000000">);</span>
<span style="color: #000000">pFileReader</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Close</span><span style="color: #000000">();</span>

<span style="color: #0000ff">delete</span><span style="color: #000000"> pFileReader</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_24">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>There are no threading capabilities in the current implementation of <code><a href="#_umc_filereader">UMC::FileReader</a></code>.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p><code><a href="#_umc_filereader">UMC::FileReader</a></code> allocates memory only for file mapping.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_32">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_file_reader.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;sample-dir\sources\audio-video-codecs\\core\umc\include;
&lt;sample-dir\sources\audio-video-codecs\\core\vm\include;
&lt;sample-dir\sources\audio-video-codecs\\core\vm_plus\include;
$(IPPROOT)\include;</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps.</p></div>
<div class="paragraph"><div class="title">Macros</div><p>UMC_ENABLE_FILE_READER - Enabling macro in umc_defs.h.</p></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_auxiliary_classes">Auxiliary Classes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_umc_defaultmemoryallocator">UMC::DefaultMemoryAllocator</h3>
<div class="paragraph"><p>The <code><a href="#_umc_defaultmemoryallocator">UMC::DefaultMemoryAllocator</a></code> class is inherited from the base abstract <code><a href="#_umc_memoryallocator">UMC::MemoryAllocator</a></code> Class. The class provides basic implementation of the memory allocator and unifies memory management in UMC components. If an external memory allocator object is specified in the initialization structure, the component should use it, otherwise it should create and use the default memory allocator.</p></div>
<div class="sect3">
<h4 id="_user_interface_33">User Interface</h4>
<h5 id="_defined_types" class="float">Defined Types</h5>
<div class="tableblock" id="tab_umc_5_70">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 157. MemoryInfo Structure Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                       </th>
<th align="left" valign="top">Type                    </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>pMemory</code></p></td>
<td align="left" valign="top"><p class="table"><code>void*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to the memory allocated for the buffer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Size</code></p></td>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table">Allocated size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>MID</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::MemID</code></p></td>
<td align="left" valign="top"><p class="table">Identifier of the memory buffer (MID_INVALID if unused)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Aligment</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Requested alignment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>LocksCount</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Buffer lock counter</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>InvalidatedFlag</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32s</code></p></td>
<td align="left" valign="top"><p class="table">Flag indicating that memory buffer is invalidated (the <code>Free</code> method was called)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The <code><a href="#_umc_memoryinfo">UMC::MemoryInfo</a></code> structure describes the allocated memory buffer.</p></div>
<div class="tableblock" id="tab_umc_5_71">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 158. DefaultMemoryAllocator Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_defaultmemoryallocator_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes memory managing object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_defaultmemoryallocator_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the object and releases all allocated resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_defaultmemoryallocator_alloc">Alloc</a></code></p></td>
<td align="left" valign="top"><p class="table">Allocates or reserves physical memory and returns unique ID, sets lock counter to 0.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_defaultmemoryallocator_lock">Lock</a></code></p></td>
<td align="left" valign="top"><p class="table">Locks memory buffer, increases lock counter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_defaultmemoryallocator_unlock">Unlock</a></code></p></td>
<td align="left" valign="top"><p class="table">Decreases lock counter.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_defaultmemoryallocator_free">Free</a></code></p></td>
<td align="left" valign="top"><p class="table">Notifies that the data will not be used anymore and the memory can be released.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_defaultmemoryallocator_deallocatemem">DeallocateMem</a></code></p></td>
<td align="left" valign="top"><p class="table">Immediately deallocates memory regardless of whether it is in use (locked) or not.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_defaultmemoryallocator_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes default memory managing object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MemoryAllocatorParams *pParams);</code></pre>
</div></div>
<h5 id="_parameters_151" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pParams</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. This parameter is ignored and can be set to <code>NULL</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the default memory allocator. In fact the allocator does not require initialization. The method is only used to invoke <code>Close()</code> method.</p></div>
<h5 id="_return_values_243" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_defaultmemoryallocator_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes the default allocator and releases all allocated resources.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void)</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the default memory allocator object and releases all memory regardless of whether it is still in use (locked) or not.</p></div>
<h5 id="_return_values_244" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling <code>Close</code>.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_defaultmemoryallocator_alloc" class="float">Alloc</h4>
<div class="paragraph"><p><em>Allocates or reserves physical memory and returns unique ID, sets lock counter to 0.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Alloc(UMC::MemID *pNewMemID, size_t Size, Ipp32u Flags,
                            Ipp32u Align = 16);</code></pre>
</div></div>
<h5 id="_parameters_152" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pNewMemID</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Memory address where the unique identifier of the new buffer will be stored.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>Size</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Size in bytes of the memory buffer to be allocated.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>Flags</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. One of the flags from the UMC::UMC_ALLOC_FLAGS enumeration, which determines if the memory is persistent or temporal.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>Align</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Memory alignment value.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method allocates memory using IPP Malloc function and returns unique ID, sets lock counter to 0. If the allocation fails, the method returns UMC::UMC_ERR_ALLOC and the ID is not valid. The method accepts size in bytes of the buffer to be allocated through the second parameter. The Flags parameter is ignored.</p></div>
<h5 id="_return_values_245" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Method is unable to allocate memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_PARAMS</code></p></td>
<td align="left" valign="top"><p class="table">Some parameters have invalid values, when size of memory to be allocated is zero or align value is not a power of 2.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table"><code>NULL</code> pointer was passed as a parameter.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_defaultmemoryallocator_lock" class="float">Lock</h4>
<div class="paragraph"><p><em>Locks memory buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual void* Lock(UMC::MemID MID);</code></pre>
</div></div>
<h5 id="_parameters_153" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>MID</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Identifier of the memory buffer to lock.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method locks memory buffer identified by MID. If the method  succeeds it returns
buffer pointer and increases lock counter for this buffer.  If the method fails (for
example, the memory cannot be locked, the identifier is not  valid, etc.), the method
returns <code>NULL</code>.</p></div>
<hr />
<h4 id="_umc_defaultmemoryallocator_unlock" class="float">Unlock</h4>
<div class="paragraph"><p><em>Decreases lock counter.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Unlock(UMC::MemID MID);</code></pre>
</div></div>
<h5 id="_parameters_154" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>MID</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Identifier of the memory buffer to unlock.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method decreases lock counter for the buffer specified  by the MID identifier. After
the buffer has been unlocked the pointer obtained by the corresponding  <code>Lock()</code> method is
no longer valid. Using this pointer can lead to memory corruption and application crash.</p></div>
<h5 id="_return_values_246" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Memory identifier is not valid.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_defaultmemoryallocator_free" class="float">Free</h4>
<div class="paragraph"><p><em>Releases memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Free(UMC::MemID MID);</code></pre>
</div></div>
<h5 id="_parameters_155" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>MID</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Identifier of the memory buffer to release.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method frees memory specified by the MID identifier.</p></div>
<div class="paragraph"><p>If the buffer was previously locked,  the memory is not released until the buffer is
unlocked, but marked as invalidated.  This memory cannot be locked any more. The <code>Lock()</code>
method returns <code>UMC::UMC_ERR_FAILED</code> if  invalidated memory is attempted to be locked. The
memory is released when locks counter of  the buffer reaches zero. The buffer is released
using IPP <code>Free</code> function.</p></div>
<h5 id="_return_values_247" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed. The memory identifier is not valid.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_defaultmemoryallocator_deallocatemem" class="float">DeallocateMem</h4>
<div class="paragraph"><p><em>Deallocates memory immediately.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status DeallocateMem(UMC::MemID MID);</code></pre>
</div></div>
<h5 id="_parameters_156" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>MID</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Identifier of the memory buffer to deallocate.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method  immediately deallocates memory regardless of whether it is in use (locked) or
not unlike the <code>Free()</code> method that checks whether the memory is in use or not.</p></div>
<h5 id="_return_values_248" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed. The memory identifier is not valid.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_29">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To  initialize the default memory allocator, create an instance of the
<code><a href="#_umc_defaultmemoryallocator">UMC::DefaultMemoryAllocator</a></code> class  and invoke <code>Init()</code>
method. The  method accepts one parameter of type
<code>UMC::MemoryAllocatorParams*</code> but ignores it  since the default
allocator has no specific initialization parameters. This parameter can be set to <code>NULL</code>.</p></div>
<div class="paragraph"><p>UMC component can use either  external memory allocator specified in the initialization
structure or create and use the  default memory allocator. For example, the decoder should
check if <code>lpMemoryAllocator</code> member  of the initialization structure is not <code>NULL</code>. If an
external memory allocator is not  specified, the decoder should create the default memory
allocator as shown in next example:</p></div>
<div class="exampleblock">
<div class="title">Example 56. DefaultMemoryAllocator Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #008000">// Set up allocator at initialization of codec</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">init_param</span><span style="color: #000000">-&gt;</span><span style="color: #000000">lpMemoryAllocator </span><span style="color: #000000">!=</span><span style="color: #000000"> NULL</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    m_pMemoryAllocator </span><span style="color: #000000">=</span><span style="color: #000000"> init_param</span><span style="color: #000000">-&gt;</span><span style="color: #000000">lpMemoryAllocator</span><span style="color: #000000">;</span>
<span style="color: #000000">    m_bUseExternalMemoryControl </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">true</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>
<span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    m_bUseExternalMemoryControl </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">false</span><span style="color: #000000">;</span>
<span style="color: #000000">    m_pMemoryAllocator </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">DefaultMemoryAllocator</span><span style="color: #000000">();</span>
<span style="color: #000000">    m_pMemoryAllocator</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000"> NULL </span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_7">De-Initialization</h5>
<div class="paragraph"><p>To de-initialize the default  memory allocator, invoke <code>Close()</code> method. Since this method
releases all allocated memory,  all pointers obtained by the <code>Lock()</code> method become
invalid. For example, the video decoder should de-initialize the memory allocator in the following way:</p></div>
<div class="exampleblock">
<div class="title">Example 57. DefaultMemoryAllocator De-Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #008000">//Delete allocator</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(!</span><span style="color: #000000">m_bUseExternalMemoryControl </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> m_pMemoryAllocator</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    m_pMemoryAllocator</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Close</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> m_pMemoryAllocator</span><span style="color: #000000">;</span>
<span style="color: #000000">    m_pMemoryAllocator </span><span style="color: #000000">=</span><span style="color: #000000"> NULL</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">UMC component should not release an external memory allocator.</td>
</tr></table>
</div>
</div>
<div class="sect4">
<h5 id="_typical_usage_cases_6">Typical Usage Cases</h5>
<div class="paragraph"><p>The memory allocator should be used for allocating large memory buffers with capacity starting from 1 MB instead of IPP Malloc/Free functions. To allocate the memory, the code</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">some_buffer </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000">*)</span><span style="color: #000000">ippsMalloc_8u</span><span style="color: #000000">(</span><span style="color: #000000">buff_size</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000">(!</span><span style="color: #000000">some_buffer</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_ALLOC</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="paragraph"><p>should be replaced with the following:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000"> m_pMemoryAllocator</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Alloc</span><span style="color: #000000">(&amp;</span><span style="color: #000000">some_buffer_mid</span><span style="color: #000000">,</span><span style="color: #000000"> buff_size</span><span style="color: #000000">,</span>
<span style="color: #000000">            UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ALLOC_PERSISTENT</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">16</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_ALLOC</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="paragraph"><p>To obtain memory pointer from ID, call the <code>Lock()</code> method:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">some_buffer_ptr </span><span style="color: #000000">=</span><span style="color: #000000"> m_pMemoryAllocator</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Lock</span><span style="color: #000000">(</span><span style="color: #000000">some_buffer_mid</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">NULL </span><span style="color: #000000">==</span><span style="color: #000000"> some_buffer_ptr</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NULL_PTR</span><span style="color: #000000">;</span></tt></pre></div></div>
<div class="paragraph"><p>After you finish working with the buffer (for example, the frame buffer is filled with the decoded image) and the pointer is no longer needed, unlock the buffer:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">m_pMemoryAllocator</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Unlock</span><span style="color: #000000">(</span><span style="color: #000000">some_buffer_mid</span><span style="color: #000000">);</span>
<span style="color: #000000">some_buffer_ptr </span><span style="color: #000000">=</span><span style="color: #000000"> NULL</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">//To avoid errors</span></tt></pre></div></div>
<div class="paragraph"><p>If the memory is not needed deallocate it by the <code>Free()</code> method:</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000"> m_pMemoryAllocator </span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    m_pMemoryAllocator</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Free</span><span style="color: #000000">(</span><span style="color: #000000">some_buffer_mid</span><span style="color: #000000">);</span>
<span style="color: #000000">    some_buffer_mid </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">MemID</span><span style="color: #000000">)-</span><span style="color: #000000">1</span><span style="color: #000000">;</span><span style="color: #008000">//To avoid errors</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_25">Important Technical Information</h4>
<div class="paragraph"><div class="title">Memory Usage</div><p>The <code><a href="#_umc_defaultmemoryallocator">UMC::DefaultMemoryAllocator</a></code> class uses dynamically allocated array of <code><a href="#_umc_memoryinfo">UMC::MemoryInfo</a></code> objects to keep information about memory buffers. Each array element occupies approximately 32 bytes of memory. So the total memory usage is 32 bytes per allocated buffer plus some memory reserved for new buffers.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_33">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_default_memory_allocator.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include
&lt;samples-dir&gt;\sources\audio-video-codecs\common\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
common
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps, ippi, ippvc.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_linearbuffer">UMC::LinearBuffer</h3>
<div class="paragraph"><p>The <code><a href="#_umc_linearbuffer">UMC::LinearBuffer</a></code> class provides a thread-safe access to a pseudo-infinite region of memory. It encapsulates synchronization tools, memory boundaries management, and data organization overhead, providing a convenient way for the asynchronous data passing between threads.</p></div>
<div class="paragraph"><p>An instance of the class contains a region of dynamically allocated memory. Its size, reading and writing granulations are set by the <code>Init</code> method. The object tracks amount of free or filled bytes, and provides appropriate pointers to callers. If available amount of bytes is less than the required amount, the object immediately returns one of predefined return values. So the caller code has to organize a special waiting code around an object call. Despite the set reading and writing granulations, the object returns the entire amount of bytes available for reading or writing. The granulations values have a meaning of minimal acceptable values.</p></div>
<div class="paragraph"><p>The typical internal scheme of the buffer is as follows:</p></div>
<div class="imageblock" id="fig_umc_5_64">
<div class="content">
<img src="images/umc/umc_5_64.png" alt="images/umc/umc_5_64.png" />
</div>
<div class="title">Figure 51. LinearBuffer Functional Scheme</div>
</div>
<div class="imageblock" id="fig_umc_5_65">
<div class="content">
<img src="images/umc/umc_5_65.png" alt="images/umc/umc_5_65.png" />
</div>
<div class="title">Figure 52. Processing Writing Thread</div>
</div>
<div class="imageblock" id="fig_umc_5_66">
<div class="content">
<img src="images/umc/umc_5_66.png" alt="images/umc/umc_5_66.png" />
</div>
<div class="title">Figure 53. Processing Reading Thread</div>
</div>
<div class="sect4">
<h5 id="_see_also_19">See Also</h5>
<div class="paragraph"><p>UMC::MediaReceiver, UMC::MediaBuffer and UMC::MediaReceiverParams classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_34">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p>The UMC::SampleInfo structure holds info about data chunks in buffers. See next table.</p></div>
<div class="tableblock" id="tab_umc_5_73">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 159. SampleInfo Members</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Type                           </th>
<th align="left" valign="top">Name                        </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_dTime</code></p></td>
<td align="left" valign="top"><p class="table">PTS of media sample</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_dTimeAux</code></p></td>
<td align="left" valign="top"><p class="table">Additional time stamp, it can be interpreted as DTS of end time</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::FrameType</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_FrameType</code></p></td>
<td align="left" valign="top"><p class="table">Type of frame (I, P, B)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_lDataSize</code></p></td>
<td align="left" valign="top"><p class="table">Media sample size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_lBufferSize</code></p></td>
<td align="left" valign="top"><p class="table">Media sample buffer size</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp8u*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pbData</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to data</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC::SampleInfo*</code></p></td>
<td align="left" valign="top"><p class="table"><code>m_pNext</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to next media sample info</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Data Members</div><p>There are no public data members.</p></div>
<div class="tableblock" id="tab_umc_5_74">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 160. LinearBuffer Class Methods</caption>
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Method</code></p></td>
<td align="left" valign="top"><p class="table">Description</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_linearbuffer_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_linearbuffer_lockinputbuffer">LockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Inquires the buffer about
available unused memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_linearbuffer_unlockinputbuffer">UnLockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Informs the buffer
about the amount of data written into the unused region of the memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_linearbuffer_lockoutputbuffer">LockOutputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Inquires the buffer about
available data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_linearbuffer_unlockoutputbuffer">UnLockOutputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Informs the buffer
about the amount of used bytes of data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_linearbuffer_stop">Stop</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops all internal waiting and deadlocks.
Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_linearbuffer_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the object, releases all resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_linearbuffer_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the buffer into the initial
initialized state, resets all internal counters.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_linearbuffer_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams *pParam);</code></pre>
</div></div>
<h5 id="_parameters_157" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pParam</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The pointer to an instance of the UMC::MediaBufferParams class or a derived class that contains specific information for initialization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes the buffer and allocates memory. The method returns the status code of the performed operation.</p></div>
<div class="paragraph"><p>The input parameter should be a valid pointer to an instance of the UMC::MediaBufferParams class or to a derived class. Before the initializing, the buffer calls the <code>Close</code> method, so the <code>Init</code> method can be called many times in series.</p></div>
<div class="paragraph"><p>For best performance, the initializing structure should carry valid parameters describing the working memory pattern:</p></div>
<div class="paragraph"><p>m_prefInputBufferSize means granulation of the input data stream, m_prefOutputBufferSize means granulation of the output data stream, m_numberOfFrames specifies the maximum number of available memory
chunks that have m_prefInputBufferSize or
m_prefOutputBufferSize.</p></div>
<h5 id="_return_values_249" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to parameters is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Failed to allocate memory as the specified amount of memory is too big for allocation, or there is huge difference between input and output memory granulations.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed as the instance of the UMC::MediaBufferParams class contains invalid values, or an error occurs during initialization, for example, a mutex could not be created for thread synchronization.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_linearbuffer_lockinputbuffer" class="float">LockInputBuffer</h4>
<div class="paragraph"><p><em>Inquires the buffer about available unused memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockInputBuffer(UMC::MediaData *in);</code></pre>
</div></div>
<h5 id="_parameters_158" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an instance of the UMC::MediaData class or a derived class to deliver the pointer and the size of available unused memory to the caller.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method inquires the buffer about available unused memory. If the amount of memory is sufficient, the method initializes a given UMC::MediaData object with the pointer of unused memory.</p></div>
<div class="paragraph"><p>This method should be called to obtain a pointer for writing data into the buffer. This method does not change the state of the object and can be called iteratively.</p></div>
<div class="paragraph"><p>If the method returns the UMC::UMC_OK value, it is guaranteed, that the UMC::MediaData object is initialized with a memory region of a size exceeding or equivalent to m_prefInputBufferSize. To get a pointer to the available memory and its size, the GetBufferPointer and GetBufferSize methods of the UMC::MediaData object should be called respectively. When a frame has been copied into the available memory region, the SetDataSize method of the UMC::MediaData object should be called to set amount of written data. If there are no more bytes to pass to the buffer, the size of the written memory should not be set.</p></div>
<h5 id="_return_values_250" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized correctly.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Insufficient free space in the buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_linearbuffer_unlockinputbuffer" class="float">UnLockInputBuffer</h4>
<div class="paragraph"><p><em>Informs the buffer about the amount of data written into the unused region of the memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnLockInputBuffer(UMC::MediaData *in,
                        UMC::Status streamStatus = UMC::UMC_OK);</code></pre>
</div></div>
<h5 id="_parameters_159" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The pointer to an instance of the UMC::MediaData class or a derived class. Holds pointers to a region of available memory and size of the written data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>streamStatus</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Current stream status parameter.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method marks the memory that has just been written as <em>available for reading</em> and adds it to the end of the region <em>available for reading</em>. The method should be called only once after every successful LockInputBuffer call.
If there are no more bytes to pass to the buffer, streamStatus should be set to the
UMC::UMC_ERR_END_OF_STREAM value.</p></div>
<h5 id="_return_values_251" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table"><code>NULL</code> pointer was passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized correctly.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The LockInputBuffer method was not called or returned a failed value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">There was not enough free space at the LockInputBuffer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_linearbuffer_lockoutputbuffer" class="float">LockOutputBuffer</h4>
<div class="paragraph"><p><em>Inquires the buffer about available data.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockOutputBuffer(UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_160" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. The pointer to an instance of the UMC::MediaData class or a derived class to deliver the pointer and the size of available data to a caller.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method inquires the buffer about available data. If the amount of data is sufficient, the method initializes a given UMC::MediaData object with the pointer of available data.</p></div>
<div class="paragraph"><p>This method should be called to obtain a pointer for reading data from the buffer. This method does not change the state of the object and can be called iteratively.</p></div>
<div class="paragraph"><p>If the method returns the UMC::UMC_OK value, it is guaranteed, that the UMC::MediaData object is initialized with a memory region of a size exceeding or equivalent to m_prefOutputBufferSize, except end-of-stream cases. If the UMC::UMC_ERR_END_OF_STREAM value is passed to UnLockInputBuffer, the last chunk of the stream can be of a smaller size. To get a pointer to the available data and its size, the GetDataPointer and GetDataSize methods of the UMC::MediaData object should be called respectively. When a frame has been read from the available memory region, the MoveDataPointer method of the UMC::MediaData object should be called to decrement amount of the available data by the amount of the actually used bytes. Only this amount of data is marked as <em>free, available for writing</em>.</p></div>
<div class="paragraph"><p>If size of the available data is too small and the caller rejects using it, a subsequent
LockOutputBuffer call may return the UMC::UMC_ERR_END_OF_STREAM value.</p></div>
<h5 id="_return_values_252" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData object is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized correctly.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">The amount of available data is too small.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The stream is over.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_linearbuffer_unlockoutputbuffer" class="float">UnLockOutputBuffer</h4>
<div class="paragraph"><p><em>Informs the buffer about the amount of used bytes of data.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnLockOutputBuffer(UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_161" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The pointer to an instance of the UMC::MediaData class or a derived class. Holds pointers to a region of available data and size of the used data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method marks the data that has just been read as <em>available for writing</em> and adds it to the end of the region <em>available for writing</em>. The method should be called only once after every successful LockOutputBuffer call.</p></div>
<h5 id="_return_values_253" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData object is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The object is not initialized correctly.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The LockOutputBuffer method was not called or returned a failed value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">There was not enough free space at the LockOutputBuffer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_linearbuffer_stop" class="float">Stop</h4>
<div class="paragraph"><p><em>Stops all internal waiting and deadlocks.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Stop(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method stops internal waiting.</p></div>
<div class="paragraph"><p>The method is not used at the moment, because all internal threads were eliminated and waiting cycles were implemented outside of the buffer.</p></div>
<h5 id="_return_values_254" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_linearbuffer_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the object and releases all internal resources.</p></div>
<h5 id="_return_values_255" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_linearbuffer_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets state of the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method sets the buffer to the initial state and resets all internal counters. This method implements a soft sequence of <code>Close</code> and <code>Init</code> calls.</p></div>
<h5 id="_return_values_256" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_30">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_linearbuffer">UMC::LinearBuffer</a></code>, create an instance of the UMC::MediaData class or a class derived from it and invoke <code>Init()</code> method. The method accepts a pointer of type UMC::MediaReceiverParams* as its single parameter.</p></div>
<div class="paragraph"><p>The following example illustrated setting of input parameters.</p></div>
<div class="paragraph"><p>If the application reads an input stream by net packets 102 bytes long, it reconstructs frames from 1000 to 1200 bytes long from these packets. The input parameters should be set in the following way:</p></div>
<div class="ulist"><ul>
<li>
<p>
m_prefInputBufferSize should be set to 102,
</p>
</li>
<li>
<p>
m_prefOutputBufferSize should be set to 1200,
</p>
</li>
<li>
<p>
m_numberOfFrames should be set to any suitable value greater than 3 and providing effective tradeoff between allocated memory and performance.
</p>
</li>
</ul></div>
<div class="paragraph"><div class="title">Behavior features</div><p>The buffer may be initialized with m_prefInputBufferSize equal to 1. In this case, performance of the buffer is very low because the buffer keeps additional supplemental info for every written chunk of memory. In the case mentioned, the volume of supplemental information is too large.</p></div>
<div class="paragraph"><div class="title">Initialization Examples</div><p>See next example for the initialization example:</p></div>
<div class="exampleblock">
<div class="title">Example 58. LinearBuffer Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaBufferParams</span><span style="color: #000000"> bufParam</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">LinearBuffer</span><span style="color: #000000"> buf</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #008000">// set the buffer working parameters</span>
<span style="color: #000000">bufParam</span><span style="color: #000000">.</span><span style="color: #000000">m_prefInputBufferSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">102</span><span style="color: #000000">;</span>
<span style="color: #000000">bufParam</span><span style="color: #000000">.</span><span style="color: #000000">m_prefOutputBufferSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1200</span><span style="color: #000000">;</span>
<span style="color: #000000">bufParam</span><span style="color: #000000">.</span><span style="color: #000000">m_numberOfFrames </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">3</span><span style="color: #000000">;</span>

<span style="color: #008000">// initialize the buffer</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> buf</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">bufParam</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_8">De-Initialization</h5>
<div class="paragraph"><p>To de-initialize <code><a href="#_umc_linearbuffer">UMC::LinearBuffer</a></code>, invoke  <code>Close()</code> method.</p></div>
</div>
<div class="sect4">
<h5 id="_typical_usage_cases_7">Typical Usage Cases</h5>
<div class="exampleblock">
<div class="title">Example 59. Writing Thread Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> mediaDst</span><span style="color: #000000">;</span>

<span style="color: #008000">// main working cycle</span>
<span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// waiting cycle</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> buf</span><span style="color: #000000">.</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaDst</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_BUFFER </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">5</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">true</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #008000">// do something with the buffer</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">there_are_more_bytes_to_write</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #008000">// ...</span>
<span style="color: #000000">        mediaDst</span><span style="color: #000000">.</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">amount_of_data</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span>
<span style="color: #000000">        </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #008000">// mark written bytes</span>
<span style="color: #000000">    buf</span><span style="color: #000000">.</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaDst</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">true</span><span style="color: #000000">);</span>
<span style="color: #008000">// finalize the stream</span>
<span style="color: #000000">buf</span><span style="color: #000000">.</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaDst</span><span style="color: #000000">,</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_END_OF_STREAM</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="exampleblock">
<div class="title">Example 60. Reading Thread Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> mediaSrc</span><span style="color: #000000">;</span>
<span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// waiting cycle</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> buf</span><span style="color: #000000">.</span><span style="color: #000000">LockOutputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaSrc</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">5</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">true</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #008000">// do something with the data</span>
<span style="color: #000000">    </span><span style="color: #008000">// ...</span>
<span style="color: #000000">    mediaSrc</span><span style="color: #000000">.</span><span style="color: #000000">MoveDataPointer</span><span style="color: #000000">(</span><span style="color: #000000">number_of_spent_bytes</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #008000">// mark spent bytes</span>
<span style="color: #000000">    buf</span><span style="color: #000000">.</span><span style="color: #000000">UnLockOutputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaSrc</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">true</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_26">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>The class is designed to be used in multithreaded applications and contains all necessary synchronization tools. The input and output methods are supposed to be called from different threads.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The component allocates memory only for the main region and for supplemental information. The piece of supplemental information is negligibly small and can be omitted. The size of the main region is calculated by the following formula:</p></div>
<div class="paragraph"><p>SIZE = MAX(3, m_numberOfFrames) * MAX(m_prefInputBufferSize, m_prefOutputBufferSize).</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_34">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_linear_buffer.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_samplebuffer">UMC::SampleBuffer</h3>
<div class="paragraph"><p>The <code><a href="#_umc_samplebuffer">UMC::SampleBuffer</a></code> class provides a thread-safe access to a pseudo-infinite region of memory. It encapsulates synchronization tools, memory boundaries management, and data organization overhead, providing a convenient way for the asynchronous data passing between threads.</p></div>
<div class="paragraph"><p>An instance of the class contains a region of dynamically allocated memory. Its size and writing granulations are set by the <code>Init</code> method. The object tracks amount of free or filled bytes, and provides appropriate pointers to callers. If available amount of bytes is less than the required amount, the object immediately returns one of predefined return values. So the caller code has to organize a special waiting code around an object call. Despite the set writing granulations, the object returns the entire amount of bytes available for writing. The granulations values have a meaning of minimal acceptable values.</p></div>
<div class="paragraph"><p>The buffer does not concatenate separate written memory chunks - samples. It provides a reader with exactly the same samples as written by a writer.</p></div>
<div class="paragraph"><p>The typical internal scheme of the buffer is as follows:</p></div>
<div class="imageblock" id="fig_umc_5_68">
<div class="content">
<img src="images/umc/umc_5_68.png" alt="images/umc/umc_5_68.png" />
</div>
<div class="title">Figure 54. SampleBuffer FunctionalScheme</div>
</div>
<div class="imageblock" id="fig_umc_5_69">
<div class="content">
<img src="images/umc/umc_5_69.png" alt="images/umc/umc_5_69.png" />
</div>
<div class="title">Figure 55. Processing Writing Thread</div>
</div>
<div class="imageblock" id="fig_umc_5_70">
<div class="content">
<img src="images/umc/umc_5_70.png" alt="images/umc/umc_5_70.png" />
</div>
<div class="title">Figure 56. Processing Reading Thread</div>
</div>
<div class="sect4">
<h5 id="_see_also_20">See Also</h5>
<div class="paragraph"><p>UMC::MediaReceiver, UMC::MediaBuffer and UMC::MediaReceiverParams classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_35">User Interface</h4>
<div class="paragraph"><div class="title">Data Members</div><p>There are no public data members.</p></div>
<div class="paragraph"><div class="title">Related Types</div><p>The UMC::SampleInfo structure holds info about data chunks in buffers. See Ta ble 5-73.</p></div>
<div class="tableblock" id="tab_umc_5_76">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 161. SampleBuffer Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_samplebuffer_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes the buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_samplebuffer_lockinputbuffer">LockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Inquires the buffer about
available unused memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_samplebuffer_unlockinputbuffer">UnLockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Informs the buffer
about the amount of data written into the unused region of the memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_samplebuffer_lockoutputbuffer">LockOutputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Inquires the buffer about
available data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_samplebuffer_unlockoutputbuffer">UnLockOutputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Informs the buffer
about the amount of used bytes of data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_samplebuffer_stop">Stop</a></code></p></td>
<td align="left" valign="top"><p class="table">Stops all internal waiting and deadlocks.
Currently not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_samplebuffer_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes the object, releases all resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_samplebuffer_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets the buffer into the initial
initialized state, resets all internal counters.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_samplebuffer_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams *pParam);</code></pre>
</div></div>
<h5 id="_parameters_162" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pParam</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The pointer to an instance of the UMC::MediaBufferParams class or a derived class that contains specific information for initialization.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes an instance of the class and sets it to the default state. The input parameter should be a valid pointer to an instance of the
UMC::MediaBufferParams class or to a derived class. Before the initializing, the buffer
calls the <code>Close</code> method, so the <code>Init</code> method can be called many times in series.</p></div>
<div class="paragraph"><p>For best performance, the initializing structure should carry valid parameters describing the working memory pattern:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_prefInputBufferSize</code></p></td>
<td align="left" valign="top"><p class="table">means granulation of the input data stream,</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_prefOutputBufferSize</code></p></td>
<td align="left" valign="top"><p class="table">is ignored,</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_numberOfFrames</code></p></td>
<td align="left" valign="top"><p class="table">specifies the maximum number of available memory chunks that have m_prefInputBufferSize size.</p></td>
</tr>
</tbody>
</table>
</div>
<h5 id="_return_values_257" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to parameters is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Failed to allocate memory as the specified amount of memory is too big for allocation, or there is huge difference between input and output memory granulations.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed as the instance of the UMC::MediaBufferParams class contains invalid values, or an error occurs during initialization, for example, a mutex could not be created for thread synchronization.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_samplebuffer_lockinputbuffer" class="float">LockInputBuffer</h4>
<div class="paragraph"><p><em>Inquires the buffer about available unused memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockInputBuffer(UMC::MediaData *in);</code></pre>
</div></div>
<h5 id="_parameters_163" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to an instance of the UMC::MediaData class or a derived class to deliver the pointer and the size of available unused memory to the caller.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method inquires the buffer about available unused memory. If the amount of memory is sufficient, the method initializes a given UMC::MediaData object with the pointer of unused memory.</p></div>
<div class="paragraph"><p>This method should be called to obtain a pointer for writing data into the buffer. This method does not change the state of the object and can be called iteratively.</p></div>
<div class="paragraph"><p>If the method returns the UMC::UMC_OK value, it is guaranteed, that the UMC::MediaData object is initialized with a memory region of a size exceeding or equivalent to m_prefInputBufferSize. To get a pointer to the available memory and its size, the GetBufferPointer and GetBufferSize methods of the UMC::MediaData object should be called respectively. When a frame has been copied into the available memory region, the SetDataSize method of the UMC::MediaData object should be called to set amount of written data. If there are no more bytes to pass to the buffer, the size of the written memory should not be set.</p></div>
<h5 id="_return_values_258" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The buffer is not yet initialized. The <code>Init</code> method should be called first.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Insufficient free space in the buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_samplebuffer_unlockinputbuffer" class="float">UnLockInputBuffer</h4>
<div class="paragraph"><p><em>Informs the buffer about the amount of data written into the unused region of the memory.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnLockInputBuffer(UMC::MediaData *in,
                                    UMC::Status streamStatus = UMC::UMC_OK);</code></pre>
</div></div>
<h5 id="_parameters_164" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The pointer to an instance of the UMC::MediaData class or a derived class. Holds pointers to a region of available memory and size of the written data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>streamStatus</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Current stream status parameter.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method marks the memory that has just been written as <em>available for reading</em> and adds it to the end of the region <em>available for reading</em>. The method should be called only once after every successful LockInputBuffer call.
If there are no more bytes to pass to the buffer, streamStatus should be set to the
UMC::UMC_ERR_END_OF_STREAM value.</p></div>
<h5 id="_return_values_259" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table"><code>NULL</code> pointer was passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The buffer is not yet initialized. The <code>Init</code> method should be called first.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">An internal buffer error happened. It may be caused by insufficient internal space to save service information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">The wrong calling sequence or error return value from the LockInputBuffer was not properly handled. This return value can happen only when amount of written data is bigger than memory buffer provided by the LockInputBuffer method.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_samplebuffer_lockoutputbuffer" class="float">LockOutputBuffer</h4>
<div class="paragraph"><p><em>Inquires the buffer about available data.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockOutputBuffer(UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_165" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. The pointer to an instance of the UMC::MediaData class or a derived class to deliver the pointer and the size of available data to a caller.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method inquires the buffer about available data. If the amount of data is sufficient, the method initializes a given UMC::MediaData object with the pointer of available data.</p></div>
<div class="paragraph"><p>This method should be called to obtain a pointer for reading data from the buffer. This method does not change the state of the object and can be called iteratively.</p></div>
<div class="paragraph"><p>If the method returns the UMC::UMC_OK value, it is guaranteed, that the UMC::MediaData object is initialized with a memory region of a size exceeding or equivalent to m_prefInputBufferSize. If the UMC::UMC_ERR_END_OF_STREAM value is passed to UnLockInputBuffer, the last chunk of the stream can be of a smaller size or even be zero. To get a pointer to the available data and its size, the GetDataPointer and GetDataSize methods of the UMC::MediaData object should be called respectively. When a frame has been read from the available memory region, the MoveDataPointer method</p></div>
<div class="paragraph"><p>of the UMC::MediaData object should be called to decrement amount of the available data by the amount of the actually used bytes. Only this amount of data is marked as <em>free, available for writing</em>.</p></div>
<div class="paragraph"><p>If size of the available data is too small and the caller rejects using it, a subsequent
LockOutputBuffer call may return the UMC::UMC_ERR_END_OF_STREAM value.</p></div>
<h5 id="_return_values_260" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData object is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The buffer is not yet initialized. The <code>Init</code> method should be called first.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">The amount of available data is too small.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The stream is over.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_samplebuffer_unlockoutputbuffer" class="float">UnLockOutputBuffer</h4>
<div class="paragraph"><p><em>Informs the buffer about the amount of used bytes of data.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnLockOutputBuffer(UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_166" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The pointer to an instance of the UMC::MediaData class or a derived class. Holds pointers to a region of available data and size of the used data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method marks the data that has just been read as <em>available for writing</em>. The method should be called only once after every successful LockOutputBuffer call.</p></div>
<h5 id="_return_values_261" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData object is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">The buffer is not yet initialized. The <code>Init</code> method should be called first.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">An internal buffer error happened. It may be caused by insufficient internal space to save service information.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_samplebuffer_stop" class="float">Stop</h4>
<div class="paragraph"><p><em>Stops all internal waiting and deadlocks.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Stop(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method stops internal waiting.</p></div>
<div class="paragraph"><p>The method is not used at the moment, because all internal threads are eliminated and waiting cycles are implemented outside the buffer.</p></div>
<h5 id="_return_values_262" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_samplebuffer_close" class="float">Close</h4>
<div class="paragraph"><p><em>Closes the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method closes the object and releases all internal resources.</p></div>
<h5 id="_return_values_263" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_samplebuffer_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets state of the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method sets the buffer to the initial state and resets all internal counters. This method implements a soft sequence of <code>Close</code> and <code>Init</code> calls.</p></div>
<h5 id="_return_values_264" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_31">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_samplebuffer">UMC::SampleBuffer</a></code>, pass an instance of the UMC::MediaBufferParams structure though the <code>Init</code> method.</p></div>
<div class="paragraph"><p>Members of the initialization structure have the following meanings:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_prefInputBufferSize</code></p></td>
<td align="left" valign="top"><p class="table">defines the minimal suitable amount of free space. The object does not provide a pointer, which refers to a free space of a smaller size.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_prefOutputBufferSize</code></p></td>
<td align="left" valign="top"><p class="table">is ignored. The buffer provides data sample by sample, which are passed through LockInputBuffer/LockInputBuffer methods.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_numberOfFrames</code></p></td>
<td align="left" valign="top"><p class="table">defines the minimal samples count in the object. The sample size is defined as maximum of m_prefInputBufferSize and m_prefOutputBufferSize parameters.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table">holds a pointer to an external memory allocator.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>For better performance and correct work the parameters should have actual values. Using extremely little or extremely big values may lead to a deadlock of consumer&#8217;s threads. The m_pMemoryAllocator parameter provides an external memory allocation ability to the buffer. If the pointer is zero the buffer allocates memory internally.</p></div>
<div class="exampleblock">
<div class="title">Example 61. SampleBuffer Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaBufferParams</span><span style="color: #000000"> bufParam</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">SampleBuffer</span><span style="color: #000000"> buf</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #008000">// set the buffer working parameters</span>
<span style="color: #000000">bufParam</span><span style="color: #000000">.</span><span style="color: #000000">m_prefInputBufferSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1020</span><span style="color: #000000">;</span>
<span style="color: #000000">bufParam</span><span style="color: #000000">.</span><span style="color: #000000">m_prefOutputBufferSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">bufParam</span><span style="color: #000000">.</span><span style="color: #000000">m_numberOfFrames </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">3</span><span style="color: #000000">;</span>

<span style="color: #008000">// initialize the buffer</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> buf</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">bufParam</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_9">De-Initialization</h5>
<div class="paragraph"><p>To de-initialize UMC::SampleBuffer, invoke <code>Close()</code> method.</p></div>
</div>
<div class="sect4">
<h5 id="_typical_usage_cases_8">Typical Usage Cases</h5>
<div class="exampleblock">
<div class="title">Example 62. Writing Thread Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> mediaDst</span><span style="color: #000000">;</span>

<span style="color: #008000">// main working cycle</span>
<span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// waiting cycle</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> buf</span><span style="color: #000000">.</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaDst</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_BUFFER </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">5</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">true</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #008000">// do something with the buffer</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">there_are_more_bytes_to_write</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #008000">// ...</span>
<span style="color: #000000">        mediaDst</span><span style="color: #000000">.</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">amount_of_data</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #008000">// mark written bytes</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span>
<span style="color: #000000">        </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">    buf</span><span style="color: #000000">.</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaDst</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">true</span><span style="color: #000000">);</span>
<span style="color: #008000">// finalize the stream</span>
<span style="color: #000000">buf</span><span style="color: #000000">.</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaDst</span><span style="color: #000000">,</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_END_OF_STREAM</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="exampleblock">
<div class="title">Example 63. Reading Thread Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> mediaSrc</span><span style="color: #000000">;</span>
<span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// waiting cycle</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> buf</span><span style="color: #000000">.</span><span style="color: #000000">LockOutputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaSrc</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">5</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">true</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #008000">// do something with the data</span>
<span style="color: #000000">    </span><span style="color: #008000">// ...</span>
<span style="color: #000000">    mediaSrc</span><span style="color: #000000">.</span><span style="color: #000000">MoveDataPointer</span><span style="color: #000000">(</span><span style="color: #000000">number_of_spent_bytes</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #008000">// mark spent bytes</span>
<span style="color: #000000">    buf</span><span style="color: #000000">.</span><span style="color: #000000">UnLockOutputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">mediaSrc</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #0000ff">true</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_27">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>The class is designed to be used in multithreaded applications and contains all necessary synchronization tools. The input and output methods are supposed to be called from different threads.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>The component allocates memory only for the main region of memory. Supplemental information is located in the main region immediately after the corresponding sample. The size of the main region is calculated by the following formula:</p></div>
<div class="paragraph"><p>SIZE = MAX(3, m_numberOfFrames) * MAX(m_prefInputBufferSize, m_prefOutputBufferSize).</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_35">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_sample_buffer.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP: ipps.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_frameconstructor">UMC::FrameConstructor</h3>
<div class="paragraph"><p>The <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> class is similar to other implementations of abstract UMC::MediaBuffer Class such as <code><a href="#_umc_samplebuffer">UMC::SampleBuffer</a></code> or <code><a href="#_umc_linearbuffer">UMC::LinearBuffer</a></code>. It also provides asynchronous thread-safe access to pseudo-infinite region of memory.</p></div>
<div class="paragraph"><p>There is another feature that determines the name of the class. The <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> can accept portions of encoded video bitstream (e.g. payloads of PES packets[ISOIEC93-1, ISO/IEC00]) at the input and provide frames, or access units (AU), at the output. Encoded video bitstreams are strongly required to be partitioned into frames before passing to UMC video decoders.</p></div>
<div class="paragraph"><p>Frame constructing is a very specific process for every type of video bitstream. This functionality is implemented in derived classes. The following types of video bitstreams are supported:</p></div>
<div class="ulist"><ul>
<li>
<p>
MPEG1<a href="#ISOIEC93_2">[ISOIEC93_2]</a> and MPEG2<a href="#ISOIEC96">[ISOIEC96]</a> - UMC::Mpeg2FrameConstructor
</p>
</li>
<li>
<p>
MPEG4<a href="#ISOIEC_Visual">[ISOIEC_Visual]</a> - UMC::Mpeg4FrameConstructor
</p>
</li>
<li>
<p>
H.261<a href="#ITUH261">[ITUH261]</a> - UMC::H261FrameConstructor
</p>
</li>
<li>
<p>
H.263<a href="#ITUH263">[ITUH263]</a> - UMC::H263FrameConstructor
</p>
</li>
<li>
<p>
H.264<a href="#ITUH264">[ITUH264]</a> - UMC::H264FrameConstructor
</p>
</li>
</ul></div>
<div class="paragraph"><p>The base class <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> is not abstract. It has all methods implemented and operates as <code><a href="#_umc_samplebuffer">UMC::SampleBuffer</a></code>.</p></div>
<div class="paragraph"><p>There is also abstract UMC::AudioFrameConstructor which is, strictly speaking, not a frame constructor. Data chunks at the output are not access units. UMC::AudioFrameConstructor is mostly used to get information about audio bitstream and reformat input chucks into output chunks following a certain strategy. There are several derivatives implementing different strategies:</p></div>
<div class="ulist"><ul>
<li>
<p>
UMC::PureAudioFrameConstructor should be used for pure audio streams without time-stamps, such as mp3 files. This kind of UMC::AudioFrameConstructor only parses the information and does not reformat input samples.
</p>
</li>
<li>
<p>
UMC::TimeStampedAudioFrameConstructor should be used for audio streams which come from container. Input chunks of such audio streams may be
time-stamped. This kind of UMC::AudioFrameConstructor parses the information and ensures that every output chunk is time-stamped, appending chunks without
time-stamp to the preceding time-stamped chunk.
</p>
</li>
<li>
<p>
UMC::BufferedAudioFrameConstructor is similar to UMC::TimeStampedFrameConstructor. It ensures that every output chunk is
time-stamped and buffers audio. The number of seconds buffered is controlled via constructor parameter of UMC::BufferedAudioFrameConstructor.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Every implementation of UMC::AudioFrameConstructor works with all supported types of audio:</p></div>
<div class="ulist"><ul>
<li>
<p>
Mpeg1Audio
</p>
</li>
<li>
<p>
Mpeg2Audio
</p>
</li>
<li>
<p>
Mpeg4Audio
</p>
</li>
<li>
<p>
AC3
</p>
</li>
<li>
<p>
DTS
</p>
</li>
</ul></div>
<div class="paragraph"><p>As a positive side effect of frame constructing process detailed information about bitstream is available after the first frame is constructed. For video frame constructors, it is UMC::VideoStreamInfo structure.</p></div>
<div class="paragraph"><p>See next figure for <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> functional scheme:</p></div>
<div class="imageblock" id="fig_umc_5_72">
<div class="content">
<img src="images/umc/umc_5_72.png" alt="images/umc/umc_5_72.png" />
</div>
<div class="title">Figure 57. FrameConstructor Algorithm Block Diagram</div>
</div>
<div class="sect4">
<h5 id="_see_also_21">See Also</h5>
<div class="paragraph"><p>UMC::MediaData, UMC::MediaBuffer and UMC::MediaReceiverParams classes.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_36">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p><code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> class contains the following parameters:</p></div>
<div class="tableblock" id="tab_umc_5_78">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 162. FrameConstructor Class Parameters</caption>
<col width="20%" />
<col width="20%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Type                        </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pInfo</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::Mpeg2TrackInfo*</code></p></td>
<td align="left" valign="top"><p class="table">This pointer is used to pass info from up-streaming component to <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_lBufferSize</code></p></td>
<td align="left" valign="top"><p class="table"><code>size_t</code></p></td>
<td align="left" valign="top"><p class="table">Size of buffer to allocate in bytes. Should be non-zero.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_nOfFrames</code></p></td>
<td align="left" valign="top"><p class="table"><code>Ipp32u</code></p></td>
<td align="left" valign="top"><p class="table">Initial number of frames constructed and stored in the buffer. This number is dynamically extended if needed. Should be non-zero.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_pMemoryAllocator</code></p></td>
<td align="left" valign="top"><p class="table"><code>UMC::MemoryAllocator*</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to external memory allocator. If pointer is <code>NULL</code> the internal memory allocator is used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_bStopAtFrame</code></p></td>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table">Indicator of a stop when frame is constructed or parses whole input chunk. If it stops at the first frame constructed remaining data will be parsed when next portion comes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_bPureStream</code></p></td>
<td align="left" valign="top"><p class="table"><code>bool</code></p></td>
<td align="left" valign="top"><p class="table">Flag to toggle the methods calculating the absolute byte position of constructed frames. It is packet-accurate for streams coming from containers and may be byte-accurate for pure streams.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_79">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 163. FrameConstructor Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes object. Allocates buffer and other
resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">Closes object. Releases buffer and other resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_reset">Reset</a></code></p></td>
<td align="left" valign="top"><p class="table">Resets state of
<code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> object. Flushes all samples, does not release buffer and any resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_softreset">SoftReset</a></code></p></td>
<td align="left" valign="top"><p class="table">Flushes all bytes that follow the
last constructed sample.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_lockinputbuffer">LockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the
UMC::MediaData object that refers to free space in buffer.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_unlockinputbuffer">UnLockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Confirms writing
portion of
data. <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> processes the newly arrived data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_lockoutputbuffer">LockOutputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the
UMC::MediaData object that refers to first sample in the list of constructed samples.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_unlockoutputbuffer">UnLockOutputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Removes the
previously locked sample
from the buffer. If the passed sample does not match the first sample in the list, the method takes no effect.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_getinfo">GetInfo</a></code></p></td>
<td align="left" valign="top"><p class="table">Provides info about the bitstream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_preunlockinputbuffer">PreUnlockInputBuffer</a></code></p></td>
<td align="left" valign="top"><p class="table">Unlocks input
buffer and
tries to construct frame, but the constructed frame is uncommited (can be rolled back).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_getlastframe">GetLastFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Returns the last constructed
frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_frameconstructor_setrate">SetRate</a></code></p></td>
<td align="left" valign="top"><p class="table">Sets playback rate, affects only video
frame constructors.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::MediaReceiverParams *pInit);</code></pre>
</div></div>
<h5 id="_parameters_167" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>pInit</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to UMC::FrameConstructorParams. Must be valid.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code>. The method uses <code><a href="#_umc_memoryallocator">UMC::MemoryAllocator</a></code> pointed to the initialization structure (or creates <code><a href="#_umc_defaultmemoryallocator">UMC::DefaultMemoryAllocator</a></code>) to allocate a buffer of size requested.</p></div>
<h5 id="_return_values_265" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to parameters is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Failed to allocate memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INIT</code></p></td>
<td align="left" valign="top"><p class="table">Initialization failed as the input parameters are incorrect. For example, the number of frames or size of buffer are zero. There may be other causes of the intialization failure.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_close" class="float">Close</h4>
<div class="paragraph"><p><em>Stops the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method stops the object and releases all allocated resources.</p></div>
<h5 id="_return_values_266" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
<hr />
<h4 id="_umc_frameconstructor_reset" class="float">Reset</h4>
<div class="paragraph"><p><em>Resets state of the object.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Reset(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets state of object, flushes all constructed samples but does not release allocated resources.</p></div>
<h5 id="_return_values_267" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_softreset" class="float">SoftReset</h4>
<div class="paragraph"><p><em>Flushes all bytes that follow the last constructed sample.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status SoftReset(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method resets state of object and flushes only unused bytes at the end of the buffer that were not included into any sample. All constructed samples remain unchanged.</p></div>
<div class="paragraph"><p>This method can be used for trick-mode operations when a partial bitstream passes to <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> and bytes that remained after sample construction should be discarded before receiving the next portion of the bitstream.</p></div>
<h5 id="_return_values_268" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_lockinputbuffer" class="float">LockInputBuffer</h4>
<div class="paragraph"><p><em>Locks portion of unused data in input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockInputBuffer(UMC::MediaData *in);</code></pre>
</div></div>
<h5 id="_parameters_168" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to a UMC::MediaData object that should be valid.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method obtains a pointer on a free-to-write portion of data in the internal buffer.
UMC::MediaData method SetDataSize() should return the requested number of bytes.</p></div>
<div class="paragraph"><p>The method differs from other implementations of UMC::MediaBuffer such as <code><a href="#_umc_samplebuffer">UMC::SampleBuffer</a></code> and <code><a href="#_umc_linearbuffer">UMC::LinearBuffer</a></code> where the input data size is determined through initialization parameters and cannot be changed.</p></div>
<h5 id="_return_values_269" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_BUFFER</code></p></td>
<td align="left" valign="top"><p class="table">Insufficient free space in the buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_unlockinputbuffer" class="float">UnLockInputBuffer</h4>
<div class="paragraph"><p><em>Unlocks input buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnLockInputBuffer(UMC::MediaData *in,
                            UMC::Status streamStatus = UMC::UMC_OK);</code></pre>
</div></div>
<h5 id="_parameters_169" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to an object of UMC::MediaData class or derived class, allocated by user, which contains updated information. If it is not <code>NULL</code>, the parameter should specify how much data was written. Pointer can also be <code>NULL</code> that means that zero bytes were written.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>streamStatus</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Current stream status parameter that is UMC::UMC_OK (default value) if the stream continues and UMC::UMC_ERR_END_OF_STREAM if no more data within the current stream is expected.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method unlocks the input buffer. The method informs <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> of a new portion of data to be processed. If <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> constructs a sample, it is added to the list of constructed samples and becomes available through LockOutputBuffer() method.</p></div>
<div class="paragraph"><p><code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> should construct no more than one sample per call. When a sample is constructed, processing of newly arrived portion of data is stopped and the method returns UMC::UMC_OK. At the next call processing continues from the byte that follows the previously constructed sample.</p></div>
<div class="paragraph"><p>To be sure that all written data is processed, the method UnLockInputBuffer() should be called until it returns status UMC::UMC_ERR_NOT_ENOUGH_DATA.</p></div>
<h5 id="_return_values_270" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Not enough data to construct the next sample.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Not enough data to construct the next sample. This code is returned instead of UMC::UMC_ERR_NOT_ENOUGH_DATA after UnlockInputBuffer() or PreUnLockInputBuffer() was called with streamStatus != UMC::UMC_OK.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_lockoutputbuffer" class="float">LockOutputBuffer</h4>
<div class="paragraph"><p><em>Provides access to first constructed sample.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status LockOutputBuffer(UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_170" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to a UMC::MediaData object that should be valid.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns a UMC::MediaData object that refers to the first sample in the list of constructed samples. The next sample is accessible after unlocking the first one.</p></div>
<h5 id="_return_values_271" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData object is <code>NULL</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">No samples are ready.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">The end of stream occured.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_unlockoutputbuffer" class="float">UnLockOutputBuffer</h4>
<div class="paragraph"><p><em>Removes previously locked sample from buffer.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status UnLockOutputBuffer(UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_171" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to a UMC::MediaData object that should be valid.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method removes the previously locked sample from the buffer. Memory address pointed by UMC::MediaData should be the same as provided by LockOutputBuffer(), otherwise no action is performed.</p></div>
<div class="paragraph"><p>The method always removes the whole sample.</p></div>
<h5 id="_return_values_272" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">Pointer to UMC::MediaData object is <code>NULL</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_getinfo" class="float">GetInfo</h4>
<div class="paragraph"><p><em>Provides info about the bitstream.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Mpeg2TrackInfo GetInfo(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method returns pointer to the UMC::Mpeg2TrackInfo structure that presents parameters of the bitstream.</p></div>
<h5 id="_return_values_273" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_preunlockinputbuffer" class="float">PreUnlockInputBuffer</h4>
<div class="paragraph"><p><em>Unlocks input buffer and tries to construct a frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status PreUnLockInputBuffer(UMC::MediaData *in,
                    UMC::Status streamStatus = UMC::UMC_OK)</code></pre>
</div></div>
<h5 id="_parameters_172" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to UMC::MediaData object. If it is not <code>NULL</code>, it specifies how much data were written. If it is <code>NULL</code>, 0 bytes was written.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>streamStatus</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. If doesn&#8217;t equal UMC::UMC_OK, the data will no longer arrive. It forces <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> to return UMC::UMC_ERR_END_OF_STREAM after all constructed samples were received from the buffer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method informs the <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> that a new portion of data was written and should be processed. If <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> constructs a sample it is added into the list of constructed samples, but in contrast to method UnLockInputBuffer() it won&#8217;t be available through LockOutputBuffer() method.</p></div>
<div class="paragraph"><p>If the next frame is constructed by method UnLockInputBuffer() all frames previously constructed by method PreUnLockInputBuffer() will be committed and become available.</p></div>
<div class="paragraph"><p>Frames from PreUnLockInputBuffer() can also be rolled back by calling method
SoftReset().</p></div>
<h5 id="_return_values_274" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Not enough data to constuct the next sample.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_END_OF_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Not enough data to construct the next sample. This code is returned instead of UMC::UMC_ERR_NOT_ENOUGH_DATA after UnlockInputBuffer() or PreUnLockInputBuffer() was one called with streamStatus != UMC::UMC_OK.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_getlastframe" class="float">GetLastFrame</h4>
<div class="paragraph"><p><em>Returns the last frame constructed by UnLockInputBuffer() or PreUnLockInputBuffer().</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetLastFrame(UMC::MediaData *data)</code></pre>
</div></div>
<h5 id="_parameters_173" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>data</em></p></td>
<td align="left" valign="top"><p class="table">Output parameter. Pointer to UMC::MediaData object which is to be copy-assigned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method returns the last frame constructed by UnLockInputBuffer() or
PreUnLockInputBuffer().</p></div>
<h5 id="_return_values_275" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Not a single frame is yet constructed. <code>Init</code> or Reset may just have been called.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">The pointer to the UMC::MediaData object was <code>NULL</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_frameconstructor_setrate" class="float">SetRate</h4>
<div class="paragraph"><p><em>Sets a new playback rate value.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual void SetRate(Ipp64f dRate)</code></pre>
</div></div>
<h5 id="_parameters_174" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>dRate</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. The value of the playback rate.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method sets new playback rate value. It doesn&#8217;t flush constructed frames. It is recommended to Reset() right before or after changing the playback rate.</p></div>
<div class="paragraph"><p>The method affects output order of video frames. It does not affect the
UMC::AudioFrameConstructor.</p></div>
</div>
<div class="sect3">
<h4 id="_usage_examples_32">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>To initialize <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code>, create an instance of the <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> class or a class derived from it and invoke <code>Init()</code> method. The method accepts a pointer of type UMC::MediaReceiverParams* as its single parameter. The reference must refer to an instance of UMC::FrameConstructorParams class, otherwise <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> returns UMC::UMC_ERR_NULL_PTR.</p></div>
<div class="paragraph"><p>The application should determine size of the buffer to be allocated and the initial number of samples to be constructed and stored in the buffer. The application can also pass <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> a memory allocator that will be used for buffer allocation and UMC::TrackInfo object that will be used for copying to UMC::TrackInfo of <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code>.</p></div>
<div class="paragraph"><p><code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> performs two operations: input data flow transformation and extraction of info from input data flow. It is unable to extract certain info from the data flow but obtains this missing information from the component that provides the data flow. <code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> aggregates the info about the data stream and passes the comprehensive information further, if requested.</p></div>
<div class="exampleblock">
<div class="title">Example 64. FrameConstructor Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">GetTrackInfo</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Mpeg2TrackInfo</span><span style="color: #000000">*</span><span style="color: #000000"> info</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// fill info</span>
<span style="color: #000000">}</span>
<span style="color: #000000">.....</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Mpeg2TrackInfo</span><span style="color: #000000"> info</span><span style="color: #000000">;</span>
<span style="color: #000000">GetTrackInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">info</span><span style="color: #000000">);</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FrameConstructor</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">pFC </span><span style="color: #000000">=</span><span style="color: #000000"> NULL</span><span style="color: #000000">;</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">((</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_MPEG1V </span><span style="color: #000000">|</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_MPEG2V</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000"> info</span><span style="color: #000000">.</span><span style="color: #000000">m_Type</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    pFC </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">Mpeg2FrameConstructor</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FrameConstructorParams</span><span style="color: #000000"> fcParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    fcParams</span><span style="color: #000000">.</span><span style="color: #000000">m_nOfFrames </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">10</span><span style="color: #000000">;</span>
<span style="color: #000000">    fcParams</span><span style="color: #000000">.</span><span style="color: #000000">m_lBufferSize </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">1024</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">1024</span><span style="color: #000000">;</span>
<span style="color: #000000">    fcParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pInfo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">info</span><span style="color: #000000">;</span>
<span style="color: #000000">    fcParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pMemoryAllocator </span><span style="color: #000000">=</span><span style="color: #000000"> NULL</span><span style="color: #000000">;</span>
<span style="color: #000000">    pFC</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">fcParams</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_10">De-Initialization</h5>
<div class="paragraph"><p>To de-initialize FrameConstructor, invoke <code>Close()</code> method. The destructor automatically invokes <code>Close()</code> method.</p></div>
</div>
<div class="sect4">
<h5 id="_typical_usage_cases_9">Typical Usage Cases</h5>
<div class="exampleblock">
<div class="title">Example 65. FrameConstructor Usage</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> </span><span style="color: #000000">ReceivePacket</span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">FrameConstructor</span><span style="color: #000000">*</span><span style="color: #000000"> pFC</span><span style="color: #000000">,</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000">*</span><span style="color: #000000"> pData</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(!</span><span style="color: #000000">pData</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> pFC</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">,</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_END_OF_STREAM</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// order space from FrameConstructor's buffer</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> buf</span><span style="color: #000000">;</span>
<span style="color: #000000">    buf</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">((</span><span style="color: #000000">Ipp8u </span><span style="color: #000000">*)</span><span style="color: #000000">1</span><span style="color: #000000">,</span><span style="color: #000000"> pData</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>
<span style="color: #000000">    buf</span><span style="color: #000000">.</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">pData</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pFC</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">buf</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #008000">// put received packet into FrameConstructor</span>
<span style="color: #000000">    </span><span style="color: #000000">ippsCopy_8u</span><span style="color: #000000">((</span><span style="color: #000000">Ipp8u </span><span style="color: #000000">*)</span><span style="color: #000000">pData</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(),</span>
<span style="color: #000000">                    </span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u </span><span style="color: #000000">*)</span><span style="color: #000000">buf</span><span style="color: #000000">.</span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(),</span><span style="color: #000000"> pData</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>

<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pFC</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">buf</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #008000">// frame constructed</span>
<span style="color: #000000">        pFC</span><span style="color: #000000">-&gt;</span><span style="color: #000000">LockOutputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">buf</span><span style="color: #000000">);</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> pFC</span><span style="color: #000000">-&gt;</span><span style="color: #000000">UnLockOutputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">buf</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>

<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_28">Important Technical Information</h4>
<div class="paragraph"><div class="title">Memory Usage</div><p><code><a href="#_umc_frameconstructor">UMC::FrameConstructor</a></code> allocates a buffer the size of which is determined by user. It also dynamically allocates small structures for representation of constructed samples.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_36">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_frame_constructor.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;samples-dir&gt;\sources\audio-video-codecs\codec\demuxer\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP libraries: ipps.</p></div>
<div class="paragraph"><div class="title">Macros</div><p><em>BIG_ENDIAN</em> is a macro for big-endian platforms. It is applied for LPCM audio tracks only.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_umc_sceneanalyzer">UMC::SceneAnalyzer</h3>
<div class="paragraph"><p><code><a href="#_umc_sceneanalyzer">UMC::SceneAnalyzer</a></code> is an auxiliary derived class that provides functionality for detecting scene change in sequences of uncompressed frames and setting an appropriate type of encoding.</p></div>
<div class="paragraph"><p>The analyzer tracks several parameters of the frames that are being analyzed. When most of the tracked parameters of the current frame are close to the parameters of the previous frames, no scene changing is observed. When most of the parameters clearly differ from the corresponding parameters of the previous frames, the analyzer reports scene changing.</p></div>
<div class="paragraph"><p>For tracking purpose, the analyzer keeps the working parameters of eight frames that were previously analyzed. The range of parameters can vary. In the current implementation, the working set of parameters contains an average frame color, intra dispersion, inter dispersion, and a number of exactly matching blocks.</p></div>
<div class="sect4">
<h5 id="_derivation_18">Derivation</h5>
<div class="paragraph"><p>The class is derived from UMC::BaseCodec Class.</p></div>
</div>
<div class="sect4">
<h5 id="_see_also_22">See Also</h5>
<div class="paragraph"><p>UMC::BaseCodec class.</p></div>
</div>
<div class="sect3">
<h4 id="_user_interface_37">User Interface</h4>
<div class="paragraph"><div class="title">Related Types</div><p>The <code><a href="#_umc_sceneanalyzer">UMC::SceneAnalyzer</a></code> uses the UMC::SceneAnalyzerParam class as the initializing parameter in the <code>Init</code> method. See Ta ble 5-81 for the members of the class:</p></div>
<div class="tableblock" id="tab_umc_5_81">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 164. SceneAnalyzerParams Members</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Name                   </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>m_maxGOPLength</code></p></td>
<td align="left" valign="top"><p class="table">Sets the maximum distance between consequent I-frames. A non-positive value means that I-frames are used only when the scene has been changed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_maxBLength</code></p></td>
<td align="left" valign="top"><p class="table">Sets the maximum distance between any two reference frames.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_maxDelayTime</code></p></td>
<td align="left" valign="top"><p class="table">Not used in this implementation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>m_interlaceType</code></p></td>
<td align="left" valign="top"><p class="table">Specifies the interlacing type of the source frame sequence.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_5_82">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 165. SceneAnalyzer Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method         </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sceneanalyzer_init">Init</a></code></p></td>
<td align="left" valign="top"><p class="table">Initializes an instance of the
<code><a href="#_umc_sceneanalyzer">UMC::SceneAnalyzer</a></code> class, sets it into the ready-to-analyze state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sceneanalyzer_getframe">GetFrame</a></code></p></td>
<td align="left" valign="top"><p class="table">Analyzes the next frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><a href="#_umc_sceneanalyzer_close">Close</a></code></p></td>
<td align="left" valign="top"><p class="table">De-initializes an instance of the class, releases all internal resources.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_sceneanalyzer_init" class="float">Init</h4>
<div class="paragraph"><p><em>Initializes an instance of the class.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Init(UMC::BaseCodecParams *params);</code></pre>
</div></div>
<h5 id="_parameters_175" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>params</em></p></td>
<td align="left" valign="top"><p class="table">Input parameter. Pointer to an instance of the UMC::SceneAnalyzerParams class or a derived class, which contains specific information for initialization of an instance of the analyzer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method initializes an instance of the <code><a href="#_umc_sceneanalyzer">UMC::SceneAnalyzer</a></code> class and sets it into the ready-to-analyze state, that is, the method initializes internal data for subsequent frame analysis.</p></div>
<div class="paragraph"><p>Note that before the initialization process starts, the analyzer calls the <code>Close</code> method. So the <code>Init</code> method can be called many times in series.</p></div>
<h5 id="_return_values_276" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table"><code>NULL</code> pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">No free dynamic memory is available for internal frame buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_sceneanalyzer_getframe" class="float">GetFrame</h4>
<div class="paragraph"><p><em>Analyzes the next frame.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status GetFrame(UMC::MediaData *in, UMC::MediaData *out);</code></pre>
</div></div>
<h5 id="_parameters_176" class="float">Parameters</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><em>in</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an instance of the UMC::VideoData class or a derived class, which contains a source frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><em>out</em></p></td>
<td align="left" valign="top"><p class="table">Input/Output parameter. Pointer to an instance of the UMC::VideoData class or a derived class, which contains a buffer for the analyzed source frame. After a successful analysis, the object updates the m_FrameType member of the UMC::VideoData object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><div class="title">Description</div><p>The method analyzes the next frame. The analyzer copies it into the internal buffer, compares with the previous frame, and returns the result of the operation.</p></div>
<div class="paragraph"><p>The stream analyzer uses frame-level dependence analysis. So at the end of the decoding process the <code>NULL</code> input pointer is supposed to be passed into the analyzer as a source to get buffered sources frames.</p></div>
<div class="paragraph"><p>Both the input and output pointers should hold valid addresses of the corresponding classes.</p></div>
<div class="paragraph"><p>After analysis is completed, the object provides a pointer to the internal buffer that holds a copy of the source frame. The object copies frames into the internal buffer to enable correct B-frame detection.</p></div>
<div class="paragraph"><p>Note, that the analyzer is configured to detect only I &amp; P frames, there is no frame latency. Result of the analysis can be obtained through GetFrameType of the UMC::VideoData object.</p></div>
<h5 id="_return_values_277" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table">One or more pointers hold <code>NULL</code> value, one or more pointers are not pointers to the UMC::VideoData class instances or UMC::VideoData instances have incorrect plane pointers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Initialization process has not been started before this method is called.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_INVALID_STREAM</code></p></td>
<td align="left" valign="top"><p class="table">Incorrect color format was specified.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_ALLOC</code></p></td>
<td align="left" valign="top"><p class="table">Method is unable to allocate memory needed for internal buffers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">One-frame latency is made for correct B-frame detection. The next frame should be provided to get the current frame.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_ERR_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">The parameters hold invalid values.</p></td>
</tr>
</tbody>
</table>
</div>
<hr />
<h4 id="_umc_sceneanalyzer_close" class="float">Close</h4>
<div class="paragraph"><p><em>De-initializes an instance of the class.</em></p></div>
<div class="listingblock">
<div class="title">Syntax</div>
<div class="content">
<pre><code>virtual UMC::Status Close(void);</code></pre>
</div></div>
<div class="paragraph"><div class="title">Description</div><p>The method de-initializes the object, frees all allocated memory and releases all internal resources.</p></div>
<div class="paragraph"><p>This method is optional because it is called from the <code>Init</code> method and the destructor automatically.</p></div>
<h5 id="_return_values_278" class="float">Return Values</h5>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OK</code></p></td>
<td align="left" valign="top"><p class="table">Successful operation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/warning.png" alt="Warning" />
</td>
<td class="content">The <code>Close</code> function releases all resources. None of the object methods should be called and no object resources can be used after calling Close.
The only exception is the <code>Init</code> method.</td>
</tr></table>
</div>
</div>
<div class="sect3">
<h4 id="_usage_examples_33">Usage Examples</h4>
<div class="paragraph"><div class="title">Initialization</div><p>The analyzer uses an instance of the UMC::SceneAnalyzerParams class for initialization. The most typical parameters are as follows:</p></div>
<div class="ulist"><ul>
<li>
<p>
m_maxGOPLength is set to zero to produce I-frames only when the scene is changing
</p>
</li>
<li>
<p>
m_maxBLength is set to the desired number of subsequent B-frames. Typically half a second of the subsequent B-frames is enough. It means 12 frames for PAL and
15 frames for NTSC systems
</p>
</li>
<li>
<p>
m_interlaceType should reflect the kind of source video stream. PROGRESSIVE means a progressive stream, any other value means that an interlaced stream is being processed.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Using default parameters, the analyzer is initialized without any non-fixed GOP structure, does not detect B-frames and treats all frames as progressive.</p></div>
<div class="exampleblock">
<div class="title">Example 66. SceneAnalyzer Initialization</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">SceneAnalyzer</span><span style="color: #000000"> analyzer</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">SceneAnalyzerParams</span><span style="color: #000000"> analyzerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span>

<span style="color: #008000">// initialization of the analyzer</span>
<span style="color: #000000">umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> analyzer</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoParams</span><span style="color: #000000">);</span>
<span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> umcRes</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span></tt></pre></div></div>
</div></div>
<div class="sect4">
<h5 id="_de_initialization_11">De-Initialization</h5>
<div class="paragraph"><p>De-initialization is done as follows:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>// release the analyzer
analyzer.Close();</code></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_typical_usage_cases_10">Typical Usage Cases</h5>
<div class="paragraph"><p>Typically, objects of the <code><a href="#_umc_sceneanalyzer">UMC::SceneAnalyzer</a></code> class are used for consecutive frame analysis.</p></div>
<div class="exampleblock">
<div class="title">Example 67. SceneAnalyzer Main Cycle</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> videoSrc</span><span style="color: #000000">,</span><span style="color: #000000"> videoDst</span><span style="color: #000000">;</span>

<span style="color: #008000">//</span>
<span style="color: #008000">// MAIN WORKING CYCLE</span>
<span style="color: #008000">//</span>
<span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// get somewhere a source frame</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">get_source_frame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoSrc</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>

<span style="color: #000000">    </span><span style="color: #008000">// try to analyze a frame</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> analyzer</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoSrc</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// a frame was analyzed successfully</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #008000">// process the analyzed frame</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">encode_or_do_something</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// correct return value for UMC_ERR_NOT_ENOUGH_DATA</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
<div class="paragraph"><p>After successful analysis of the stream all buffered frames should be obtained from the analyzer.</p></div>
<div class="exampleblock">
<div class="title">Example 68. SceneAnalyzer Finalizing Cycle</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #008000">//</span>
<span style="color: #008000">// FINISHING CYCLE</span>
<span style="color: #008000">//</span>
<span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #008000">// try to analyze a frame</span>
<span style="color: #000000">    umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> analyzer</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">// a frame was analyzed successfully</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">==</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #008000">// process an analyzed frame</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">encode_or_do_something</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoDst</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK </span><span style="color: #000000">!=</span><span style="color: #000000"> umcRes</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// something is wrong</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">else</span>
<span style="color: #000000">        umcRes </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">;</span><span style="color: #000000"> </span><span style="color: #008000">// correct return value for</span>
<span style="color: #000000">                              </span><span style="color: #008000">// UMC::UMC_ERR_NOT_ENOUGH_DATA</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_important_technical_information_29">Important Technical Information</h4>
<div class="paragraph"><div class="title">Threading Capabilities</div><p>The analyzer does not spawn any internal threads and cannot be used by different threads simultaneously.</p></div>
<div class="paragraph"><div class="title">Memory Usage</div><p>Mainly, the analyzer allocates memory  only for internal frame storing. For every frame,
the analyzer keeps original sample data and its reduced clone for analysis.</p></div>
<div class="paragraph"><p>Typical memory usage in case of a YUV420 VGA stream is 640x480x1.5x(3 + 3/4) = ~1.7Mb.</p></div>
</div>
<div class="sect3">
<h4 id="_build_specific_information_37">Build Specific Information</h4>
<div class="paragraph"><div class="title">Header name</div><p>umc_scene_analyzer.h</p></div>
<div class="listingblock">
<div class="title">Include paths to required UMC components</div>
<div class="content">
<pre><code>&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\vm_plus\include
&lt;samples-dir&gt;\sources\audio-video-codecs\core\umc\include
&lt;samples-dir&gt;\sources\audio-video-codecs\codec\color_space_converter\include
$(IPPROOT)\include</code></pre>
</div></div>
<div class="paragraph"><div class="title">Link dependencies</div><p>UMC components:</p></div>
<div class="ulist"><ul>
<li>
<p>
umc
</p>
</li>
<li>
<p>
vm
</p>
</li>
<li>
<p>
vm_plus
</p>
</li>
<li>
<p>
color_space_converter
</p>
</li>
</ul></div>
<div class="paragraph"><p>IPP: ippcorel, ippvc, ippi, ipps.</p></div>
</div>
</div>
</div>
</div>
<h1 id="_6_virtual_machine_library">6. Virtual Machine Library</h1>
<div class="paragraph"><p>The Virtual Machine (VM) library is a small set of primitive functions that are critical for media codec development. VM functions are OS-dependent but they have common interface for any operating system and provide independence of media codecs from a specific OS. As a result, adapting a codec to a new operation system requires minimum effort.</p></div>
<div class="paragraph"><p>The VM library is implemented in C and includes the following groups of functions:</p></div>
<div class="tableblock" id="tab_umc_6_1">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 166. Groups of VM Functions</caption>
<col width="33%" />
<col width="66%" />
<thead>
<tr>
<th align="left" valign="top">Group Name                  </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">Threading Functions</p></td>
<td align="left" valign="top"><p class="table">Implement threading control.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Event Functions</p></td>
<td align="left" valign="top"><p class="table">Emulate Windows* OS events.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Mutex Functions</p></td>
<td align="left" valign="top"><p class="table">Synchronize threads.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Semaphore Functions</p></td>
<td align="left" valign="top"><p class="table">Control access to limited resources.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Memory Mapping</p></td>
<td align="left" valign="top"><p class="table">Functions Map files to physical addresses in the memory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Timing Functions</p></td>
<td align="left" valign="top"><p class="table">Perform time measurement.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">File Functions</p></td>
<td align="left" valign="top"><p class="table">Provide wrappers for all functions to meet requirements of different operating systems.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">System Information</p></td>
<td align="left" valign="top"><p class="table">Functions Obtain system information (memory size, disk space, amount of CPUs, etc.)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">Debugging Functions</p></td>
<td align="left" valign="top"><p class="table">Provide debugging information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Timing and debugging functions are support functions.</p></div>
<div class="sect1">
<h2 id="_definitions">Definitions</h2>
<div class="sectionbody">
<div class="paragraph"><p>The VM library defines the following data types or macros for cross-OS development:</p></div>
<div class="tableblock" id="tab_umc_6_2">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 167. VM Library Definitions</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Data Type               </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_char</code></p></td>
<td align="left" valign="top"><p class="table">String data type. Byte in most cases but may be integer in the case of Unicode encoding.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_time_handle</code></p></td>
<td align="left" valign="top"><p class="table">An abstract handle for a timing object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_tick</code></p></td>
<td align="left" valign="top"><p class="table">64-bit data type used for timing functions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><strong>Macro</strong></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_ALIGN_DECL(x,y)</code></p></td>
<td align="left" valign="top"><p class="table">An alignment macro for data variables or arrays. X is the alignment bits and Y is the actual data definition. Examples include VM_ALIGN_DECL(16,int) variable and VM_ALIGN_DECL(32,int), array[100].</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_ALIGN32_DECL(y)</code></p></td>
<td align="left" valign="top"><p class="table">Same as VM_ALIGN_DECL(32,y).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_ALIGN16_DECL(y)</code></p></td>
<td align="left" valign="top"><p class="table">Same as VM_ALIGN_DECL(16,y).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code><strong>Structure</strong></code></p></td>
<td align="left" valign="top"><p class="table"></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_thread</code></p></td>
<td align="left" valign="top"><p class="table">An abstract structure for threading functions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_event</code></p></td>
<td align="left" valign="top"><p class="table">An abstract structure for event functions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_mmap</code></p></td>
<td align="left" valign="top"><p class="table">An abstract structure for memory mapping functions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_mutex</code></p></td>
<td align="left" valign="top"><p class="table">An abstract structure for mutex functions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_semaphore</code></p></td>
<td align="left" valign="top"><p class="table">An abstract structure for semaphore functions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_time</code></p></td>
<td align="left" valign="top"><p class="table">An abstract structure for specific time information for time arithmetics.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_debug</code></p></td>
<td align="left" valign="top"><p class="table">A set of debugging functions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_socket</code></p></td>
<td align="left" valign="top"><p class="table">An abstract structure for network connection functions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_timeval</code></p></td>
<td align="left" valign="top"><p class="table">An abstract structure for current time information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_timezone</code></p></td>
<td align="left" valign="top"><p class="table">An abstract structure for timezone specific information.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Function names in the VM library have the following general format:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>vm_&lt;function group&gt;_&lt;operation tag&gt;;</code></pre>
</div></div>
<div class="paragraph"><p>The function group elements represent contracted names of VM groups of function. The values are as follows:</p></div>
<div class="tableblock">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<col width="25%" />
<col width="75%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>thread</code></p></td>
<td align="left" valign="top"><p class="table">Threading functions</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>event</code></p></td>
<td align="left" valign="top"><p class="table">Event functions</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>mutex</code></p></td>
<td align="left" valign="top"><p class="table">Mutex functions</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>mmap</code></p></td>
<td align="left" valign="top"><p class="table">Memory mapping functions</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>semaphore</code></p></td>
<td align="left" valign="top"><p class="table">Semaphore functions</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>file</code></p></td>
<td align="left" valign="top"><p class="table">File functions</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>sys_info</code></p></td>
<td align="left" valign="top"><p class="table">System information functions</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>time</code></p></td>
<td align="left" valign="top"><p class="table">Timing functions</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>debug</code></p></td>
<td align="left" valign="top"><p class="table">Debugging functions</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The operation tag element represents the operations performed by the respective function and may be expressed by one or two words, for example: terminate, set_invalid, reset.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_error_codes">Error Codes</h2>
<div class="sectionbody">
<div class="paragraph"><p>VM functions return status codes of the performed operation to report errors to the calling program. Thus, it is up to the application to perform error-related actions and/or recover from the error. The last value of the error status is not stored, and the user is to decide whether to check it or not as the function returns.
The status codes are of vm_status type and are global constant integers.</p></div>
<div class="paragraph"><p>The status codes and corresponding messages reported by the VM functions for data processing are listed in the next table.</p></div>
<div class="tableblock" id="tab_umc_6_3">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 168. Status Codes and Messages</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Status Code        </th>
<th align="left" valign="top">Message</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_OK</code></p></td>
<td align="left" valign="top"><p class="table">The operation is performed successfully.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>UMC_OPERATION_FAILED</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_NOT_INITIALIZED</code></p></td>
<td align="left" valign="top"><p class="table">Object is not yet initialized.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_TIMEOUT</code></p></td>
<td align="left" valign="top"><p class="table">Operation failed to complete successfully within reasonable time.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_NOT_ENOUGH_DATA</code></p></td>
<td align="left" valign="top"><p class="table">Not enough input data to process data.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_NULL_PTR</code></p></td>
<td align="left" valign="top"><p class="table"><code>NULL</code> pointer is passed to the function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_SO_CANT_LOAD</code></p></td>
<td align="left" valign="top"><p class="table">Shared object failed to be loaded.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_SO_INVALID_HANDLE</code></p></td>
<td align="left" valign="top"><p class="table">The current stream contains an error or errors.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>VM_SO_CANT_GET_ADDR</code></p></td>
<td align="left" valign="top"><p class="table">Function address failed to be located inside the shared object.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_threading_functions">Threading Functions</h2>
<div class="sectionbody">
<div class="paragraph"><p>VM threading functions implement a set of threading control functions for various operating systems. Hence the threading model is different for any OS.</p></div>
<div class="paragraph"><p>In the VM threading model, a parent thread is responsible for creating and closing of a thread. Closing a thread is important to avoid memory leak. Changing a thread priority or terminating a thread is possible but may fail. In this case, wait till the thread terminates itself.</p></div>
<div class="paragraph"><p>Thread synchronization is implemented via other means, such as mutexes or semaphores.</p></div>
<div class="tableblock" id="tab_umc_6_4">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 169. Threading Functions</caption>
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_thread_set_invalid(vm_thread *thread);</code></p></td>
<td align="left" valign="top"><p class="table">Invalidates the thread handler by marking the thread object referred by thread as uninitialized. DO NOT call this function after the thread creation as it is used for constructors and for initial object setup only.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_thread_is_valid(vm_thread *thread);</code></p></td>
<td align="left" valign="top"><p class="table">Returns 1 if the thread handler is valid, 0 otherwise.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_thread_create(vm_thread *thread, vm_thread_callback func, void *arg);</code></p></td>
<td align="left" valign="top"><p class="table">Creates a thread. The thread function func takes the protocol: void*(*vm_thread_callback)(void *); The parameter arg is an arbitrary user-defined argument to be passed to the thread. The function returns 1 if the thread is successfully created. The thread is running after the call.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_thread_wait(vm_thread *thread);</code></p></td>
<td align="left" valign="top"><p class="table">Blocks execution until a specified thread is terminated. vm_thread_wait function closes thread handle after thread termination (implemented for Win32 only). After successful thread creation by vm_thread_create, call vm_thread_wait or vm_thread_terminate function to close thread handle to return system handle to the system for reuse.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_thread_set_priority(vm_thread *thread, vm_thread_priority priority);</code></p></td>
<td align="left" valign="top"><p class="table">Changes the thread priority. The priority takes the following values: typedef enum { VM_THREAD_PRIORITY_HIGHEST, VM_THREAD_PRIORITY_HIGH, VM_THREAD_PRIORITY_NORMAL, VM_THREAD_PRIORITY_LOW, VM_THREAD_PRIORITY_LOWEST } vm_thread_priority; If successful, the function returns 1. There is no guarantee that the thread is assigned the specified priority even after a successful return.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_thread_close(vm_thread *thread);</code></p></td>
<td align="left" valign="top"><p class="table">Closes the thread, if it is not needed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_thread_priority vm_get_current_thread_priority(void);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the priority of the current thread.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_set_current_thread_priority(vm_thread_prio rity priority);</code></p></td>
<td align="left" valign="top"><p class="table">Tries to set new priority for the current thread. Result of the operation may be obtained by the vm_get_current_priority function.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_event_functions">Event Functions</h2>
<div class="sectionbody">
<div class="paragraph"><p>VM event functions emulate Windows* OS events. An event has a state of high (signaled) or low (non-signaled). VM event functions include functions that set the event state and wait for a change in the event state. If an event is automatic, the event state returns to low state. Otherwise, the event is set to non-signaled state manually.</p></div>
<div class="tableblock" id="tab_umc_6_5">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 170. Event Functions</caption>
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_event_set_invalid(vm_event *event);</code></p></td>
<td align="left" valign="top"><p class="table">Invalidates the event handler by marking the event object referred by event as uninitialized. DO NOT call this function after the event creation as it is used for constructors and for initial object setup only.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_event_is_valid(vm_event *event);</code></p></td>
<td align="left" valign="top"><p class="table">Returns 1 if the event handler is valid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_event_init(vm_event *event, Ipp32s manual, Ipp32s state);</code></p></td>
<td align="left" valign="top"><p class="table">Initializes the event handler. The value manual determines the event type: Manual (non-zero) and Automatic (zero). The value state determines the initial state of the event: High (non-zero) and Low (zero).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_event_signal(vm_event *event);</code></p></td>
<td align="left" valign="top"><p class="table">Manually sets event state to signaled.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_event_reset(vm_event *event);</code></p></td>
<td align="left" valign="top"><p class="table">Manually sets event state to unsignaled.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_event_pulse(vm_event *event);</code></p></td>
<td align="left" valign="top"><p class="table">Sets the event to state HIGH and then back to state LOW.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_event_wait(vm_event *event);</code></p></td>
<td align="left" valign="top"><p class="table">Blocks execution until the event becomes signaled (state HIGH).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_event_timed_wait(vm_event *event, Ipp32u msec);</code></p></td>
<td align="left" valign="top"><p class="table">The function returns immediately if the event is in HIGH state, or blocks execution for msec milliseconds and returns 1 if the event is in HIGH state. The value msec can be zero for a non-blocking test on the event state.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_event_destroy(vm_event *event);</code></p></td>
<td align="left" valign="top"><p class="table">Destroys the event handler.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mutex_functions">Mutex Functions</h2>
<div class="sectionbody">
<div class="paragraph"><p>Mutex is one of the many ways to synchronize threads. A code segment protected by mutex can only be accessed from a single thread at a time.</p></div>
<div class="tableblock" id="tab_umc_6_6">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 171. Mutex Functions</caption>
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_mutex_set_invalid(vm_mutex *mutex);</code></p></td>
<td align="left" valign="top"><p class="table">Invalidates the mutex handler by marking the mutex object referred by mutex as uninitialized. DO NOT call this function after the mutex creation as it is used for constructors and for initial object setup only.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_mutex_is_valid(vm_mutex *mutex);</code></p></td>
<td align="left" valign="top"><p class="table">Returns 0 if the mutex handler is valid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_mutex_init(vm_mutex *mutex);</code></p></td>
<td align="left" valign="top"><p class="table">Initializes a mutex handler. Returns VM_OK, if successful.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_mutex_lock(vm_mutex *mutex);</code></p></td>
<td align="left" valign="top"><p class="table">Locks the mutex object. If the mutex is already locked by a different thread, the execution is blocked until the mutex is unlocked.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_mutex_unlock(vm_mutex *mutex);</code></p></td>
<td align="left" valign="top"><p class="table">Unlocks the mutex object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_mutex_try_lock(vm_mutex *mutex);</code></p></td>
<td align="left" valign="top"><p class="table">Attempts to lock the mutex object without blocking the execution. If the mutex can be locked, returns VM_OK. Otherwise, returns UMC_ERR_TIMEOUT or UMC_ERR_NOT_INITIALIZED.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_mutex_destroy(vm_mutex *mutex);</code></p></td>
<td align="left" valign="top"><p class="table">Destroys the mutex handler.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_semaphore_functions">Semaphore Functions</h2>
<div class="sectionbody">
<div class="paragraph"><p>Semaphore functions control access to limited resources. A typical usage of semaphores is consumer and producer model in some buffers. The producer fills the buffer and the consumer drains the buffer. The semaphores control access to the buffer and protect the buffer from overflow or underflow.</p></div>
<div class="tableblock" id="tab_umc_6_7">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 172. Semaphore Functions</caption>
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_semaphore_set_invalid(vm_semaphore *sem);</code></p></td>
<td align="left" valign="top"><p class="table">Invalidates the semaphore handler by marking semaphore object referred by semaphore sem as uninitialized. DO NOT call this function after the semaphore creation as it is used for constructors and for initial object setup only.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_semaphore_is_valid(vm_semaphore *sem);</code></p></td>
<td align="left" valign="top"><p class="table">Returns 1 if the semaphore handler is valid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_semaphore_init(vm_semaphore *sem, Ipp32s init_count);</code></p></td>
<td align="left" valign="top"><p class="table">Initializes the semaphore handler. The semaphore is set to init_count.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_semaphore_wait(vm_semaphore *sem, Ipp32u msec);</code></p></td>
<td align="left" valign="top"><p class="table">Decreases the semaphore count. If the semaphore count before decrease is zero, the execution is blocked until the count is greater than zero. msec parameter refers to timeout in milliseconds. If timeout expires before semaphore count becomes nonzero, function returns UMC_ERR_TIMEOUT.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_semaphore_timedwait(vm_semaphore *sem, Ipp32u msec);</code></p></td>
<td align="left" valign="top"><p class="table">Decreases the semaphore value by blocking for msec milliseconds. Returns VM_OK, if successful.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_semaphore_try_wait(vm_semaphore *sem);</code></p></td>
<td align="left" valign="top"><p class="table">Returns UMC_ERR_TIMEOUT, if the semaphore count is zero. Otherwise, decreases the semaphore count. This is a non-blocking function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_semaphore_post(vm_semaphore *sem);</code></p></td>
<td align="left" valign="top"><p class="table">Increases the semaphore count.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_semaphore_destroy(vm_semaphore *sem);</code></p></td>
<td align="left" valign="top"><p class="table">Releases the semaphore handler.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_memory_mapping_functions">Memory Mapping Functions</h2>
<div class="sectionbody">
<div class="paragraph"><p>Memory mapping functions map a file on the disk to a physical address in the memory. Compared with loading the entire file into memory, memory mapping takes advantage of dynamic paging features of the underlying OS.</p></div>
<div class="tableblock" id="tab_umc_6_8">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 173. Memory Mapping Functions</caption>
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_mmap_set_invalid(vm_mmap *handle);</code></p></td>
<td align="left" valign="top"><p class="table">Invalidates the memory mapping handler by marking mmap object referred by handle as uninitialized. DO NOT call this function after the mmap creation as it is used for constructors and for initial object setup only.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_mmap_is_valid(vm_mmap *handle);</code></p></td>
<td align="left" valign="top"><p class="table">Returns 1 if the mmap handler is valid.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64u vm_mmap_create(vm_mmap *handle, vm_char *file, Ipp32s fileAttr);</code></p></td>
<td align="left" valign="top"><p class="table">Creates a mmap handler. The argument file points to a valid file name. The function returns the size of the mapped file. The following enumerator defines possible values of fileAttr: enum { FLAG_ATTRIBUTE_READ = 0x00000001, FLAG_ATTRIBUTE_WRITE  = 0x00000002 };</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void *vm_mmap_set_view(vm_mmap *handle, Ipp64u *offset, Ipp64u *size);</code></p></td>
<td align="left" valign="top"><p class="table">Obtains an address pointer to a specific range of the file (view). The range is specified by offset and size . If successful, a valid address is returned, and offset and size are adjusted according to OS page restrictions. Otherwise, <code>NULL</code> pointer is returned.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u vm_mmap_get_page_size(void);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the page size. Each view of the mapped file is a multiple of page size.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u vm_mmap_get_alloc_granularity(void);</code></p></td>
<td align="left" valign="top"><p class="table">Returns allocation granularity.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_mmap_unmap(vm_mmap *handle);</code></p></td>
<td align="left" valign="top"><p class="table">Cancels the previous view of the mapped file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_mmap_close(vm_mmap *handle);</code></p></td>
<td align="left" valign="top"><p class="table">Destroys the mmap handler.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_timing_functions">Timing Functions</h2>
<div class="sectionbody">
<div class="paragraph"><p>Different platforms provide different mechanisms of time measurement. The VM library provides the functions to support timing on various OSs.</p></div>
<div class="tableblock" id="tab_umc_6_9">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 174. Timing Functions</caption>
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_time_sleep(Ipp32u msec);</code></p></td>
<td align="left" valign="top"><p class="table">Blocks execution of the current thread for msec milliseconds. If msec = 0, the function blocks the current thread till the next time slice is available.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_tick vm_time_get_tick(void);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the number of system clock ticks. The value is platform-dependent. The function provides accurate time estimation for time-critical operations. For data accuracy reasons, the return value of this function is not used directly. Rather, the delta is used of the ticks from a period of operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_tick vm_time_get_frequency(void);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the frequency of the clock tick.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_time_open(vm_time_handle *handle);</code></p></td>
<td align="left" valign="top"><p class="table">Creates the object of time measurement.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_time_init(vm_time *m);</code></p></td>
<td align="left" valign="top"><p class="table">Initializes the object of time measurement</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_time_start(vm_time_handle handle, vm_time *m);</code></p></td>
<td align="left" valign="top"><p class="table">Starts time measurement.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64f vm_time_stop(vm_time_handle handle, vm_time *m);</code></p></td>
<td align="left" valign="top"><p class="table">Stops time measurement and obtains the sampling time in seconds.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_time_close(vm_time_handle *handle);</code></p></td>
<td align="left" valign="top"><p class="table">Closes the object of time measurement.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_status vm_time_gettimeofday(struct vm_timeval *TP, struct vm_timezone *TZP);</code></p></td>
<td align="left" valign="top"><p class="table">Fills the TP structure with the time passed from Jan 1, 1970. No support for time zone so TZP must be <code>NULL</code> otherwise <code>VM_NOT_INITIALIZED</code> is returned. Time value structure is defined as struct vm_timeval { Ipp32u tv_sec;  /* seconds passed from 1-jan-1970 <strong>/ long int tv_usec; /</strong> microseconds remaining */ };</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_time_timeradd(struct vm_timeval* destination, struct vm_timeval* src1, struct vm_timeval* src2);</code></p></td>
<td align="left" valign="top"><p class="table">Performs destination = src1 + src2.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_time_timersub(struct vm_timeval* destination, struct vm_timeval* src1, struct vm_timeval* src2);</code></p></td>
<td align="left" valign="top"><p class="table">Performs destination = src1 - src2.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_time_timercmp(struct vm_timeval* src1, struct vm_timeval* src2, struct vm_timeval* threshold);</code></p></td>
<td align="left" valign="top"><p class="table">Compares vm_timeval operands; returns 0 if src1 = src2, -1  if src1 &lt; src2, 1 if src1 &gt; src2.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_file_functions">File Functions</h2>
<div class="sectionbody">
<div class="paragraph"><p>File functions are the specially designed wrappers for the file operations. The main goal is to prepare a set of functions with the same behavior for all operating systems. All vm_file_xx functions have 64-bit files support.</p></div>
<div class="paragraph"><p>The file functions have their own definitions for widely using constants: File attributes:</p></div>
<div class="paragraph"><p>VM_FILE_ATTR_FILE , VM_FILE_ATTR_DIRECTORY, VM_FILE_ATTR_LINK, VM_FILE_ATTR_HIDDEN</p></div>
<div class="paragraph"><p>File seek:</p></div>
<div class="paragraph"><p>VM_FILE_SEEK_SET, VM_FILE_SEEK_CUR, VM_FILE_SEEK_END</p></div>
<div class="paragraph"><p>Standard files:</p></div>
<div class="paragraph"><p>vm_stdin, vm_stdout, vm_stderr.</p></div>
<div class="paragraph"><p>All file functions have the same behavior as defined for the standard C runtime and their names are created as</p></div>
<div class="paragraph"><p>vm_file_standard_C_runtime_function_name.</p></div>
<div class="tableblock" id="tab_umc_6_10">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 175. File Functions</caption>
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64u vm_file_fseek(vm_file *fd, Ipp64s position, VM_FILE_SEEK_MODE mode);</code></p></td>
<td align="left" valign="top"><p class="table">Moves the file pointer to position according to the mode. Mode may be set in line with one of the following values: VM_FILE_SEEK_SET, VM_FILE_SEEK_CUR, VM_FILE_SEEK_END.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64u vm_file_ftell(vm_file *fd);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the current offset of the file pointer from the beginning of the file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_file_getinfo(const vm_char *filename, Ipp64u *file_size, Ipp32u *file_attr);</code></p></td>
<td align="left" valign="top"><p class="table">Fills file_size and file_attr fields for the selected filename. File attributes are an OR combination of the following values: VM_FILE_ATTR_FILE , VM_FILE_ATTR_DIRECTORY, VM_FILE_ATTR_LINK, VM_FILE_ATTR_HIDDEN.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_file *vm_file_fopen(const vm_char *fname, const vm_char *mode);</code></p></td>
<td align="left" valign="top"><p class="table">Attempts to open or create file fname according to the mode. Returns the address of the file descriptor structure or <code>NULL</code>, if failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_file_fclose(vm_file *fd);</code></p></td>
<td align="left" valign="top"><p class="table">Closes the file by the handle. If the file is temporary, it is deleted.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_file_feof(vm_file* fd);</code></p></td>
<td align="left" valign="top"><p class="table">Returns non-zero if the end of the file is reached.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_file_remove(vm_char *path);</code></p></td>
<td align="left" valign="top"><p class="table">Removes a file or a directory entry (if empty).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_file_fflush(vm_file *fd);</code></p></td>
<td align="left" valign="top"><p class="table">Flushes or updates written data (cache writing).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_char *vm_file_fgets(vm_char *str, int nchar, vm_file *fd);</code></p></td>
<td align="left" valign="top"><p class="table">Reads a string from the file in the same manner as fgets, returns pointer to the string.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_file_fputs(vm_char *str, vm_file *fd);</code></p></td>
<td align="left" valign="top"><p class="table">Writes a string to the file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_file_fscanf(vm_file *fd,vm_char *format, &#8230;);</code></p></td>
<td align="left" valign="top"><p class="table">Reads formatted data from the file. Returns the number of parameters parsed. All restrictions are the same as for the fscanf.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_file_fprintf(vm_file *fd,vm_char *format, &#8230;);</code></p></td>
<td align="left" valign="top"><p class="table">Same as fprintf but maximum buffer size is limited at 8192.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_file_vfprintf(vm_file *fd, vm_char *format, va_list argptr);</code></p></td>
<td align="left" valign="top"><p class="table">Similar to vfprintf but with the same restrictions as for the vm_file_fprintf.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_file *vm_file_tmpfile(void);</code></p></td>
<td align="left" valign="top"><p class="table">Prepares a temporary file name and creates a corresponding file. Returns the address of the current file descriptor or <code>NULL</code>, if failed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_char *vm_file_tmpnam(vm_char *RESULT);</code></p></td>
<td align="left" valign="top"><p class="table">Fills RESULT with a generated temporary file name. If RESULT is equal to <code>NULL</code>, then a new character buffer is created. RESULT buffer must have enough size to hold the whole filename. No runtime check is performed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_char *vm_file_tmpnam_r(vm_char *RESULT);</code></p></td>
<td align="left" valign="top"><p class="table">The same as tmpnam but if RESULT is equal to <code>NULL</code>, no name is generated. <code>NULL</code> is returned.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_char *vm_file_tempnam(vm_char *DIR, vm_char *PREFIX);</code></p></td>
<td align="left" valign="top"><p class="table">Prepares a temporary name using path and prefix information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_file_getpath(vm_char *filename, vm_char *path, int nchars);</code></p></td>
<td align="left" valign="top"><p class="table">Extracts path from the full filename to path. Path length may be up to nchars symbols, other symbols will be omitted. For example, after vm_file_getpath("c:\\windows_temporar y_path\test.file", s, 128) s will contain c:\windows_temporary_path.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_file_getbasename(vm_char *filename, vm_char *base, int nchars);</code></p></td>
<td align="left" valign="top"><p class="table">Extracts only the file name from the full file name. File name is truncated to nchars symbols. For example, after vm_file_getbasename("c:\\windows_temp orary_path\test.file", s, 128) s will contain test.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_file_getsuffix(vm_char *filename, vm_char *suffix, int nchars);</code></p></td>
<td align="left" valign="top"><p class="table">Extracts only the suffix from a full or restricted (without path) filename. The suffix may have up to nchars symbols. For example, after vm file_getsuffix("c:\\windows_tempo rary_path\test.file", s, 128) s will contain file.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_file_makefilename(vm_char *path, vm_char *base, vm_char *suffix, vm_char *filename, int nchars);</code></p></td>
<td align="left" valign="top"><p class="table">Links path, base, and suffix to form a full filename. Any part of the filename may be omitted. For example, after vm_file_makefilename(<code>NULL</code>, "test", "fil", s, MAX_PATH) s will be test.fil.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_dir_remove(vm_char *path);</code></p></td>
<td align="left" valign="top"><p class="table">Removes the file or directory specified by path. Returns 0, if OK.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_dir_mkdir(vm_char *path);</code></p></td>
<td align="left" valign="top"><p class="table">Creates a new, empty directory with name path. Returns 0, if OK. Links path, base, and suffix to form a full filename. Any part of the filename may be omitted. For example, after vm_file_makefilename(NULL, "test", "fil", s, MAX_PATH) s will be test.fil.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_dir_open(vm_dir **dd, vm_char *path);</code></p></td>
<td align="left" valign="top"><p class="table">Similar to Unix opendir</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32s vm_dir_read(vm_dir *dd, vm_char *filename, int nchars);</code></p></td>
<td align="left" valign="top"><p class="table">Similar to Unix readdir</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_dir_close(vm_dir *dd);</code></p></td>
<td align="left" valign="top"><p class="table">Similar to Unix closedir</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp64u vm_dir_get_free_disk_space(void);</code></p></td>
<td align="left" valign="top"><p class="table">VM specific function to read the amount of free space on the current disk drive. The function returns a total number of free bytes on drive or a remaining disk quota for multi-user OSs.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_system_information_functions">System Information Functions</h2>
<div class="sectionbody">
<div class="paragraph"><p>The VM library provides a set of functions to obtain current system state. These functions are used to collect system information in various multithreaded real-time applications.</p></div>
<div class="tableblock" id="tab_umc_6_11">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 176. System Information Functions</caption>
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_sys_info_get_cpu_name(vm_char *name);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the CPU name as it is defined in the system.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_sys_info_get_date(vm_char *m_date, DateFormat df);</code></p></td>
<td align="left" valign="top"><p class="table">Prepares the current system date in one of the predefined formats (DateFormat enum definition): DDMMYY - day:month:year MMDDYY - month:day:year YYMMDD - year:month:day The m_date buffer must be sufficient to hold the date string and must be initialized with spaces.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_sys_info_get_time(vm_char *m_time, TimeFormat tf);</code></p></td>
<td align="left" valign="top"><p class="table">Prepares the current system time in one of the predefined formats (TimeFormat enum definition): HHMMSS - hour:minute;second HHMM - hour:minute HHMMSSMS1 - hour:minute:second:millisecond/100 HHMMSSMS2 - hour:minute:second:millisecond/10 HHMMSSMS3 - hour:minute:second:millisecond The m_time buffer must be sufficient to hold the time string and must be initialized with spaces.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_sys_info_get_vga_card(vm_char *vga_card);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the vga card name, if possible.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_sys_info_get_os_name(vm_char *os_name);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the OS name.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_sys_info_get_computer_name(vm_char *computer_name);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the computer name string.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_sys_info_get_program_name(vm_char *program_name);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the current program name.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_sys_info_get_program_path(vm_char *program_path);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the current program path.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_sys_info_get_program_description(vm_char *program_description);</code></p></td>
<td align="left" valign="top"><p class="table">This is only a pattern that will be filled later.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u vm_sys_info_get_cpu_speed(void);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the CPU speed in Mhz. For multi-CPU system the first CPU frequency is returned.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u vm_sys_info_get_mem_size(void);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the memory size in Mbytes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u vm_sys_info_get_avail_cpu_num(void);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the number of currently available CPUs in the system. The system may contain any number of CPU and any number of them may be disabled or set unavailable.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Ipp32u vm_sys_info_get_cpu_num(void);</code></p></td>
<td align="left" valign="top"><p class="table">Returns the total amount of CPUs in the current system.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_debugging_functions">Debugging Functions</h2>
<div class="sectionbody">
<div class="paragraph"><p>The VM library supports debugging information output of various levels. The output is leveled bit-wise so that debugging information can be selectively printed out. The exact output is OS- or platform-dependent. It can be presented via console output or in a message box in a windowing system.</p></div>
<div class="paragraph"><p>See the following enumerator for the levels of detailization:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>typedef enum{                           /* debug level */
    VM_DEBUG_NONE = 0x0000,             /* none of the debug levels */
    VM_DEBUG_ERROR  = 0x0001,           /* critical errors */
    VM_DEBUG_WARNING  = 0x0002,         /* warning/non-critical errors */
    VM_DEBUG_INFO  = 0x0004,            /* general attribute information */
    VM_DEBUG_MEMORY = 0x0008,           /* new/delete and alloc/free information */
    VM_DEBUG_PROGRESS = 0x0010,         /* general progressive information */
    VM_DEBUG_CALL = 0x0020,             /* information about calls */
    VM_DEBUG_VERBOSE = 0x0040,          /* other information */
    VM_DEBUG_LOG_ALL = 0x00FF,          /* all information */
    VM_DEBUG_SHOW_FILELINE = 0x0100,    /* show filename &amp; line info in the
                                           logging message */
    VM_DEBUG_SHOW_DIRECTORY = 0x0200,   /* show filename with directory */
    VM_DEBUG_SHOW_TIME = 0x0400,        /* show time info in the logging message */
    VM_DEBUG_SHOW_PID = 0x0800,         /* show thread PID in the logging message */
    VM_DEBUG_SHOW_FUNCTION = 0x1000,    /* show function name */
    VM_DEBUG_SHOW_LEVEL = 0x2000,       /* show level in the logging message */
    VM_DEBUG_SHOW_ALL = 0xFF00,         /* show all */
    VM_DEBUG_ALL = 0xFFFF               /* all above */
} vm_debug_level;</code></pre>
</div></div>
<div class="paragraph"><p>The following enumerator defines the log output direction:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>typedef enum {          /* debug output */
    VM_DEBUG_AUTO = 0,  /* automatic (stdio for console app,
                           OutputDebugString for win32 app) */
    VM_DEBUG_CONSOLE = 0x10000, /* stdio or stderr */
    VM_DEBUG_SYSLOG = 0x20000,  /* OutputDebugString or syslog */
    VM_DEBUG_FILE = 0x40000     /* append to a debug file */
} vm_debug_output;</code></pre>
</div></div>
<div class="tableblock" id="tab_umc_6_12">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 177. Debugging Functions</caption>
<col width="40%" />
<col width="60%" />
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_debug_level vm_debug_setlevel(vm_debug_level level);</code></p></td>
<td align="left" valign="top"><p class="table">Sets detailization level.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_debug_output vm_debug_setoutput(vm_debug_output output);</code></p></td>
<td align="left" valign="top"><p class="table">Sets log output direction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_debug_setfile(vm_char *file, Ipp32s truncate);</code></p></td>
<td align="left" valign="top"><p class="table">Sets the file for log output.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_debug_message(const vm_char *format, &#8230;);</code></p></td>
<td align="left" valign="top"><p class="table">Rises a message box in Win32* systems or prints message to the standard output in Linux* systems, using the set level.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>void vm_debug_trace_ex(Ipp32s level, const void *ptr_this, const vm_char *func_name,constvm_char*file_name, Ipp32s line, const vm_char *format, &#8230;);</code></p></td>
<td align="left" valign="top"><p class="table">Prints debugging information as output formatted line without limitation to the number of parameters.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="tableblock" id="tab_umc_6_13">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 178. Debugging Macros</caption>
<col width="40%" />
<col width="60%" />
<thead>
<tr>
<th align="left" valign="top">Macro               Description</th>
<th align="left" valign="top">vm_debug_trace(level, format)                   </th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Calls vm_debug_trace_ex without additional parameters.</code></p></td>
<td align="left" valign="top"><p class="table">vm_debug_trace1(level, format, a1)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Calls vm_debug_trace_ex with parameter a1. vm_debug_trace2(level, format, a1, a2) Calls vm_debug_trace_ex with parameters a1,a2.</code></p></td>
<td align="left" valign="top"><p class="table">vm_debug_trace3(level, format, a1, a2, a3)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Calls vm_debug_trace_ex with parameters a1,a2, a3.</code></p></td>
<td align="left" valign="top"><p class="table">vm_debug_trace_withfunc(level, func, format)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The remaining format and variable arguments are the same as in the printf function. The debugging level is controlled by a compile time macro VM_DEBUG. If VM_DEBUG is unset, debugging output is ignored.</p></div>
</div>
</div>
<h1 id="_7_shared_objects_classes">7. Shared Objects Classes</h1>
<div class="paragraph"><p>The shared objects classes are intended for creation of plugin-based cross-platform applications and provide the same interface for each platform. The application is divided into the main part and components. The main part can link the components dynamically (in runtime) or statically (in linking time). Static linking allows functionality of some basic components to be provided within the application. Both types of linking can be used together.</p></div>
<div class="paragraph"><p>The main part of application uses Object Factory (further "Factory") for component instance creation. The Factory loads and registers all required components, provides interfaces for creation and destruction of an object. A component provides Object interface for registration inside Factory.</p></div>
<div class="imageblock" id="fig_umc_7_1">
<div class="content">
<img src="images/umc/umc_7_1.png" alt="images/umc/umc_7_1.png" />
</div>
<div class="title">Figure 58. Interaction of Interfaces in Shared Objects Classes</div>
</div>
<div class="paragraph"><p>A different OS has a different interface for using dynamic-link libraries (DLL). To avoid platform dependence, VM Library functions are used. Any component is represented as DLL-library (for Windows* OS), SO-library (for Linux* OS) or DYLD-library (for OS X* OS).</p></div>
<div class="paragraph"><p>Example of using those classes illustrated below, in example section.</p></div>
<div class="sect1">
<h2 id="_vm_library_functions_for_shared_objects">VM Library Functions for Shared Objects</h2>
<div class="sectionbody">
<div class="paragraph"><p>The functions provide basic functionality for shared objects.</p></div>
<div class="tableblock" id="tab_umc_7_1">
<table rules="rows"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 179. VM Library Functions for Shared Objects</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Function Name       </th>
<th align="left" valign="top">Operation</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_so_load</code></p></td>
<td align="left" valign="top"><p class="table">Loads a shared object file into application address space.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_so_get_addr</code></p></td>
<td align="left" valign="top"><p class="table">Returns the address of an exported object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>vm_so_free</code></p></td>
<td align="left" valign="top"><p class="table">Unloads a shared object file from application address space.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The vm_so_load function returns the descriptor of the loaded library of vm_so_handle type.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_object_class">Object Class</h2>
<div class="sectionbody">
<div class="paragraph"><p>This class provides interface for creation and destruction of an object. The class also includes control of the object instances life circle.</p></div>
<div class="tableblock" id="tab_umc_7_2">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 180. Object Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method Name                     </th>
<th align="left" valign="top">Operation</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Create</code></p></td>
<td align="left" valign="top"><p class="table">Creates instance of the provided class.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Destroy</code></p></td>
<td align="left" valign="top"><p class="table">Destroys instance (includes mechanism of object creator control, and does not allow destroying a compatible object created outside).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetName</code></p></td>
<td align="left" valign="top"><p class="table">Returns pointer to the string name of the provided object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetVersion</code></p></td>
<td align="left" valign="top"><p class="table">Returns pointer to the string version of the provided object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Try</code></p></td>
<td align="left" valign="top"><p class="table">Returns result of data block checking.The method returns: &gt; 0, if the object supports the data 0, if the object does not support data -1, if the required functionality is not implemented.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetObjectType</code></p></td>
<td align="left" valign="top"><p class="table">Returns pointer to the string object type of the provided object.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>A plug-in can include any number of components. Each plug-in returns a list of implemented components through ObjectsList class:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>struct ObjectsList
{
    Object* p_begin; // the first object in list.
    ObjectsList* p_next; // pointer to the next list
    vm_so_handle handle; // handle of plug-in
}</code></pre>
</div></div>
<div class="paragraph"><p>The class includes two static member functions:</p></div>
<div class="tableblock" id="tab_umc_7_3">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 181. ObjectList Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method Name         </th>
<th align="left" valign="top">Operation</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Load</code></p></td>
<td align="left" valign="top"><p class="table">Loads plug-in and returns the list of components that are exported from this plug-in.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Free</code></p></td>
<td align="left" valign="top"><p class="table">Unloads plug-in.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The global function ObjectReg is also available for registering a single object in the list of components.</p></div>
<div class="paragraph"><p>Objects can be organized into groups. Each group can have additional properties and features, for example, AudioCodecObject, SplitterObject, etc. To provide object type control, the member function GetObjectType is used. Two macros provide a feature of the object:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>OBJECT_TYPE_DECL(); // is used in a class declaration
OBJECT_TYPE_IMPL(); // is used in a class implementation</code></pre>
</div></div>
<div class="paragraph"><p>To check object type, a function of the following template is used:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>template &lt;class T&gt;
bool ObjectTypeCheck(T* p_object); // Returns true if the object is compatible
                                   //with type T.</code></pre>
</div></div>
<div class="paragraph"><p>For the Object class the function ObjectTypeCheck is redefined and always returns true
because all objects are compatible with the Object.</p></div>
<div class="paragraph"><p>To simplify object implementation, class template SimpleObject can be used:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>template &lt;class component, class parent = Object&gt; class SimpleObject :
public parent
{
protected:
    vm_char* m_component_name;
    vm_char* m_component_version;
public:
     SimpleObject(vm_char* component_name, vm_char* component_version = NULL);
...
}</code></pre>
</div></div>
<div class="paragraph"><p>The template implements only base functionality (Create, Destroy, Try, etc.), and all objects are inherited from Object by default.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_factory_class">Factory Class</h2>
<div class="sectionbody">
<div class="paragraph"><p>The class provides interface for Shared Objects loading, and registration in the Factory. The class includes templates for getting access to objects.</p></div>
<div class="tableblock" id="tab_umc_7_4">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 182. Factory Class Methods</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Method Name             </th>
<th align="left" valign="top">Operation</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Load</code></p></td>
<td align="left" valign="top"><p class="table">Loads a shared object from the file of DLL-library or SO-library.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>InitStatic</code></p></td>
<td align="left" valign="top"><p class="table">Initializes static components, that is, adds all statically linked components to the Factory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>GetObjectsList</code></p></td>
<td align="left" valign="top"><p class="table">Returns the pointer to the list of objects registered in the Factory.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The Factory also includes class template Iterator. The template can serve as iterator for a list of objects registered in the Factory.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>template &lt;class T = Object&gt;
class Iterator
{
...
public:
    Iterator();
    Iterator(Factory&amp; factory);
...
}</code></pre>
</div></div>
<div class="tableblock" id="tab_umc_7_5">
<table rules="none"
width="100%"
frame="void"
cellspacing="0" cellpadding="4">
<caption class="title">Table 183. Iterator Member Functions</caption>
<col width="25%" />
<col width="75%" />
<thead>
<tr>
<th align="left" valign="top">Function Name       </th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>Iterator()</code></p></td>
<td align="left" valign="top"><p class="table">Default constructor; iterator points to static components.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Iterator(Factory&amp;)</code></p></td>
<td align="left" valign="top"><p class="table">Constructor; iterator points to the first Object in the Factory. The first parameter passes reference of the Factory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>Find</code></p></td>
<td align="left" valign="top"><p class="table">Finds an object by name. If the object is found, the method sets iterator pointer to this object and returns true, else returns false.The first parameter passes the name.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The following C<code> operators are also defined: =, </code>, ==, !=, &#8594;.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_examples">Examples</h2>
<div class="sectionbody">
<div class="exampleblock">
<div class="title">Example 69. Plug-in Project (without using SimpleObject template)</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"object.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"ex_component.h"</span>
<span style="color: #008000">// For example "ex_component.h" includes declaration of</span>
<span style="color: #008000">// ExComponent class</span>
<span style="color: #0000ff">class</span><span style="color: #000000"> </span><span style="color: #000000">ExObject</span><span style="color: #000000"> </span><span style="color: #000000">:</span><span style="color: #000000"> </span><span style="color: #0000ff">public</span><span style="color: #000000"> Object</span>
<span style="color: #000000">{</span>
<span style="color: #0000ff">public</span><span style="color: #000000">:</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">Create</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> </span><span style="color: #0000ff">void</span><span style="color: #000000">  </span><span style="color: #000000">Destroy</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">*);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">virtual</span><span style="color: #000000"> vm_char</span><span style="color: #000000">*</span><span style="color: #000000"> </span><span style="color: #000000">GetName</span><span style="color: #000000">();</span>
<span style="color: #000000">...</span><span style="color: #008000">// All other methods are also defined and implemented.</span>
<span style="color: #000000">}</span>
<span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000"> ExObject</span><span style="color: #000000">::</span><span style="color: #000000">Create</span><span style="color: #000000">()</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> ExComponent</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #0000ff">void</span><span style="color: #000000"> ExObject</span><span style="color: #000000">::</span><span style="color: #000000">Destroy</span><span style="color: #000000">(</span><span style="color: #0000ff">void</span><span style="color: #000000">*</span><span style="color: #000000"> pExComponent</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">delete</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">ExComponent</span><span style="color: #000000">*)</span><span style="color: #000000">pExComponent</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #000000">vm_char</span><span style="color: #000000">*</span><span style="color: #000000"> ExObject</span><span style="color: #000000">::</span><span style="color: #000000">GetName</span><span style="color: #000000">()</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000"> </span><span style="color: #A31515">"ExComponent"</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>

<span style="color: #0000ff">static</span><span style="color: #000000"> </span><span style="color: #000000">ExObject</span><span style="color: #000000"> g_object</span><span style="color: #000000">;</span>
<span style="color: #0000ff">static</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> b_ex_object </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ObjectReg</span><span style="color: #000000">(&amp;</span><span style="color: #000000">g_object</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="exampleblock">
<div class="title">Example 70. Plug-in Project (using SimpleObject template)</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"object.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"simple_object.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"ex_component.h"</span>
<span style="color: #008000">// For example "ex_component.h" includes declaration of</span>
<span style="color: #008000">// ExComponent class</span>
<span style="color: #0000ff">static</span><span style="color: #000000"> </span><span style="color: #000000">SimpleObject&lt;ExComponent&gt;</span><span style="color: #000000"> </span><span style="color: #000000">g_object</span><span style="color: #000000">(</span><span style="color: #A31515">"ExComponent"</span><span style="color: #000000">);</span>
<span style="color: #0000ff">static</span><span style="color: #000000"> </span><span style="color: #0000ff">bool</span><span style="color: #000000"> b_ex_object </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ObjectReg</span><span style="color: #000000">(&amp;</span><span style="color: #000000">g_object</span><span style="color: #000000">);</span></tt></pre></div></div>
</div></div>
<div class="exampleblock">
<div class="title">Example 71. Application Project</div>
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"factory.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"object.h"</span>
<span style="color: #0000ff">#include</span><span style="color: #000000"> </span><span style="color: #A31515">"ex_component.h"</span>
<span style="color: #008000">// For example "ex_component.h" includes declaration of</span>
<span style="color: #008000">// ExComponent class</span>
<span style="color: #0000ff">int</span><span style="color: #000000"> </span><span style="color: #000000">main</span><span style="color: #000000">()</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">Factory</span><span style="color: #000000"> factory</span><span style="color: #000000">;</span>
<span style="color: #000000">    Factory</span><span style="color: #000000">::</span><span style="color: #000000">Iterator&lt;Object&gt;</span><span style="color: #000000"> iterator</span><span style="color: #000000">;</span>
<span style="color: #000000">    ExComponent</span><span style="color: #000000">*</span><span style="color: #000000">  pExComponent</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #008000">// Initialization, etc.</span>
<span style="color: #000000">    factory</span><span style="color: #000000">.</span><span style="color: #000000">Load</span><span style="color: #000000">(</span><span style="color: #A31515">"ExComponent.dll"</span><span style="color: #000000">);</span>
<span style="color: #000000">    factory</span><span style="color: #000000">.</span><span style="color: #000000">Load</span><span style="color: #000000">(</span><span style="color: #A31515">"ExComponent_2.dll"</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">    iterator </span><span style="color: #000000">=</span><span style="color: #000000"> factory</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">...</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">iterator</span><span style="color: #000000">.</span><span style="color: #000000">Find</span><span style="color: #000000">(</span><span style="color: #A31515">"ExComponent"</span><span style="color: #000000">))</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        pExComponent </span><span style="color: #000000">=</span><span style="color: #000000"> iterator</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Create</span><span style="color: #000000">();</span>
<span style="color: #000000">        </span><span style="color: #008000">// pExComponent is fully available here in case of</span>
<span style="color: #000000">        </span><span style="color: #008000">// none runtime error. pExComponent-&gt;Do();</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">else</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #008000">// Component of Type "Object" with name</span>
<span style="color: #000000">        </span><span style="color: #008000">// "ExComponent" is not found return 1;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">...</span>

<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<h1 id="_a_getting_started_with_intel_174_ipp_unified_media_classes_sample">A. Getting Started with Intel&#174; IPP Unified Media Classes Sample</h1>
<div class="paragraph"><p>This appendix shows how to use some basic UMC classes to build a simple decoder or encoder and to use a splitter or a muxer. For additional information, see the UMC sample code applications at \audio-video-codecs\application.</p></div>
<div class="sect1">
<h2 id="_creating_a_simple_decoder">Creating a simple decoder</h2>
<div class="sectionbody">
<div class="paragraph"><p>The UMC::VideoDecoder class provides basic interfaces to video decoders. It uses methods that perform initialization of the decoder, decompression of the frame, destroying of the decoder, etc. To complete a video decoding process, use a class derived from UMC::VideoDecoder (for example,  UMC::H264VideoDecoder, UMC::MPEG4VideoDecoder).</p></div>
<div class="paragraph"><p>To use a UMC decoder, perform the following steps:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Set the decoding parameters in the UMC::VideoDecoderParams class.
</p>
</li>
<li>
<p>
Initialize a VideoDecoder class with UMC::VideoDecoderParams.
</p>
</li>
<li>
<p>
Call the GetFrame() method in the UMC::VideoDecoder class to get the decoded frames.
</p>
</li>
<li>
<p>
Call the GetFrame() method with the <code>NULL</code> input pointer to get buffered decoded frames left by the decoder.
</p>
</li>
</ol></div>
<div class="paragraph"><p>The sample code below decodes a raw H.264 video stream in cVideoData, places the decoded YUV data into the cYUVData buffer, and sets the image size and the decoded frame number. Please click here to get a full sample code:</p></div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">DecodeStream</span><span style="color: #000000">(</span><span style="color: #000000"> </span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">cVideoData</span><span style="color: #000000">,</span><span style="color: #0000ff">int</span><span style="color: #000000"> VideoDataSize</span><span style="color: #000000">,</span>
<span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">cYUVData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">int</span><span style="color: #000000">&amp;</span><span style="color: #000000"> imgWidth</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">int</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000"> imgHeight</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">int</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">frameNumber </span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> status</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> DataIn</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> DataOut</span><span style="color: #000000">;</span>

<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> Params</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264VideoDecoder</span><span style="color: #000000"> H264Decoder</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> frameSize</span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cVideoData</span><span style="color: #000000">,</span><span style="color: #000000">VideoDataSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">VideoDataSize</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #008000">//use default paramter, threading number=1</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">DataIn</span><span style="color: #000000">;</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">lFlags</span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">numThreads</span><span style="color: #000000">=</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000"> H264Decoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">Params</span><span style="color: #000000">)!=</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>

<span style="color: #000000">    H264Decoder</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">Params</span><span style="color: #000000">);</span>
<span style="color: #000000">    imgWidth</span><span style="color: #000000">=</span><span style="color: #000000">Params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">;</span>
<span style="color: #000000">    imgHeight</span><span style="color: #000000">=</span><span style="color: #000000">Params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">;</span>

<span style="color: #000000">    frameSize </span><span style="color: #000000">=</span><span style="color: #000000"> imgWidth</span><span style="color: #000000">*</span><span style="color: #000000">imgHeight</span><span style="color: #000000">*</span><span style="color: #000000">3</span><span style="color: #000000">/</span><span style="color: #000000">2</span><span style="color: #000000">;</span>
<span style="color: #000000">    DataOut</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">imgWidth</span><span style="color: #000000">,</span><span style="color: #000000">imgHeight</span><span style="color: #000000">,</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">YV12</span><span style="color: #000000">,</span><span style="color: #000000">8</span><span style="color: #000000">);</span>
<span style="color: #000000">    DataOut</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cYUVData</span><span style="color: #000000">,</span><span style="color: #000000">frameSize</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> exit_flag</span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">,</span><span style="color: #000000"> frameNumber</span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        status </span><span style="color: #000000">=</span><span style="color: #000000"> H264Decoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">DataIn</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">DataOut</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            cYUVData </span><span style="color: #000000">+=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">frameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">            DataOut</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">frameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">            frameNumber</span><span style="color: #000000">++;</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000">((</span><span style="color: #000000">status </span><span style="color: #000000">!=</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)||(</span><span style="color: #000000">frameNumber </span><span style="color: #000000">&gt;=</span><span style="color: #000000">MAXFRAME</span><span style="color: #000000">))</span>
<span style="color: #000000">            exit_flag </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">exit_flag</span><span style="color: #000000">!=</span><span style="color: #000000">1</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        status </span><span style="color: #000000">=</span><span style="color: #000000"> H264Decoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">DataOut</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            cYUVData </span><span style="color: #000000">+=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">frameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">            DataOut</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cYUVData</span><span style="color: #000000">,</span><span style="color: #000000">frameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">            frameNumber</span><span style="color: #000000">++;</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_simple_encoder">Creating a simple encoder</h2>
<div class="sectionbody">
<div class="paragraph"><p>The UMC::VideoEncoder class provides interfaces to video encoders. To complete a UMC video encoding process, use a class derived from UMC::VideoEncoder (for example, UMC::H264VideoEncoder, UMC::MPEG2VideoEncoder, UMC::MPEG4VideoEncoder) to compress input data.</p></div>
<div class="paragraph"><p>To use a UMC encoder, perform the following steps:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Set the encoding parameters with the  UMC::VideoEncoderParams class or its derived class.
</p>
</li>
<li>
<p>
Initialize a VideoEncoder class.
</p>
</li>
<li>
<p>
Call the GetFrame() method in the UMC::VideoEncoder class to get the encoded frames. The method performs the encoding frame by frame.
</p>
</li>
</ol></div>
<div class="paragraph"><p>The sample code below encodes the YUV data in the cYUVData memory buffer into an H.264 video stream. The encoded h.264 data is placed into the cVideoData buffer. Please click here to get a full sample code:</p></div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EncodeStream</span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">cYUVData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">int</span><span style="color: #000000"> imgWidth</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">int</span><span style="color: #000000"> imgHeight</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #0000ff">int</span><span style="color: #000000"> frameNumber</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">cVideoData</span><span style="color: #000000">,</span><span style="color: #0000ff">int</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">VideoDataSize </span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> status</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> DataOut</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> DataIn</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264EncoderParams</span><span style="color: #000000"> Params</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264VideoEncoder</span><span style="color: #000000"> H264Encoder</span><span style="color: #000000">;;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> FrameSize</span><span style="color: #000000">;</span>

<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">key_frame_controls</span><span style="color: #000000">.</span><span style="color: #000000">method</span><span style="color: #000000">=</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">=</span><span style="color: #000000">imgHeight</span><span style="color: #000000">;</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">=</span><span style="color: #000000">imgWidth</span><span style="color: #000000">;</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">bitrate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1000000</span><span style="color: #000000">;</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">((</span><span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000"> H264Encoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">Params</span><span style="color: #000000">))!=</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>

<span style="color: #000000">    FrameSize </span><span style="color: #000000">=</span><span style="color: #000000"> imgWidth</span><span style="color: #000000">*</span><span style="color: #000000">imgHeight</span><span style="color: #000000">*</span><span style="color: #000000">3</span><span style="color: #000000">/</span><span style="color: #000000">2</span><span style="color: #000000">;</span>
<span style="color: #000000">    DataIn</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">imgWidth</span><span style="color: #000000">,</span><span style="color: #000000">imgHeight</span><span style="color: #000000">,</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">YV12</span><span style="color: #000000">,</span><span style="color: #000000">8</span><span style="color: #000000">);</span>
<span style="color: #000000">    DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cYUVData</span><span style="color: #000000">,</span><span style="color: #000000">FrameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">FrameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    DataOut</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cVideoData</span><span style="color: #000000">,</span><span style="color: #000000">MAXVIDEOSIZE</span><span style="color: #000000">);</span>
<span style="color: #000000">    VideoDataSize</span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> nEncodedFrames</span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000"> nEncodedFrames </span><span style="color: #000000">&lt;</span><span style="color: #000000"> frameNumber</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        status </span><span style="color: #000000">=</span><span style="color: #000000"> H264Encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">DataIn</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">DataOut</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            nEncodedFrames</span><span style="color: #000000">++;</span>
<span style="color: #000000">            VideoDataSize</span><span style="color: #000000">+=</span><span style="color: #000000">DataOut</span><span style="color: #000000">.</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">();</span>
<span style="color: #000000">            DataOut</span><span style="color: #000000">.</span><span style="color: #000000">MoveDataPointer</span><span style="color: #000000">(</span><span style="color: #000000">DataOut</span><span style="color: #000000">.</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>

<span style="color: #000000">            cYUVData</span><span style="color: #000000">+=</span><span style="color: #000000">FrameSize</span><span style="color: #000000">;</span>
<span style="color: #000000">            DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cYUVData</span><span style="color: #000000">,</span><span style="color: #000000">FrameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">            DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">FrameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_using_a_splitter">Using a splitter</h2>
<div class="sectionbody">
<div class="paragraph"><p>The Intel&#174; IPP UMC splitter separates audio, video, and auxiliary elementary streams (ES) from several file formats (MPEG TS stream, MP4, and AVI). The splitter class receives data from the UMC::DataReader interface.
To use a UMC splitter, perform the following steps:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Set splitter parameters in the UMC::SplitterParams class.
</p>
</li>
<li>
<p>
Call the <code>Init()</code> method to perform initialization of the splitter according to the input parameter.
</p>
</li>
<li>
<p>
Call the GetInfo() method to collect information on the processed stream.
</p>
</li>
<li>
<p>
Call the Run() method to run the internal processing thread(s).
</p>
</li>
<li>
<p>
Call the GetNextData() and CheckNextData() methods to obtain the next data chunk from the stream.
</p>
</li>
</ol></div>
<div class="paragraph"><p>The sample below uses an MP4 splitter to separate H.264 video data and an H.264 decoder to decode the video stream. Please click here to get the complete sample code.</p></div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EncodeStream</span><span style="color: #000000">(</span><span style="color: #000000">vm_char </span><span style="color: #000000">*</span><span style="color: #000000"> inputfilename</span><span style="color: #000000">,</span><span style="color: #000000"> vm_char </span><span style="color: #000000">*</span><span style="color: #000000"> outputfilename </span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp32u</span><span style="color: #000000"> videoTrack</span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> exit_flag </span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> status</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> in</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> out</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FIOReader</span><span style="color: #000000"> reader</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileReaderParams</span><span style="color: #000000"> readerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterParams</span><span style="color: #000000"> splitterParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">SplitterInfo </span><span style="color: #000000">*</span><span style="color: #000000"> streamInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MP4Splitter</span><span style="color: #000000"> Splitter</span><span style="color: #000000">;</span>

<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">videoInfo</span><span style="color: #000000">=</span><span style="color: #000000">NULL</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder </span><span style="color: #000000">*</span><span style="color: #000000"> videoDecoder</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoderParams</span><span style="color: #000000"> videoDecParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FWVideoRender</span><span style="color: #000000"> fwRender</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FWVideoRenderParams</span><span style="color: #000000"> fwRenderParams</span><span style="color: #000000">;</span>

<span style="color: #000000">    readerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_portion_size </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">vm_string_strcpy</span><span style="color: #000000">(</span><span style="color: #000000">readerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> inputfilename</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">((</span><span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000"> reader</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">readerParams</span><span style="color: #000000">))!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">    splitterParams</span><span style="color: #000000">.</span><span style="color: #000000">m_lFlags </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VIDEO_SPLITTER</span><span style="color: #000000">;</span>
<span style="color: #000000">    splitterParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pDataReader </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">reader</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">((</span><span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000"> Splitter</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">splitterParams</span><span style="color: #000000">))!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">    Splitter</span><span style="color: #000000">.</span><span style="color: #000000">GetInfo</span><span style="color: #000000">(&amp;</span><span style="color: #000000">streamInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">for</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">videoTrack </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">0</span><span style="color: #000000">;</span><span style="color: #000000"> videoTrack </span><span style="color: #000000">&lt;</span><span style="color: #000000"> streamInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_nOfTracks</span><span style="color: #000000">;</span><span style="color: #000000"> videoTrack</span><span style="color: #000000">++)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">streamInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">videoTrack</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_Type </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TRACK_H264</span><span style="color: #000000">)</span>
<span style="color: #000000">            </span><span style="color: #0000ff">break</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    videoInfo </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000">*)(</span><span style="color: #000000">streamInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">videoTrack</span><span style="color: #000000">]-&gt;</span>
<span style="color: #000000">                    m_pStreamInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">stream_type</span><span style="color: #000000">!=</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264_VIDEO</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">    videoDecParams</span><span style="color: #000000">.</span><span style="color: #000000">info </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(*</span><span style="color: #000000">videoInfo</span><span style="color: #000000">);</span>
<span style="color: #000000">    videoDecParams</span><span style="color: #000000">.</span><span style="color: #000000">m_pData </span><span style="color: #000000">=</span>
<span style="color: #000000">            streamInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">m_ppTrackInfo</span><span style="color: #000000">[</span><span style="color: #000000">videoTrack</span><span style="color: #000000">]-&gt;</span><span style="color: #000000">m_pDecSpecInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    videoDecParams</span><span style="color: #000000">.</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    videoDecoder </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoDecoder</span><span style="color: #000000">*)(</span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264VideoDecoder</span><span style="color: #000000">());</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">((</span><span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000"> videoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">videoDecParams</span><span style="color: #000000">))!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">    fwRenderParams</span><span style="color: #000000">.</span><span style="color: #000000">out_data_template</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">,</span>
<span style="color: #000000">                videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">,</span><span style="color: #000000"> videoInfo</span><span style="color: #000000">-&gt;</span><span style="color: #000000">color_format</span><span style="color: #000000">);</span>
<span style="color: #000000">    fwRenderParams</span><span style="color: #000000">.</span><span style="color: #000000">pOutFile </span><span style="color: #000000">=</span><span style="color: #000000"> outputfilename</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000"> fwRender</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">fwRenderParams</span><span style="color: #000000">)!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">    Splitter</span><span style="color: #000000">.</span><span style="color: #000000">Run</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">in</span><span style="color: #000000">.</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">()</span><span style="color: #000000"> </span><span style="color: #000000">&lt;</span><span style="color: #000000"> </span><span style="color: #000000">4</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span><span style="color: #000000"> status</span><span style="color: #000000">=</span><span style="color: #000000"> Splitter</span><span style="color: #000000">.</span><span style="color: #000000">GetNextData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">,</span><span style="color: #000000">videoTrack</span><span style="color: #000000">);</span>
<span style="color: #000000">                    </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status</span><span style="color: #000000">==</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA</span><span style="color: #000000">)</span>
<span style="color: #000000">                        </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">5</span><span style="color: #000000">);</span>
<span style="color: #000000">                </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">status</span><span style="color: #000000">==</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA</span><span style="color: #000000">);</span>
<span style="color: #000000">                </span><span style="color: #0000ff">if</span><span style="color: #000000">(((</span><span style="color: #000000">status </span><span style="color: #000000">!=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">&amp;&amp;</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">!=</span>
<span style="color: #000000">                        UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_END_OF_STREAM</span><span style="color: #000000">))||</span>
<span style="color: #000000">                        </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_END_OF_STREAM</span><span style="color: #000000">)&amp;&amp;</span>
<span style="color: #000000">                        </span><span style="color: #000000">(</span><span style="color: #000000">in</span><span style="color: #000000">.</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">()&lt;</span><span style="color: #000000">4</span><span style="color: #000000">))</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                    exit_flag</span><span style="color: #000000">=</span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">                </span><span style="color: #000000">}</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span>
<span style="color: #000000">            fwRender</span><span style="color: #000000">.</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">            videoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">in</span><span style="color: #000000">,&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">            fwRender</span><span style="color: #000000">.</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">            fwRender</span><span style="color: #000000">.</span><span style="color: #000000">RenderFrame</span><span style="color: #000000">();</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000">(!</span><span style="color: #000000">exit_flag</span><span style="color: #000000">&amp;&amp;(</span><span style="color: #000000">status</span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_DATA </span><span style="color: #000000">||</span>
<span style="color: #000000">                status</span><span style="color: #000000">==</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_SYNC</span><span style="color: #000000">));</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">exit_flag</span><span style="color: #000000">!=</span><span style="color: #000000">1</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        fwRender</span><span style="color: #000000">.</span><span style="color: #000000">LockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">        status </span><span style="color: #000000">=</span><span style="color: #000000"> videoDecoder</span><span style="color: #000000">-&gt;</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(</span><span style="color: #000000">NULL</span><span style="color: #000000">,&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">        fwRender</span><span style="color: #000000">.</span><span style="color: #000000">UnLockInputBuffer</span><span style="color: #000000">(&amp;</span><span style="color: #000000">out</span><span style="color: #000000">);</span>
<span style="color: #000000">        fwRender</span><span style="color: #000000">.</span><span style="color: #000000">RenderFrame</span><span style="color: #000000">();</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span></tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_using_a_muxer">Using a muxer</h2>
<div class="sectionbody">
<div class="paragraph"><p>The Intel IPP UMC sample code provides the MPEG2 and MP4 muxer classes to multiplex audio, video, and other elementary streams (ES) into a container.</p></div>
<div class="paragraph"><p>The following are basic steps to use a UMC Muxer class:</p></div>
<div class="olist arabic"><ol class="arabic">
<li>
<p>
Set the muxer parameters UMC::MPEG2MuxerParams or UMC::MP4MuxerParams. See the  MuxerParams class.
</p>
</li>
<li>
<p>
Call the <code>Init()</code> method to initialize a muxer according to the input parameter.
</p>
</li>
<li>
<p>
Call the PutVideoData()/PutAudioData() method to copy video or audio data into an output buffer.
</p>
</li>
<li>
<p>
Call the <code>Close()</code> method to delete all samples remaining in the internal buffers and close the muxer.
</p>
</li>
</ol></div>
<div class="paragraph"><p>The code example below uses the MPEG2 TS muxer to place an H.264 video stream into a
TS stream. Check  here to get full sample code.</p></div>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.1
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #0000ff">void</span><span style="color: #000000"> </span><span style="color: #000000">EncodeStream</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">cYUVData</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">int</span><span style="color: #000000"> imgWidth</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #0000ff">int</span><span style="color: #000000"> imgHeight</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #0000ff">int</span><span style="color: #000000"> frameNumber</span><span style="color: #000000">,</span><span style="color: #000000"> vm_char </span><span style="color: #000000">*</span><span style="color: #000000"> tsFileName</span><span style="color: #000000">)</span>
<span style="color: #000000">{</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">Status</span><span style="color: #000000"> status</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MediaData</span><span style="color: #000000"> DataOut</span><span style="color: #000000">,</span><span style="color: #000000"> MuxData</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoData</span><span style="color: #000000"> DataIn</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264EncoderParams</span><span style="color: #000000"> Params</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264VideoEncoder</span><span style="color: #000000"> H264Encoder</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG2Muxer</span><span style="color: #000000"> Muxer</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">MPEG2MuxerParams</span><span style="color: #000000"> MuxerParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">Ipp8u</span><span style="color: #000000"> </span><span style="color: #000000">*</span><span style="color: #000000">cMaxVideoData</span><span style="color: #000000">=</span><span style="color: #000000">NULL</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> FrameSize</span><span style="color: #000000">;</span>

<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">VideoStreamInfo</span><span style="color: #000000"> VideoInfo</span><span style="color: #000000">;</span>

<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileWriter</span><span style="color: #000000"> Writer</span><span style="color: #000000">;</span>
<span style="color: #000000">    UMC</span><span style="color: #000000">::</span><span style="color: #000000">FileWriterParams</span><span style="color: #000000"> WriterParams</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #000000">strcpy</span><span style="color: #000000">(</span><span style="color: #000000">WriterParams</span><span style="color: #000000">.</span><span style="color: #000000">m_file_name</span><span style="color: #000000">,</span><span style="color: #000000"> tsFileName</span><span style="color: #000000">);</span>
<span style="color: #000000">    Writer</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">WriterParams</span><span style="color: #000000">);</span>

<span style="color: #000000">    MuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_lpDataWriter </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">Writer</span><span style="color: #000000">;</span>
<span style="color: #000000">    MuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_SystemType </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000"> MPEG2_TRANSPORT_STREAM</span><span style="color: #000000">;</span>

<span style="color: #000000">    MuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_nNumberOfTracks </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    MuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #0000ff">new</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">TrackParams</span><span style="color: #000000">[</span><span style="color: #000000">MuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">m_nNumberOfTracks</span><span style="color: #000000">];</span>

<span style="color: #000000">    VideoInfo</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">=</span><span style="color: #000000">imgHeight</span><span style="color: #000000">;</span>
<span style="color: #000000">    VideoInfo</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">=</span><span style="color: #000000">imgWidth</span><span style="color: #000000">;</span>
<span style="color: #000000">    VideoInfo</span><span style="color: #000000">.</span><span style="color: #000000">stream_type</span><span style="color: #000000">=</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">H264_VIDEO</span><span style="color: #000000">;</span>
<span style="color: #000000">    VideoInfo</span><span style="color: #000000">.</span><span style="color: #000000">color_format</span><span style="color: #000000">=</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">YV12</span><span style="color: #000000">;</span>
<span style="color: #000000">    VideoInfo</span><span style="color: #000000">.</span><span style="color: #000000">interlace_type</span><span style="color: #000000">=</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">PROGRESSIVE</span><span style="color: #000000">;</span>
<span style="color: #000000">    VideoInfo</span><span style="color: #000000">.</span><span style="color: #000000">bitrate</span><span style="color: #000000">=</span><span style="color: #000000">1000000</span><span style="color: #000000">;</span><span style="color: #000000"> VideoInfo</span><span style="color: #000000">.</span><span style="color: #000000">streamPID</span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>

<span style="color: #000000">    MuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">type </span><span style="color: #000000">=</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">VIDEO_TRACK</span><span style="color: #000000">;</span>
<span style="color: #000000">    MuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">video </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">VideoInfo</span><span style="color: #000000">;</span>
<span style="color: #000000">    MuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefInputBufferSize</span><span style="color: #000000">=</span><span style="color: #000000">2000000</span><span style="color: #000000">;</span>
<span style="color: #000000">    MuxerParams</span><span style="color: #000000">.</span><span style="color: #000000">pTrackParams</span><span style="color: #000000">[</span><span style="color: #000000">0</span><span style="color: #000000">].</span><span style="color: #000000">bufferParams</span><span style="color: #000000">.</span><span style="color: #000000">m_prefOutputBufferSize</span><span style="color: #000000">=</span><span style="color: #000000">2000000</span><span style="color: #000000">;</span>

<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">((</span><span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000">Muxer</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">MuxerParams</span><span style="color: #000000">))!=</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>

<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">height</span><span style="color: #000000">=</span><span style="color: #000000">imgHeight</span><span style="color: #000000">;</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">clip_info</span><span style="color: #000000">.</span><span style="color: #000000">width</span><span style="color: #000000">=</span><span style="color: #000000">imgWidth</span><span style="color: #000000">;</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">info</span><span style="color: #000000">.</span><span style="color: #000000">bitrate </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1000000</span><span style="color: #000000">;</span>
<span style="color: #000000">    Params</span><span style="color: #000000">.</span><span style="color: #000000">numThreads </span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">1</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">if</span><span style="color: #000000">((</span><span style="color: #000000">status </span><span style="color: #000000">=</span><span style="color: #000000"> H264Encoder</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(&amp;</span><span style="color: #000000">Params</span><span style="color: #000000">))!=</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000ff">return</span><span style="color: #000000">;</span>

<span style="color: #000000">    FrameSize </span><span style="color: #000000">=</span><span style="color: #000000"> imgWidth</span><span style="color: #000000">*</span><span style="color: #000000">imgHeight</span><span style="color: #000000">*</span><span style="color: #000000">3</span><span style="color: #000000">/</span><span style="color: #000000">2</span><span style="color: #000000">;</span>
<span style="color: #000000">    cMaxVideoData</span><span style="color: #000000">=</span><span style="color: #000000"> </span><span style="color: #000000">ippsMalloc_8u</span><span style="color: #000000">(</span><span style="color: #000000">MAXAFRAMESIZE</span><span style="color: #000000">);</span>
<span style="color: #000000">    DataIn</span><span style="color: #000000">.</span><span style="color: #000000">Init</span><span style="color: #000000">(</span><span style="color: #000000">imgWidth</span><span style="color: #000000">,</span><span style="color: #000000">imgHeight</span><span style="color: #000000">,</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">YV12</span><span style="color: #000000">,</span><span style="color: #000000">8</span><span style="color: #000000">);</span>
<span style="color: #000000">    DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cYUVData</span><span style="color: #000000">,</span><span style="color: #000000">FrameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">FrameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">    DataOut</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cMaxVideoData</span><span style="color: #000000">,</span><span style="color: #000000">MAXAFRAMESIZE</span><span style="color: #000000">);</span>

<span style="color: #000000">    </span><span style="color: #0000ff">int</span><span style="color: #000000"> nEncodedFrames</span><span style="color: #000000">=</span><span style="color: #000000">0</span><span style="color: #000000">;</span>
<span style="color: #000000">    </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000"> nEncodedFrames </span><span style="color: #000000">&lt;</span><span style="color: #000000"> frameNumber</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">        status </span><span style="color: #000000">=</span><span style="color: #000000"> H264Encoder</span><span style="color: #000000">.</span><span style="color: #000000">GetFrame</span><span style="color: #000000">(&amp;</span><span style="color: #000000">DataIn</span><span style="color: #000000">,</span><span style="color: #000000"> </span><span style="color: #000000">&amp;</span><span style="color: #000000">DataOut</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">status </span><span style="color: #000000">==</span><span style="color: #000000"> UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_OK</span><span style="color: #000000">)</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">            nEncodedFrames</span><span style="color: #000000">++;</span>
<span style="color: #000000">            MuxData</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">((</span><span style="color: #000000">Ipp8u</span><span style="color: #000000">*)</span><span style="color: #000000">DataOut</span><span style="color: #000000">.</span><span style="color: #000000">GetBufferPointer</span><span style="color: #000000">(),</span>
<span style="color: #000000">                    DataOut</span><span style="color: #000000">.</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>
<span style="color: #000000">            </span><span style="color: #000000">memcpy</span><span style="color: #000000">(</span><span style="color: #000000">MuxData</span><span style="color: #000000">.</span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(),</span><span style="color: #000000">DataOut</span><span style="color: #000000">.</span><span style="color: #000000">GetDataPointer</span><span style="color: #000000">(),</span>
<span style="color: #000000">                    DataOut</span><span style="color: #000000">.</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>
<span style="color: #000000">            MuxData</span><span style="color: #000000">.</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">DataOut</span><span style="color: #000000">.</span><span style="color: #000000">GetDataSize</span><span style="color: #000000">());</span>
<span style="color: #000000">            MuxData</span><span style="color: #000000">.</span><span style="color: #000000">SetTime</span><span style="color: #000000">(</span><span style="color: #000000">nEncodedFrames</span><span style="color: #000000">*((</span><span style="color: #0000ff">double</span><span style="color: #000000">)</span><span style="color: #000000">1.0</span><span style="color: #000000">)/</span><span style="color: #000000">30</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #0000ff">do</span><span style="color: #000000"> </span><span style="color: #000000">{</span>
<span style="color: #000000">                status </span><span style="color: #000000">=</span><span style="color: #000000"> Muxer</span><span style="color: #000000">.</span><span style="color: #000000">PutVideoData</span><span style="color: #000000">(&amp;</span><span style="color: #000000">MuxData</span><span style="color: #000000">);</span>
<span style="color: #000000">                </span><span style="color: #0000ff">if</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_BUFFER </span><span style="color: #000000">==</span><span style="color: #000000"> status</span><span style="color: #000000">)</span>
<span style="color: #000000">                    </span><span style="color: #000000">vm_time_sleep</span><span style="color: #000000">(</span><span style="color: #000000">5</span><span style="color: #000000">);</span>
<span style="color: #000000">            </span><span style="color: #000000">}</span><span style="color: #000000"> </span><span style="color: #0000ff">while</span><span style="color: #000000"> </span><span style="color: #000000">(</span><span style="color: #000000">UMC</span><span style="color: #000000">::</span><span style="color: #000000">UMC_ERR_NOT_ENOUGH_BUFFER </span><span style="color: #000000">==</span><span style="color: #000000"> status</span><span style="color: #000000">);</span>
<span style="color: #000000">            cYUVData</span><span style="color: #000000">+=</span><span style="color: #000000">FrameSize</span><span style="color: #000000">;</span>
<span style="color: #000000">            DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cYUVData</span><span style="color: #000000">,</span><span style="color: #000000">FrameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">            DataIn</span><span style="color: #000000">.</span><span style="color: #000000">SetDataSize</span><span style="color: #000000">(</span><span style="color: #000000">FrameSize</span><span style="color: #000000">);</span>
<span style="color: #000000">            DataOut</span><span style="color: #000000">.</span><span style="color: #000000">SetBufferPointer</span><span style="color: #000000">(</span><span style="color: #000000">cMaxVideoData</span><span style="color: #000000">,</span><span style="color: #000000">MAXAFRAMESIZE</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #000000">}</span>
<span style="color: #000000">    </span><span style="color: #000000">}</span>
<span style="color: #000000">    Muxer</span><span style="color: #000000">.</span><span style="color: #000000">Close</span><span style="color: #000000">();</span>
<span style="color: #0000ff">return</span><span style="color: #000000">;</span>
<span style="color: #000000">}</span>
</tt></pre></div></div>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="_yuv_i420_and_y_u_v_separate_planes">YUV(I420) and Y, U, V separate planes</h2>
<div class="sectionbody">
<div class="paragraph"><p>In the above examples, the YUVData (I420) is stored in a single consecutive array. If your YUV data is stored in a three-planar array, use the UMC function SetPlanePointer(*p, iPlanceNumber) to amend the above code for the Y, U, V planes.  For example, see the following change in the encoder sample:</p></div>
<div class="paragraph"><p>Change</p></div>
<div class="listingblock">
<div class="content">
<pre><code>DataIn.SetBufferPointer(cYUVData,imgWidth*imgHeight*3/2);</code></pre>
</div></div>
<div class="paragraph"><p>to</p></div>
<div class="listingblock">
<div class="content">
<pre><code>// Compared to I420 (YUV) plans are in YV12 (YVU)
//LPBYTE pSrcY = cYUVData;
//LPBYTE pSrcU = pDestY + (imgWidth * imgHeight);
//LPBYTE pSrcV = pDestU + ((imgWidth * imgHeight) / 4);

DataIn.SetPlanePointer(pSrcY, 0); // Y
DataIn.SetPlanePointer(pSrcU, 1); // U
DataIn.SetPlanePointer(pSrcV, 2); // V</code></pre>
</div></div>
</div>
</div>
<h1 id="_bibliography">Bibliography</h1>
<div class="ulist bibliography"><div class="title">This bibliography provides a list of standards that might be helpful to you in using the UMC classes and understanding their descriptions.</div><ul>
<li>
<p>
<a id="3GTS"></a>[3GTS] 3rd Generation Partnership Project - Technical Specification Group Services and System Aspects - Mandatory Speech Codec speech processing functions AMR Speech Coded - General Description (1999).
</p>
</li>
<li>
<p>
<a id="ATSC05"></a>[ATSC05] Digital Audio Compression Standard (AC-3, E-AC-3) - Revision B // Document A/52B:2005. <a href="http://www.atsc.org/standards/a52.html">http://www.atsc.org/standards/a52.html</a>.
</p>
</li>
<li>
<p>
<a id="AVI_RIFF"></a>[AVI_RIFF] AVI RIFF File Reference. <a href="http://msdn.microsoft.com/en-us/library/ms779636.aspx">http://msdn.microsoft.com/en-us/library/ms779636.aspx</a>.
</p>
</li>
<li>
<p>
<a id="DVD"></a>[DVD] DVD Specifications for Read-Only Disc - Part 3: VIDEO SPECIFICATIONS. (v1.14: 2005).
</p>
</li>
<li>
<p>
<a id="DV_AVI"></a>[DV_AVI] DV Data in AVI File Format. <a href="http://msdn.microsoft.com/en-us/library/ms783421.aspx">http://msdn.microsoft.com/en-us/library/ms783421.aspx</a>.
</p>
</li>
<li>
<p>
<a id="ETSI02"></a>[ETSI02] ETSI TS 102 114:2002 (DTS Coherent Acoustics - Core and Extensions)(2002). <a href="http://www.etsi.org/WebSite/homepage.aspx">http://www.etsi.org/WebSite/homepage.aspx</a>
</p>
</li>
<li>
<p>
<a id="ETSI03"></a>[ETSI03] ETSI EN 301 775:2003 (Digital Video Broadcasting (DVB) - Specification for the carriage of Vertical Blanking Information (VBI) data in DVB bitstreams)(2003). <a href="http://www.etsi.org/WebSite/homepage.aspx">http://www.etsi.org/WebSite/homepage.aspx</a>
</p>
</li>
<li>
<p>
<a id="ETSI06"></a>[ETSI06] ETSI TS 300 468:2006 (Digital Video Broadcasting (DVB) - Specification for Service Information (SI) in DVB systems)(2006). <a href="http://www.etsi.org/WebSite/homepage.aspx">http://www.etsi.org/WebSite/homepage.aspx</a>
</p>
</li>
<li>
<p>
<a id="FOURCC"></a>[FOURCC] <a href="http://www.fourcc.org/">http://www.fourcc.org/</a>
</p>
</li>
<li>
<p>
<a id="GBT200902"></a>[GBT200902] The Standards of People&#8217;s Republic of China - GB/T 20090.2-2006. Information Technology. Advanced Coding of Audio and Video. Part 2: Video (February, 2006).
</p>
</li>
<li>
<p>
<a id="IEC61834"></a>[IEC61834] IEC 61834. International Electrochemical Commission. Specifications of Consumer-Use Digital VCRs using 6.3 mm magnetic tape (the "Blue Book" DV specification).
</p>
</li>
<li>
<p>
<a id="ISOIEC109181"></a>[ISOIEC109181] ISO/IEC 10918-1:1994 (Information Technology - Digital compression and coding of continuous-tone still images: Requirements and guidelines).(1994).
</p>
</li>
<li>
<p>
<a id="ISOIEC931"></a>[ISOIEC931] ISO/IEC 11172-1:1993 (Coding of moving pictures and associated audio - for digital storage media at up to about 1.5 Mbit/s - Part 1 Systems).(1993). <a href="http://www.mpeg.org/MPEG/systems.html">http://www.mpeg.org/MPEG/systems.html</a>.
</p>
</li>
<li>
<p>
<a id="ISOIEC932"></a>[ISOIEC932] ISO/IEC 11172-2:1993 (Coding of moving pictures and associated audio - for digital storage media at up to about 1.5 Mbit/s - Part 2 Video).(1993). <a href="http://www.mpeg.org/MPEG/video.html">http://www.mpeg.org/MPEG/video.html</a>.
</p>
</li>
<li>
<p>
<a id="ISOIEC933"></a>[ISOIEC933] ISO/IEC 11172-3:1993 (Coding of moving pictures and associated audio - for digital storage media at up to about 1.5 Mbit/s - Part 3 Audio).(1993). <a href="http://www.mpeg.org/MPEG/audio.html">http://www.mpeg.org/MPEG/audio.html</a>.
</p>
</li>
<li>
<p>
<a id="ISOIEC96"></a>[ISOIEC96] ISO/IEC 13818-2:1996 (E) (Information Technology. - Generic Coding of Moving Pictures and Associated Audio Information). (05/96).
</p>
</li>
<li>
<p>
<a id="ISOIEC98"></a>[ISOIEC98] ISO/IEC 13818-3:1998 (E) (Information Technology. - Generic Coding of Moving Pictures and Associated Audio Information) (1998).
</p>
</li>
<li>
<p>
<a id="ISOIEC00"></a>[ISOIEC00] ISO/IEC 13818-1:2000 (E) (Information Technology. - Generic Coding of Moving Pictures and Associated Audio Information: Systems) (2000).
</p>
</li>
<li>
<p>
<a id="ISOIEC_Sys"></a>[ISOIEC_Sys] ISO/IEC 14496-1:2001 (E) (Information technology - Coding of audio-visual objects. Part 1: Systems). <a href="http://www.mpeg.org/MPEG/systems.html">http://www.mpeg.org/MPEG/systems.html</a>
</p>
</li>
<li>
<p>
<a id="ISOIEC_Visual"></a>[ISOIEC_Visual] ISO/IEC 14496-2:2004 (E) (Information technology - Coding of audio-visual objects. Part 2: Visual).
</p>
</li>
<li>
<p>
<a id="ISOIEC_Audio"></a>[ISOIEC_Audio] ISO/IEC 14496-3:2001 (E) (Information technology - Coding of audio-visual objects. Part 3: Audio).
</p>
</li>
<li>
<p>
<a id="ISOIEC_Main"></a>[ISOIEC_Main] ISO/IEC FDIS 14496-3:2001 (Information technology - Coding of audio-visual objects. Part 3: Audio Subpart 1: Main).
</p>
</li>
<li>
<p>
<a id="ISOIEC_GA"></a>[ISOIEC_GA] ISO/IEC FDIS 14496-3:2001 (Information Technology - Coding of audio-visual objects. Part 3: Audio Subpart 4: General Audio (GA) Coding: AAC/TwinVQ).
</p>
</li>
<li>
<p>
<a id="ISOIEC_Am1"></a>[ISOIEC_Am1] ISO/IEC FDIS 14496-3:2001/Amd.1:2003 (Information Technology - Coding of audio-visual objects. Part 3: Audio AMENDMENT 1: Bandwidth extension).
</p>
</li>
<li>
<p>
<a id="ISOIEC_AmCor"></a>[ISOIEC_AmCor]ISO/IEC FDIS 14496-3:2001/Amd.1:2003/Cor.1:2004 (Information Technology - Coding of audio-visual objects Part 3: Audio AMENDMENT 1: Bandwidth extension TECHNICAL CORRIGENDUM 1).
</p>
</li>
<li>
<p>
<a id="ISOIEC_10"></a>[ISOIEC_10] ISO/IEC FDIS 14496-10:2005 (E) (Information Technology - Coding of audio-visual objects Part 10: Advanced Video Coding).
</p>
</li>
<li>
<p>
<a id="ISOIEC_12"></a>[ISOIEC_12] ISO/IEC 14496-12:2005 (E) (Information Technology - Coding of audio-visual objects Part 12: ISO base media file format).
</p>
</li>
<li>
<p>
<a id="ISOIEC_14"></a>[ISOIEC_14] ISO/IEC FDIS 14496-14:2003 (E) (Information Technology - Coding of audio-visual objects Part 14: MP4 file format).
</p>
</li>
<li>
<p>
<a id="ISOIEC_15"></a>[ISOIEC_15] ISO/IEC FDIS 14496-15:2004 (E) (Information Technology - Coding of audio-visual objects Part 15: Advanced Video Coding (AVC) file format).
</p>
</li>
<li>
<p>
<a id="ITUH261"></a>[ITUH261] ITU-T Recommendation H.261. Line transmission of non-telephone signals. Video codec for audiovisual services at p x 64 kbits (03/93).
</p>
</li>
<li>
<p>
<a id="ITUH263"></a>[ITUH263] ITU-T Recommendation H.263. Series H: AUDIOVISUAL AND MULTIMEDIA SYSTEMS. Infrastructure of audiovisual services - Coding of moving video. Video coding for low bit rate communication (01/05).
</p>
</li>
<li>
<p>
<a id="ITUH264"></a>[ITUH264] ITU-T Recommendation H.264. Series H: AUDIOVISUAL AND MULTIMEDIA SYSTEMS. Infrastructure of audiovisual services - Coding of moving video. Advanced video coding for generic audiovisual services (ITU-T Rec. H.264 | ISO/IEC 14496-10:2005)(11/07).
</p>
</li>
<li>
<p>
<a id="OpenDML"></a>[OpenDML] OpenDML AVI File Format Extensions. Version 1.02. OpenDML AVI M-JPEG File Format Subcommittee. Last revision - February 28,1996 (09/97).
</p>
</li>
<li>
<p>
<a id="RFC2032"></a>[RFC2032] RTP Payload Format for H.261 Video Streams // RFC2032 (10/96).
</p>
</li>
<li>
<p>
<a id="RFC2190"></a>[RFC2190] RTP Payload Format for H.263 Video Streams // RFC2190 (09/97). See <a href="http://www.ietf.org/rfc/rfc2190.txt">http://www.ietf.org/rfc/rfc2190.txt</a>
</p>
</li>
<li>
<p>
<a id="SMPTE314M"></a>[SMPTE314M] SMPTE 314M-2005 for Television - Data Structure for DV-Based Audio, Data and Compressed Video - 25 and 50 Mb/s. The Society of Motion Picture and Television Engineers (09/05).
</p>
</li>
<li>
<p>
<a id="SMPTE370M"></a>[SMPTE370M] SMPTE 370M-2002 for Television - Data Structure for DV-Based Audio, Data and Compressed Video at 100 Mb/s 1080/60i, 1080/50i, 720/60p. The Society of Motion Picture and Television Engineers (2002).
</p>
</li>
<li>
<p>
<a id="SMPTE421M"></a>[SMPTE421M] SMPTE 421M-2006 Television - VC-1 Compressed Video Bitstream Format and Decoding Process (01/06).
</p>
</li>
</ul></div>
<h1 id="_glossary">Glossary</h1>
<div class="dlist glossary"><dl>
<dt>
AAC
</dt>
<dd>
<p>
    Advanced Audio Coding
</p>
</dd>
<dt>
AAC_LC
</dt>
<dd>
<p>
    AAC Low Complexity Profile
</p>
</dd>
<dt>
AAC_LTP
</dt>
<dd>
<p>
        AAC Long Term Prediction Profile
</p>
</dd>
<dt>
AAC_MAIN
</dt>
<dd>
<p>
    AAC Main Profile
</p>
</dd>
<dt>
AAC_SSR
</dt>
<dd>
<p>
    AAC Scalable Sampling Rate Profile
</p>
</dd>
<dt>
ABR
</dt>
<dd>
<p>
    Average Bit Rate
</p>
</dd>
<dt>
AC
</dt>
<dd>
<p>
    Audio Compression
</p>
</dd>
<dt>
ADIF
</dt>
<dd>
<p>
        Accounting Data Interchange Format
</p>
</dd>
<dt>
ADTS
</dt>
<dd>
<p>
    Audio Data Transport Stream
</p>
</dd>
<dt>
Allegro DVT*
</dt>
<dd>
<p>
    Set of conformance streams provided by Allegro company
</p>
</dd>
<dt>
APP0
</dt>
<dd>
<p>
    Application segment marker used in M-JPEG streams to specify video frame parameters
</p>
</dd>
<dt>
ASCII
</dt>
<dd>
<p>
    American Standard Code for Information Interchange
</p>
</dd>
<dt>
ATSC
</dt>
<dd>
<p>
    Advanced Television Systems Committee
</p>
</dd>
<dt>
AU
</dt>
<dd>
<p>
    Access Unit
</p>
</dd>
<dt>
AVBR
</dt>
<dd>
<p>
    Average Variable Bit Rate
</p>
</dd>
<dt>
AVI
</dt>
<dd>
<p>
    Audio Video Interleave
</p>
</dd>
<dt>
B frame
</dt>
<dd>
<p>
    Bi-predicted frame. B frame encoding utilizes information from the previous and future frames in presentation order.
</p>
</dd>
<dt>
BRC
</dt>
<dd>
<p>
    Bitrate Control
</p>
</dd>
<dt>
CABAC
</dt>
<dd>
<p>
    Context-based Adaptive Binary Arithmetic Coding
</p>
</dd>
<dt>
CAVLC
</dt>
<dd>
<p>
    Context-based Adaptive Variable Length Coding
</p>
</dd>
<dt>
CBR
</dt>
<dd>
<p>
    Constant Bit Rate
</p>
</dd>
<dt>
CCE
</dt>
<dd>
<p>
    Channel Coupling Element
</p>
</dd>
<dt>
CPE
</dt>
<dd>
<p>
    Channel Pair Element
</p>
</dd>
<dt>
DBP
</dt>
<dd>
<p>
    Decoded buffer size, an internal buffer of the decoder, where the decoder keeps reference and frames in process of decoding.
</p>
</dd>
<dt>
DCT
</dt>
<dd>
<p>
    Discrete Cosine Transform
</p>
</dd>
<dt>
DPB
</dt>
<dd>
<p>
    Decoded Picture Buffer
</p>
</dd>
<dt>
DRC
</dt>
<dd>
<p>
    Dynamic Range Control
</p>
</dd>
<dt>
DS
</dt>
<dd>
<p>
    MS* DirectShow*
</p>
</dd>
<dt>
DSE
</dt>
<dd>
<p>
    Data Stream Element
</p>
</dd>
<dt>
DTS
</dt>
<dd>
<p>
    Decoding Time Stamp
</p>
</dd>
<dt>
DV
</dt>
<dd>
<p>
    Digital Video
</p>
</dd>
<dt>
DVHD
</dt>
<dd>
<p>
    Digital Video High Definition, DV100
</p>
</dd>
<dt>
DVSD
</dt>
<dd>
<p>
    Digital Video Standard Definition
</p>
</dd>
<dt>
EOS
</dt>
<dd>
<p>
    End of Stream
</p>
</dd>
<dt>
ES
</dt>
<dd>
<p>
    Elementary Stream
</p>
</dd>
<dt>
FDIS
</dt>
<dd>
<p>
    Final Draft International Standard
</p>
</dd>
<dt>
Field coded frame
</dt>
<dd>
<p>
        Frame that consists of two interlaced halves - fields. Each field contains either odd or even lines of the frame. Fields have to be displayed at different time moments. Both top and bottom field can go first.
</p>
</dd>
<dt>
FOURCC
</dt>
<dd>
<p>
    FOUR Character Code, a sequence of four bytes used to uniquely identify data formats
</p>
</dd>
<dt>
FW
</dt>
<dd>
<p>
    File Writer
</p>
</dd>
<dt>
GMC
</dt>
<dd>
<p>
    Global Motion Compensation
</p>
</dd>
<dt>
GOB
</dt>
<dd>
<p>
    Group of Blocks
</p>
</dd>
<dt>
GOP
</dt>
<dd>
<p>
    Group of Pictures - independent decoding unit
</p>
</dd>
<dt>
H264
</dt>
<dd>
<p>
    Standard that described rules, limitations, and algorithms of MPEG4 part 10 video encoding/decoding processes.
</p>
</dd>
<dt>
HRD
</dt>
<dd>
<p>
    Hypothetical Reference Decoder
</p>
</dd>
<dt>
I frame
</dt>
<dd>
<p>
    Intra frame. I-frame encoding does not use inter-frame dependencies.
</p>
</dd>
<dt>
IA-32
</dt>
<dd>
<p>
    Intel&#174; Architecture, 32-bit
</p>
</dd>
<dt>
IDCT
</dt>
<dd>
<p>
    Inverse Discrete Cosine Transform
</p>
</dd>
<dt>
IDR
</dt>
<dd>
<p>
    Instantaneous Decoding Refresh
</p>
</dd>
<dt>
IEC
</dt>
<dd>
<p>
    International Electrotechnical Commission
</p>
</dd>
<dt>
Intel&#174; 64
</dt>
<dd>
<p>
    Intel&#174; Architecture, formerly known as Intel&#174; Processors Family with EM64T
</p>
</dd>
<dt>
Interlace structure
</dt>
<dd>
<p>
    Property that defines whether the video data contains a single frame or two fields merged into a frame or either top or bottom field.
</p>
</dd>
<dt>
IPP
</dt>
<dd>
<p>
    Integrated Performance Primitives
</p>
</dd>
<dt>
IS
</dt>
<dd>
<p>
    Intensity Stereo
</p>
</dd>
<dt>
ISO
</dt>
<dd>
<p>
    International Organization for Standardization
</p>
</dd>
<dt>
ITU
</dt>
<dd>
<p>
    International Telecommunication Union
</p>
</dd>
<dt>
ITU-T
</dt>
<dd>
<p>
    Telecommunication Standardization Sector of ITU
</p>
</dd>
<dt>
JPEG
</dt>
<dd>
<p>
    Joint Photographic Experts Group, development group for lossy compressed 24 bit color image storage format; also a file extension
</p>
</dd>
<dt>
LFE
</dt>
<dd>
<p>
    Low-Frequency Effects; Low Frequency Element
</p>
</dd>
<dt>
LPCM
</dt>
<dd>
<p>
    Linear Pulse-Code Modulation
</p>
</dd>
<dt>
LTP
</dt>
<dd>
<p>
    Long Term Prediction
</p>
</dd>
<dt>
MB
</dt>
<dd>
<p>
    Macroblock
</p>
</dd>
<dt>
MC
</dt>
<dd>
<p>
    Motion Compensation
</p>
</dd>
<dt>
MCU
</dt>
<dd>
<p>
    Minimum Coding Unit
</p>
</dd>
<dt>
MDCT
</dt>
<dd>
<p>
    Modified Discrete Cosine Transform
</p>
</dd>
<dt>
ME
</dt>
<dd>
<p>
    Motion Estimation
</p>
</dd>
<dt>
MP3
</dt>
<dd>
<p>
    MPEG-1 Audio Layer 3, more commonly referred to as MP3, a digital audio encoding and lossy compression format
</p>
</dd>
<dt>
MP4
</dt>
<dd>
<p>
    A format of file containers that usually have an .mp4 extension.
</p>
</dd>
<dt>
MPEG
</dt>
<dd>
<p>
    Moving Picture Experts Group
</p>
</dd>
<dt>
MPEG-1
</dt>
<dd>
<p>
    Initial video and audio compression standard. Later used as the standard for Video CD, and includes the popular Layer 3 (MP3) audio compression format.
</p>
</dd>
<dt>
MPEG-2
</dt>
<dd>
<p>
    A standard created by MPEG and typically used to encode audio and video broadcast signals
</p>
</dd>
<dt>
MPEG-2.5
</dt>
<dd>
<p>
    A non-standard extension of MPEG-2 audio layer 3 by Fraunhofer Gesellschaft for lowest sampling rates (8-12 kHz) targeting bitrates from 16-32 kbps (possibly 8-160 kbps)
</p>
</dd>
<dt>
MPEG-4
</dt>
<dd>
<p>
    A standard created by MPEG and typically used in working with audio and video digital data
</p>
</dd>
<dt>
MV
</dt>
<dd>
<p>
    Motion Vector
</p>
</dd>
<dt>
NAL unit
</dt>
<dd>
<p>
    Network abstract layer unit - a syntax structure containing data bytes following the start code.
</p>
</dd>
<dt>
NTSC
</dt>
<dd>
<p>
    National Television Standards Committee, a TV standard
</p>
</dd>
<dt>
OBMC
</dt>
<dd>
<p>
    Overlapped Block Motion Compensation
</p>
</dd>
<dt>
OpenMP
</dt>
<dd>
<p>
    OpenMP* Standard, see <a href="http://www.openmp.org">http://www.openmp.org</a>
</p>
</dd>
<dt>
P frame
</dt>
<dd>
<p>
    Predicted frame. P frame encoding utilizes information from the previously encoded frames.
</p>
</dd>
<dt>
PAL
</dt>
<dd>
<p>
    Phase Alternation by Line, a TV standard
</p>
</dd>
<dt>
PAT
</dt>
<dd>
<p>
    Program Association Table. Defined in ISO/IEC 13818-1 for MPEG2 Transport Streams <a href="#ISOIEC00">[ISOIEC00]</a>.
</p>
</dd>
<dt>
PCM
</dt>
<dd>
<p>
    Pulse-Code Modulation
</p>
</dd>
<dt>
PCR
</dt>
<dd>
<p>
    Program Clock Reference. Defined in ISO/IEC 13818-1 for MPEG2 Transport Streams <a href="#ISOIEC00">[ISOIEC00]</a>.
</p>
</dd>
<dt>
PES
</dt>
<dd>
<p>
    Packetized Elementary Stream. Defined in ISO/IEC 13818-1 <a href="#ISOIEC00">[ISOIEC00]</a>.
</p>
</dd>
<dt>
PID
</dt>
<dd>
<p>
    Packet IDentificator
</p>
</dd>
<dt>
pin
</dt>
<dd>
<p>
    Elementary stream identifier that associates a certain ES with the output buffer and other related structures
</p>
</dd>
<dt>
PMT
</dt>
<dd>
<p>
    Program Map Table. Defined in ISO/IEC 13818-1 for MPEG2 Transport Streams <a href="#ISOIEC00">[ISOIEC00]</a>.
</p>
</dd>
<dt>
PNS
</dt>
<dd>
<p>
    Perceptual Noise Substitution
</p>
</dd>
<dt>
PQF
</dt>
<dd>
<p>
    Polyphase Quadrature Filter
</p>
</dd>
<dt>
PS
</dt>
<dd>
<p>
    Program Stream. Defined in ISO/IEC 13818-1 <a href="#ISOIEC00">[ISOIEC00]</a>.
</p>
</dd>
<dt>
PTS
</dt>
<dd>
<p>
    Presentation Time Stamp, a time stamp associated with a frame. Usually used to restore frame order and frame rate in formats with inter-frame dependencies.
</p>
</dd>
<dt>
RD
</dt>
<dd>
<p>
    Rate Distortion
</p>
</dd>
<dt>
RFC
</dt>
<dd>
<p>
    Request for Comments, a series of numbered Internet informational documents and standards
</p>
</dd>
<dt>
RGB
</dt>
<dd>
<p>
    An additive model in which Red, Green, and Blue are combined in various ways to reproduce other colors
</p>
</dd>
<dt>
RGB565
</dt>
<dd>
<p>
    RGB mode that has 5 bits per red, 6 bits per green, and 5 bits per blue component
</p>
</dd>
<dt>
RIFF
</dt>
<dd>
<p>
    Resource Interchange File Format
</p>
</dd>
<dt>
RTP
</dt>
<dd>
<p>
    Real-time Transport Protocol
</p>
</dd>
<dt>
RVLC
</dt>
<dd>
<p>
    Reversible VLC
</p>
</dd>
<dt>
SBR
</dt>
<dd>
<p>
    Spectral Band Replication
</p>
</dd>
<dt>
SCE
</dt>
<dd>
<p>
    Single Channel Element
</p>
</dd>
<dt>
SCR
</dt>
<dd>
<p>
    System Clock Reference. Defined in ISO/IEC 13818-1 for MPEG2 Transport Streams <a href="#ISOIEC00">[ISOIEC00]</a>.
</p>
</dd>
<dt>
SDK
</dt>
<dd>
<p>
    Software Development Kit
</p>
</dd>
<dt>
SDL
</dt>
<dd>
<p>
    Software Development Library
</p>
</dd>
<dt>
SEI
</dt>
<dd>
<p>
    Supplemental Enhancement Information
</p>
</dd>
<dt>
SMPTE
</dt>
<dd>
<p>
    Society of Motion Picture and Television Engineers
</p>
</dd>
<dt>
SSR
</dt>
<dd>
<p>
    Scalable Sampling Rate
</p>
</dd>
<dt>
SW
</dt>
<dd>
<p>
    Software
</p>
</dd>
<dt>
TNS
</dt>
<dd>
<p>
    Temporal Noise Shaping
</p>
</dd>
<dt>
TS
</dt>
<dd>
<p>
    Transport Stream. Defined in ISO/IEC 13818-1 <a href="#ISOIEC00">[ISOIEC00]</a>. TTS 1. Tree Type Structure; 2. Time-Stamped Transport Stream.
</p>
</dd>
<dt>
UMC
</dt>
<dd>
<p>
    Unified Media Classes
</p>
</dd>
<dt>
VBR
</dt>
<dd>
<p>
    Variable Bit Rate
</p>
</dd>
<dt>
VBV
</dt>
<dd>
<p>
    Video Buffering Verifier
</p>
</dd>
<dt>
VC
</dt>
<dd>
<p>
    Video Codec
</p>
</dd>
<dt>
VC1
</dt>
<dd>
<p>
    Informal name of the SMPTE standard describing a video codec based on Microsoft Windows Media Video* version 9. See <a href="#SMPTE421M">[SMPTE421M]</a>.
</p>
</dd>
<dt>
Video CD
</dt>
<dd>
<p>
    Compact Disc digital video, a standard digital format for storing video on a Compact Disc
</p>
</dd>
<dt>
VLC
</dt>
<dd>
<p>
    Variable Length Coding
</p>
</dd>
<dt>
VLD
</dt>
<dd>
<p>
    Variable Length Decoding
</p>
</dd>
<dt>
VOP
</dt>
<dd>
<p>
    Video Object Plane
</p>
</dd>
<dt>
YUV
</dt>
<dd>
<p>
    The YUV model defines a color space in terms of one luminance and two chrominance components. Y stands for the luminance component (the brightness) and U and V are the chrominance (color)
components.
</p>
</dd>
<dt>
YUV 4:2:2
</dt>
<dd>
<p>
    YUV model. Each of the two color-difference channels has half the sample rate of the luma channel, so horizontal color resolution is only half that of 4:4:4. For uncompressed video and 8-bit quantization, each macropixel of two neighboring pixels uses 4 bytes of memory.
</p>
</dd>
<dt>
YUV 4:4:4
</dt>
<dd>
<p>
    YUV model. Each of the three channels has the same sample rate, so each single pixel in the resulting image gets three full words (usually 8 or 10 bits long) of information, resulting in 3 bytes per pixel for
8-bit quantization when compression is not used.
</p>
</dd>
<dt>
YV12
</dt>
<dd>
<p>
    Model with 12 bpp. 8 bit Y plane followed by 8 bit 2x2 subsampled V and U planes.
</p>
</dd>
</dl></div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
</div>
</div>
</body>
</html>
